<!-- Generated from an LAML (Lisp Abstracted Markup Language) source file. LAML is designed and implemented by Kurt Nørmark, normark@cs.auc.dk. Time of generation: 21. Marts 2000 14:06:03-->

<html><head><title>Source file</title></head><body bgcolor = "#ffffff" text = "#000000" link = "#000000" vlink = "#000000" ><font size = "3"  ><pre><font color = "#70a800">;;;; This is a library of generally useful Scheme functions which are used in many other libraries,
;;;; styles or tools.</font>
<font color = "#70a800">; The LAML library and programs written by Kurt Normark, Aalborg University, Denmark.
; Copyright (C) 1999  Kurt Normark, normark@s.auc.dk.
;
; This program is free software; you can redistribute it and/or modify
; it under the terms of the GNU General Public License as published by
; the Free Software Foundation; either version 2 of the License, or
; (at your option) any later version.
;
; This program is distributed in the hope that it will be useful,
; but WITHOUT ANY WARRANTY; without even the implied warranty of
; MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
; GNU General Public License for more details.
;
; You should have received a copy of the GNU General Public License
; along with this program; if not, write to the Free Software
; Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  US</font>
<font color = "#70a800">;;; Generation of list selector functions.
;;; As an alternative to using car, cadr etc. we provide for generation of more general list selector functions.</font>
<a name="make-selector-function"><font color = "#70a800">;; Returns a function, which selects element number n in a list.
;; The second parameter, which is optional, is used for error message purposes.
;; In general, this parameter should be a string corresponding to the name of the selector function.
;; If the second parameter is given, we check whether the list is long enough for selection.
;; If not, we give a decent error message. We recommend use of the second parameter in order to
;; avoid meaningless error messages.
;; The first element is number 1.
;; (make-selector-function 1) corresponds to car, (make-selector-function 2) corresponds to cadr, etc.</font>
<a name="make-selector-function"><a href = "general.html#make-selector-function"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-m.html#make-selector-function" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from make-selector-function to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(make-selector-function n . selector-name)</font></b>
 (<b>let</b> ((selector-name-1 (<b>if</b> (<font color = "#a64700">null?</font> selector-name) #f (<font color = "#a64700">car</font> selector-name))))
   (<b>if</b> selector-name-1
       (<b>lambda</b> (lst) 
         (<b>let</b> ((lgt (<font color = "#a64700">length</font> lst)))
            (<b>if</b> (<font color = "#a64700">&gt;</font> n lgt)
                (<a href = "general.html#display-error" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">display-error</font></a> (<font color = "#a64700">string-append</font> "The selector function " (<a href = "general.html#as-string" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">as-string</font></a> selector-name-1) ": " 
                               "The list "  (<a href = "general.html#as-string" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">as-string</font></a> lst) " is is too short for selection. "
                               "It must have at least " (<a href = "general.html#as-string" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">as-string</font></a> n) " elements."
                               ))
                (<font color = "#a64700">list-ref</font> lst (<font color = "#a64700">-</font> n 1)))))
       (<b>lambda</b> (lst) (<font color = "#a64700">list-ref</font> lst (<font color = "#a64700">-</font> n 1))))))

<a name="first"><font color = "#70a800">;; Return the first element of a list
;; .form (first lst)</font>
<a name="first"><a href = "general.html#first"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-f.html#first" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from first to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >first</font></b> <font color = "#a64700">car</font>)

<a name="second"><font color = "#70a800">;; Return the second element of a list
;; .form (second lst)</font>
<a name="second"><a href = "general.html#second"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-s.html#second" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from second to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >second</font></b> <font color = "#a64700">cadr</font>)

<a name="third"><font color = "#70a800">;; Return the third element of a list
;; .form (third lst)</font>
<a name="third"><a href = "general.html#third"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-t.html#third" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from third to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >third</font></b> <font color = "#a64700">caddr</font>)

<a name="fourth"><font color = "#70a800">;; Return the fourth element of a list
;; .form (fourth lst)</font>
<a name="fourth"><a href = "general.html#fourth"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-f.html#fourth" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from fourth to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >fourth</font></b> <font color = "#a64700">cadddr</font>)

<a name="fifth"><font color = "#70a800">;; Return the fifth element of a list
;; .form (fifth lst)
;; .returns The fifth element of the list</font>
<a name="fifth"><a href = "general.html#fifth"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-f.html#fifth" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from fifth to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >fifth</font></b> (<a href = "general.html#make-selector-function" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">make-selector-function</font></a> 5))

<a name="sixth"><font color = "#70a800">;; Return the sixth element of a list
;; .form (sixth lst)</font>
<a name="sixth"><a href = "general.html#sixth"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-s.html#sixth" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from sixth to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >sixth</font></b> (<a href = "general.html#make-selector-function" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">make-selector-function</font></a> 6))

<a name="seventh"><font color = "#70a800">;; Return the seventh element of a list
;; .form (seventh lst)</font>
<a name="seventh"><a href = "general.html#seventh"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-s.html#seventh" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from seventh to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >seventh</font></b> (<a href = "general.html#make-selector-function" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">make-selector-function</font></a> 7))

<a name="eighth"><font color = "#70a800">;; Return the eighth element of a list
;; .form (eighth lst)</font>
<a name="eighth"><a href = "general.html#eighth"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-e.html#eighth" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from eighth to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >eighth</font></b> (<a href = "general.html#make-selector-function" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">make-selector-function</font></a> 8))

<a name="nineth"><font color = "#70a800">;; Return the nineth element of a list
;; .form (nineth lst)</font>
<a name="nineth"><a href = "general.html#nineth"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-n.html#nineth" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from nineth to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >nineth</font></b> (<a href = "general.html#make-selector-function" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">make-selector-function</font></a> 9))


<font color = "#70a800">;;; Association list functions. 
;;; Here follows a number of functions which work on alists, or make alists.</font>
<a name="symbolize-key"><font color = "#70a800">;; A functions which converts the key position in an a-lists to symbols
;; key-value-pair is a pair, such as ("key" . "val"). Return (key . "val").</font>
<a name="symbolize-key"><a href = "general.html#symbolize-key"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-s.html#symbolize-key" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from symbolize-key to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(symbolize-key key-value-pair)</font></b>
 (<font color = "#a64700">cons</font> (<a href = "general.html#as-symbol" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">as-symbol</font></a> (<font color = "#a64700">car</font> key-value-pair)) (<font color = "#a64700">cdr</font> key-value-pair)))

<a name="extend-a-list"><font color = "#70a800">;; Add a key-value pair to a-list. Like acons in some systems.</font>
<a name="extend-a-list"><a href = "general.html#extend-a-list"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-e.html#extend-a-list" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from extend-a-list to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(extend-a-list key value a-list)</font></b>
 (<font color = "#a64700">cons</font> (<font color = "#a64700">cons</font> (<a href = "general.html#as-symbol" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">as-symbol</font></a> key) value) a-list))

<a name="get"><font color = "#70a800">;; Return a value from an alist. key is a symbol. Uses assq internally.</font>
<a name="get"><a href = "general.html#get"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-g.html#get" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from get to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(get key a-list)</font></b>
  (<b>let</b> ((res (<font color = "#a64700">assq</font> key a-list)))
    (<b>if</b> (<font color = "#a64700">pair?</font> res) 
        (<font color = "#a64700">cdr</font> res)
        (error (<font color = "#a64700">string-append</font> "Cannot find " (<a href = "general.html#as-string" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">as-string</font></a> key) " in " (<a href = "general.html#as-string" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">as-string</font></a> a-list))))))

<a name="defaulted-get"><font color = "#70a800">;; Return the value of key (by means of cdr of assq). If no association is found return default.</font>
<a name="defaulted-get"><a href = "general.html#defaulted-get"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-d.html#defaulted-get" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from defaulted-get to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(defaulted-get key alist default)</font></b>
  (<b>let</b> ((res (<font color = "#a64700">assq</font> key alist)))
    (<b>if</b> res
       (<font color = "#a64700">cdr</font> res)
       default)))

<a name="alist-from-keys-and-values"><font color = "#70a800">;; Make an alist from a key-list and a val-list. 
;; Requires that the lengths of the two input lists are equal.</font>
<a name="alist-from-keys-and-values"><a href = "general.html#alist-from-keys-and-values"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-a.html#alist-from-keys-and-values" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from alist-from-keys-and-values to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(alist-from-keys-and-values key-list val-list)</font></b>
  (<b>if</b> (<font color = "#a64700">=</font> (<font color = "#a64700">length</font> key-list) (<font color = "#a64700">length</font> val-list))
      (<a href = "general.html#alist-from-keys-and-values-1" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">alist-from-keys-and-values-1</font></a> key-list val-list)
      (error "alist-from-keys-and-values: key and val list do not have same lengths")))

<a name="alist-from-keys-and-values-1"><a href = "general.html#alist-from-keys-and-values-1"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-a.html#alist-from-keys-and-values-1" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from alist-from-keys-and-values-1 to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(alist-from-keys-and-values-1 key-list val-list)</font></b>
  (<b>if</b> (<font color = "#a64700">null?</font> key-list)
      '()
      (<font color = "#a64700">cons</font> (<font color = "#a64700">cons</font> (<font color = "#a64700">car</font> key-list) (<font color = "#a64700">car</font> val-list))
            (<a href = "general.html#alist-from-keys-and-values-1" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">alist-from-keys-and-values-1</font></a> (<font color = "#a64700">cdr</font> key-list) (<font color = "#a64700">cdr</font> val-list)))))

<a name="propertylist-to-alist"><font color = "#70a800">;; Make and return an association list from a property list plist.</font>
<a name="propertylist-to-alist"><a href = "general.html#propertylist-to-alist"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-p.html#propertylist-to-alist" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from propertylist-to-alist to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(propertylist-to-alist plist)</font></b>
  (<b>let</b> ((lgt (<font color = "#a64700">length</font> plist)))
   (<b>cond</b> ((<font color = "#a64700">null?</font> plist) '())
         ((<font color = "#a64700">=</font> 1 lgt) (error "property-list-to-a-list called with list of odd length. A property list is always of even length"))
         ((<font color = "#a64700">&gt;=</font> lgt 2) (<font color = "#a64700">cons</font> (<font color = "#a64700">cons</font> (<font color = "#a64700">car</font> plist) (<font color = "#a64700">cadr</font> plist)) (<a href = "general.html#propertylist-to-alist" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">propertylist-to-alist</font></a> (<font color = "#a64700">cddr</font> plist)))))))

<a name="alist-to-propertylist"><font color = "#70a800">;; Make and return a property list from an association list.</font>
<a name="alist-to-propertylist"><a href = "general.html#alist-to-propertylist"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-a.html#alist-to-propertylist" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from alist-to-propertylist to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(alist-to-propertylist alist)</font></b>
  (<b>cond</b> ((<font color = "#a64700">null?</font> alist) '())
        (<b>else</b> (<font color = "#a64700">cons</font> (<font color = "#a64700">car</font> (<font color = "#a64700">car</font> alist)) (<font color = "#a64700">cons</font> (<font color = "#a64700">cdr</font> (<font color = "#a64700">car</font> alist)) (<a href = "general.html#alist-to-propertylist" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">alist-to-propertylist</font></a> (<font color = "#a64700">cdr</font> alist)))))))

<a name="every-second-element"><font color = "#70a800">;; Return every second element of list, starting with the first element.
;; This function is useful to extract the keys or values of a property list.</font>
<a name="every-second-element"><a href = "general.html#every-second-element"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-e.html#every-second-element" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from every-second-element to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(every-second-element lst)</font></b>
  (<b>cond</b> ((<font color = "#a64700">null?</font> lst) '())
        ((<font color = "#a64700">null?</font> (<font color = "#a64700">cdr</font> lst)) (<font color = "#a64700">list</font> (<font color = "#a64700">car</font> lst)))
        (<b>else</b> (<font color = "#a64700">cons</font> (<font color = "#a64700">car</font> lst) (<a href = "general.html#every-second-element" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">every-second-element</font></a> (<font color = "#a64700">cddr</font> lst))))))

<font color = "#70a800">;;; Filter functions. 
;;; Variants of the very useful higher order filtering function.</font>
<a name="filter"><font color = "#70a800">;; Filter a list lst by means of the predicate pred. Only return those elements that fulfil pred.</font>
<a name="filter"><a href = "general.html#filter"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-f.html#filter" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from filter to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(filter pred lst)</font></b>
  (reverse (<a href = "general.html#filter-help" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">filter-help</font></a> pred lst '())))

<a name="filter-no-ordering"><font color = "#70a800">;; Like filter, but the ordering among elements in the resulting list is unknown and arbitrary.
;; Actually returns filtered list in reverse order. OK in situations,
;; where a boolean result is needed: Are there anything passing the filter?</font>
<a name="filter-no-ordering"><a href = "general.html#filter-no-ordering"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-f.html#filter-no-ordering" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from filter-no-ordering to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(filter-no-ordering pred lst)</font></b>
  (<a href = "general.html#filter-help" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">filter-help</font></a> pred lst '()))


<a name="filter-help"><a href = "general.html#filter-help"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-f.html#filter-help" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from filter-help to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(filter-help pred lst res)</font></b>
  (<b>cond</b> ((<font color = "#a64700">null?</font> lst) res)
        ((pred (<font color = "#a64700">car</font> lst)) (<a href = "general.html#filter-help" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">filter-help</font></a> pred (<font color = "#a64700">cdr</font> lst) (<font color = "#a64700">cons</font> (<font color = "#a64700">car</font> lst) res)))
        (<b>else</b> (<a href = "general.html#filter-help" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">filter-help</font></a> pred (<font color = "#a64700">cdr</font> lst) res))))

<a name="mapping-filter"><font color = "#70a800">;; Map and filter a list lst by means of the predicate pred.
;; If the predicate pred returns a true value v on the element e in list, return
;; v instead of e (this is the mapping effect).
;; Only return those mapped elements that fullfil pred.</font>
<a name="mapping-filter"><a href = "general.html#mapping-filter"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-m.html#mapping-filter" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from mapping-filter to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(mapping-filter pred lst)</font></b>
  (reverse (<a href = "general.html#mapping-filter-help" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">mapping-filter-help</font></a> pred lst '())))

<a name="mapping-filter-help"><a href = "general.html#mapping-filter-help"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-m.html#mapping-filter-help" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from mapping-filter-help to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(mapping-filter-help pred lst res)</font></b>
  (<b>if</b> (<font color = "#a64700">null?</font> lst)
      res
      (<b>let</b> ((pred-appl (pred (<font color = "#a64700">car</font> lst))))
        (<b>if</b> pred-appl 
            (<a href = "general.html#mapping-filter-help" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">mapping-filter-help</font></a> pred (<font color = "#a64700">cdr</font> lst) (<font color = "#a64700">cons</font> pred-appl res))
            (<a href = "general.html#mapping-filter-help" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">mapping-filter-help</font></a> pred (<font color = "#a64700">cdr</font> lst) res)))))




<font color = "#70a800">;;; Mapping functions.
;;; Here is a set of generalized mapping functions</font>
<a name="map2"><font color = "#70a800">;; Like map, but maps f on two lists</font>
<a name="map2"><a href = "general.html#map2"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-m.html#map2" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from map2 to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(map2 f lst1 lst2)</font></b>
  (<b>if</b> (<b>or</b> (<font color = "#a64700">null?</font> lst1) (<font color = "#a64700">null?</font> lst2)) '()
      (<font color = "#a64700">cons</font> (f (<font color = "#a64700">car</font> lst1) (<font color = "#a64700">car</font> lst2)) 
            (<a href = "general.html#map2" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">map2</font></a> f (<font color = "#a64700">cdr</font> lst1) (<font color = "#a64700">cdr</font> lst2)))))

<a name="map3"><font color = "#70a800">;; Like map, but maps f on three lists</font>
<a name="map3"><a href = "general.html#map3"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-m.html#map3" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from map3 to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(map3 f lst1 lst2 lst3)</font></b>
  (<b>if</b> (<b>or</b> (<font color = "#a64700">null?</font> lst1) (<font color = "#a64700">null?</font> lst2) (<font color = "#a64700">null?</font> lst3)) '()
      (<font color = "#a64700">cons</font> (f (<font color = "#a64700">car</font> lst1) (<font color = "#a64700">car</font> lst2) (<font color = "#a64700">car</font> lst3)) 
            (<a href = "general.html#map3" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">map3</font></a> f (<font color = "#a64700">cdr</font> lst1) (<font color = "#a64700">cdr</font> lst2) (<font color = "#a64700">cdr</font> lst3)))))

<a name="map4"><font color = "#70a800">;; Like map, but maps f on four lists</font>
<a name="map4"><a href = "general.html#map4"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-m.html#map4" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from map4 to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(map4 f lst1 lst2 lst3 lst4)</font></b>
  (<b>if</b> (<b>or</b> (<font color = "#a64700">null?</font> lst1) (<font color = "#a64700">null?</font> lst2) (<font color = "#a64700">null?</font> lst3)  (<font color = "#a64700">null?</font> lst4)) '()
      (<font color = "#a64700">cons</font> (f (<font color = "#a64700">car</font> lst1) (<font color = "#a64700">car</font> lst2) (<font color = "#a64700">car</font> lst3) (<font color = "#a64700">car</font> lst4)) 
            (<a href = "general.html#map4" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">map4</font></a> f (<font color = "#a64700">cdr</font> lst1) (<font color = "#a64700">cdr</font> lst2) (<font color = "#a64700">cdr</font> lst3) (<font color = "#a64700">cdr</font> lst4)))))

<a name="map5"><font color = "#70a800">;; Like map, but maps f on five lists</font>
<a name="map5"><a href = "general.html#map5"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-m.html#map5" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from map5 to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(map5 f lst1 lst2 lst3 lst4 lst5)</font></b>
  (<b>if</b> (<b>or</b> (<font color = "#a64700">null?</font> lst1) (<font color = "#a64700">null?</font> lst2) (<font color = "#a64700">null?</font> lst3)  (<font color = "#a64700">null?</font> lst4) (<font color = "#a64700">null?</font> lst5)) '()
      (<font color = "#a64700">cons</font> (f (<font color = "#a64700">car</font> lst1) (<font color = "#a64700">car</font> lst2) (<font color = "#a64700">car</font> lst3) (<font color = "#a64700">car</font> lst4) (<font color = "#a64700">car</font> lst5) ) 
            (<a href = "general.html#map5" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">map5</font></a> f (<font color = "#a64700">cdr</font> lst1) (<font color = "#a64700">cdr</font> lst2) (<font color = "#a64700">cdr</font> lst3) (<font color = "#a64700">cdr</font> lst4) (<font color = "#a64700">cdr</font> lst5)))))


<font color = "#70a800">;;; Conversion functions. 
;;; In this category we provide a number of useful conversion functions.</font>
<a name="char->string"><font color = "#70a800">;; Convert a character to a string</font>
<a name="char->string"><a href = "general.html#char->string"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-c.html#char->string" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from char->string to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(char-&gt;string ch)</font></b>
  (<font color = "#a64700">make-string</font> 1 ch))


<a name="as-string"><font color = "#70a800">;; Convert x to a string. Conversion of numbers, symbols, strings, booleans, characters, proper list and improper lists are supported.</font>
<a name="as-string"><a href = "general.html#as-string"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-a.html#as-string" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from as-string to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(as-string x)</font></b>
  (<b>cond</b> ((<font color = "#a64700">number?</font> x) (<font color = "#a64700">number-&gt;string</font> x))
        ((<font color = "#a64700">symbol?</font> x) (symbol-&gt;string x))
        ((<font color = "#a64700">string?</font> x) x)
        ((<font color = "#a64700">boolean?</font> x) 
            (<b>if</b> x "true" "false"))
        ((<font color = "#a64700">char?</font> x) (<a href = "general.html#char->string" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">char-&gt;string</font></a> x))
        ((<font color = "#a64700">list?</font> x)
            (<font color = "#a64700">string-append</font> "(" 
               (<a href = "general.html#string-merge" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">string-merge</font></a> (<font color = "#a64700">map</font> <a href = "general.html#as-string" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">as-string</font></a> x) (<a href = "general.html#make-list" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">make-list</font></a> (<font color = "#a64700">-</font> (<font color = "#a64700">length</font> x) 1) " "))
               ")"))
        ((<font color = "#a64700">pair?</font> x)
            (<font color = "#a64700">string-append</font> "(" 
               (<font color = "#a64700">apply</font> <font color = "#a64700">string-append</font>
                  (<font color = "#a64700">map</font> (<b>lambda</b> (y) (<font color = "#a64700">string-append</font> (<a href = "general.html#as-string" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">as-string</font></a> y) " ")) (<a href = "general.html#proper-part" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">proper-part</font></a> x))
               )
               " . " (<a href = "general.html#as-string" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">as-string</font></a> (<a href = "general.html#first-improper-part" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">first-improper-part</font></a> x))
               ")"))
        (<b>else</b> "??")))

<a name="as-symbol"><font color = "#70a800">;; Convert x to a symbol. String, symbols, booleans, and characters are supported</font>
<a name="as-symbol"><a href = "general.html#as-symbol"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-a.html#as-symbol" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from as-symbol to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(as-symbol x)</font></b>
  (<b>cond</b> ((<font color = "#a64700">symbol?</font> x) x)
        ((<font color = "#a64700">string?</font> x) (<font color = "#a64700">string-&gt;symbol</font> x))
        ((<font color = "#a64700">boolean?</font> x) 
            (<b>if</b> x (<a href = "general.html#as-symbol" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">as-symbol</font></a> "true") (<a href = "general.html#as-symbol" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">as-symbol</font></a> "false")))
        ((<font color = "#a64700">char?</font> x) (<a href = "general.html#as-symbol" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">as-symbol</font></a> (<a href = "general.html#char->string" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">char-&gt;string</font></a> x)))
        (<b>else</b> #f)))

<a name="as-number"><font color = "#70a800">;; Convert x to a number. Strings and numbers are supported</font>
<a name="as-number"><a href = "general.html#as-number"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-a.html#as-number" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from as-number to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(as-number x)</font></b>
  (<b>cond</b> ((<font color = "#a64700">string?</font> x) (<font color = "#a64700">string-&gt;number</font> x))
        ((<font color = "#a64700">number?</font> x) x)
        ((<font color = "#a64700">char?</font> x) (<font color = "#a64700">char-&gt;integer</font> x))
        ((<font color = "#a64700">boolean?</font> x) (<b>if</b> x 1 0))  <font color = "#70a800">; false -&gt; 0, true -&gt; 1</font>
        (<b>else</b> 
           (<b>begin</b> 
              (<b>set!</b> <a href = "general.html#problem-object" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">problem-object</font></a> x)
              (error (<font color = "#a64700">string-append</font> "Cannot convert to number" (<a href = "general.html#as-string" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">as-string</font></a> x)))))))

<a name="as-char"><a href = "general.html#as-char"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-a.html#as-char" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from as-char to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(as-char x)</font></b>
  (<b>cond</b> ((<font color = "#a64700">char?</font> x) x)
        ((<font color = "#a64700">integer?</font> x) 
           (<b>if</b> (<b>and</b> (<font color = "#a64700">&gt;=</font> x 0) (<font color = "#a64700">&lt;=</font> x 255)) 
               (<font color = "#a64700">integer-&gt;char</font> x)
               #\?))
        ((<font color = "#a64700">string?</font> x) (<font color = "#a64700">string-ref</font> x 0))
        ((<font color = "#a64700">boolean?</font> x) (<b>if</b> x #\t #\f))
        ((<font color = "#a64700">symbol?</font> x)  (<a href = "general.html#as-char" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">as-char</font></a> (<a href = "general.html#as-string" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">as-string</font></a> x)))
        (<b>else</b> #\?)))

<a name="as-list"><font color = "#70a800">;; Convert x to a list.
;; In particular are strings converted to a list of elements separated by spaces, newlines, and tabs.</font>
<a name="as-list"><a href = "general.html#as-list"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-a.html#as-list" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from as-list to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(as-list x)</font></b>
  (<b>cond</b> ((<font color = "#a64700">string?</font> x) (<a href = "general.html#string-to-list" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">string-to-list</font></a> x (<font color = "#a64700">list</font> #\space (<a href = "general.html#as-char" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">as-char</font></a> 13) (<a href = "general.html#as-char" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">as-char</font></a> 10) #\ht)))
        ((<font color = "#a64700">list?</font> x) x)
        ((<font color = "#a64700">pair?</font> x) x)
        (<b>else</b> (<font color = "#a64700">list</font> x))))

<a name="string-to-list"><font color = "#70a800">;; Convert a string to a list.
;; The second parameter is a list of separator chararcters.</font>
<a name="string-to-list"><a href = "general.html#string-to-list"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-s.html#string-to-list" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from string-to-list to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(string-to-list str element-separator-chars)</font></b>
 (<a href = "general.html#filter" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">filter</font></a> (<a href = "general.html#negate" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">negate</font></a> <a href = "general.html#empty-string?" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">empty-string?</font></a>)
  (<a href = "general.html#string-to-list-help" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">string-to-list-help</font></a> str "" '() element-separator-chars (<font color = "#a64700">string-length</font> str))))

<a name="string-to-list-help"><a href = "general.html#string-to-list-help"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-s.html#string-to-list-help" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from string-to-list-help to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(string-to-list-help str next-el res-list element-separator-chars str-lgt)</font></b>
 (<b>if</b> (<font color = "#a64700">=</font> 0 str-lgt)
     (reverse (<font color = "#a64700">cons</font> next-el res-list))     <font color = "#70a800">; add last 'rest element: next-el</font>
     (<b>let</b> ((next-char (<font color = "#a64700">string-ref</font> str 0))
	   (rest-string (<font color = "#a64700">substring</font> str 1 str-lgt)))
       (<b>cond</b> 
         ((<font color = "#a64700">memq</font> next-char element-separator-chars) (<a href = "general.html#string-to-list-help" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">string-to-list-help</font></a> rest-string "" (<font color = "#a64700">cons</font> next-el res-list) element-separator-chars (<font color = "#a64700">-</font> str-lgt 1)))
         (<b>else</b> (<a href = "general.html#string-to-list-help" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">string-to-list-help</font></a> rest-string (<font color = "#a64700">string-append</font> next-el (<a href = "general.html#as-string" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">as-string</font></a> next-char)) res-list element-separator-chars (<font color = "#a64700">-</font> str-lgt 1)))))))

<a name="problem-object"><a href = "general.html#problem-object"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-p.html#problem-object" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from problem-object to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >problem-object</font></b> #f)


<a name="as-boolean"><a href = "general.html#as-boolean"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-a.html#as-boolean" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from as-boolean to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(as-boolean x)</font></b>
  (<b>cond</b> ((<font color = "#a64700">string?</font> x) (<b>if</b> (<b>or</b> (<font color = "#a64700">equal?</font> x "false") (<font color = "#a64700">equal?</font> x "no") (<font color = "#a64700">equal?</font> x "NO")) #f #t))
        ((<font color = "#a64700">boolean?</font> x) x)
        (<b>else</b> (error "Cannot convert to boolean"))))


<a name="empty-string?"><font color = "#70a800">;; Is the string str empty</font>
<a name="empty-string?"><a href = "general.html#empty-string?"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-e.html#empty-string?" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from empty-string? to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(empty-string? str)</font></b>
  (<font color = "#a64700">=</font> (<font color = "#a64700">string-length</font> str) 0))

<a name="white-space-char-list"><font color = "#70a800">;; A list of characters considered as blank space characters</font>
<a name="white-space-char-list"><a href = "general.html#white-space-char-list"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-w.html#white-space-char-list" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from white-space-char-list to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >white-space-char-list</font></b> (<font color = "#a64700">list</font> #\space (<a href = "general.html#as-char" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">as-char</font></a> 13) (<a href = "general.html#as-char" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">as-char</font></a> 10) #\ht))

<a name="blank-string?"><font color = "#70a800">;; Is the string str empty or blank (consists of white space)</font>
<a name="blank-string?"><a href = "general.html#blank-string?"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-b.html#blank-string?" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from blank-string? to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(blank-string? str)</font></b>
  (<b>or</b> (<a href = "general.html#empty-string?" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">empty-string?</font></a> str) 
      (<a href = "general.html#string-of-char-list?" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">string-of-char-list?</font></a> str <a href = "general.html#white-space-char-list" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">white-space-char-list</font></a>)))

<a name="numeric-string?"><font color = "#70a800">;; Is the string str purely numeric. 
;; More specifically, does it consist exclusively of the ciffers 0 through 9.</font>
<a name="numeric-string?"><a href = "general.html#numeric-string?"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-n.html#numeric-string?" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from numeric-string? to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(numeric-string? str)</font></b>
 (<a href = "general.html#string-of-char-list?" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">string-of-char-list?</font></a> str (<font color = "#a64700">list</font> #\0 #\1 #\2 #\3 #\4 #\5 #\6 #\7 #\8 #\9 )))

<a name="string-of-char-list?"><font color = "#70a800">;; Are all characters in str member of char-list (a list of characters).</font>
<a name="string-of-char-list?"><a href = "general.html#string-of-char-list?"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-s.html#string-of-char-list?" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from string-of-char-list? to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(string-of-char-list? str char-list)</font></b>
  (<a href = "general.html#string-of-char-list-1?" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">string-of-char-list-1?</font></a> str char-list 0 (<font color = "#a64700">string-length</font> str)))

<a name="string-of-char-list-1?"><a href = "general.html#string-of-char-list-1?"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-s.html#string-of-char-list-1?" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from string-of-char-list-1? to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(string-of-char-list-1? str char-list i lgt)</font></b>
  (<b>if</b> (<font color = "#a64700">=</font> i lgt)
      #t
      (<b>and</b> (<font color = "#a64700">memq</font> (<font color = "#a64700">string-ref</font> str i) char-list)
           (<a href = "general.html#string-of-char-list-1?" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">string-of-char-list-1?</font></a> str char-list (<font color = "#a64700">+</font> i 1) lgt))))


<font color = "#70a800">; ---------------------------------------------------------------------------------------------------</font>
<font color = "#70a800">;;; Functions that change letter case.
;;; Here comes a number of functions which changes the letter case of a string</font>
<a name="capitalize-string"><font color = "#70a800">;  Capitalizing characters and strings.</font>

<a name="capitalize-string"><a href = "general.html#capitalize-string"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-c.html#capitalize-string" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from capitalize-string to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(capitalize-string str)</font></b>
  <font color = "#70a800">;; Mutate str to have an initial capital character. 
  ;; A destructive procedure. See capitalize-string-nd for a non-destructive variant.</font>
  (<font color = "#a64700">string-set!</font> str 0 (<a href = "general.html#capitalize-char" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">capitalize-char</font></a> (<font color = "#a64700">string-ref</font> str 0)))
  str)

<a name="capitalize-string-nd"><a href = "general.html#capitalize-string-nd"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-c.html#capitalize-string-nd" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from capitalize-string-nd to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(capitalize-string-nd str)</font></b>
  <font color = "#70a800">;; Return str with capital, initial character. 
  ;; A non-destructive variant of capitalize-string</font>
  (<b>let</b> ((res (<font color = "#a64700">string-copy</font> str)))
    (<font color = "#a64700">string-set!</font> res 0 (<a href = "general.html#capitalize-char" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">capitalize-char</font></a> (<font color = "#a64700">string-ref</font> str 0)))
    res))

<a name="capitalize-char"><a href = "general.html#capitalize-char"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-c.html#capitalize-char" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from capitalize-char to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(capitalize-char ch)</font></b>
  <font color = "#70a800">; if it makes sense, return the capital character corresponding to ch.
  ; else, just return ch</font>
  (<b>let</b> ((char-code (<font color = "#a64700">char-&gt;integer</font> ch)))
    (<b>if</b> (<a href = "general.html#lower-case-letter-code?" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">lower-case-letter-code?</font></a> char-code)
        (<b>let</b> ((offset (<a href = "general.html#small-capital-offset" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">small-capital-offset</font></a> char-code)))
          (<font color = "#a64700">integer-&gt;char</font> (<font color = "#a64700">+</font> char-code offset)))
        ch)))

<a name="lower-case-letter-code?"><a href = "general.html#lower-case-letter-code?"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-l.html#lower-case-letter-code?" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from lower-case-letter-code? to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(lower-case-letter-code? n)</font></b>
  (<b>or</b> (<b>and</b> (<font color = "#a64700">&gt;=</font> n 97) (<font color = "#a64700">&lt;=</font> n 122)) (<font color = "#a64700">=</font> n 230) (<font color = "#a64700">=</font> n 248) (<font color = "#a64700">=</font> n 229)))

<a name="small-capital-offset"><a href = "general.html#small-capital-offset"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-s.html#small-capital-offset" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from small-capital-offset to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(small-capital-offset n)</font></b>
 <font color = "#70a800">; in all cases, the distance between lower and upper case letters are -32 in the ASCII table</font>
 (<b>cond</b> ((<b>and</b> (<font color = "#a64700">&gt;=</font> n 97) (<font color = "#a64700">&lt;=</font> n 122)) -32)
       ((<font color = "#a64700">=</font> n 230) -32)
       ((<font color = "#a64700">=</font> n 248) -32)
       ((<font color = "#a64700">=</font> n 229) -32)
       (<b>else</b> 0)))

<a name="upcase-string"><font color = "#70a800">; -----------------------------------------------------------------------------
; Upcasing all characters in a string</font>

<a name="upcase-string"><a href = "general.html#upcase-string"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-u.html#upcase-string" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from upcase-string to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(upcase-string str)</font></b>
  <font color = "#70a800">;; Upcase all characters in str</font>
  (<b>let</b> ((res (<font color = "#a64700">make-string</font> (<font color = "#a64700">string-length</font> str) #\space)))
    (<a href = "general.html#upcase-string-help!" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">upcase-string-help!</font></a> str res 0 (<font color = "#a64700">string-length</font> str))))

<a name="upcase-string-help!"><a href = "general.html#upcase-string-help!"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-u.html#upcase-string-help!" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from upcase-string-help! to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(upcase-string-help! input output i lgt)</font></b>
  (<b>cond</b> ((<font color = "#a64700">&gt;=</font> i lgt) output)
        (<b>else</b> (<font color = "#a64700">string-set!</font> output i (<a href = "general.html#capitalize-char" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">capitalize-char</font></a> (<font color = "#a64700">string-ref</font> input i)))
              (<a href = "general.html#upcase-string-help!" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">upcase-string-help!</font></a> input output (<font color = "#a64700">+</font> i 1) lgt))))

<a name="downcase-string"><font color = "#70a800">; -----------------------------------------------------------------------------
;
; Downcasing all characters in a string</font>

<a name="downcase-string"><a href = "general.html#downcase-string"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-d.html#downcase-string" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from downcase-string to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(downcase-string str)</font></b>
 <font color = "#70a800">;; Downcase all characters in str, non-destructively (i.e., str is not mutated).</font>
  (<b>let</b> ((res (<font color = "#a64700">make-string</font> (<font color = "#a64700">string-length</font> str) #\space)))
    (<a href = "general.html#downcase-string-help!" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">downcase-string-help!</font></a> str res 0 (<font color = "#a64700">string-length</font> str))))

<a name="downcase-string-help!"><a href = "general.html#downcase-string-help!"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-d.html#downcase-string-help!" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from downcase-string-help! to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(downcase-string-help! input output i lgt)</font></b>
  (<b>cond</b> ((<font color = "#a64700">&gt;=</font> i lgt) output)
        (<b>else</b> (<font color = "#a64700">string-set!</font> output i (<a href = "general.html#decapitalize-char" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">decapitalize-char</font></a> (<font color = "#a64700">string-ref</font> input i)))
              (<a href = "general.html#downcase-string-help!" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">downcase-string-help!</font></a> input output (<font color = "#a64700">+</font> i 1) lgt))))

<a name="decapitalize-string"><font color = "#70a800">; -----------------------------------------------------------------------------
;
; decapitalizing characters and strings.</font>

<a name="decapitalize-string"><a href = "general.html#decapitalize-string"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-d.html#decapitalize-string" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from decapitalize-string to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(decapitalize-string str)</font></b>
  <font color = "#70a800">;; Mutate str to have lower case, initial character. 
  ;; A destructive procedure. See decapitalize-string-nd for a non-destructive variant.</font>
  (<font color = "#a64700">string-set!</font> str 0 (<a href = "general.html#decapitalize-char" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">decapitalize-char</font></a> (<font color = "#a64700">string-ref</font> str 0)))
  str)


<a name="decapitalize-string-nd"><a href = "general.html#decapitalize-string-nd"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-d.html#decapitalize-string-nd" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from decapitalize-string-nd to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(decapitalize-string-nd str)</font></b>
  <font color = "#70a800">;; Return str with lower case, initial character. 
  ;; A non-destructive variant of decapitalize-string.</font>
  (<b>let</b> ((res (<font color = "#a64700">string-copy</font> str)))
    (<font color = "#a64700">string-set!</font> res 0 (<a href = "general.html#decapitalize-char" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">decapitalize-char</font></a> (<font color = "#a64700">string-ref</font> str 0)))
    res))

<a name="decapitalize-char"><a href = "general.html#decapitalize-char"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-d.html#decapitalize-char" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from decapitalize-char to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(decapitalize-char ch)</font></b>
  <font color = "#70a800">; if it makes sense, return the lower case character corresponding to ch.
  ; else, just return ch</font>
  (<b>let</b> ((char-code (<font color = "#a64700">char-&gt;integer</font> ch)))
    (<b>if</b> (<a href = "general.html#upper-case-letter-code?" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">upper-case-letter-code?</font></a> char-code)
        (<b>let</b> ((offset (<a href = "general.html#large-capital-offset" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">large-capital-offset</font></a> char-code)))
          (<font color = "#a64700">integer-&gt;char</font> (<font color = "#a64700">+</font> char-code offset)))
        ch)))

<a name="upper-case-letter-code?"><a href = "general.html#upper-case-letter-code?"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-u.html#upper-case-letter-code?" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from upper-case-letter-code? to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(upper-case-letter-code? n)</font></b>
  (<b>or</b> (<b>and</b> (<font color = "#a64700">&gt;=</font> n 65) (<font color = "#a64700">&lt;=</font> n 90)) (<font color = "#a64700">=</font> n 198) (<font color = "#a64700">=</font> n 216) (<font color = "#a64700">=</font> n 197)))

<a name="large-capital-offset"><a href = "general.html#large-capital-offset"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-l.html#large-capital-offset" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from large-capital-offset to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(large-capital-offset n)</font></b>
 <font color = "#70a800">; in all cases, the distance between lower and upper case letters are -32 in the ASCII table</font>
 (<b>cond</b> ((<b>and</b> (<font color = "#a64700">&gt;=</font> n 65) (<font color = "#a64700">&lt;=</font> n 90)) 32)
       ((<font color = "#a64700">=</font> n 198) 32)
       ((<font color = "#a64700">=</font> n 216) 32)
       ((<font color = "#a64700">=</font> n 197) 32)
       (<b>else</b> 0)))

<font color = "#70a800">; --------------------------------------------------------------------------------------------------</font>
<font color = "#70a800">;;; Other functions. 
;;; Here follows a set of miscellaneous functions</font>
<a name="number-interval"><font color = "#70a800">;; Return a list of all numbers from f to t. Empty if f is greater than t</font>

<a name="number-interval"><a href = "general.html#number-interval"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-n.html#number-interval" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from number-interval to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(number-interval f t)</font></b>
 (<b>if</b> (<font color = "#a64700">&lt;=</font> f t) (<font color = "#a64700">cons</font> f (<a href = "general.html#number-interval" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">number-interval</font></a> (<font color = "#a64700">+</font> f 1) t)) '()))


<a name="split-on"><font color = "#70a800">;; Return a list of two strings taken from str. ch is a character.
;; The first is the prefix of str up to the first occurence of ch
;; The second is the suffix from ch to the end of str</font>
<a name="split-on"><a href = "general.html#split-on"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-s.html#split-on" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from split-on to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(split-on ch str)</font></b>
 (<b>let</b> ((sp (<a href = "general.html#split-point" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">split-point</font></a> ch str)))
   (<font color = "#a64700">list</font> (<font color = "#a64700">substring</font> str 0 sp)

         (<font color = "#a64700">substring</font> str (<font color = "#a64700">+</font> sp 1) (<font color = "#a64700">string-length</font> str)))))


<a name="split-point"><font color = "#70a800">;; Return the character position where ch occurs the first time in str.
;; If it does not appear, the procedure returns #f.
;; This function allocates some temporary strings, and as such it is not efficient. 
;; Use find-in-string instead.</font>
<a name="split-point"><a href = "general.html#split-point"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-s.html#split-point" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from split-point to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(split-point ch str)</font></b>
 (<font color = "#a64700">call-with-current-continuation</font>
  (<b>lambda</b> (exit)
   (<b>cond</b> ((<font color = "#a64700">equal?</font> str "") #f)
         ((<font color = "#a64700">eq?</font> ch (<font color = "#a64700">string-ref</font> str 0)) 0)
         (<b>else</b> (<b>let</b> ((res (<a href = "general.html#split-point" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">split-point</font></a> ch (<font color = "#a64700">substring</font> str 1 (<font color = "#a64700">string-length</font> str)))))
                  (<b>if</b> (<font color = "#a64700">not</font> res)
                      (exit #f)
                      (<font color = "#a64700">+</font> 1 res))))))))


<a name="find-in-string"><font color = "#70a800">;; Search linearly for the character ch in the string str. 
;; An optional start postion start-post tells at which position to start the search (default is position 0).
;; Return the index of the first occurence of ch, or #f if it does not exist in str.
;; The index of the first character in a string is 0.</font>
<a name="find-in-string"><a href = "general.html#find-in-string"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-f.html#find-in-string" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from find-in-string to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(find-in-string str ch . start-pos)</font></b>
 (<b>let</b> ((start-pos-1 (<b>if</b> (<font color = "#a64700">null?</font> start-pos) 0 (<font color = "#a64700">car</font> start-pos))))
  (<a href = "general.html#find-in-string-1" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">find-in-string-1</font></a> str ch start-pos-1 (<font color = "#a64700">string-length</font> str))))

<a name="find-in-string-1"><a href = "general.html#find-in-string-1"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-f.html#find-in-string-1" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from find-in-string-1 to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(find-in-string-1 str ch i lgt)</font></b>
  (<b>cond</b> ((<font color = "#a64700">&gt;=</font> i lgt) #f)
        ((<font color = "#a64700">eq?</font> ch (<font color = "#a64700">string-ref</font> str i)) i)
        (<b>else</b> (<a href = "general.html#find-in-string-1" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">find-in-string-1</font></a> str ch (<font color = "#a64700">+</font> i 1) lgt))))

<a name="find-in-string-from-end"><font color = "#70a800">;; Search linearly for the character ch in the string str, beginning from the rear end of str.
;; Return the index of the last occurence of ch, or #f if it does not exist in str.
;; The index of the first character in a string is 0.</font>
<a name="find-in-string-from-end"><a href = "general.html#find-in-string-from-end"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-f.html#find-in-string-from-end" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from find-in-string-from-end to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(find-in-string-from-end str ch)</font></b>
 (<b>let</b> ((lgt (<font color = "#a64700">string-length</font> str)))
  (<a href = "general.html#find-in-string-from-end-1" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">find-in-string-from-end-1</font></a> str ch (<font color = "#a64700">-</font> lgt 1) lgt)))

<a name="find-in-string-from-end-1"><a href = "general.html#find-in-string-from-end-1"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-f.html#find-in-string-from-end-1" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from find-in-string-from-end-1 to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(find-in-string-from-end-1 str ch i lgt)</font></b>
  (<b>cond</b> ((<font color = "#a64700">&lt;</font> i 0) #f)
        ((<font color = "#a64700">eq?</font> ch (<font color = "#a64700">string-ref</font> str i)) i)
        (<b>else</b> (<a href = "general.html#find-in-string-from-end-1" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">find-in-string-from-end-1</font></a> str ch (<font color = "#a64700">-</font> i 1) lgt))))

<a name="looking-at-substring?"><font color = "#70a800">;; Does str contain sub-str as substring, starting at position pos?
;; An efficient implementation without any string copying, only character comparsion</font>
<a name="looking-at-substring?"><a href = "general.html#looking-at-substring?"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-l.html#looking-at-substring?" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from looking-at-substring? to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(looking-at-substring? str pos sub-str)</font></b>
  (<a href = "general.html#looking-at-substring-1?" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">looking-at-substring-1?</font></a> str pos sub-str 0 (<font color = "#a64700">string-length</font> str) (<font color = "#a64700">string-length</font> sub-str)))

<a name="looking-at-substring-1?"><a href = "general.html#looking-at-substring-1?"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-l.html#looking-at-substring-1?" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from looking-at-substring-1? to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(looking-at-substring-1? str pos sub-str i lgt1 lgt2)</font></b>
 (<b>let</b> ((a (<font color = "#a64700">+</font> i pos)))
  (<b>cond</b> ((<font color = "#a64700">=</font> i lgt2) #t)
        ((<b>and</b> (<font color = "#a64700">&lt;</font> a lgt1) (<font color = "#a64700">&lt;</font> i lgt2) (<font color = "#a64700">eq?</font> (<font color = "#a64700">string-ref</font> str a) (<font color = "#a64700">string-ref</font> sub-str i)))
          (<a href = "general.html#looking-at-substring-1?" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">looking-at-substring-1?</font></a> str pos sub-str (<font color = "#a64700">+</font> i 1) lgt1 lgt2))
        (<b>else</b> #f))))
  

<a name="skip-chars-in-string"><font color = "#70a800">;; Starting from char-pos, skip characters in string from char-list.
;; Return the first index higher or equal to start-pos, which contains
;; a character which is NOT in char-list. If start-pos is higher than
;; the maximum legal string index, return start-post.</font>
<a name="skip-chars-in-string"><a href = "general.html#skip-chars-in-string"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-s.html#skip-chars-in-string" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from skip-chars-in-string to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(skip-chars-in-string str char-list start-pos)</font></b>
  (<a href = "general.html#skip-chars-in-string-1" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">skip-chars-in-string-1</font></a> str char-list start-pos (<font color = "#a64700">string-length</font> str)))

<a name="skip-chars-in-string-1"><a href = "general.html#skip-chars-in-string-1"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-s.html#skip-chars-in-string-1" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from skip-chars-in-string-1 to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(skip-chars-in-string-1 str char-list i lgt)</font></b>
  (<b>cond</b> ((<b>and</b> (<font color = "#a64700">&lt;</font> i lgt) (<font color = "#a64700">memq</font> (<font color = "#a64700">string-ref</font> str i) char-list))
          (<a href = "general.html#skip-chars-in-string-1" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">skip-chars-in-string-1</font></a> str char-list (<font color = "#a64700">+</font> i 1) lgt))
        ((<b>and</b> (<font color = "#a64700">&lt;</font> i lgt) (<font color = "#a64700">not</font> (<font color = "#a64700">memq</font> (<font color = "#a64700">string-ref</font> str i) char-list)))
          i)
        (<b>else</b> i)))




<a name="proper-part"><font color = "#70a800">;; Return the proper part of an S-expression</font>
<a name="proper-part"><a href = "general.html#proper-part"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-p.html#proper-part" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from proper-part to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(proper-part lst)</font></b>
  (<b>cond</b> ((<b>and</b> (<font color = "#a64700">pair?</font> lst) (<font color = "#a64700">pair?</font> (<font color = "#a64700">cdr</font> lst)))  (<font color = "#a64700">cons</font> (<font color = "#a64700">car</font> lst) (<a href = "general.html#proper-part" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">proper-part</font></a> (<font color = "#a64700">cdr</font> lst))))
        ((<font color = "#a64700">pair?</font> lst) (<font color = "#a64700">cons</font> (<font color = "#a64700">car</font> lst) '()))
        (<b>else</b> '())))

<a name="first-improper-part"><font color = "#70a800">;; Return the first improper part of an S-expression</font>
<a name="first-improper-part"><a href = "general.html#first-improper-part"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-f.html#first-improper-part" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from first-improper-part to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(first-improper-part lst)</font></b>
  (<b>cond</b> ((<b>and</b> (<font color = "#a64700">pair?</font> lst) (<font color = "#a64700">pair?</font> (<font color = "#a64700">cdr</font> lst)))  (<a href = "general.html#first-improper-part" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">first-improper-part</font></a> (<font color = "#a64700">cdr</font> lst)))
        ((<font color = "#a64700">pair?</font> lst) (<font color = "#a64700">cdr</font> lst))
        (<b>else</b> (error (<font color = "#a64700">string-append</font> "Troubles in first-improper-part:" (<a href = "general.html#as-string" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">as-string</font></a> lst))))))


<a name="max-int-list"><font color = "#70a800">; (define (as-string x)
  ; (cond ((number? x) (number-&gt;string x))
        ; ((symbol? x) (symbol-&gt;string x))
        ; ((string? x) x)
        ; ((boolean? x) 
            ; (if x "true" "false"))
        ; ((char? x) (char-&gt;string x))
        ; ((list? x)
            ; (string-append "(" 
               ; (apply string-append
                  ; (map (lambda (y) (string-append (as-string y) " ")) x))
               ; ")"))
        ; ((pair? x)
            ; (string-append "(" 
               ; (apply string-append
                  ; (map (lambda (y) (string-append (as-string y) " ")) (proper-part x))
               ; )
               ; " . " (as-string (first-improper-part x))
               ; ")"))
        ; (else "??")))</font>





<a name="max-int-list"><a href = "general.html#max-int-list"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-m.html#max-int-list" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from max-int-list to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(max-int-list lst)</font></b>
 (<a href = "general.html#max-int-list-help" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">max-int-list-help</font></a> lst 0))
 
<a name="max-int-list-help"><a href = "general.html#max-int-list-help"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-m.html#max-int-list-help" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from max-int-list-help to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(max-int-list-help lst res)</font></b>
  (<b>if</b> (<font color = "#a64700">null?</font> lst) 
      res
      (<a href = "general.html#max-int-list-help" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">max-int-list-help</font></a> (<font color = "#a64700">cdr</font> lst) (<font color = "#a64700">max</font> res (<font color = "#a64700">car</font> lst)))))

<a name="re-break"><font color = "#70a800">;; A quite special HTML line breaking function.
;; Html format str, either with br og p tags between lines.
;; depends on break-at-all from decoding stuff</font>
<a name="re-break"><a href = "general.html#re-break"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-r.html#re-break" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from re-break to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(re-break str)</font></b>
 (<b>letrec</b> ((line-breaker (break-at-all #\nl)))  <font color = "#70a800">; from decoding stuff</font>
  (<b>let*</b> ((lines (line-breaker str))
         (line-lengths (<font color = "#a64700">map</font> <font color = "#a64700">string-length</font> lines))
         (max-line-length (<a href = "general.html#max-int-list" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">max-int-list</font></a> line-lengths)))
   (<b>if</b> (<font color = "#a64700">&gt;</font> max-line-length 120)
       (<font color = "#a64700">apply</font> <font color = "#a64700">string-append</font> 
          (<font color = "#a64700">map</font> (<b>lambda</b> (ln) (<font color = "#a64700">string-append</font> ln "&lt;p&gt;")) lines))
       (<font color = "#a64700">apply</font> <font color = "#a64700">string-append</font> 
          (<font color = "#a64700">map</font> (<b>lambda</b> (ln) (<font color = "#a64700">string-append</font> ln "&lt;br&gt;")) lines))))))



<a name="string-merge"><a href = "general.html#string-merge"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-s.html#string-merge" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from string-merge to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(string-merge str-list-1 str-list-2)</font></b>
  <font color = "#70a800">;; Merge str-list-1 with str-list-2, returning one string.
  ;; Strings from the first list are merged with the strings from the second list.
  ;; In case one list is shorter than the other, the strings from the longests lists
  ;; are concatenated and appended</font>

 (<b>cond</b> ((<font color = "#a64700">null?</font> str-list-1) (<font color = "#a64700">apply</font> <font color = "#a64700">string-append</font> str-list-2))
       ((<font color = "#a64700">null?</font> str-list-2) (<font color = "#a64700">apply</font> <font color = "#a64700">string-append</font> str-list-1))
       (<b>else</b> (<font color = "#a64700">string-append</font>
                 (<font color = "#a64700">car</font> str-list-1) (<font color = "#a64700">car</font> str-list-2)
                 (<a href = "general.html#string-merge" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">string-merge</font></a> (<font color = "#a64700">cdr</font> str-list-1) (<font color = "#a64700">cdr</font> str-list-2))))))

<a name="list-to-string"><font color = "#70a800">;; Return a string with the elements of str-lst separated by separator.
;; The first parameter str-lst is a list of strings, and separator is a string.</font>
<a name="list-to-string"><a href = "general.html#list-to-string"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-l.html#list-to-string" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from list-to-string to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(list-to-string str-lst separator)</font></b>
  (<a href = "general.html#string-merge" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">string-merge</font></a> 
     str-lst
     (<a href = "general.html#make-list" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">make-list</font></a> (<font color = "#a64700">-</font> (<font color = "#a64700">length</font> str-lst) 1) separator)))

<a name="transliterate"><font color = "#70a800">; -----------------------------------------------------------------------------
; Transliteration</font>

<a name="transliterate"><a href = "general.html#transliterate"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-t.html#transliterate" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from transliterate to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(transliterate in-string ch str)</font></b>
 <font color = "#70a800">;; In in-string, substitute each occurence of character ch with the string str</font>
 (<a href = "general.html#transliterate-1" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">transliterate-1</font></a> in-string 0 (<font color = "#a64700">string-length</font> in-string) 
                  (<font color = "#a64700">make-string</font> (<font color = "#a64700">*</font> (<font color = "#a64700">string-length</font> in-string) (<font color = "#a64700">string-length</font> str)) #\space) 0
                  ch str))

<a name="transliterate-1"><a href = "general.html#transliterate-1"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-t.html#transliterate-1" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from transliterate-1 to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(transliterate-1 in-string n in-length
         out-string m 
         ch str)</font></b>
  <font color = "#70a800">; n is the position in the input
  ; m is the positin in the output</font>
  (<b>cond</b> ((<font color = "#a64700">=</font> n in-length) (<font color = "#a64700">substring</font> out-string 0 m))
        ((<font color = "#a64700">&lt;</font> n in-length)
           (<b>let</b> ((in-char (<font color = "#a64700">string-ref</font> in-string n)))
              (<b>if</b> (<font color = "#a64700">eq?</font> in-char ch)
                  (<b>begin</b> (<a href = "general.html#copy-string-into!" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">copy-string-into!</font></a> out-string m str)
                         (<a href = "general.html#transliterate-1" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">transliterate-1</font></a> in-string (<font color = "#a64700">+</font> n 1) in-length out-string (<font color = "#a64700">+</font> m (<font color = "#a64700">string-length</font> str)) ch str))
                  (<b>begin</b> (<a href = "general.html#copy-string-into!" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">copy-string-into!</font></a> out-string m (<a href = "general.html#as-string" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">as-string</font></a> in-char)) 
                         (<a href = "general.html#transliterate-1" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">transliterate-1</font></a> in-string (<font color = "#a64700">+</font> n 1) in-length out-string (<font color = "#a64700">+</font> m 1) ch str)))))
        (<b>else</b> (error "transliterate error")) ))

  
<font color = "#70a800">; ----------------------------------------------------------------------------</font>
<a name="delete-string-portion"><font color = "#70a800">;; Delete the substring of length lgt from index i in the string str.
;; A non-destructive function which returns the result (a shorter string than the input).
;; i is supposed to be a valid index in str. If lgt is too long for str, we just delete to the end of str.
;; The first character is number 0.</font>
<a name="delete-string-portion"><a href = "general.html#delete-string-portion"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-d.html#delete-string-portion" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from delete-string-portion to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(delete-string-portion str i lgt)</font></b>
  (<b>let*</b> ((str-lgt (<font color = "#a64700">string-length</font> str))
         (prefix (<font color = "#a64700">substring</font> str 0 (<font color = "#a64700">max</font> i 0)))
         (suffix (<font color = "#a64700">substring</font> str (<font color = "#a64700">min</font> (<font color = "#a64700">+</font> i lgt) str-lgt) str-lgt)))
    (<font color = "#a64700">string-append</font> prefix suffix)))

<a name="replace-string"><font color = "#70a800">;; In str1 replace all occurences of str2 with str3 and return the resulting string.
;; str2 is not allowed to be empty.
;; A non-destructive function which leaves all input strings unaffected.</font>
<a name="replace-string"><a href = "general.html#replace-string"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-r.html#replace-string" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from replace-string to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(replace-string str1 str2 str3)</font></b>
  (<b>if</b> (<font color = "#a64700">not</font> (<a href = "general.html#empty-string?" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">empty-string?</font></a> str2))
      (<a href = "general.html#replace-string-1" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">replace-string-1</font></a> 0 str1 str2 str3)
      (error (<font color = "#a64700">string-append</font> "replace-string: Cannot replace empty string in " str1))))

<a name="replace-string-1"><font color = "#70a800">; A helping function of replace-string which replaces from a given index i.</font>
<a name="replace-string-1"><a href = "general.html#replace-string-1"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-r.html#replace-string-1" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from replace-string-1 to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(replace-string-1 i str1 str2 str3)</font></b>
  (<b>let</b> ((match-index (<a href = "general.html#substring-index" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">substring-index</font></a> str1 i str2)))
    (<b>if</b> match-index 
        (<a href = "general.html#replace-string-1" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">replace-string-1</font></a>
          (<font color = "#a64700">+</font> match-index (<font color = "#a64700">string-length</font> str3))
          (<a href = "general.html#put-into-string" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">put-into-string</font></a> (<a href = "general.html#delete-string-portion" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">delete-string-portion</font></a> str1 match-index (<font color = "#a64700">string-length</font> str2))  match-index str3)
          str2
          str3)
        str1)))

<a name="put-around-substring"><a href = "general.html#put-around-substring"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-p.html#put-around-substring" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from put-around-substring to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(put-around-substring str pre-index pre-putin post-index post-putin)</font></b>
  <font color = "#70a800">;; Put pre-putin at pre-index, and post-putit at post-index in the string str.
  ;; Return the result. Str is not affected.
  ;; Assumed that pre-index is less than post-index</font>
 (<a href = "general.html#put-into-string" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">put-into-string</font></a>
    (<a href = "general.html#put-into-string" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">put-into-string</font></a> str post-index post-putin)
                         pre-index pre-putin))

<a name="put-into-string"><a href = "general.html#put-into-string"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-p.html#put-into-string" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from put-into-string to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(put-into-string str index putin-str)</font></b>
  <font color = "#70a800">;; Before the character with index put in putin-str into str, and return the resulting,
  ;; extended string. I.e, make room in the resulting string for putin-str, and slide a suffix of str 
  ;; to the right. Str is left unchanged. The first character is number 0.</font>
 (<b>let</b> ((res (<font color = "#a64700">make-string</font> (<font color = "#a64700">+</font> (<font color = "#a64700">string-length</font> str) (<font color = "#a64700">string-length</font> putin-str)))))
   (<a href = "general.html#copy-string-into!" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">copy-string-into!</font></a> res 0 (<font color = "#a64700">substring</font> str 0 index))
   (<a href = "general.html#copy-string-into!" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">copy-string-into!</font></a> res index putin-str)
   (<a href = "general.html#copy-string-into!" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">copy-string-into!</font></a> res (<font color = "#a64700">+</font> index (<font color = "#a64700">string-length</font> putin-str)) (<font color = "#a64700">substring</font> str index (<font color = "#a64700">string-length</font> str)))
   res))

<a name="copy-string-into!"><a href = "general.html#copy-string-into!"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-c.html#copy-string-into!" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from copy-string-into! to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(copy-string-into! target i source)</font></b>
  <font color = "#70a800">;; Copy source into target and overwrite a portion of target. 
  ;; Both target and source are strings, and i is an integer index.
  ;; The first char of source becomes chararter number i in the target string.
  ;; The first character in a string is number 0.
  ;; Target is mutated by this procedure.
  ;; If there is not enough room for source in target, only part of the source is copied into a suffix of target.</font>
  (<a href = "general.html#copy-string-into-help!" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">copy-string-into-help!</font></a> target i (<font color = "#a64700">string-length</font> target) source 0 (<font color = "#a64700">string-length</font> source)))

<a name="copy-string-into-help!"><a href = "general.html#copy-string-into-help!"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-c.html#copy-string-into-help!" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from copy-string-into-help! to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(copy-string-into-help! target i target-length source j source-length)</font></b>
  <font color = "#70a800">; A helping operation, doing the real work, of copy-string-into!</font>
  (<b>cond</b> ((<font color = "#a64700">=</font> i target-length) target)
        ((<font color = "#a64700">=</font> j source-length) target)
        ((<font color = "#a64700">&lt;</font> j source-length) 
              (<b>begin</b> (<font color = "#a64700">string-set!</font> target i (<font color = "#a64700">string-ref</font> source j))
                     (<a href = "general.html#copy-string-into-help!" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">copy-string-into-help!</font></a> target (<font color = "#a64700">+</font> 1 i) target-length source (<font color = "#a64700">+</font> 1 j) source-length)))))


<a name="substring-index"><a href = "general.html#substring-index"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-s.html#substring-index" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from substring-index to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(substring-index str str-index find-str)</font></b>
  <font color = "#70a800">;; Return the index of the first occurence of find-str in str.
  ;; The search starts at str-index.
  ;; The first character in str has index 0.
  ;; If find-str is not a substring of str, starting the search at str-index, #f is returned.</font>
 (<b>let</b> ((str-length (<font color = "#a64700">string-length</font> str))
       (find-str-length (<font color = "#a64700">string-length</font> find-str)))
  (<b>cond</b> ((<font color = "#a64700">=</font> 0 (<font color = "#a64700">string-length</font> find-str)) str-index)  <font color = "#70a800">; new 10.9.98</font>
        ((<font color = "#a64700">&gt;</font> str-index (<font color = "#a64700">-</font> str-length find-str-length)) #f)
        ((<a href = "general.html#substring-index-help" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">substring-index-help</font></a> str str-index str-length find-str 0 find-str-length) str-index)
        (<b>else</b> (<a href = "general.html#substring-index" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">substring-index</font></a> str (<font color = "#a64700">+</font> 1 str-index) find-str)))))

<a name="substring-index-help"><a href = "general.html#substring-index-help"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-s.html#substring-index-help" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from substring-index-help to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(substring-index-help str str-index str-length find-str find-str-index find-str-length)</font></b>
  <font color = "#70a800">; return whether find-str matches at postion str-index at str.
  ; I.e., at boolean results from this function
  ; str-length is the length of str.
  ; find-str-length is the length of the remaining part of find-str to match.
  ; find-str-index is the actual index ind find-str.
  ; str-index is the actua index of str.</font>
  (<b>cond</b>((<font color = "#a64700">=</font> 0 find-str-length) #t)
       ((<font color = "#a64700">=</font> str-index str-length) #f)
       ((<font color = "#a64700">eq?</font> (<font color = "#a64700">string-ref</font> str str-index) (<font color = "#a64700">string-ref</font> find-str find-str-index))
          (<a href = "general.html#substring-index-help" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">substring-index-help</font></a> str (<font color = "#a64700">+</font> str-index 1) str-length find-str (<font color = "#a64700">+</font> 1 find-str-index) (<font color = "#a64700">-</font> find-str-length 1)))
       (<b>else</b> #f)))

<a name="first-sentence-in-string"><font color = "#70a800">;; Return the first sentence in str (including a point).
;; The first sentence is running up to the first point followed by space or line termination.</font>
<a name="first-sentence-in-string"><a href = "general.html#first-sentence-in-string"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-f.html#first-sentence-in-string" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from first-sentence-in-string to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(first-sentence-in-string str)</font></b>
  (<b>let*</b> ((point-index (<a href = "general.html#first-sentence-split-point" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">first-sentence-split-point</font></a> str)))
    (<b>if</b> (<font color = "#a64700">number?</font> point-index) (<font color = "#a64700">substring</font> str 0 (<font color = "#a64700">+</font> 1 point-index)) str)))

<a name="but-first-sentence-of-string"><font color = "#70a800">;; Return all but the first sentence in str.</font>
<a name="but-first-sentence-of-string"><a href = "general.html#but-first-sentence-of-string"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-b.html#but-first-sentence-of-string" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from but-first-sentence-of-string to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(but-first-sentence-of-string str)</font></b>
  (<b>let</b> ((point-index (<a href = "general.html#first-sentence-split-point" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">first-sentence-split-point</font></a> str)))
    (<b>if</b> point-index (<font color = "#a64700">substring</font> str (<font color = "#a64700">+</font> point-index 2) (<font color = "#a64700">string-length</font> str)) "")))

<a name="first-sentence-split-point"><font color = "#70a800">; Return the split point of the first sentence in str.
; If no split point can be located, return #f.</font>
<a name="first-sentence-split-point"><a href = "general.html#first-sentence-split-point"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-f.html#first-sentence-split-point" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from first-sentence-split-point to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(first-sentence-split-point str)</font></b>
  (<b>let*</b> ((point-index-0 (<a href = "general.html#substring-index" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">substring-index</font></a> str 0 ". "))
         (point-index-1 (<a href = "general.html#substring-index" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">substring-index</font></a> str 0 (<font color = "#a64700">string-append</font> "." (<a href = "general.html#as-string" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">as-string</font></a> (<a href = "general.html#as-char" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">as-char</font></a> 10)))))
         (point-index-2 (<a href = "general.html#substring-index" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">substring-index</font></a> str 0 (<font color = "#a64700">string-append</font> "." (<a href = "general.html#as-string" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">as-string</font></a> (<a href = "general.html#as-char" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">as-char</font></a> 13)))))
         (point-index-min (<a href = "general.html#min-special" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">min-special</font></a> point-index-0 point-index-1 point-index-2)))
    point-index-min))

<a name="min-special"><a href = "general.html#min-special"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-m.html#min-special" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from min-special to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(min-special . numbers-or-nulls)</font></b>
  (<a href = "general.html#min-special-1" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">min-special-1</font></a> numbers-or-nulls #f))

<a name="min-special-1"><a href = "general.html#min-special-1"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-m.html#min-special-1" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from min-special-1 to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(min-special-1 numbers-or-nulls res)</font></b>
  (<b>cond</b> ((<font color = "#a64700">null?</font> numbers-or-nulls) res)
        ((<font color = "#a64700">boolean?</font> res) (<a href = "general.html#min-special-1" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">min-special-1</font></a> (<font color = "#a64700">cdr</font> numbers-or-nulls) (<font color = "#a64700">car</font> numbers-or-nulls)))
        ((<b>and</b> (<font color = "#a64700">number?</font> res) (<font color = "#a64700">number?</font> (<font color = "#a64700">car</font> numbers-or-nulls)) (<font color = "#a64700">&lt;</font>  (<font color = "#a64700">car</font> numbers-or-nulls) res))
            (<a href = "general.html#min-special-1" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">min-special-1</font></a> (<font color = "#a64700">cdr</font> numbers-or-nulls) (<font color = "#a64700">car</font> numbers-or-nulls)))
        ((<b>and</b> (<font color = "#a64700">number?</font> res) (<font color = "#a64700">number?</font> (<font color = "#a64700">car</font> numbers-or-nulls)) (<font color = "#a64700">&gt;=</font> (<font color = "#a64700">car</font> numbers-or-nulls) res))
            (<a href = "general.html#min-special-1" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">min-special-1</font></a> (<font color = "#a64700">cdr</font> numbers-or-nulls) res))
        (<b>else</b> (<a href = "general.html#min-special-1" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">min-special-1</font></a> (<font color = "#a64700">cdr</font> numbers-or-nulls) res))))


<a name="strip-initial-characters"><font color = "#70a800">;; Strip initial occurences of chars from char-list from string. Returns the empty string if given the empty string.
;; This function makes intermediate substrings, and as such it is not efficient.</font>
<a name="strip-initial-characters"><a href = "general.html#strip-initial-characters"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-s.html#strip-initial-characters" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from strip-initial-characters to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(strip-initial-characters char-list <font color = "#a64700">string</font>)</font></b>
  (<b>if</b> (<font color = "#a64700">=</font> (<font color = "#a64700">string-length</font> <font color = "#a64700">string</font>) 0)
      ""
      (<b>if</b> (<font color = "#a64700">memq</font> (<font color = "#a64700">string-ref</font> <font color = "#a64700">string</font> 0) char-list)
          (<a href = "general.html#strip-initial-characters" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">strip-initial-characters</font></a> char-list (<font color = "#a64700">substring</font> <font color = "#a64700">string</font> 1 (<font color = "#a64700">string-length</font> <font color = "#a64700">string</font>)))
          <font color = "#a64700">string</font>)))

<a name="strip-trailing-characters"><font color = "#70a800">;; Strip trailing occurences of chars from char-list from string. Returns the empty string if given the empty string.
;; This function makes intermediate substrings, and as such it is not efficient.</font>
<a name="strip-trailing-characters"><a href = "general.html#strip-trailing-characters"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-s.html#strip-trailing-characters" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from strip-trailing-characters to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(strip-trailing-characters char-list <font color = "#a64700">string</font>)</font></b>
  (<b>if</b> (<font color = "#a64700">=</font> (<font color = "#a64700">string-length</font> <font color = "#a64700">string</font>) 0)
      ""
      (<b>let</b> ((lgt (<font color = "#a64700">string-length</font> <font color = "#a64700">string</font>)))
       (<b>if</b> (<font color = "#a64700">memq</font> (<font color = "#a64700">string-ref</font> <font color = "#a64700">string</font> (<font color = "#a64700">-</font> lgt 1)) char-list)
           (<a href = "general.html#strip-trailing-characters" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">strip-trailing-characters</font></a> char-list (<font color = "#a64700">substring</font> <font color = "#a64700">string</font> 0 (<font color = "#a64700">max</font> 0 (<font color = "#a64700">-</font> lgt 2))))
           <font color = "#a64700">string</font>))))

<a name="strip-initial-spaces"><a href = "general.html#strip-initial-spaces"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-s.html#strip-initial-spaces" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from strip-initial-spaces to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(strip-initial-spaces <font color = "#a64700">string</font>)</font></b>
  <font color = "#70a800">;; Strip all initial space characters and lineshifting characters from string</font>
  (<a href = "general.html#strip-initial-characters" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">strip-initial-characters</font></a> 
     (<font color = "#a64700">list</font> #\space (<font color = "#a64700">integer-&gt;char</font> 10) (<font color = "#a64700">integer-&gt;char</font> 13) (<font color = "#a64700">integer-&gt;char</font> 9) (<font color = "#a64700">integer-&gt;char</font> 12))
     <font color = "#a64700">string</font>))
      

<font color = "#70a800">; -----------------------------------------------------------------------------</font>
<a name="cr"><font color = "#70a800">;; Return a CR string</font>
<a name="cr"><a href = "general.html#cr"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-c.html#cr" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from cr to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >cr</font></b> "
")

<a name="newline-string"><font color = "#70a800">;; Return a CR string</font>
<a name="newline-string"><a href = "general.html#newline-string"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-n.html#newline-string" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from newline-string to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(newline-string)</font></b>
  <a href = "general.html#cr" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">cr</font></a>)

<a name="make-list"><font color = "#70a800">;; Return a list of n elements, each being el</font>
<a name="make-list"><a href = "general.html#make-list"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-m.html#make-list" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from make-list to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(make-list n el)</font></b>
  (<b>if</b> (<font color = "#a64700">&lt;=</font> n 0) '() (<font color = "#a64700">cons</font> el (<a href = "general.html#make-list" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">make-list</font></a> (<font color = "#a64700">-</font> n 1) el))))

<a name="con"><font color = "#70a800">;; Concatenete a number of strings. Con is an alias of string-append</font>
<a name="con"><a href = "general.html#con"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-c.html#con" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from con to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >con</font></b> <font color = "#a64700">string-append</font>)

<a name="con-space"><font color = "#70a800">;; Like con, but ensure that there are white space in between the concatenated strings.</font>
<a name="con-space"><a href = "general.html#con-space"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-c.html#con-space" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from con-space to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(con-space . string-list)</font></b>
  <font color = "#70a800">; like con, but insert a space between all strings in string-list</font>
  (<b>let</b> ((space-list (<a href = "general.html#make-list" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">make-list</font></a> (<font color = "#a64700">-</font> (<font color = "#a64700">length</font> string-list) 1) " ")))
    (<a href = "general.html#string-merge" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">string-merge</font></a> string-list space-list)))

<a name="replicate-to-length"><font color = "#70a800">; con-par in the html library file</font>

<a name="replicate-to-length"><a href = "general.html#replicate-to-length"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-r.html#replicate-to-length" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from replicate-to-length to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(replicate-to-length lst lgt)</font></b>
  <font color = "#70a800">;; Replicate lst cyclically to a list of length lgt</font>
  (reverse (<a href = "general.html#replicate-to-length-1" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">replicate-to-length-1</font></a> lst lst '() 0 lgt)))

<a name="replicate-to-length-1"><a href = "general.html#replicate-to-length-1"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-r.html#replicate-to-length-1" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from replicate-to-length-1 to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(replicate-to-length-1 original-lst lst res count lgt)</font></b>
  <font color = "#70a800">; helping function to replicate-to-length
  ; original-lst is constant through this function.
  ; elements are taken out of lst
  ; the result is accumulated up in res
  ; count goes from 0 to lgt</font>
 (<b>cond</b> ((<font color = "#a64700">null?</font> lst) (<a href = "general.html#replicate-to-length-1" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">replicate-to-length-1</font></a> original-lst original-lst res count lgt))
       ((<font color = "#a64700">&lt;</font> count lgt) (<a href = "general.html#replicate-to-length-1" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">replicate-to-length-1</font></a> original-lst (<font color = "#a64700">cdr</font> lst) (<font color = "#a64700">cons</font> (<font color = "#a64700">car</font> lst) res) (<font color = "#a64700">+</font> 1 count) lgt))
       (<b>else</b> res)))

<a name="accumulate-right"><font color = "#70a800">;; A higher order functions which right accumulates a list</font>
<a name="accumulate-right"><a href = "general.html#accumulate-right"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-a.html#accumulate-right" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from accumulate-right to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(accumulate-right f init lst)</font></b>
  (<b>if</b> (<font color = "#a64700">null?</font> lst)
        init
        (f (<font color = "#a64700">car</font> lst) (<a href = "general.html#accumulate-right" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">accumulate-right</font></a> f init (<font color = "#a64700">cdr</font> lst)))))

<a name="flatten"><font color = "#70a800">;; Flatten a list of lists to one list.</font>
<a name="flatten"><a href = "general.html#flatten"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-f.html#flatten" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from flatten to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(flatten lst-of-lst)</font></b>
  (<a href = "general.html#accumulate-right" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">accumulate-right</font></a> <font color = "#a64700">append</font> '() lst-of-lst))

<a name="sum-list"><font color = "#70a800">;; Add all elmenets in a list of numbers</font>
<a name="sum-list"><a href = "general.html#sum-list"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-s.html#sum-list" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from sum-list to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(sum-list lst)</font></b>
  (<a href = "general.html#accumulate-right" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">accumulate-right</font></a> <font color = "#a64700">+</font> 0 lst))

<a name="front-sublist"><font color = "#70a800">;; Return the first n elements of lst. 
;; Just returns lst if n is equal or greater than the length of lst.
;; In other cases, a new 'copy' is returned.</font>
<a name="front-sublist"><a href = "general.html#front-sublist"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-f.html#front-sublist" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from front-sublist to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(front-sublist lst n)</font></b>
 (<b>if</b> (<font color = "#a64700">&gt;=</font> n (<font color = "#a64700">length</font> lst)) lst (<a href = "general.html#front-sublist-1" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">front-sublist-1</font></a> lst n)))

<a name="front-sublist-1"><font color = "#70a800">; A helping operation to front-sublist</font>
<a name="front-sublist-1"><a href = "general.html#front-sublist-1"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-f.html#front-sublist-1" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from front-sublist-1 to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(front-sublist-1 lst n)</font></b>
 (<b>cond</b> ((<font color = "#a64700">=</font> n 0) '())
       ((<b>and</b> (<font color = "#a64700">&gt;</font> n 0) (<font color = "#a64700">not</font> (<font color = "#a64700">null?</font> lst))) (<font color = "#a64700">cons</font> (<font color = "#a64700">car</font> lst) (<a href = "general.html#front-sublist-1" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">front-sublist-1</font></a> (<font color = "#a64700">cdr</font> lst) (<font color = "#a64700">-</font> n 1))))
       ((<b>and</b> (<font color = "#a64700">&gt;</font> n 0) (<font color = "#a64700">null?</font> lst)) '())
       (<b>else</b> (error "front-sublist-1: Should not happen"))))
  

<a name="merge-lists"><a href = "general.html#merge-lists"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-m.html#merge-lists" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from merge-lists to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(merge-lists list1 list2 pred)</font></b>
  <font color = "#70a800">;; Merge list1 and list2. Let e1 be the head of list1 and e2 the head of list2.
  ;; take e2 if (pred e1 e2) holds. Else e1</font>
 (<b>cond</b> ((<font color = "#a64700">null?</font> list1) list2)
       ((<font color = "#a64700">null?</font> list2) list1)
       ((pred (<font color = "#a64700">car</font> list1) (<font color = "#a64700">car</font> list2)) (<font color = "#a64700">cons</font> (<font color = "#a64700">car</font> list2) (<a href = "general.html#merge-lists" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">merge-lists</font></a> list1 (<font color = "#a64700">cdr</font> list2) pred)))
       (<b>else</b> (<font color = "#a64700">cons</font> (<font color = "#a64700">car</font> list1) (<a href = "general.html#merge-lists" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">merge-lists</font></a> (<font color = "#a64700">cdr</font> list1) list2 pred)))))

<a name="turn-into-boolean"><a href = "general.html#turn-into-boolean"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-t.html#turn-into-boolean" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from turn-into-boolean to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(turn-into-boolean x)</font></b>
  <font color = "#70a800">;; If x is considered true return #t else #f. 
  ;; See also as-boolean which is more versatile.
  ;; recall that (nearly all) expressions, conveniently, acts as true  </font>
  (<b>if</b> x #t #f))



<a name="find-in-list"><font color = "#70a800">;; A very simple and basic list search function.
;; Return first element which matches lst.
;; If no element is found, return #f.
;; Tail recursive and iterative</font>
<a name="find-in-list"><a href = "general.html#find-in-list"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-f.html#find-in-list" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from find-in-list to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(find-in-list pred lst)</font></b>
  (<b>cond</b> ((<font color = "#a64700">null?</font> lst) #f)
        ((pred (<font color = "#a64700">car</font> lst)) (<font color = "#a64700">car</font> lst))
        (<b>else</b> (<a href = "general.html#find-in-list" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">find-in-list</font></a> pred (<font color = "#a64700">cdr</font> lst)))))

<a name="butlast"><font color = "#70a800">;; quick and dirty butlast; Return all but the last element of a list</font>
<a name="butlast"><a href = "general.html#butlast"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-b.html#butlast" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from butlast to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(butlast lst)</font></b>
  (reverse (<font color = "#a64700">cdr</font> (reverse lst))))

<a name="last"><font color = "#70a800">;; quick and dirty last: Return the last element of a list.</font>
<a name="last"><a href = "general.html#last"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-l.html#last" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from last to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(last lst)</font></b>
  (<font color = "#a64700">car</font> (reverse lst)))

<font color = "#70a800">; ----------------------------------------------------------------------------</font>
<a name="remove-duplicates"><font color = "#70a800">;; Duplicate removal - non-destructive.
;; This function uses equal for comparison of elements.</font>
<a name="remove-duplicates"><a href = "general.html#remove-duplicates"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-r.html#remove-duplicates" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from remove-duplicates to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(remove-duplicates lst)</font></b>
 (<a href = "general.html#remove-duplicates-help" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">remove-duplicates-help</font></a> lst '()))

<a name="remove-duplicates-help"><a href = "general.html#remove-duplicates-help"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-r.html#remove-duplicates-help" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from remove-duplicates-help to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(remove-duplicates-help lst res)</font></b>
  (<b>cond</b> ((<font color = "#a64700">null?</font> lst) (reverse res))
        ((<font color = "#a64700">member</font> (<font color = "#a64700">car</font> lst) res) (<a href = "general.html#remove-duplicates-help" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">remove-duplicates-help</font></a> (<font color = "#a64700">cdr</font> lst) res))
        (<b>else</b> (<a href = "general.html#remove-duplicates-help" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">remove-duplicates-help</font></a> (<font color = "#a64700">cdr</font> lst) (<font color = "#a64700">cons</font> (<font color = "#a64700">car</font> lst) res)))))

<a name="remove-duplicates-with-selection"><font color = "#70a800">;; A variant of remove-duplicates with a selector function.
;; This function applies a selector function before comparisons and member is called.
;; This function uses equal for comparison of elements.</font>
<a name="remove-duplicates-with-selection"><a href = "general.html#remove-duplicates-with-selection"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-r.html#remove-duplicates-with-selection" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from remove-duplicates-with-selection to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(remove-duplicates-with-selection lst selector)</font></b>
 (<a href = "general.html#remove-duplicates-with-selection-help" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">remove-duplicates-with-selection-help</font></a> lst '() '() selector))

<a name="remove-duplicates-with-selection-help"><a href = "general.html#remove-duplicates-with-selection-help"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-r.html#remove-duplicates-with-selection-help" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from remove-duplicates-with-selection-help to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(remove-duplicates-with-selection-help lst res selected-res selector)</font></b>
  (<b>cond</b> ((<font color = "#a64700">null?</font> lst) (reverse res))
        ((<font color = "#a64700">member</font> (selector (<font color = "#a64700">car</font> lst)) selected-res)
            (<a href = "general.html#remove-duplicates-with-selection-help" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">remove-duplicates-with-selection-help</font></a> (<font color = "#a64700">cdr</font> lst) res selected-res selector))
        (<b>else</b> (<a href = "general.html#remove-duplicates-with-selection-help" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">remove-duplicates-with-selection-help</font></a> (<font color = "#a64700">cdr</font> lst) (<font color = "#a64700">cons</font> (<font color = "#a64700">car</font> lst) res)  (<font color = "#a64700">cons</font> (selector (<font color = "#a64700">car</font> lst)) selected-res) selector ))))


<a name="element-before"><font color = "#70a800">;; Return the element of lst just before el, or #f if no such element exists.
;; Comparsion is done via application of selector on the elements of lst, and via eq?.
;; More precise return the element e of lst just before f, where (eq? (selector f) el).</font>
<a name="element-before"><a href = "general.html#element-before"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-e.html#element-before" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from element-before to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(element-before el lst selector)</font></b>
  (<a href = "general.html#element-before-1" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">element-before-1</font></a> el lst selector (<font color = "#a64700">length</font> lst)))

<a name="element-before-1"><a href = "general.html#element-before-1"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-e.html#element-before-1" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from element-before-1 to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(element-before-1 el lst selector lgt)</font></b>
  (<b>cond</b> ((<font color = "#a64700">&lt;=</font> lgt 1) #f)
        ((<font color = "#a64700">eq?</font> el (selector (<font color = "#a64700">car</font> lst))) #f)
        ((<font color = "#a64700">eq?</font> el (selector (<font color = "#a64700">cadr</font> lst))) (<font color = "#a64700">car</font> lst))
        (<b>else</b> (<a href = "general.html#element-before-1" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">element-before-1</font></a> el (<font color = "#a64700">cdr</font> lst) selector (<font color = "#a64700">-</font> lgt 1)))))

<a name="element-after"><font color = "#70a800">;; Return the element of lst just after el, or #f if no such element exists.
;; Comparsion is done via application of selector on the elements of lst, and via eq?.
;; More precise return the element e of lst just after f, where (eq? (selector f) el).</font>
<a name="element-after"><a href = "general.html#element-after"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-e.html#element-after" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from element-after to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(element-after el lst selector)</font></b>
  (<a href = "general.html#element-after-1" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">element-after-1</font></a> el lst selector (<font color = "#a64700">length</font> lst)))

<a name="element-after-1"><a href = "general.html#element-after-1"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-e.html#element-after-1" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from element-after-1 to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(element-after-1 el lst selector lgt)</font></b>
  (<b>cond</b> ((<font color = "#a64700">&lt;=</font> lgt 1) #f)
        ((<font color = "#a64700">eq?</font> el (selector (<font color = "#a64700">car</font> lst))) (<font color = "#a64700">cadr</font> lst))
        (<b>else</b> (<a href = "general.html#element-after-1" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">element-after-1</font></a> el (<font color = "#a64700">cdr</font> lst) selector (<font color = "#a64700">-</font> lgt 1)))))


<a name="save-a-list"><font color = "#70a800">; Functions earlier in the cgi library</font>

<a name="save-a-list"><a href = "general.html#save-a-list"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-s.html#save-a-list" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from save-a-list to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(save-a-list alist filename)</font></b>
<font color = "#70a800">;; Save the alist on a file named filename</font>
  (<font color = "#a64700">with-output-to-file</font> filename
     (<b>lambda</b> () (<font color = "#a64700">write</font> alist))))


<a name="unique-timed-file-name"><a href = "general.html#unique-timed-file-name"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-u.html#unique-timed-file-name" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from unique-timed-file-name to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(unique-timed-file-name prefix)</font></b>
  <font color = "#70a800">;; Return a unique file name with prefix. The suffic becomes the current-time i seconds representation</font>
  (<font color = "#a64700">string-append</font> prefix (<font color = "#a64700">number-&gt;string</font> (current-time))))


<a name="file-append"><a href = "general.html#file-append"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-f.html#file-append" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from file-append to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(file-append file-name x)</font></b>
<font color = "#70a800">;; Write the list expression x at the end of the file named file-name</font>
 (<b>let*</b> ((port (<font color = "#a64700">open-input-file</font> file-name))
        (contents (<font color = "#a64700">read</font> port))
        (new-contents (<font color = "#a64700">append</font> (<font color = "#a64700">list</font> x) contents)))
  (<font color = "#a64700">close-input-port</font> port)
  (delete-file file-name)  <font color = "#70a800">; new!</font>
  (<b>let</b> ((output-port (<font color = "#a64700">open-output-file</font> file-name)))
    (<font color = "#a64700">write</font> new-contents output-port)
    (<font color = "#a64700">close-output-port</font> output-port))))

<a name="file-read"><a href = "general.html#file-read"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-f.html#file-read" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from file-read to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(file-read file-name)</font></b>
<font color = "#70a800">;; Read the (next) Lisp expression from file-name</font>
 (<b>let*</b> ((port (<font color = "#a64700">open-input-file</font> file-name))
        (contents (<font color = "#a64700">read</font> port)))
   (<font color = "#a64700">close-input-port</font> port)
   contents))

<a name="file-write"><a href = "general.html#file-write"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-f.html#file-write" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from file-write to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(file-write x file-name)</font></b>
<font color = "#70a800">;; Write the list expression x at the file named file-name</font>
  (<b>if</b> (file-exists? file-name) (delete-file file-name))  <font color = "#70a800">; new!</font>
  (<b>let</b> ((output-port (<font color = "#a64700">open-output-file</font> file-name)))
    (<font color = "#a64700">write</font> x output-port)
    (<font color = "#a64700">close-output-port</font> output-port)))

<a name="save-on-file"><a href = "general.html#save-on-file"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-s.html#save-on-file" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from save-on-file to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(save-on-file x filename)</font></b>
  <font color = "#70a800">;; Displays the first parameter x on a file named filename</font>
  (<font color = "#a64700">with-output-to-file</font> filename
     (<b>lambda</b> () (<font color = "#a64700">display</font> x))))

<a name="quote-string"><a href = "general.html#quote-string"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-q.html#quote-string" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from quote-string to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >quote-string</font></b> (<a href = "general.html#as-string" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">as-string</font></a> #\"))

<a name="string-it"><font color = "#70a800">;; embed the string x in double string quotes</font>
<a name="string-it"><a href = "general.html#string-it"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-s.html#string-it" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from string-it to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(string-it x)</font></b>
  (<font color = "#a64700">string-append</font> <a href = "general.html#quote-string" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">quote-string</font></a>  x <a href = "general.html#quote-string" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">quote-string</font></a>))

<a name="single-quote-string"><a href = "general.html#single-quote-string"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-s.html#single-quote-string" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from single-quote-string to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >single-quote-string</font></b> (<a href = "general.html#as-string" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">as-string</font></a> #\'))

<a name="string-it-single"><font color = "#70a800">;; embed the string x in single string quotes</font>
<a name="string-it-single"><a href = "general.html#string-it-single"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-s.html#string-it-single" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from string-it-single to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(string-it-single x)</font></b>
  (<font color = "#a64700">string-append</font> <a href = "general.html#single-quote-string" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">single-quote-string</font></a> x <a href = "general.html#single-quote-string" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">single-quote-string</font></a>))

<a name="id-1"><font color = "#70a800">;; The identify function of one parameter</font>
<a name="id-1"><a href = "general.html#id-1"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-i.html#id-1" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from id-1 to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(id-1 x)</font></b> x)

<a name="negate"><font color = "#70a800">;; A higher order functions which negates the predicate p. Negate accepts a predicate and returns the negated predicate.</font>
<a name="negate"><a href = "general.html#negate"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-n.html#negate" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from negate to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(negate p)</font></b>
  (<b>lambda</b> (x) 
    (<b>if</b> (p x) #f #t)))

<a name="compose"><font color = "#70a800">;; Return a composed function which applies f on g
;; Both f and g are supposed to take a single argument.</font>
<a name="compose"><a href = "general.html#compose"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-c.html#compose" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from compose to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(compose f g)</font></b>
  (<b>lambda</b> (x)
    (f (g x))))

<a name="generate-leq"><font color = "#70a800">;; Generate a less than or equal predicate from the enumeration-order.
;; If p is the generated predicate, (p x y) is true if and only if
;; (selector x) comes before (or at the same position) as (selector y)
;; in the enumeration-order. Thus, (selector x) is assumed to give a
;; value in enumeration-order. Comparison with elements in the enumeration-list
;; is done with eq?</font>
<a name="generate-leq"><a href = "general.html#generate-leq"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-g.html#generate-leq" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from generate-leq to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(generate-leq enumeration-order selector)</font></b>
  (<b>lambda</b> (x y)
     <font color = "#70a800">; x and y supposed to be elements in enumeration order</font>
     (<b>let</b> ((x-index (<a href = "general.html#list-index" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">list-index</font></a> (selector x) enumeration-order))
           (y-index (<a href = "general.html#list-index" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">list-index</font></a> (selector y) enumeration-order)))
       (<font color = "#a64700">&lt;=</font> x-index y-index))))

<a name="list-index"><font color = "#70a800">; A helping function of generate-leq.
; Return the position of e in lst. First is 1
; compare with eq?
; if e is not member of lst return (+ 1 (length lst))</font>
<a name="list-index"><a href = "general.html#list-index"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-l.html#list-index" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from list-index to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(list-index e lst)</font></b>
 (<b>cond</b> ((<font color = "#a64700">null?</font> lst) 1)
       ((<font color = "#a64700">eq?</font> (<font color = "#a64700">car</font> lst) e) 1)
       (<b>else</b> (<font color = "#a64700">+</font> 1 (<a href = "general.html#list-index" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">list-index</font></a> e (<font color = "#a64700">cdr</font> lst))))))


<a name="exchange-chars-in-str!"><font color = "#70a800">;; Exchange destructively char n and m in str. First character is number 0.
;; Not a function, thus no return value.</font>
<a name="exchange-chars-in-str!"><a href = "general.html#exchange-chars-in-str!"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-e.html#exchange-chars-in-str!" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from exchange-chars-in-str! to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(exchange-chars-in-str! str n m)</font></b>
  (<b>let</b> ((remember-char (<font color = "#a64700">string-ref</font> str m)))
    (<font color = "#a64700">string-set!</font> str m (<font color = "#a64700">string-ref</font> str n))
    (<font color = "#a64700">string-set!</font> str n remember-char)))


<a name="list-difference"><font color = "#70a800">;; Remove the elements of lst2 from lst1. 
;; A non-destructive function.
;; Uses eq? for comparison</font>
<a name="list-difference"><a href = "general.html#list-difference"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-l.html#list-difference" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from list-difference to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(list-difference lst1 lst2)</font></b>
  (<a href = "general.html#list-difference-1" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">list-difference-1</font></a> lst1 lst2 '()))

<a name="list-difference-1"><a href = "general.html#list-difference-1"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-l.html#list-difference-1" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from list-difference-1 to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(list-difference-1 lst1 lst2 res)</font></b>
  (<b>cond</b> ((<font color = "#a64700">null?</font> lst1) (reverse res))
        ((<font color = "#a64700">memq</font> (<font color = "#a64700">car</font> lst1) lst2) (<a href = "general.html#list-difference-1" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">list-difference-1</font></a> (<font color = "#a64700">cdr</font> lst1) lst2 res))
        (<b>else</b> (<a href = "general.html#list-difference-1" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">list-difference-1</font></a> (<font color = "#a64700">cdr</font> lst1) lst2 (<font color = "#a64700">cons</font> (<font color = "#a64700">car</font> lst1) res)))))

<a name="pair-up"><font color = "#70a800">;; Return a list of pairs of elements from lst1 and lst2.
;; The list is as long as the shortest of lst1 and lst2.</font>
<a name="pair-up"><a href = "general.html#pair-up"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-p.html#pair-up" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from pair-up to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(pair-up lst1 lst2)</font></b>
  (<a href = "general.html#pair-up-1" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">pair-up-1</font></a> lst1 lst2 '()))

<a name="pair-up-1"><a href = "general.html#pair-up-1"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-p.html#pair-up-1" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from pair-up-1 to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(pair-up-1 lst1 lst2 res)</font></b>
  (<b>cond</b> ((<b>or</b> (<font color = "#a64700">null?</font> lst1) (<font color = "#a64700">null?</font> lst2)) (reverse res))
        (<b>else</b> (<a href = "general.html#pair-up-1" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">pair-up-1</font></a> (<font color = "#a64700">cdr</font> lst1) (<font color = "#a64700">cdr</font> lst2) (<font color = "#a64700">cons</font> (<font color = "#a64700">cons</font> (<font color = "#a64700">car</font> lst1) (<font color = "#a64700">car</font> lst2)) res)))))


<a name="sublist-by-rows"><font color = "#70a800">;; Return a list of lists of elements from lst.
;; Each sub list is of length n.
;; Take elements consequtive (by rows) and put them into sublists.
;; The function sublist-by-predicate generalizes this function.</font>
<a name="sublist-by-rows"><a href = "general.html#sublist-by-rows"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-s.html#sublist-by-rows" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from sublist-by-rows to it's cross reference table entry" border = "0" ></a>&nbsp;<a href = "documentation.html#sublist-by-rows" target = documentation-frame><img src = "./images/doc-left.gif" alt = "2.1. The first row sublist function" border = "0" ></a>&nbsp;<a href = "documentation.html#sublist-by-predicate" target = documentation-frame><img src = "./images/doc-left-weak.gif" alt = "2.2. A more general function" border = "0" ></a>&nbsp;<a href = "documentation.html#sublist-by-2columns" target = documentation-frame><img src = "./images/doc-left-weak.gif" alt = "3.2. A dedicated two column solution" border = "0" ></a>&nbsp;<a href = "documentation.html#sublist-by-columns" target = documentation-frame><img src = "./images/doc-left-weak.gif" alt = "3.3. A more general solution" border = "0" ></a><br>(<b>define</b> <b><font color = "#ff0000"  >(sublist-by-rows n lst)</font></b>
 (<b>let</b> ((lgt (<font color = "#a64700">length</font> lst)))
  (<b>cond</b> ((<font color = "#a64700">&lt;=</font> n 0) (error  (<font color = "#a64700">string-append</font> "sublist-by-rows: Cannot deal with row numbers less than or equal to zero: " (<a href = "general.html#as-string" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">as-string</font></a> n))))
        ((<font color = "#a64700">&lt;</font> lgt n) (error (<font color = "#a64700">string-append</font> "sublist-by-rows: Cannot deal with list of fewer elements than the sublist length:" (<a href = "general.html#as-string" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">as-string</font></a> lgt))))
        (<b>else</b> (<a href = "general.html#sublist-by-rows-1" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">sublist-by-rows-1</font></a> n lst 0 '() '())))))

<a name="sublist-by-rows-1"><a href = "general.html#sublist-by-rows-1"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-s.html#sublist-by-rows-1" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from sublist-by-rows-1 to it's cross reference table entry" border = "0" ></a>&nbsp;<a href = "documentation.html#sublist-by-rows" target = documentation-frame><img src = "./images/doc-left.gif" alt = "2.1. The first row sublist function" border = "0" ></a><br>(<b>define</b> <b><font color = "#ff0000"  >(sublist-by-rows-1 n lst m res result)</font></b>
  (<b>cond</b> ((<b>and</b> (<font color = "#a64700">null?</font> lst) (<font color = "#a64700">null?</font> res)) (reverse result))  <font color = "#70a800">; <a name="sublist-by-rows-1-@a"><a href = "documentation.html#sublist-by-rows-@a" target = documentation-frame><img src = "./images/source-mark-red.gif" alt = "A linked program source marker to section 2.1:
'The first row sublist function'
Mark char: a" border = "0" ></a></font>
        ((<b>and</b> (<font color = "#a64700">null?</font> lst) (<font color = "#a64700">not</font> (<font color = "#a64700">null?</font> res))) (reverse (<font color = "#a64700">cons</font> (reverse res) result)))    <font color = "#70a800">; <a name="sublist-by-rows-1-@b"><a href = "documentation.html#sublist-by-rows-@b" target = documentation-frame><img src = "./images/source-mark-green.gif" alt = "A linked program source marker to section 2.1:
'The first row sublist function'
Mark char: b" border = "0" ></a></font>
        ((<font color = "#a64700">=</font> m n ) (<a href = "general.html#sublist-by-rows-1" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">sublist-by-rows-1</font></a> n lst 0 '() (<font color = "#a64700">cons</font> (reverse res) result)))         <font color = "#70a800">; <a name="sublist-by-rows-1-@c"><a href = "documentation.html#sublist-by-rows-@c" target = documentation-frame><img src = "./images/source-mark-blue.gif" alt = "A linked program source marker to section 2.1:
'The first row sublist function'
Mark char: c" border = "0" ></a></font>
        ((<font color = "#a64700">&lt;=</font> m n) (<a href = "general.html#sublist-by-rows-1" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">sublist-by-rows-1</font></a> n (<font color = "#a64700">cdr</font> lst) (<font color = "#a64700">+</font> m 1) (<font color = "#a64700">cons</font> (<font color = "#a64700">car</font> lst) res) result)) <font color = "#70a800">; <a name="sublist-by-rows-1-@d"><a href = "documentation.html#sublist-by-rows-@d" target = documentation-frame><img src = "./images/source-mark-black.gif" alt = "A linked program source marker to section 2.1:
'The first row sublist function'
Mark char: d" border = "0" ></a></font>
        (<b>else</b> (error "sublist-by-rows-1: Should not happen"))))                       

<a name="sublist-by-2columns"><font color = "#70a800">;; Return sublists of lst in two column format. Thus each produced sublist is of length 2.
;; Good for presentation of the list in two columns, column by column.
;; In cases there is an uneven number of elements in lst, we add extra.</font>
<a name="sublist-by-2columns"><a href = "general.html#sublist-by-2columns"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-s.html#sublist-by-2columns" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from sublist-by-2columns to it's cross reference table entry" border = "0" ></a>&nbsp;<a href = "documentation.html#sublist-by-2columns" target = documentation-frame><img src = "./images/doc-left.gif" alt = "3.2. A dedicated two column solution" border = "0" ></a>&nbsp;<a href = "documentation.html#sublist-by-columns" target = documentation-frame><img src = "./images/doc-left-weak.gif" alt = "3.3. A more general solution" border = "0" ></a><br>(<b>define</b> <b><font color = "#ff0000"  >(sublist-by-2columns lst extra)</font></b>
 (<b>if</b> (<font color = "#a64700">null?</font> lst)
     '()
  (<b>let*</b> ((lgt (<font color = "#a64700">length</font> lst))
         (lst1 (<b>if</b> (<font color = "#a64700">even?</font> lgt) lst (<font color = "#a64700">append</font> lst (<font color = "#a64700">list</font> extra))))
         (row-sublst (<a href = "general.html#sublist-by-rows" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">sublist-by-rows</font></a> (<font color = "#a64700">quotient</font> (<b>if</b> (<font color = "#a64700">even?</font> lgt) lgt (<font color = "#a64700">+</font> 1 lgt)) 2) lst1)) <font color = "#70a800">; <a name="sublist-by-2columns-@i"><a href = "documentation.html#sublist-by-2columns-@i" target = documentation-frame><img src = "./images/source-mark-tetal.gif" alt = "A linked program source marker to section 3.2:
'A dedicated two column solution'
Mark char: i" border = "0" ></a></font>
        )
    (<font color = "#a64700">map</font> <font color = "#70a800">; <a name="sublist-by-2columns-@j"><a href = "documentation.html#sublist-by-2columns-@j" target = documentation-frame><img src = "./images/source-mark-aqua.gif" alt = "A linked program source marker to section 3.2:
'A dedicated two column solution'
Mark char: j" border = "0" ></a></font>
      (<b>lambda</b> (e1 e2) (<font color = "#a64700">list</font> e1 e2))
      (<font color = "#a64700">car</font> row-sublst) (<font color = "#a64700">cadr</font> row-sublst)))))

<a name="sublist-by-columns"><a href = "general.html#sublist-by-columns"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-s.html#sublist-by-columns" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from sublist-by-columns to it's cross reference table entry" border = "0" ></a>&nbsp;<a href = "documentation.html#sublist-by-columns" target = documentation-frame><img src = "./images/doc-left.gif" alt = "3.3. A more general solution" border = "0" ></a><br>(<b>define</b> <b><font color = "#ff0000"  >(sublist-by-columns n lst extra)</font></b>
 (<b>if</b> (<font color = "#a64700">null?</font> lst)
     '()
  (<b>let*</b> ((lgt (<font color = "#a64700">length</font> lst))
         (q (<font color = "#a64700">quotient</font> lgt n))
         (lst1 (<b>if</b> (<a href = "general.html#multiplum-of" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">multiplum-of</font></a> lgt n) lst (<font color = "#a64700">append</font> lst (<a href = "general.html#make-list" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">make-list</font></a> (<font color = "#a64700">-</font> (<font color = "#a64700">*</font> (<font color = "#a64700">+</font> q 1) n) lgt) extra)))) <font color = "#70a800">; <a name="sublist-by-columns-@a"><a href = "documentation.html#sublist-by-columns-@a" target = documentation-frame><img src = "./images/source-mark-red.gif" alt = "A linked program source marker to section 3.3:
'A more general solution'
Mark char: a" border = "0" ></a></font>
         (rows (<b>if</b> (<a href = "general.html#multiplum-of" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">multiplum-of</font></a> lgt n) q (<font color = "#a64700">+</font> q 1)))
         (row-sublst (<a href = "general.html#sublist-by-rows" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">sublist-by-rows</font></a> rows lst1)))
    (<a href = "general.html#multi-pair" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">multi-pair</font></a> row-sublst))))

<a name="multi-pair"><font color = "#70a800">;; lst-of-lst is a list of list. All first elements of the sublists are taken first, whereafter
;; we take all second elements, etc. 
;; It is assumed that all sublists of lst-of-lst have the same lengths.</font>
<a name="multi-pair"><a href = "general.html#multi-pair"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-m.html#multi-pair" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from multi-pair to it's cross reference table entry" border = "0" ></a>&nbsp;<a href = "documentation.html#sublist-by-columns" target = documentation-frame><img src = "./images/doc-left.gif" alt = "3.3. A more general solution" border = "0" ></a><br>(<b>define</b> <b><font color = "#ff0000"  >(multi-pair lst-of-lst)</font></b>
  (<b>cond</b> ((<font color = "#a64700">null?</font> (<font color = "#a64700">car</font> lst-of-lst)) '())
        (<b>else</b> (<b>let</b> ((cars (<font color = "#a64700">map</font> <font color = "#a64700">car</font> lst-of-lst))
                    (cdrs (<font color = "#a64700">map</font> <font color = "#a64700">cdr</font> lst-of-lst)))
                (<font color = "#a64700">cons</font> cars (<a href = "general.html#multi-pair" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">multi-pair</font></a> cdrs))))))

<a name="multiplum-of"><font color = "#70a800">;; is a (the first par) a multiplum of b (the last par)?</font>
<a name="multiplum-of"><a href = "general.html#multiplum-of"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-m.html#multiplum-of" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from multiplum-of to it's cross reference table entry" border = "0" ></a>&nbsp;<a href = "documentation.html#sublist-by-columns" target = documentation-frame><img src = "./images/doc-left.gif" alt = "3.3. A more general solution" border = "0" ></a><br>(<b>define</b> <b><font color = "#ff0000"  >(multiplum-of a b)</font></b>
  (<font color = "#a64700">=</font> 0 (<font color = "#a64700">remainder</font> a b)))



<a name="sublist-by-predicate"><font color = "#70a800">;; Return a list of sublists of elements from lst controlled by an element predicate p.
;; The sublists are formed consequtively by taking elements from lst.  The predicate p decides
;; when to start a new sublist. Thus, when p evaluates to true, we start
;; a new sublist. The predicate p takes as parameters the current
;; elements, the previous element, and the number of elements before the
;; current one, p is not activated on (car lst). 
;; This function generalizes sublist-by-rows.
;; p: (cur prev n) -&gt; boolean</font>
<a name="sublist-by-predicate"><a href = "general.html#sublist-by-predicate"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-s.html#sublist-by-predicate" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from sublist-by-predicate to it's cross reference table entry" border = "0" ></a>&nbsp;<a href = "documentation.html#sublist-by-predicate" target = documentation-frame><img src = "./images/doc-left.gif" alt = "2.2. A more general function" border = "0" ></a><br>(<b>define</b> <b><font color = "#ff0000"  >(sublist-by-predicate lst p)</font></b>
  (<b>cond</b> ((<font color = "#a64700">null?</font> lst) '()) <font color = "#70a800">; <a name="sublist-by-predicate-@a"><a href = "documentation.html#sublist-by-predicate-@a" target = documentation-frame><img src = "./images/source-mark-red.gif" alt = "A linked program source marker to section 2.2:
'A more general function'
Mark char: a" border = "0" ></a></font>
        ((<font color = "#a64700">=</font> 1 (<font color = "#a64700">length</font> lst)) (<font color = "#a64700">list</font> lst))  <font color = "#70a800">; <a name="sublist-by-predicate-@b"><a href = "documentation.html#sublist-by-predicate-@b" target = documentation-frame><img src = "./images/source-mark-green.gif" alt = "A linked program source marker to section 2.2:
'A more general function'
Mark char: b" border = "0" ></a> special case: sublist the only element.</font>
        (<b>else</b> (<a href = "general.html#sublist-by-predicate-1" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">sublist-by-predicate-1</font></a> (<font color = "#a64700">cdr</font> lst) (<font color = "#a64700">car</font> lst) p 1 (<font color = "#a64700">list</font> (<font color = "#a64700">car</font> lst)) '()))))


<a name="sublist-by-predicate-1"><a href = "general.html#sublist-by-predicate-1"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-s.html#sublist-by-predicate-1" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from sublist-by-predicate-1 to it's cross reference table entry" border = "0" ></a>&nbsp;<a href = "documentation.html#sublist-by-predicate" target = documentation-frame><img src = "./images/doc-left.gif" alt = "2.2. A more general function" border = "0" ></a><br>(<b>define</b> <b><font color = "#ff0000"  >(sublist-by-predicate-1 lst previous-el p n res result)</font></b>
  (<b>cond</b> ((<b>and</b> (<font color = "#a64700">null?</font> lst) (<font color = "#a64700">null?</font> res)) (reverse result)) <font color = "#70a800">; <a name="sublist-by-predicate-1-@d"><a href = "documentation.html#sublist-by-predicate-@d" target = documentation-frame><img src = "./images/source-mark-black.gif" alt = "A linked program source marker to section 2.2:
'A more general function'
Mark char: d" border = "0" ></a></font>
        ((<b>and</b> (<font color = "#a64700">null?</font> lst) (<font color = "#a64700">not</font> (<font color = "#a64700">null?</font> res))) (reverse (<font color = "#a64700">cons</font> (reverse res) result))) <font color = "#70a800">; <a name="sublist-by-predicate-1-@e"><a href = "documentation.html#sublist-by-predicate-@e" target = documentation-frame><img src = "./images/source-mark-maroon.gif" alt = "A linked program source marker to section 2.2:
'A more general function'
Mark char: e" border = "0" ></a></font>
        ((p (<font color = "#a64700">car</font> lst) previous-el n)   (<a href = "general.html#sublist-by-predicate-1" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">sublist-by-predicate-1</font></a> (<font color = "#a64700">cdr</font> lst) (<font color = "#a64700">car</font> lst) p (<font color = "#a64700">+</font> n 1) (<font color = "#a64700">list</font> (<font color = "#a64700">car</font> lst)) (<font color = "#a64700">cons</font> (reverse res) result))) <font color = "#70a800">; <a name="sublist-by-predicate-1-@f"><a href = "documentation.html#sublist-by-predicate-@f" target = documentation-frame><img src = "./images/source-mark-grey.gif" alt = "A linked program source marker to section 2.2:
'A more general function'
Mark char: f" border = "0" ></a></font>
        (<b>else</b>                          (<a href = "general.html#sublist-by-predicate-1" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">sublist-by-predicate-1</font></a> (<font color = "#a64700">cdr</font> lst) (<font color = "#a64700">car</font> lst) p (<font color = "#a64700">+</font> n 1) (<font color = "#a64700">cons</font> (<font color = "#a64700">car</font> lst) res) result)))) <font color = "#70a800">; <a name="sublist-by-predicate-1-@g"><a href = "documentation.html#sublist-by-predicate-@g" target = documentation-frame><img src = "./images/source-mark-purple.gif" alt = "A linked program source marker to section 2.2:
'A more general function'
Mark char: g" border = "0" ></a></font>
<a name="remove-duplicates-by-predicate"><font color = "#70a800">;; Remove duplicates from lst.
;; A duplicates satisfy the comparing predicate p.
;; (p element element) -&gt; boolean.</font>
<a name="remove-duplicates-by-predicate"><a href = "general.html#remove-duplicates-by-predicate"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-r.html#remove-duplicates-by-predicate" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from remove-duplicates-by-predicate to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(remove-duplicates-by-predicate lst p)</font></b>
 (<a href = "general.html#remove-duplicates-by-predicate-1" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">remove-duplicates-by-predicate-1</font></a> lst p '()))

<a name="remove-duplicates-by-predicate-1"><a href = "general.html#remove-duplicates-by-predicate-1"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-r.html#remove-duplicates-by-predicate-1" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from remove-duplicates-by-predicate-1 to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(remove-duplicates-by-predicate-1 lst p res)</font></b>
  (<b>cond</b> ((<font color = "#a64700">null?</font> lst) (reverse res))
        ((<a href = "general.html#member-by-predicate" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">member-by-predicate</font></a> (<font color = "#a64700">car</font> lst) res p) (<a href = "general.html#remove-duplicates-by-predicate-1" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">remove-duplicates-by-predicate-1</font></a> (<font color = "#a64700">cdr</font> lst) p res))
        (<b>else</b> (<a href = "general.html#remove-duplicates-by-predicate-1" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">remove-duplicates-by-predicate-1</font></a> (<font color = "#a64700">cdr</font> lst) p (<font color = "#a64700">cons</font> (<font color = "#a64700">car</font> lst) res)))))

<a name="duplicates-by-predicate"><font color = "#70a800">;; Return the duplicates in lst. 
;; The duplicates are returned in the order of their fist occurence in lst.
;; Comparison of elements is done by the predicate (p element element) -&gt; boolean.</font>
<a name="duplicates-by-predicate"><a href = "general.html#duplicates-by-predicate"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-d.html#duplicates-by-predicate" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from duplicates-by-predicate to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(duplicates-by-predicate lst p)</font></b>
  (<a href = "general.html#duplicates-by-predicate-1" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">duplicates-by-predicate-1</font></a> lst p '()))

<a name="duplicates-by-predicate-1"><a href = "general.html#duplicates-by-predicate-1"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-d.html#duplicates-by-predicate-1" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from duplicates-by-predicate-1 to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(duplicates-by-predicate-1 lst p res)</font></b>
  (<b>cond</b> ((<font color = "#a64700">null?</font> lst) (reverse res))
        ((<a href = "general.html#member-by-predicate" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">member-by-predicate</font></a> (<font color = "#a64700">car</font> lst) (<font color = "#a64700">cdr</font> lst) p) (<a href = "general.html#duplicates-by-predicate-1" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">duplicates-by-predicate-1</font></a> (<font color = "#a64700">cdr</font> lst) p (<font color = "#a64700">cons</font> (<font color = "#a64700">car</font> lst) res)))
        (<b>else</b> (<a href = "general.html#duplicates-by-predicate-1" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">duplicates-by-predicate-1</font></a> (<font color = "#a64700">cdr</font> lst) p res))))  

<a name="member-by-predicate"><font color = "#70a800">;; Is el member of lst by means of the predicate p.
;; el is always passed as the first parameter to p.
;; If el is member, return the suffix of the list in which the first element (and el) satisfy the predicate.
;; Else return #f.
;; The element el and elements of lst are compared by p, el as the first one.
;; p: (el1, el2) -&gt; boolean</font>
<a name="member-by-predicate"><a href = "general.html#member-by-predicate"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-m.html#member-by-predicate" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from member-by-predicate to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(member-by-predicate el lst p)</font></b>
  (<b>cond</b> ((<font color = "#a64700">null?</font> lst) #f)
        ((p el (<font color = "#a64700">car</font> lst)) lst)
        (<b>else</b> (<a href = "general.html#member-by-predicate" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">member-by-predicate</font></a> el (<font color = "#a64700">cdr</font> lst) p))))


<a name="cut-list-by-predicate"><font color = "#70a800">;; Cut the tail of lst; The tail to be cutted starts with an element which fulfils pred.
;; Notice that the first element which fulfils the predicate is not included in the resulting list.</font>
<a name="cut-list-by-predicate"><a href = "general.html#cut-list-by-predicate"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-c.html#cut-list-by-predicate" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from cut-list-by-predicate to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(cut-list-by-predicate lst pred)</font></b>
  (<b>cond</b> ((<font color = "#a64700">null?</font> lst) '())
        ((pred (<font color = "#a64700">car</font> lst)) '())
        (<b>else</b> (<font color = "#a64700">cons</font> (<font color = "#a64700">car</font> lst) (<a href = "general.html#cut-list-by-predicate" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">cut-list-by-predicate</font></a> (<font color = "#a64700">cdr</font> lst) pred)))))


<a name="subset-of-by-predicate"><font color = "#70a800">;; Return whether every element in set-list-1 (a list) is a member of set-list-2, compared by the comparator comp.
;; This corresponds to a subset operations on sets, represented by a list.
;; comp: el x el -&gt; boolean.</font>
<a name="subset-of-by-predicate"><a href = "general.html#subset-of-by-predicate"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-s.html#subset-of-by-predicate" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from subset-of-by-predicate to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(subset-of-by-predicate set-list-1 set-list-2 comp)</font></b>
  (<b>cond</b> ((<font color = "#a64700">null?</font> set-list-1) #t)
        ((<a href = "general.html#member-by-predicate" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">member-by-predicate</font></a> (<font color = "#a64700">car</font> set-list-1) set-list-2 comp) (<a href = "general.html#subset-of-by-predicate" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">subset-of-by-predicate</font></a> (<font color = "#a64700">cdr</font> set-list-1) set-list-2 comp))
        (<b>else</b> #f)))

<a name="index-in-list-by-predicate"><font color = "#70a800">;; Return the index of the first occurrence of el in lst. 
;; Return #f is el is not found in lst.
;; Comparison is done by comparator.
;; The index of the first element is 0.</font>
<a name="index-in-list-by-predicate"><a href = "general.html#index-in-list-by-predicate"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-i.html#index-in-list-by-predicate" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from index-in-list-by-predicate to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(index-in-list-by-predicate lst el comparator)</font></b>
  (<a href = "general.html#index-in-list-by-predicate-1" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">index-in-list-by-predicate-1</font></a> lst el comparator 0))

<a name="index-in-list-by-predicate-1"><a href = "general.html#index-in-list-by-predicate-1"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-i.html#index-in-list-by-predicate-1" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from index-in-list-by-predicate-1 to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(index-in-list-by-predicate-1 lst el comparator i)</font></b>
  (<b>cond</b> ((<font color = "#a64700">null?</font> lst) #f)
        ((comparator el (<font color = "#a64700">car</font> lst)) i)
        (<b>else</b> (<a href = "general.html#index-in-list-by-predicate-1" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">index-in-list-by-predicate-1</font></a> (<font color = "#a64700">cdr</font> lst) el comparator (<font color = "#a64700">+</font> i 1)))))

<font color = "#70a800">; --------------------------------------------------------------------------------------------------</font>
<a name="copy-text-file"><font color = "#70a800">;; Copy the text file in from-path to the file in to-path. 
;; A quick and dirty solution by reading and writing strings to and from files.
;; If the destination file exists you must pass a third parameter, overwrite, with the value #t</font>
<a name="copy-text-file"><a href = "general.html#copy-text-file"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-c.html#copy-text-file" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from copy-text-file to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(copy-text-file from-path to-path overwrite?)</font></b>
  (<b>if</b> (<b>and</b> (file-exists? to-path) overwrite?) (delete-file to-path))
  (<b>let</b> ((contents (<a href = "file-read.html#read-text-file" title = "file-read" style = "{text-decoration: none;}" ><font color = "#000080">read-text-file</font></a> from-path)))
    (<b>if</b> (<font color = "#a64700">not</font> (file-exists? to-path))
        (<a href = "file-read.html#write-text-file" title = "file-read" style = "{text-decoration: none;}" ><font color = "#000080">write-text-file</font></a> contents to-path)
        (error (<font color = "#a64700">string-append</font> "copy-a-file: Overwriting an existing file requires a third overwrite #t parameter: " to-path)))))


<a name="copy-files"><font color = "#70a800">;; Copy each of the files in the list files from source-dir to target-dir.
;; Both source-dir and target-dir ends in a slash.</font>
<a name="copy-files"><a href = "general.html#copy-files"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-c.html#copy-files" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from copy-files to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(copy-files files source-dir target-dir)</font></b>
  (<b>letrec</b> ((copy-a-file 
            (<b>lambda</b> (f)
             (<b>let</b> ((target-file (<font color = "#a64700">string-append</font> target-dir f)))
               (<b>if</b> (file-exists? target-file) (delete-file target-file))
               (copy-file (<font color = "#a64700">string-append</font> source-dir f) target-file)))))
   (<font color = "#a64700">for-each</font> copy-a-file files)))

<a name="ensure-final-character"><font color = "#70a800">;; Ensure that the last character in str (a string) is ch (a char)</font>
<a name="ensure-final-character"><a href = "general.html#ensure-final-character"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-e.html#ensure-final-character" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from ensure-final-character to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(ensure-final-character str ch)</font></b>
  (<b>let</b> ((lgt (<font color = "#a64700">string-length</font> str)))
    (<b>if</b> (<b>and</b> (<font color = "#a64700">&gt;</font> lgt 0)
             (<font color = "#a64700">eq?</font> ch (<font color = "#a64700">string-ref</font> str (<font color = "#a64700">-</font> lgt 1))))
         str
         (<font color = "#a64700">string-append</font> str (<a href = "general.html#as-string" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">as-string</font></a> ch)))))



<font color = "#70a800">;;; Message displaying and error handling</font>
<a name="display-warning"><font color = "#70a800">;; Display a warning message line on standard output via the Scheme display function.
;; This is not a fatal error</font>
<a name="display-warning"><a href = "general.html#display-warning"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-d.html#display-warning" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from display-warning to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(display-warning message)</font></b>
  (<font color = "#a64700">display</font> (<font color = "#a64700">string-append</font> "Warning: " message)) (<font color = "#a64700">newline</font>))

<a name="display-error"><font color = "#70a800">;; Display an error message and stop the program. 
;; This is a fatal event.</font>
<a name="display-error"><a href = "general.html#display-error"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-d.html#display-error" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from display-error to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(display-error message)</font></b>
  (error message))

<a name="display-message"><font color = "#70a800">;; Display a message on standard output.
;; Not a warning, and not fatal by any means.</font>
<a name="display-message"><a href = "general.html#display-message"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-d.html#display-message" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from display-message to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(display-message message)</font></b>
  (<b>begin</b> (<font color = "#a64700">display</font> (<font color = "#a64700">string-append</font> message)) (<font color = "#a64700">newline</font>)))

<a name="errors-among-conditions"><font color = "#70a800">;; Return a list of error message strings for those conditions that are true.
;; The function returns #f in case no errors are found.
;; There are no errors if all conditions evaluate to #f, and in this case returns the #f.
;; err-condition-message-list is a property list (of even length) of error-condition error messages pairs.
;; This function checks the conditions and returns a concatenated list of error messages.
;; If no error conditions are found, return #f.</font>
<a name="errors-among-conditions"><a href = "general.html#errors-among-conditions"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-e.html#errors-among-conditions" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from errors-among-conditions to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(errors-among-conditions . err-condition-message-list)</font></b>
  (<a href = "general.html#errors-among-conditions-1" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">errors-among-conditions-1</font></a> err-condition-message-list #f '()))

<a name="errors-among-conditions-1"><a href = "general.html#errors-among-conditions-1"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-e.html#errors-among-conditions-1" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from errors-among-conditions-1 to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(errors-among-conditions-1 err-condition-message-list errors-found accumulated-error-messages)</font></b>
  (<b>cond</b> ((<font color = "#a64700">null?</font> err-condition-message-list) (<b>if</b> errors-found (reverse accumulated-error-messages) #f))
        (<b>else</b> (<b>let</b> ((error-condition (<font color = "#a64700">car</font> err-condition-message-list))
                    (error-message (<font color = "#a64700">cadr</font> err-condition-message-list)))
                (<b>if</b> error-condition 
                    (<a href = "general.html#errors-among-conditions-1" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">errors-among-conditions-1</font></a> (<font color = "#a64700">cddr</font> err-condition-message-list) #t (<font color = "#a64700">cons</font> error-message accumulated-error-messages))
                    (<a href = "general.html#errors-among-conditions-1" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">errors-among-conditions-1</font></a> (<font color = "#a64700">cddr</font> err-condition-message-list) errors-found accumulated-error-messages))))
  ))






<font color = "#70a800">;;; File name components</font>
<a name="file-name-sans-extension"><font color = "#70a800">;; Return the filename component sans the final extension.
;; The extension, in a file name, is the part that follows the last `.'.
;; If no dot character is found the function returns file-name</font>
<a name="file-name-sans-extension"><a href = "general.html#file-name-sans-extension"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-f.html#file-name-sans-extension" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from file-name-sans-extension to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(file-name-sans-extension file-name)</font></b>
  (<b>let</b> ((extension-pos (<a href = "general.html#find-in-string-from-end" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">find-in-string-from-end</font></a> file-name #\.)))
    (<b>if</b> extension-pos
        (<font color = "#a64700">substring</font> file-name 0 extension-pos)
        file-name)))

<a name="file-name-proper"><font color = "#70a800">;; Return the part of file-name without extension and without an initial path.
;; Works as expected even there are dots in the initial path.
;; Example: (file-name-proper "/xxx/yyy/zzz.eee") = "zzz".</font>
<a name="file-name-proper"><a href = "general.html#file-name-proper"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-f.html#file-name-proper" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from file-name-proper to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(file-name-proper file-name)</font></b>
 (<b>let*</b> ((extension-pos (<a href = "general.html#find-in-string-from-end" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">find-in-string-from-end</font></a> file-name #\.))
        (forward-slash-pos (<a href = "general.html#find-in-string-from-end" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">find-in-string-from-end</font></a> file-name #\/))
        (backward-slash-pos (<a href = "general.html#find-in-string-from-end" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">find-in-string-from-end</font></a> file-name #\\))
        (max-slash-pos (<b>cond</b> ((<b>and</b> forward-slash-pos backward-slash-pos) (<font color = "#a64700">max</font> forward-slash-pos backward-slash-pos))
                             (forward-slash-pos forward-slash-pos)
                             (backward-slash-pos backward-slash-pos)
                             (<b>else</b> -1)))
        (extension-pos-1 (<b>if</b> (<b>and</b> extension-pos (<font color = "#a64700">&gt;</font> extension-pos max-slash-pos)) extension-pos #f))
      )
  (<font color = "#a64700">substring</font>
      file-name
      (<font color = "#a64700">+</font> max-slash-pos 1)
      (<b>if</b> extension-pos-1 extension-pos-1 (<font color = "#a64700">string-length</font> file-name)))))


<a name="file-name-extension"><font color = "#70a800">;; Return the extension of file-name. 
;; The extension, in a file name, is the part that follows the last `.'.
;; This function handles dots in the initial path properly.</font>
<a name="file-name-extension"><a href = "general.html#file-name-extension"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-f.html#file-name-extension" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from file-name-extension to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(file-name-extension file-name)</font></b>
 (<b>let</b> ((extension-pos (<a href = "general.html#find-in-string-from-end" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">find-in-string-from-end</font></a> file-name #\.))
       (forward-slash-pos (<a href = "general.html#find-in-string-from-end" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">find-in-string-from-end</font></a> file-name #\/))
       (backward-slash-pos (<a href = "general.html#find-in-string-from-end" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">find-in-string-from-end</font></a> file-name #\\)))
  (<b>cond</b> ((<b>and</b> extension-pos forward-slash-pos (<font color = "#a64700">&gt;</font> extension-pos forward-slash-pos))
            (<font color = "#a64700">substring</font> file-name (<font color = "#a64700">+</font> extension-pos 1) (<font color = "#a64700">string-length</font> file-name)))
        ((<b>and</b> extension-pos forward-slash-pos (<font color = "#a64700">&lt;=</font> extension-pos forward-slash-pos))
            "")
        ((<b>and</b> extension-pos backward-slash-pos (<font color = "#a64700">&gt;</font> extension-pos backward-slash-pos))
             (<font color = "#a64700">substring</font> file-name (<font color = "#a64700">+</font> extension-pos 1) (<font color = "#a64700">string-length</font> file-name)))
        ((<b>and</b> extension-pos backward-slash-pos (<font color = "#a64700">&lt;=</font> extension-pos backward-slash-pos))
             "")
        (extension-pos (<font color = "#a64700">substring</font> file-name (<font color = "#a64700">+</font> extension-pos 1) (<font color = "#a64700">string-length</font> file-name)))
        (<b>else</b> ""))))


<a name="file-name-initial-path"><font color = "#70a800">;; Return the initial path of the file-name.
;; The initial path of a file name is the prefix of the file name without the proper file name
;; and without the extension. The initial path ends in a forward of backward slash, or it is empty.</font>
<a name="file-name-initial-path"><a href = "general.html#file-name-initial-path"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-f.html#file-name-initial-path" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from file-name-initial-path to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(file-name-initial-path file-name)</font></b>
 (<b>let</b> ((extension-pos (<a href = "general.html#find-in-string-from-end" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">find-in-string-from-end</font></a> file-name #\.))
       (forward-slash-pos (<a href = "general.html#find-in-string-from-end" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">find-in-string-from-end</font></a> file-name #\/))
       (backward-slash-pos (<a href = "general.html#find-in-string-from-end" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">find-in-string-from-end</font></a> file-name #\\)))
  (<font color = "#a64700">substring</font> 
    file-name
    0
    (<b>cond</b> ((<b>and</b> forward-slash-pos backward-slash-pos) (<font color = "#a64700">+</font> 1 (<font color = "#a64700">max</font> forward-slash-pos backward-slash-pos)))
	  (forward-slash-pos (<font color = "#a64700">+</font> 1 forward-slash-pos))
	  (backward-slash-pos (<font color = "#a64700">+</font> 1 backward-slash-pos))
	  (<b>else</b> 0))
  )))

<a name="absolute-file-path?"><font color = "#70a800">;; Return whether x - a string - represents an absolute path to a file.</font>
<a name="absolute-file-path?"><a href = "general.html#absolute-file-path?"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-a.html#absolute-file-path?" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from absolute-file-path? to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(absolute-file-path? x)</font></b>
  (<b>let</b> ((forward-slash-pos (<a href = "general.html#find-in-string" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">find-in-string</font></a> x #\/))
        (backward-slash-pos (<a href = "general.html#find-in-string" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">find-in-string</font></a> x #\\))
        (colon-pos (<a href = "general.html#find-in-string" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">find-in-string</font></a> x #\:)))
     (<b>or</b> (<b>and</b> (<font color = "#a64700">number?</font> forward-slash-pos) (<font color = "#a64700">=</font> 0 forward-slash-pos))
         (<b>and</b> (<font color = "#a64700">number?</font> colon-pos) (<font color = "#a64700">=</font> 1 colon-pos)))))

<a name="parent-directory"><font color = "#70a800">;; Return the name of the parent directory of dir (a string), or #f if dir is the root directory.</font>
<a name="parent-directory"><a href = "general.html#parent-directory"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-p.html#parent-directory" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from parent-directory to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(parent-directory dir)</font></b>
  (<b>let*</b> ((dir1 (<a href = "general.html#ensure-final-character" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">ensure-final-character</font></a> dir #\/))
         (lgt (<font color = "#a64700">string-length</font> dir1))
         (dir2 (<font color = "#a64700">substring</font> dir1 0 (<font color = "#a64700">max</font> (<font color = "#a64700">-</font> lgt 1) 0)))  <font color = "#70a800">; dir without ending slash</font>
         (forward-slash-pos (<a href = "general.html#find-in-string-from-end" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">find-in-string-from-end</font></a> dir2 #\/))
         (backward-slash-pos (<a href = "general.html#find-in-string-from-end" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">find-in-string-from-end</font></a> dir2 #\\)))
   (<b>cond</b> ((<b>and</b> forward-slash-pos backward-slash-pos (<font color = "#a64700">&gt;=</font> forward-slash-pos backward-slash-pos))
             (<font color = "#a64700">substring</font> dir2 0 (<font color = "#a64700">+</font> 1 forward-slash-pos)))
         ((<b>and</b> forward-slash-pos backward-slash-pos (<font color = "#a64700">&gt;=</font> backward-slash-pos forward-slash-pos))
             (<font color = "#a64700">substring</font> dir2 0 (<font color = "#a64700">+</font> 1 backward-slash-pos)))
         (forward-slash-pos
             (<font color = "#a64700">substring</font> dir2 0 (<font color = "#a64700">+</font> 1 forward-slash-pos)))
         (backward-slash-pos
             (<font color = "#a64700">substring</font> dir2 0 (<font color = "#a64700">+</font> 1 backward-slash-pos)))
         (<b>else</b> #f))))         

<a name="directory-level-difference"><font color = "#70a800">;; Return the number of directory levels in between dir1 and dir2.
;; Example: (directory-level-difference "/x/x/z/v/" "/x/x/") = 2
;; Another example: (directory-level-difference "/x/x/" "/x/x/z/v/") = -2
;; If dir1 is not a subdirectory of dir2, or dir2 is not a subdirectory of dir1 return #f.</font>
<a name="directory-level-difference"><a href = "general.html#directory-level-difference"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-d.html#directory-level-difference" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from directory-level-difference to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(directory-level-difference dir1 dir2)</font></b>
 (<b>let</b> ((dir1-lc (<a href = "general.html#downcase-string" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">downcase-string</font></a> dir1))
       (dir2-lc (<a href = "general.html#downcase-string" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">downcase-string</font></a> dir2)))
  (<b>let</b> ((res1 (<a href = "general.html#directory-level-difference-1" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">directory-level-difference-1</font></a> dir1-lc dir2-lc 0))
        (res2 (<a href = "general.html#directory-level-difference-1" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">directory-level-difference-1</font></a> dir2-lc dir1-lc 0)))
    (<b>cond</b> ((<b>and</b> res1 (<font color = "#a64700">number?</font> res1)) res1)
          ((<b>and</b> res2 (<font color = "#a64700">number?</font> res2)) (<font color = "#a64700">-</font> res2))
          (<b>else</b> #f)))))

<a name="directory-level-difference-1"><a href = "general.html#directory-level-difference-1"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-d.html#directory-level-difference-1" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from directory-level-difference-1 to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(directory-level-difference-1 dir1 dir2 n)</font></b>
 (<b>let</b> ((parent-dir-1 (<a href = "general.html#parent-directory" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">parent-directory</font></a> dir1)))
   (<b>cond</b> ((<b>and</b> dir1 dir2 (<font color = "#a64700">equal?</font> dir1 dir2)) n)
         ((<b>and</b> parent-dir-1 (<font color = "#a64700">string?</font> parent-dir-1)) (<a href = "general.html#directory-level-difference-1" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">directory-level-difference-1</font></a> parent-dir-1 dir2 (<font color = "#a64700">+</font> n 1)))
         ((<font color = "#a64700">not</font> parent-dir-1) #f))))

<a name="repeat-string"><font color = "#70a800">;; Repeat the string str n times.
;; If n equals n, return the empty string. 
;; Causes a fatal error if n is negative.</font>
<a name="repeat-string"><a href = "general.html#repeat-string"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-r.html#repeat-string" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from repeat-string to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(repeat-string str n)</font></b>
  (<b>cond</b> ((<font color = "#a64700">&lt;</font> n 0) (error (<font color = "#a64700">string-append</font> "repeat-string with negative repeat count is not supported: " (<a href = "general.html#as-string" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">as-string</font></a> n))))
        ((<font color = "#a64700">=</font> n 0) "")
        (<b>else</b> (<font color = "#a64700">string-append</font> str (<a href = "general.html#repeat-string" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">repeat-string</font></a> str (<font color = "#a64700">-</font> n 1))))))


<a name="sublistify"><font color = "#70a800">;; Divided the elements of lst into sublists of sublist-length.
;; In case that sublist-length does not divide (length lst) the last
;; sublist is shorter than the others.
;; Example: (sublistify '(1 2 3 4 5 6 7 8 9) 4) = ((1 2 3 4) (5 6 7 8) (9))</font>
<a name="sublistify"><a href = "general.html#sublistify"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-s.html#sublistify" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from sublistify to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(sublistify lst sublist-length)</font></b>
 (<b>if</b> (<font color = "#a64700">&lt;=</font> (<font color = "#a64700">length</font> lst) sublist-length)
     (<font color = "#a64700">list</font> lst)
     (<b>let</b> ((first-sublist (<a href = "general.html#list-prefix" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">list-prefix</font></a> lst sublist-length))
           (rest-lst (<font color = "#a64700">list-tail</font> lst sublist-length)))
       (<font color = "#a64700">cons</font> first-sublist
             (<a href = "general.html#sublistify" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">sublistify</font></a> rest-lst sublist-length)))))

<a name="list-prefix"><font color = "#70a800">;; Return the list of the first n elements of lst.
;; If n &lt; (length lst) just return lst</font>
<a name="list-prefix"><a href = "general.html#list-prefix"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-l.html#list-prefix" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from list-prefix to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(list-prefix lst n)</font></b>
  (<b>if</b> (<font color = "#a64700">&lt;</font> (<font color = "#a64700">length</font> lst) n)
      lst
      (<a href = "general.html#list-prefix-1" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">list-prefix-1</font></a> lst n)))

<a name="list-prefix-1"><a href = "general.html#list-prefix-1"><img src = "./images/small-square.gif" alt = "Show source file in small font" border = "0" ></a>&nbsp;<a href = "cross-reference-index-l.html#list-prefix-1" target = control-frame><img src = "./images/small-green-up-triangle.gif" alt = "In general: Link from list-prefix-1 to it's cross reference table entry" border = "0" ></a>&nbsp;<br>(<b>define</b> <b><font color = "#ff0000"  >(list-prefix-1 lst n)</font></b>
  (<b>if</b> (<font color = "#a64700">=</font> n 0)
      '()
      (<font color = "#a64700">cons</font> (<font color = "#a64700">car</font> lst) (<a href = "general.html#list-prefix-1" title = "general" style = "{text-decoration: none;}" ><font color = "#000080">list-prefix-1</font></a> (<font color = "#a64700">cdr</font> lst) (<font color = "#a64700">-</font> n 1)))))

</pre></font>&nbsp;<p>&nbsp;<p>&nbsp;<p>&nbsp;<p>&nbsp;<p>&nbsp;<p>&nbsp;<p>&nbsp;<p>&nbsp;<p>&nbsp;<p>&nbsp;<p>&nbsp;<p>&nbsp;<p>&nbsp;<p>&nbsp;<p>&nbsp;<p>&nbsp;<p>&nbsp;<p>&nbsp;<p>&nbsp;<p>&nbsp;<p>&nbsp;<p>&nbsp;<p>&nbsp;<p>&nbsp;<p></body></html>