<html><head><title>Source file</title></head><body bgcolor = "#ffffff" text = "#000000" link = "#000000" vlink = "#000000"  ><font size = "2"  ><pre><span class = "comment"  >;;;;This is a library of common and generally useful Scheme functions, which are used in other LAML libraries,
;;;; in LAML styles, and in LAML tools. Far the majority of the functions can also be used outside LAML. 
;;;; .title Reference Manual of the General LAML library</span>
<span class = "comment"  >;The LAML library and programs written by Kurt Normark, Aalborg University, Denmark.
; Copyright (C) 1999  Kurt Normark, normark@s.auc.dk.
;
; This program is free software; you can redistribute it and/or modify
; it under the terms of the GNU General Public License as published by
; the Free Software Foundation; either version 2 of the License, or
; (at your option) any later version.
;
; This program is distributed in the hope that it will be useful,
; but WITHOUT ANY WARRANTY; without even the implied warranty of
; MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
; GNU General Public License for more details.
;
; You should have received a copy of the GNU General Public License
; along with this program; if not, write to the Free Software
; Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA</span>
<span class = "comment"  >;;;List selection functions and their generators. 
;;; As an alternative to using car, cadr etc. we provide for generation of more general list selector functions.
;;; .id selection-generation</span>
<a name="make-selector-function"></a><span class = "comment"  >;;Returns a function, which selects element number n in a list.
;; The second parameter, which is optional, is used for error message purposes.
;; In general, this parameter should be a string corresponding to the name of the selector function.
;; If the second parameter is given, we check whether the list is long enough for selection.
;; If not, we give a decent error message. We recommend use of the second parameter in order to
;; avoid meaningless error messages.
;; The first element is number 1.
;; (make-selector-function 1) corresponds to car, (make-selector-function 2) corresponds to cadr, etc.
;; .form (make-selector-function n [selector-name])</span>
<a name="make-selector-function"></a><span> <span><a href="cross-reference-index-m.html#make-selector-function" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from make-selector-function to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(make-selector-function n . optional-parameter-list)</font></b>
 (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((selector-name (optional-parameter 1 optional-parameter-list #f)))
   (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> selector-name
       (<a href="../../../../r4rs/r4rs_6.htm#SEC30" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>lambda</b></a> (lst) 
         (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_8.htm#IDX264" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">list?</font></a> lst)
                 (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((lgt (<a href="../../../../r4rs/r4rs_8.htm#IDX266" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">length</font></a> lst)))
		   (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX353" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&gt;</font></a> n lgt)
		       (<a href="general.html#display-error" title="general" style="{text-decoration: none;}"><font color="#000080">display-error</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX510" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-append</font></a> "The selector function " (<a href="general.html#as-string" title="general" style="{text-decoration: none;}"><font color="#000080">as-string</font></a> selector-name) ": " 
						     "The list "  (<a href="general.html#as-string" title="general" style="{text-decoration: none;}"><font color="#000080">as-string</font></a> lst) " is is too short for selection. "
						     "It must have at least " (<a href="general.html#as-string" title="general" style="{text-decoration: none;}"><font color="#000080">as-string</font></a> n) " elements."
						     ))
		       (<a href="../../../../r4rs/r4rs_8.htm#IDX271" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">list-ref</font></a> lst (<a href="../../../../r4rs/r4rs_8.htm#IDX369" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">-</font></a> n 1)))))
               (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> (<a href="general.html#display-error" title="general" style="{text-decoration: none;}"><font color="#000080">display-error</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX510" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-append</font></a> "The selector function " (<a href="general.html#as-string" title="general" style="{text-decoration: none;}"><font color="#000080">as-string</font></a> selector-name) ": " 
						   "The parameter  "  (<a href="general.html#as-string" title="general" style="{text-decoration: none;}"><font color="#000080">as-string</font></a> lst) "  is supposed to be a list. "
                                                   "In addition, it must have at least "
				                    (<a href="general.html#as-string" title="general" style="{text-decoration: none;}"><font color="#000080">as-string</font></a> n) " elements."
						     )))))
       (<a href="../../../../r4rs/r4rs_6.htm#SEC30" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>lambda</b></a> (lst) (<a href="../../../../r4rs/r4rs_8.htm#IDX271" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">list-ref</font></a> lst (<a href="../../../../r4rs/r4rs_8.htm#IDX369" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">-</font></a> n 1))))))

<a name="make-mutator-function"></a><span class = "comment"  >;;Make and return a mutator function which mutates element number n in a list.
;; The returned function takes a list and a new value as arguments.
;; This function takes one optional parameter, which is the name of the mutator
;; This is used for error message purposes.</span>
<a name="make-mutator-function"></a><span> <span><a href="cross-reference-index-m.html#make-mutator-function" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from make-mutator-function to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(make-mutator-function n . optional-parameter-list)</font></b>
 (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((mutator-name (optional-parameter 1 optional-parameter-list)))
   (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> mutator-name
       (<a href="../../../../r4rs/r4rs_6.htm#SEC30" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>lambda</b></a> (lst new-value) 
         (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((lgt (<a href="../../../../r4rs/r4rs_8.htm#IDX266" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">length</font></a> lst)))
            (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX353" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&gt;</font></a> n lgt)
                (<a href="general.html#display-error" title="general" style="{text-decoration: none;}"><font color="#000080">display-error</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX510" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-append</font></a> "The mutator function " (<a href="general.html#as-string" title="general" style="{text-decoration: none;}"><font color="#000080">as-string</font></a> mutator-name) ": " 
                                 "The list "  (<a href="general.html#as-string" title="general" style="{text-decoration: none;}"><font color="#000080">as-string</font></a> lst) " is is too short for mutator. "
                                 "It must have at least " (<a href="general.html#as-string" title="general" style="{text-decoration: none;}"><font color="#000080">as-string</font></a> n) " elements."
                               ))
                (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((cons-pair (<a href="../../../../r4rs/r4rs_8.htm#IDX269" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">list-tail</font></a> lst (<a href="../../../../r4rs/r4rs_8.htm#IDX369" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">-</font></a> n 1))))
                  (<a href="../../../../r4rs/r4rs_8.htm#IDX250" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">set-car!</font></a> cons-pair new-value)))))
      (<a href="../../../../r4rs/r4rs_6.htm#SEC30" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>lambda</b></a> (lst new-value) 
         (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((lgt (<a href="../../../../r4rs/r4rs_8.htm#IDX266" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">length</font></a> lst)))
            (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX353" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&gt;</font></a> n lgt)
                (<a href="general.html#display-error" title="general" style="{text-decoration: none;}"><font color="#000080">display-error</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX510" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-append</font></a> "Error in mutator:"
                                 "The list "  (<a href="general.html#as-string" title="general" style="{text-decoration: none;}"><font color="#000080">as-string</font></a> lst) " is is too short for mutator. "
                                 "It must have at least " (<a href="general.html#as-string" title="general" style="{text-decoration: none;}"><font color="#000080">as-string</font></a> n) " elements."))
                (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((cons-pair (<a href="../../../../r4rs/r4rs_8.htm#IDX269" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">list-tail</font></a> lst (<a href="../../../../r4rs/r4rs_8.htm#IDX369" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">-</font></a> n 1))))
                  (<a href="../../../../r4rs/r4rs_8.htm#IDX250" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">set-car!</font></a> cons-pair new-value))))))))


<a name="first"></a><span class = "comment"  >;;Return the first element of a list
;; .form (first lst)</span>
<a name="first"></a><span> <span><a href="cross-reference-index-f.html#first" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from first to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >first</font></b> <a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a>)

<a name="second"></a><span class = "comment"  >;;Return the second element of a list
;; .form (second lst)</span>
<a name="second"></a><span> <span><a href="cross-reference-index-s.html#second" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from second to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >second</font></b> <a href="../../../../r4rs/r4rs_8.htm#IDX256" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cadr</font></a>)

<a name="third"></a><span class = "comment"  >;;Return the third element of a list
;; .form (third lst)</span>
<a name="third"></a><span> <span><a href="cross-reference-index-t.html#third" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from third to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >third</font></b> <a href="../../../../r4rs/r4rs_8.htm#IDX254" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">caddr</font></a>)

<a name="fourth"></a><span class = "comment"  >;;Return the fourth element of a list
;; .form (fourth lst)</span>
<a name="fourth"></a><span> <span><a href="cross-reference-index-f.html#fourth" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from fourth to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >fourth</font></b> <a href="../../../../r4rs/r4rs_8.htm#IDX254" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cadddr</font></a>)

<a name="fifth"></a><span class = "comment"  >;;Return the fifth element of a list
;; .form (fifth lst)
;; .returns The fifth element of the list</span>
<a name="fifth"></a><span> <span><a href="cross-reference-index-f.html#fifth" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from fifth to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >fifth</font></b> (<a href="general.html#make-selector-function" title="general" style="{text-decoration: none;}"><font color="#000080">make-selector-function</font></a> 5))

<a name="sixth"></a><span class = "comment"  >;;Return the sixth element of a list
;; .form (sixth lst)</span>
<a name="sixth"></a><span> <span><a href="cross-reference-index-s.html#sixth" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from sixth to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >sixth</font></b> (<a href="general.html#make-selector-function" title="general" style="{text-decoration: none;}"><font color="#000080">make-selector-function</font></a> 6))

<a name="seventh"></a><span class = "comment"  >;;Return the seventh element of a list
;; .form (seventh lst)</span>
<a name="seventh"></a><span> <span><a href="cross-reference-index-s.html#seventh" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from seventh to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >seventh</font></b> (<a href="general.html#make-selector-function" title="general" style="{text-decoration: none;}"><font color="#000080">make-selector-function</font></a> 7))

<a name="eighth"></a><span class = "comment"  >;;Return the eighth element of a list
;; .form (eighth lst)</span>
<a name="eighth"></a><span> <span><a href="cross-reference-index-e.html#eighth" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from eighth to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >eighth</font></b> (<a href="general.html#make-selector-function" title="general" style="{text-decoration: none;}"><font color="#000080">make-selector-function</font></a> 8))

<a name="nineth"></a><span class = "comment"  >;;Return the nineth element of a list
;; .form (nineth lst)</span>
<a name="nineth"></a><span> <span><a href="cross-reference-index-n.html#nineth" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from nineth to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >nineth</font></b> (<a href="general.html#make-selector-function" title="general" style="{text-decoration: none;}"><font color="#000080">make-selector-function</font></a> 9))


<span class = "comment"  >;;;Association and property list functions. 
;;; Here follows a number of functions which work on alists, or make alists. Also a number of property list functions are provided.</span>
<a name="symbolize-key"></a><span class = "comment"  >;;A function which converts the key position in an a-lists to a symbol.
;; .parameter key-value-pair a pair, such as ("key" . "val")
;; .returns a pair (key . "val")</span>
<a name="symbolize-key"></a><span> <span><a href="cross-reference-index-s.html#symbolize-key" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from symbolize-key to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(symbolize-key key-value-pair)</font></b>
 (<a href="../../../../r4rs/r4rs_8.htm#IDX245" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cons</font></a> (<a href="general.html#as-symbol" title="general" style="{text-decoration: none;}"><font color="#000080">as-symbol</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> key-value-pair)) (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> key-value-pair)))

<a name="extend-a-list"></a><span class = "comment"  >;;Add a key-value pair to a-list. Like acons in some systems.</span>
<a name="extend-a-list"></a><span> <span><a href="cross-reference-index-e.html#extend-a-list" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from extend-a-list to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(extend-a-list key value a-list)</font></b>
 (<a href="../../../../r4rs/r4rs_8.htm#IDX245" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cons</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX245" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cons</font></a> (<a href="general.html#as-symbol" title="general" style="{text-decoration: none;}"><font color="#000080">as-symbol</font></a> key) value) a-list))

<a name="get"></a><span class = "comment"  >;;Return a value from an alist which corresponds to key.
;; In case the key does not exist in the alist, a fatal error will occur.
;; .parameter key is a symbol.
;; .parameter a-list an association list with symbols as keys.
;; .returns the first value of key in a-list.
;; .misc Uses the function assq (based on eq? for key comparions) internally.
;; .internal-references "similar function" "defaulted-get"</span>
<a name="get"></a><span> <span><a href="cross-reference-index-g.html#get" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from get to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(get key a-list)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((res (<a href="../../../../r4rs/r4rs_8.htm#IDX281" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">assq</font></a> key a-list)))
    (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX243" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">pair?</font></a> res) 
        (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> res)
        (error (<a href="../../../../r4rs/r4rs_8.htm#IDX510" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-append</font></a> "Get: Cannot find " (<a href="general.html#as-string" title="general" style="{text-decoration: none;}"><font color="#000080">as-string</font></a> key) " in " (<a href="general.html#as-string" title="general" style="{text-decoration: none;}"><font color="#000080">as-string</font></a> a-list))))))

<a name="defaulted-get"></a><span class = "comment"  >;;Return the value of key in alist (by means of cdr of assq). If no association is found return default.
;; .internal-references "similar function" "get"</span>
<a name="defaulted-get"></a><span> <span><a href="cross-reference-index-d.html#defaulted-get" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from defaulted-get to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(defaulted-get key alist default)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((res (<a href="../../../../r4rs/r4rs_8.htm#IDX281" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">assq</font></a> key alist)))
    (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> res
       (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> res)
       default)))


<a name="get-prop"></a><span class = "comment"  >;;Return the value of key in the property list p-list.
;; In case the key does not exist in the property list, a fatal error will occur.
;; .parameter key is a symbol.
;; .parameter p-list a property list with symbols as keys.
;; .returns the first value of key in p-list
;; .misc Uses the function eq? for key comparions.
;; .internal-references "similar function" "defaulted-get-prop"
;; .pre-condition p-list is of even length</span>
<a name="get-prop"></a><span> <span><a href="cross-reference-index-g.html#get-prop" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from get-prop to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(get-prop key p-list)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((res (<a href="general.html#find-key-in-property-list" title="general" style="{text-decoration: none;}"><font color="#000080">find-key-in-property-list</font></a> key p-list)))
    (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> res
        (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX177" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">not</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> res)))
            (<a href="../../../../r4rs/r4rs_8.htm#IDX256" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cadr</font></a> res)
            (<a href="general.html#laml-error" title="general" style="{text-decoration: none;}"><font color="#000080">laml-error</font></a> "Illformed property list:" (<a href="general.html#as-string" title="general" style="{text-decoration: none;}"><font color="#000080">as-string</font></a> p-list)))
        (<a href="general.html#laml-error" title="general" style="{text-decoration: none;}"><font color="#000080">laml-error</font></a> "Get-prop: Cannot find" (<a href="general.html#as-string" title="general" style="{text-decoration: none;}"><font color="#000080">as-string</font></a> key) "in the property list" (<a href="general.html#as-string" title="general" style="{text-decoration: none;}"><font color="#000080">as-string</font></a> p-list)))))

<a name="find-key-in-property-list"></a><span> <span><a href="cross-reference-index-f.html#find-key-in-property-list" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from find-key-in-property-list to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(find-key-in-property-list key p-list)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> p-list) #f)
        ((<a href="../../../../r4rs/r4rs_8.htm#IDX204" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">eq?</font></a> key (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> p-list)) p-list)
        ((<a href="../../../../r4rs/r4rs_8.htm#IDX177" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">not</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> p-list))) (<a href="general.html#find-key-in-property-list" title="general" style="{text-decoration: none;}"><font color="#000080">find-key-in-property-list</font></a> key (<a href="../../../../r4rs/r4rs_8.htm#IDX254" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cddr</font></a> p-list)))
        (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> (<a href="general.html#laml-error" title="general" style="{text-decoration: none;}"><font color="#000080">laml-error</font></a> "Illformed property list:" (<a href="general.html#as-string" title="general" style="{text-decoration: none;}"><font color="#000080">as-string</font></a> p-list)))))

<a name="defaulted-get-prop"></a><span class = "comment"  >;;Return the value of key in the property list p-list (by means of cdr of assq). If no association is found return default.
;; .internal-references "similar function" "get-prop"
;; .pre-condition p-list is of even length</span>
<a name="defaulted-get-prop"></a><span> <span><a href="cross-reference-index-d.html#defaulted-get-prop" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from defaulted-get-prop to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(defaulted-get-prop key p-list default)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((res (<a href="general.html#find-key-in-property-list" title="general" style="{text-decoration: none;}"><font color="#000080">find-key-in-property-list</font></a> key p-list)))
    (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> res
        (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX177" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">not</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> res)))
            (<a href="../../../../r4rs/r4rs_8.htm#IDX256" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cadr</font></a> res)
            (<a href="general.html#laml-error" title="general" style="{text-decoration: none;}"><font color="#000080">laml-error</font></a> "Illformed property list:" (<a href="general.html#as-string" title="general" style="{text-decoration: none;}"><font color="#000080">as-string</font></a> p-list)))
        default)))

<a name="alist-from-keys-and-values"></a><span class = "comment"  >;;Make an alist from a key-list and a val-list. 
;; .pre-condition the lengths of the two input lists are equal.</span>
<a name="alist-from-keys-and-values"></a><span> <span><a href="cross-reference-index-a.html#alist-from-keys-and-values" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from alist-from-keys-and-values to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(alist-from-keys-and-values key-list val-list)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX351" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">=</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX266" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">length</font></a> key-list) (<a href="../../../../r4rs/r4rs_8.htm#IDX266" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">length</font></a> val-list))
      (<a href="general.html#alist-from-keys-and-values-1" title="general" style="{text-decoration: none;}"><font color="#000080">alist-from-keys-and-values-1</font></a> key-list val-list)
      (error "alist-from-keys-and-values: key and val list do not have same lengths")))

<a name="alist-from-keys-and-values-1"></a><span> <span><a href="cross-reference-index-a.html#alist-from-keys-and-values-1" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from alist-from-keys-and-values-1 to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(alist-from-keys-and-values-1 key-list val-list)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> key-list)
      '()
      (<a href="../../../../r4rs/r4rs_8.htm#IDX245" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cons</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX245" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cons</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> key-list) (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> val-list))
            (<a href="general.html#alist-from-keys-and-values-1" title="general" style="{text-decoration: none;}"><font color="#000080">alist-from-keys-and-values-1</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> key-list) (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> val-list)))))

<a name="propertylist-to-alist"></a><span class = "comment"  >;;Make and return an association list from a property list plist.</span>
<a name="propertylist-to-alist"></a><span> <span><a href="cross-reference-index-p.html#propertylist-to-alist" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from propertylist-to-alist to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(propertylist-to-alist plist)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((lgt (<a href="../../../../r4rs/r4rs_8.htm#IDX266" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">length</font></a> plist)))
   (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> plist) '())
         ((<a href="../../../../r4rs/r4rs_8.htm#IDX351" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">=</font></a> 1 lgt) (error "propertylist-to-a-list called with list of odd length. A property list is always of even length"))
         ((<a href="../../../../r4rs/r4rs_8.htm#IDX355" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&gt;=</font></a> lgt 2) (<a href="../../../../r4rs/r4rs_8.htm#IDX245" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cons</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX245" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cons</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> plist) (<a href="../../../../r4rs/r4rs_8.htm#IDX256" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cadr</font></a> plist)) (<a href="general.html#propertylist-to-alist" title="general" style="{text-decoration: none;}"><font color="#000080">propertylist-to-alist</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX254" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cddr</font></a> plist)))))))

<a name="alist-to-propertylist"></a><span class = "comment"  >;;Make and return a property list from an association list.</span>
<a name="alist-to-propertylist"></a><span> <span><a href="cross-reference-index-a.html#alist-to-propertylist" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from alist-to-propertylist to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(alist-to-propertylist alist)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> alist) '())
        (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX245" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cons</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> alist)) (<a href="../../../../r4rs/r4rs_8.htm#IDX245" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cons</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> alist)) (<a href="general.html#alist-to-propertylist" title="general" style="{text-decoration: none;}"><font color="#000080">alist-to-propertylist</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> alist)))))))

<a name="every-second-element"></a><span class = "comment"  >;;Return every second element of list, starting with the first element.
;; This function is useful to extract the keys or values of a property list.</span>
<a name="every-second-element"></a><span> <span><a href="cross-reference-index-e.html#every-second-element" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from every-second-element to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(every-second-element lst)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> lst) '())
        ((<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> lst)) (<a href="../../../../r4rs/r4rs_8.htm#IDX265" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">list</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> lst)))
        (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX245" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cons</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> lst) (<a href="general.html#every-second-element" title="general" style="{text-decoration: none;}"><font color="#000080">every-second-element</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX254" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cddr</font></a> lst))))))

<a name="but-props"></a><span class = "comment"  >;;Return those property names and values of prop-list which are not in eliminations.
;; .parameter prop-list A well-formed property list, in which the property names are symbols.
;; .parameter eliminations A list of property names, where each property name is a symbol.</span>
<a name="but-props"></a><span> <span><a href="cross-reference-index-b.html#but-props" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from but-props to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(but-props prop-list eliminations)</font></b>
 (<a href="general.html#but-props-1" title="general" style="{text-decoration: none;}"><font color="#000080">but-props-1</font></a> prop-list eliminations '()))

<a name="but-props-1"></a><span> <span><a href="cross-reference-index-b.html#but-props-1" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from but-props-1 to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(but-props-1 prop-list eliminations res)</font></b>
 (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> prop-list) (reverse res))
       ((<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> prop-list)) (<a href="general.html#laml-error" title="general" style="{text-decoration: none;}"><font color="#000080">laml-error</font></a> "but-props called with ill-formed property list (odd number of elements)"))
       (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((name (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> prop-list))
                   (val (<a href="../../../../r4rs/r4rs_8.htm#IDX256" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cadr</font></a> prop-list)))
               (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX272" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">memq</font></a> name eliminations) 
                   (<a href="general.html#but-props-1" title="general" style="{text-decoration: none;}"><font color="#000080">but-props-1</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX254" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cddr</font></a> prop-list) eliminations res)
                   (<a href="general.html#but-props-1" title="general" style="{text-decoration: none;}"><font color="#000080">but-props-1</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX254" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cddr</font></a> prop-list) eliminations (<a href="../../../../r4rs/r4rs_8.htm#IDX245" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cons</font></a> val (<a href="../../../../r4rs/r4rs_8.htm#IDX245" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cons</font></a> name res))))))))



<span class = "comment"  >;;;Filter and accumulation functions. 
;;; This sections provides variants of the very useful higher order filtering function.</span>
<a name="filter"></a><span class = "comment"  >;;Filter a list lst by means of the predicate pred. Preserves the ordering of elements in lst.
;; .returns the elements in lst that fulfills the predicate pred.
;; .misc Based on a tail recursive traversal of lst.
;; .internal-references "similar function" "filter-no-ordering"</span>
<a name="filter"></a><span> <span><a href="cross-reference-index-f.html#filter" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from filter to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(filter pred lst)</font></b>
  (reverse (<a href="general.html#filter-help" title="general" style="{text-decoration: none;}"><font color="#000080">filter-help</font></a> pred lst '())))

<a name="filter-no-ordering"></a><span class = "comment"  >;;Like filter, but the ordering among elements in the resulting list is unknown and arbitrary.
;; Actually returns filtered list in reverse order. OK in situations,
;; where a boolean result is needed: Are there anything passing the filter?
;; .internal-references "similar function" "filter"</span>
<a name="filter-no-ordering"></a><span> <span><a href="cross-reference-index-f.html#filter-no-ordering" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from filter-no-ordering to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(filter-no-ordering pred lst)</font></b>
  (<a href="general.html#filter-help" title="general" style="{text-decoration: none;}"><font color="#000080">filter-help</font></a> pred lst '()))

<a name="filter-help"></a><span> <span><a href="cross-reference-index-f.html#filter-help" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from filter-help to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(filter-help pred lst res)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> lst) res)
        ((pred (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> lst)) (<a href="general.html#filter-help" title="general" style="{text-decoration: none;}"><font color="#000080">filter-help</font></a> pred (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> lst) (<a href="../../../../r4rs/r4rs_8.htm#IDX245" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cons</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> lst) res)))
        (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> (<a href="general.html#filter-help" title="general" style="{text-decoration: none;}"><font color="#000080">filter-help</font></a> pred (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> lst) res))))

<a name="mapping-filter"></a><span class = "comment"  >;;Map and filter a list lst by means of the predicate pred.
;; If the predicate pred returns a true value v on the element e in list, return
;; v instead of e (this is the mapping effect). 
;; Only return those mapped elements that fullfil pred.
;; .misc Remember that any non-#f element counts as the true (#t) value.</span>
<a name="mapping-filter"></a><span> <span><a href="cross-reference-index-m.html#mapping-filter" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from mapping-filter to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(mapping-filter pred lst)</font></b>
  (reverse (<a href="general.html#mapping-filter-help" title="general" style="{text-decoration: none;}"><font color="#000080">mapping-filter-help</font></a> pred lst '())))

<a name="mapping-filter-help"></a><span> <span><a href="cross-reference-index-m.html#mapping-filter-help" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from mapping-filter-help to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(mapping-filter-help pred lst res)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> lst)
      res
      (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((pred-appl (pred (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> lst))))
        (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> pred-appl 
            (<a href="general.html#mapping-filter-help" title="general" style="{text-decoration: none;}"><font color="#000080">mapping-filter-help</font></a> pred (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> lst) (<a href="../../../../r4rs/r4rs_8.htm#IDX245" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cons</font></a> pred-appl res))
            (<a href="general.html#mapping-filter-help" title="general" style="{text-decoration: none;}"><font color="#000080">mapping-filter-help</font></a> pred (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> lst) res)))))

<span class = "comment"  >;accumulate-right contributed by ttn@iblet.glug.org, November 28, 2002.</span>
<a name="accumulate-right"></a><span class = "comment"  >;;A higher-order function which right accumulates the list lst by means of the binary function f, 
;; using init as the initial value of the accumulation.
;; .misc This function is iterative.</span>
<a name="accumulate-right"></a><span> <span><a href="cross-reference-index-a.html#accumulate-right" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from accumulate-right to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(accumulate-right f init lst)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> loop ((lst (reverse lst)) (acc init))
    (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> lst)
	acc
	(loop (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> lst) (f (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> lst) acc)))))


<span class = "comment"  >;;;Mapping functions.
;;; Here is a set of generalized mapping functions. These functions are all similar to map (which may take an arbitrary number of lists).
;;; Notice however, that map2, map3, etc does not require all lists to be of equal lengths.</span>
<a name="map2"></a><span class = "comment"  >;;Like map, but maps f on two lists. 
;; .returns Returns a list of length equal to the length of the shortest of the input lists.</span>
<a name="map2"></a><span> <span><a href="cross-reference-index-m.html#map2" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from map2 to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(map2 f lst1 lst2)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> (<a href="../../../../r4rs/r4rs_6.htm#IDX96" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>or</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> lst1) (<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> lst2)) '()
      (<a href="../../../../r4rs/r4rs_8.htm#IDX245" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cons</font></a> (f (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> lst1) (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> lst2)) 
            (<a href="general.html#map2" title="general" style="{text-decoration: none;}"><font color="#000080">map2</font></a> f (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> lst1) (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> lst2)))))

<a name="map3"></a><span class = "comment"  >;;Like map, but maps f on three lists
;; .returns Returns a list of length equal to the length of the shortest of the input lists.</span>
<a name="map3"></a><span> <span><a href="cross-reference-index-m.html#map3" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from map3 to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(map3 f lst1 lst2 lst3)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> (<a href="../../../../r4rs/r4rs_6.htm#IDX96" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>or</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> lst1) (<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> lst2) (<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> lst3)) '()
      (<a href="../../../../r4rs/r4rs_8.htm#IDX245" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cons</font></a> (f (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> lst1) (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> lst2) (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> lst3)) 
            (<a href="general.html#map3" title="general" style="{text-decoration: none;}"><font color="#000080">map3</font></a> f (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> lst1) (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> lst2) (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> lst3)))))

<a name="map4"></a><span class = "comment"  >;;Like map, but maps f on four lists
;; .returns Returns a list of length equal to the length of the shortest of the input lists.</span>
<a name="map4"></a><span> <span><a href="cross-reference-index-m.html#map4" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from map4 to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(map4 f lst1 lst2 lst3 lst4)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> (<a href="../../../../r4rs/r4rs_6.htm#IDX96" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>or</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> lst1) (<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> lst2) (<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> lst3)  (<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> lst4)) '()
      (<a href="../../../../r4rs/r4rs_8.htm#IDX245" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cons</font></a> (f (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> lst1) (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> lst2) (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> lst3) (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> lst4)) 
            (<a href="general.html#map4" title="general" style="{text-decoration: none;}"><font color="#000080">map4</font></a> f (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> lst1) (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> lst2) (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> lst3) (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> lst4)))))

<a name="map5"></a><span class = "comment"  >;;Like map, but maps f on five lists
;; .returns Returns a list of length equal to the length of the shortest of the input lists.</span>
<a name="map5"></a><span> <span><a href="cross-reference-index-m.html#map5" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from map5 to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(map5 f lst1 lst2 lst3 lst4 lst5)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> (<a href="../../../../r4rs/r4rs_6.htm#IDX96" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>or</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> lst1) (<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> lst2) (<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> lst3)  (<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> lst4) (<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> lst5)) '()
      (<a href="../../../../r4rs/r4rs_8.htm#IDX245" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cons</font></a> (f (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> lst1) (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> lst2) (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> lst3) (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> lst4) (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> lst5) ) 
            (<a href="general.html#map5" title="general" style="{text-decoration: none;}"><font color="#000080">map5</font></a> f (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> lst1) (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> lst2) (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> lst3) (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> lst4) (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> lst5)))))



<span class = "comment"  >;;;Other higher-order functions.</span>
<a name="negate"></a><span class = "comment"  >;;A higher order functions which negates the predicate p. Negate accepts a predicate and returns the negated predicate.</span>
<a name="negate"></a><span> <span><a href="cross-reference-index-n.html#negate" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from negate to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(negate p)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC30" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>lambda</b></a> (x) 
    (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> (p x) #f #t)))

<span class = "comment"  >;Old version of compose:
; Return a composed function which applies f on g
; Both f and g are supposed to take a single argument.
; (define (compose f g)
 ; (lambda (x)
   ; (f (g x))))</span>
<a name="compose"></a><span class = "comment"  >;;Compose a list of functions to a single function.
;; Each function in the list takes a single parameter.
;; Handles the typical case of two functions manually to achieve better efficiency.
;; .precondition f-list is a proper list of length ast least one.</span>
<a name="compose"></a><span> <span><a href="cross-reference-index-c.html#compose" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from compose to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(compose . f-list)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_8.htm#IDX351" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">=</font></a> 1 (<a href="../../../../r4rs/r4rs_8.htm#IDX266" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">length</font></a> f-list)) (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> f-list))
        ((<a href="../../../../r4rs/r4rs_8.htm#IDX351" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">=</font></a> 2 (<a href="../../../../r4rs/r4rs_8.htm#IDX266" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">length</font></a> f-list))
	 (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((f (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> f-list)) 
	       (g (<a href="../../../../r4rs/r4rs_8.htm#IDX256" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cadr</font></a> f-list)))
	   (<a href="../../../../r4rs/r4rs_6.htm#SEC30" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>lambda</b></a> (x) (f (g x)))))
        (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a>  (<a href="../../../../r4rs/r4rs_6.htm#SEC30" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>lambda</b></a> (x)
		 ((<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> f-list)
		  ((<a href="../../../../r4rs/r4rs_8.htm#IDX540" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">apply</font></a> <a href="general.html#compose" title="general" style="{text-decoration: none;}"><font color="#000080">compose</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> f-list)) x))))))


<a name="generate-leq"></a><span class = "comment"  >;;Generate a less than or equal predicate from the enumeration-order.
;; If p is the generated predicate, (p x y) is true if and only if
;; (selector x) comes before (or at the same position) as (selector y)
;; in the enumeration-order. Thus, (selector x) is assumed to give a
;; value in enumeration-order. Comparison with elements in the enumeration-list
;; is done with el-eq?
;; .form (generate-leq enumeration-order selector [el-eq?])</span>
<a name="generate-leq"></a><span> <span><a href="cross-reference-index-g.html#generate-leq" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from generate-leq to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(generate-leq enumeration-order selector . optional-parameter-list)</font></b>
 (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((el-eq? (optional-parameter 1 optional-parameter-list <a href="../../../../r4rs/r4rs_8.htm#IDX204" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">eq?</font></a>)))
  (<a href="../../../../r4rs/r4rs_6.htm#SEC30" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>lambda</b></a> (x y)
     <span class = "comment"  >;x and y supposed to be elements in enumeration order</span>
     (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((x-index (<a href="general.html#list-index" title="general" style="{text-decoration: none;}"><font color="#000080">list-index</font></a> (selector x) enumeration-order el-eq?))
           (y-index (<a href="general.html#list-index" title="general" style="{text-decoration: none;}"><font color="#000080">list-index</font></a> (selector y) enumeration-order el-eq?)))
       (<a href="../../../../r4rs/r4rs_8.htm#IDX354" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&lt;=</font></a> x-index y-index)))))

<a name="list-index"></a><span class = "comment"  >;A helping function of generate-leq.
; Return the position of e in lst. First is 1
; compare with el-eq?
; if e is not member of lst return (+ 1 (length lst))</span>
<a name="list-index"></a><span> <span><a href="cross-reference-index-l.html#list-index" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from list-index to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(list-index e lst el-eq?)</font></b>
 (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> lst) 1)
       ((el-eq? (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> lst) e) 1)
       (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> 1 (<a href="general.html#list-index" title="general" style="{text-decoration: none;}"><font color="#000080">list-index</font></a> e (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> lst) el-eq?)))))

<a name="curry-generalized"></a><span class = "comment"  >;;Generalize f with ad hoc currying. 
;; f is a function which, in its native form, takes two or more parameters.
;; The generalization allows f to act as a curried function. In case (curry-generalized f)
;; only receives a single parameter, it returns a lambda function which waits for the 
;; remaining parameters.
;; If two or more parameters are passed to f, f is applied on the the parameters; In this case
;; (curry-generalized f) is equivalent to f.
;; .example (define gmap (curry-generalized map))
;; .example (define gfilter (curry-generalized filter))</span>
<a name="curry-generalized"></a><span> <span><a href="cross-reference-index-c.html#curry-generalized" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from curry-generalized to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(curry-generalized f)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC30" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>lambda</b></a> rest
    (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_8.htm#IDX351" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">=</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX266" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">length</font></a> rest) 1) (<a href="../../../../r4rs/r4rs_6.htm#SEC30" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>lambda</b></a> lst (<a href="../../../../r4rs/r4rs_8.htm#IDX540" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">apply</font></a> f (<a href="../../../../r4rs/r4rs_8.htm#IDX245" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cons</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> rest) lst))))
          ((<a href="../../../../r4rs/r4rs_8.htm#IDX355" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&gt;=</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX266" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">length</font></a> rest) 2) (<a href="../../../../r4rs/r4rs_8.htm#IDX540" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">apply</font></a> f rest)))))

<span class = "comment"  >;;;List and Sexpr functions.</span>
<a name="number-interval"></a><span class = "comment"  >;;Return a list of all numbers from f to t. Return the empty list if f is greater than t.</span>
<a name="number-interval"></a><span> <span><a href="cross-reference-index-n.html#number-interval" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from number-interval to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(number-interval f t)</font></b>
 (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX354" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&lt;=</font></a> f t) (<a href="../../../../r4rs/r4rs_8.htm#IDX245" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cons</font></a> f (<a href="general.html#number-interval" title="general" style="{text-decoration: none;}"><font color="#000080">number-interval</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> f 1) t)) '()))


<a name="proper-part"></a><span class = "comment"  >;;Return the proper part of an S-expression</span>
<a name="proper-part"></a><span> <span><a href="cross-reference-index-p.html#proper-part" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from proper-part to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(proper-part lst)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_6.htm#IDX95" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>and</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX243" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">pair?</font></a> lst) (<a href="../../../../r4rs/r4rs_8.htm#IDX243" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">pair?</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> lst)))  (<a href="../../../../r4rs/r4rs_8.htm#IDX245" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cons</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> lst) (<a href="general.html#proper-part" title="general" style="{text-decoration: none;}"><font color="#000080">proper-part</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> lst))))
        ((<a href="../../../../r4rs/r4rs_8.htm#IDX243" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">pair?</font></a> lst) (<a href="../../../../r4rs/r4rs_8.htm#IDX245" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cons</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> lst) '()))
        (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> '())))

<a name="first-improper-part"></a><span class = "comment"  >;;Return the first improper part of an S-expression</span>
<a name="first-improper-part"></a><span> <span><a href="cross-reference-index-f.html#first-improper-part" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from first-improper-part to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(first-improper-part lst)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_6.htm#IDX95" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>and</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX243" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">pair?</font></a> lst) (<a href="../../../../r4rs/r4rs_8.htm#IDX243" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">pair?</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> lst)))  (<a href="general.html#first-improper-part" title="general" style="{text-decoration: none;}"><font color="#000080">first-improper-part</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> lst)))
        ((<a href="../../../../r4rs/r4rs_8.htm#IDX243" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">pair?</font></a> lst) (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> lst))
        (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> (error (<a href="../../../../r4rs/r4rs_8.htm#IDX510" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-append</font></a> "Troubles in first-improper-part:" (<a href="general.html#as-string" title="general" style="{text-decoration: none;}"><font color="#000080">as-string</font></a> lst))))))



<a name="make-list"></a><span class = "comment"  >;;Return a list of n elements, each being el</span>
<a name="make-list"></a><span> <span><a href="cross-reference-index-m.html#make-list" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from make-list to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(make-list n el)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX354" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&lt;=</font></a> n 0) '() (<a href="../../../../r4rs/r4rs_8.htm#IDX245" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cons</font></a> el (<a href="general.html#make-list" title="general" style="{text-decoration: none;}"><font color="#000080">make-list</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX369" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">-</font></a> n 1) el))))

<a name="replicate-to-length"></a><span class = "comment"  >;;Replicate lst cyclically to a list of length lgt</span>
<a name="replicate-to-length"></a><span> <span><a href="cross-reference-index-r.html#replicate-to-length" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from replicate-to-length to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(replicate-to-length lst lgt)</font></b>
  (reverse (<a href="general.html#replicate-to-length-1" title="general" style="{text-decoration: none;}"><font color="#000080">replicate-to-length-1</font></a> lst lst '() 0 lgt)))

<a name="replicate-to-length-1"></a><span class = "comment"  >;helping function to replicate-to-length
; original-lst is constant through this function.
; elements are taken out of lst
; the result is accumulated up in res
; count goes from 0 to lgt</span>
<a name="replicate-to-length-1"></a><span> <span><a href="cross-reference-index-r.html#replicate-to-length-1" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from replicate-to-length-1 to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(replicate-to-length-1 original-lst lst res count lgt)</font></b>
 (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> lst) (<a href="general.html#replicate-to-length-1" title="general" style="{text-decoration: none;}"><font color="#000080">replicate-to-length-1</font></a> original-lst original-lst res count lgt))
       ((<a href="../../../../r4rs/r4rs_8.htm#IDX352" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&lt;</font></a> count lgt) (<a href="general.html#replicate-to-length-1" title="general" style="{text-decoration: none;}"><font color="#000080">replicate-to-length-1</font></a> original-lst (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> lst) (<a href="../../../../r4rs/r4rs_8.htm#IDX245" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cons</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> lst) res) (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> 1 count) lgt))
       (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> res)))


<a name="flatten"></a><span class = "comment"  >;;Flatten a list of lists to one list.</span>
<a name="flatten"></a><span> <span><a href="cross-reference-index-f.html#flatten" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from flatten to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(flatten lst-of-lst)</font></b>
  (<a href="general.html#accumulate-right" title="general" style="{text-decoration: none;}"><font color="#000080">accumulate-right</font></a> <a href="../../../../r4rs/r4rs_8.htm#IDX267" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">append</font></a> '() lst-of-lst))

<a name="sum-list"></a><span class = "comment"  >;;Add all elments in a list of numbers</span>
<a name="sum-list"></a><span> <span><a href="cross-reference-index-s.html#sum-list" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from sum-list to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(sum-list lst)</font></b>
  (<a href="general.html#accumulate-right" title="general" style="{text-decoration: none;}"><font color="#000080">accumulate-right</font></a> <a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> 0 lst))



<a name="merge-lists"></a><span class = "comment"  >;;Merge list1 and list2. Let e1 be the head of list1 and e2 the head of list2.
;; take e2 if (pred e1 e2) holds. Else e1</span>
<a name="merge-lists"></a><span> <span><a href="cross-reference-index-m.html#merge-lists" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from merge-lists to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(merge-lists list1 list2 pred)</font></b>
 (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> list1) list2)
       ((<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> list2) list1)
       ((pred (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> list1) (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> list2)) (<a href="../../../../r4rs/r4rs_8.htm#IDX245" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cons</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> list2) (<a href="general.html#merge-lists" title="general" style="{text-decoration: none;}"><font color="#000080">merge-lists</font></a> list1 (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> list2) pred)))
       (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX245" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cons</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> list1) (<a href="general.html#merge-lists" title="general" style="{text-decoration: none;}"><font color="#000080">merge-lists</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> list1) list2 pred)))))

<a name="merge-lists-simple"></a><span class = "comment"  >;;Merge the two lists lst1 and lst2. lst1 provides the first element.
;; When the shortets of the lists is exhausted, insert the rest of the other list.
;; .example (merge-lists-simple '(a b c d)  '(1 2 3)) =&gt; (a 1 b 2 c 3 d)</span>
<a name="merge-lists-simple"></a><span> <span><a href="cross-reference-index-m.html#merge-lists-simple" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from merge-lists-simple to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(merge-lists-simple lst1 lst2)</font></b>
 (<a href="general.html#merge-lists-simple-1" title="general" style="{text-decoration: none;}"><font color="#000080">merge-lists-simple-1</font></a> lst1 lst2 '()))

<a name="merge-lists-simple-1"></a><span> <span><a href="cross-reference-index-m.html#merge-lists-simple-1" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from merge-lists-simple-1 to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(merge-lists-simple-1 lst1 lst2 res)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> lst1) (reverse (<a href="../../../../r4rs/r4rs_8.htm#IDX267" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">append</font></a> (reverse lst2) res)))
        ((<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> lst2) (reverse (<a href="../../../../r4rs/r4rs_8.htm#IDX267" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">append</font></a> (reverse lst1) res)))
        (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> (<a href="general.html#merge-lists-simple-1" title="general" style="{text-decoration: none;}"><font color="#000080">merge-lists-simple-1</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> lst1) (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> lst2) (<a href="../../../../r4rs/r4rs_8.htm#IDX245" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cons</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> lst2) (<a href="../../../../r4rs/r4rs_8.htm#IDX245" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cons</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> lst1) res ))))))

<a name="find-in-list"></a><span class = "comment"  >;;A simple linear list search function.
;; Return the first element which satisfies the predicate pred.
;; If no such element is found, return #f.
;; Tail recursive and iterative.</span>
<a name="find-in-list"></a><span> <span><a href="cross-reference-index-f.html#find-in-list" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from find-in-list to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(find-in-list pred lst)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> lst) #f)
        ((pred (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> lst)) (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> lst))
        (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> (<a href="general.html#find-in-list" title="general" style="{text-decoration: none;}"><font color="#000080">find-in-list</font></a> pred (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> lst)))))

<a name="butlast"></a><span class = "comment"  >;;Return all but the last element of a list. Quick and dirty version.</span>
<a name="butlast"></a><span> <span><a href="cross-reference-index-b.html#butlast" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from butlast to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(butlast lst)</font></b>
  (reverse (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> (reverse lst))))

<a name="last"></a><span class = "comment"  >;;Return the last element of a list. Quick and dirty version.</span>
<a name="last"></a><span> <span><a href="cross-reference-index-l.html#last" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from last to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(last lst)</font></b>
  (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> (reverse lst)))

<a name="remove-duplicates"></a><span class = "comment"  >;;Duplicate removal - non-destructive.
;; This function uses equal for comparison of elements.</span>
<a name="remove-duplicates"></a><span> <span><a href="cross-reference-index-r.html#remove-duplicates" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from remove-duplicates to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(remove-duplicates lst)</font></b>
 (<a href="general.html#remove-duplicates-help" title="general" style="{text-decoration: none;}"><font color="#000080">remove-duplicates-help</font></a> lst '()))

<a name="remove-duplicates-help"></a><span> <span><a href="cross-reference-index-r.html#remove-duplicates-help" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from remove-duplicates-help to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(remove-duplicates-help lst res)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> lst) (reverse res))
        ((<a href="../../../../r4rs/r4rs_8.htm#IDX274" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">member</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> lst) res) (<a href="general.html#remove-duplicates-help" title="general" style="{text-decoration: none;}"><font color="#000080">remove-duplicates-help</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> lst) res))
        (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> (<a href="general.html#remove-duplicates-help" title="general" style="{text-decoration: none;}"><font color="#000080">remove-duplicates-help</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> lst) (<a href="../../../../r4rs/r4rs_8.htm#IDX245" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cons</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> lst) res)))))

<a name="remove-duplicates-with-selection"></a><span class = "comment"  >;;A variant of remove-duplicates with a selector function.
;; This function applies a selector function before comparisons and member is called.
;; This function uses equal? for comparison of elements.</span>
<a name="remove-duplicates-with-selection"></a><span> <span><a href="cross-reference-index-r.html#remove-duplicates-with-selection" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from remove-duplicates-with-selection to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(remove-duplicates-with-selection lst selector)</font></b>
 (<a href="general.html#remove-duplicates-with-selection-help" title="general" style="{text-decoration: none;}"><font color="#000080">remove-duplicates-with-selection-help</font></a> lst '() '() selector))

<a name="remove-duplicates-with-selection-help"></a><span> <span><a href="cross-reference-index-r.html#remove-duplicates-with-selection-help" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from remove-duplicates-with-selection-help to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(remove-duplicates-with-selection-help lst res selected-res selector)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> lst) (reverse res))
        ((<a href="../../../../r4rs/r4rs_8.htm#IDX274" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">member</font></a> (selector (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> lst)) selected-res)
            (<a href="general.html#remove-duplicates-with-selection-help" title="general" style="{text-decoration: none;}"><font color="#000080">remove-duplicates-with-selection-help</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> lst) res selected-res selector))
        (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> (<a href="general.html#remove-duplicates-with-selection-help" title="general" style="{text-decoration: none;}"><font color="#000080">remove-duplicates-with-selection-help</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> lst) (<a href="../../../../r4rs/r4rs_8.htm#IDX245" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cons</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> lst) res)  (<a href="../../../../r4rs/r4rs_8.htm#IDX245" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cons</font></a> (selector (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> lst)) selected-res) selector ))))

<a name="element-before"></a><span class = "comment"  >;;Return the element of lst just before el, or #f if no such element exists.
;; Comparsion is done via application of selector on the elements of lst, and via eq?.
;; More precise return the element e of lst just before f, where (eq? (selector f) el).</span>
<a name="element-before"></a><span> <span><a href="cross-reference-index-e.html#element-before" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from element-before to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(element-before el lst selector . optional-parameter-list)</font></b>
 (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((eq-pred (optional-parameter 1 optional-parameter-list <a href="../../../../r4rs/r4rs_8.htm#IDX204" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">eq?</font></a>)))
  (<a href="general.html#element-before-1" title="general" style="{text-decoration: none;}"><font color="#000080">element-before-1</font></a> el lst selector (<a href="../../../../r4rs/r4rs_8.htm#IDX266" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">length</font></a> lst) eq-pred)))

<a name="element-before-1"></a><span> <span><a href="cross-reference-index-e.html#element-before-1" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from element-before-1 to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(element-before-1 el lst selector lgt eq-pred)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_8.htm#IDX354" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&lt;=</font></a> lgt 1) #f)
        ((eq-pred el (selector (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> lst))) #f)
        ((eq-pred el (selector (<a href="../../../../r4rs/r4rs_8.htm#IDX256" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cadr</font></a> lst))) (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> lst))
        (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> (<a href="general.html#element-before-1" title="general" style="{text-decoration: none;}"><font color="#000080">element-before-1</font></a> el (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> lst) selector (<a href="../../../../r4rs/r4rs_8.htm#IDX369" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">-</font></a> lgt 1) eq-pred))))

<a name="element-after"></a><span class = "comment"  >;;Return the element of lst just after el, or #f if no such element exists.
;; Comparsion is done via application of selector on the elements of lst, and via eq?.
;; More precise return the element e of lst just after f, where (eq? (selector f) el).</span>
<a name="element-after"></a><span> <span><a href="cross-reference-index-e.html#element-after" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from element-after to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(element-after el lst selector . optional-parameter-list)</font></b>
 (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((eq-pred (optional-parameter 1 optional-parameter-list <a href="../../../../r4rs/r4rs_8.htm#IDX204" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">eq?</font></a>)))
  (<a href="general.html#element-after-1" title="general" style="{text-decoration: none;}"><font color="#000080">element-after-1</font></a> el lst selector (<a href="../../../../r4rs/r4rs_8.htm#IDX266" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">length</font></a> lst) eq-pred)))

<a name="element-after-1"></a><span> <span><a href="cross-reference-index-e.html#element-after-1" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from element-after-1 to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(element-after-1 el lst selector lgt eq-pred)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_8.htm#IDX354" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&lt;=</font></a> lgt 1) #f)
        ((eq-pred el (selector (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> lst))) (<a href="../../../../r4rs/r4rs_8.htm#IDX256" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cadr</font></a> lst))
        (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> (<a href="general.html#element-after-1" title="general" style="{text-decoration: none;}"><font color="#000080">element-after-1</font></a> el (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> lst) selector (<a href="../../../../r4rs/r4rs_8.htm#IDX369" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">-</font></a> lgt 1) eq-pred))))


<a name="list-difference"></a><span class = "comment"  >;;Remove the elements of lst2 from lst1. 
;; This function is a non-destructive function.
;; .form (list-difference lst1 lst2 [is-eq?])
;; .parameter lst1 The list from which lst1 is subtracted
;; .parameter lst2 The list to subtract from lst1
;; .parameter is-eq? the equalilty function used for element comparison. The default comparison function is eq?
;; .returns The elements in lst1 which are not member of lst2</span>
<a name="list-difference"></a><span> <span><a href="cross-reference-index-l.html#list-difference" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from list-difference to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(list-difference lst1 lst2 . optional-parameter-list)</font></b>
 (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((is-eq? (optional-parameter 1 optional-parameter-list <a href="../../../../r4rs/r4rs_8.htm#IDX204" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">eq?</font></a>)))
  (<a href="general.html#list-difference-1" title="general" style="{text-decoration: none;}"><font color="#000080">list-difference-1</font></a> lst1 lst2 '() is-eq?)))

<a name="list-difference-1"></a><span> <span><a href="cross-reference-index-l.html#list-difference-1" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from list-difference-1 to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(list-difference-1 lst1 lst2 res eq-pred)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> lst1) (reverse res))
        ((<a href="general.html#member-by-predicate" title="general" style="{text-decoration: none;}"><font color="#000080">member-by-predicate</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> lst1) lst2 eq-pred) (<a href="general.html#list-difference-1" title="general" style="{text-decoration: none;}"><font color="#000080">list-difference-1</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> lst1) lst2 res eq-pred))
        (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> (<a href="general.html#list-difference-1" title="general" style="{text-decoration: none;}"><font color="#000080">list-difference-1</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> lst1) lst2 (<a href="../../../../r4rs/r4rs_8.htm#IDX245" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cons</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> lst1) res) eq-pred))))



<a name="pair-up"></a><span class = "comment"  >;;Return a list of pairs of elements from lst1 and lst2.
;; In other words, return an association list with keys from lst1 and values from lst2.
;; The list is as long as the shortest of lst1 and lst2.</span>
<a name="pair-up"></a><span> <span><a href="cross-reference-index-p.html#pair-up" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from pair-up to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(pair-up lst1 lst2)</font></b>
  (<a href="general.html#pair-up-1" title="general" style="{text-decoration: none;}"><font color="#000080">pair-up-1</font></a> lst1 lst2 '()))

<a name="pair-up-1"></a><span> <span><a href="cross-reference-index-p.html#pair-up-1" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from pair-up-1 to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(pair-up-1 lst1 lst2 res)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_6.htm#IDX96" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>or</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> lst1) (<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> lst2)) (reverse res))
        (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> (<a href="general.html#pair-up-1" title="general" style="{text-decoration: none;}"><font color="#000080">pair-up-1</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> lst1) (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> lst2) (<a href="../../../../r4rs/r4rs_8.htm#IDX245" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cons</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX245" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cons</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> lst1) (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> lst2)) res)))))

<a name="sublist-by-rows"></a><span class = "comment"  >;;Return a list of lists of elements from lst.
;; Each sub list is of length n.
;; Take elements consequtive (by rows) and put them into sublists.
;; .internal-references "More general function" "sublist-by-predicate"</span>
<a name="sublist-by-rows"></a><span> <span><a href="cross-reference-index-s.html#sublist-by-rows" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from sublist-by-rows to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> <a href="documentation.html#sublist-by-rows" target="documentation-frame"><img src="./images/doc-left.gif" alt="2.1. The first row sublist function" border="0"/></a> &nbsp; <a href="documentation.html#sublist-by-predicate" target="documentation-frame"><img src="./images/doc-left-weak.gif" alt="2.2. A more general function" border="0"/></a> &nbsp; <a href="documentation.html#sublist-by-2columns" target="documentation-frame"><img src="./images/doc-left-weak.gif" alt="3.2. A dedicated two column solution" border="0"/></a> &nbsp; <a href="documentation.html#sublist-by-columns" target="documentation-frame"><img src="./images/doc-left-weak.gif" alt="3.3. A more general solution" border="0"/></a></span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(sublist-by-rows n lst)</font></b>
 (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((lgt (<a href="../../../../r4rs/r4rs_8.htm#IDX266" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">length</font></a> lst)))
  (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_8.htm#IDX354" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&lt;=</font></a> n 0) (error  (<a href="../../../../r4rs/r4rs_8.htm#IDX510" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-append</font></a> "sublist-by-rows: Cannot deal with row numbers less than or equal to zero: " (<a href="general.html#as-string" title="general" style="{text-decoration: none;}"><font color="#000080">as-string</font></a> n))))
        ((<a href="../../../../r4rs/r4rs_8.htm#IDX352" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&lt;</font></a> lgt n) (<a href="../../../../r4rs/r4rs_8.htm#IDX265" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">list</font></a> lst))
        (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> (<a href="general.html#sublist-by-rows-1" title="general" style="{text-decoration: none;}"><font color="#000080">sublist-by-rows-1</font></a> n lst 0 '() '())))))

<a name="sublist-by-rows-1"></a><span> <span><a href="cross-reference-index-s.html#sublist-by-rows-1" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from sublist-by-rows-1 to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> <a href="documentation.html#sublist-by-rows" target="documentation-frame"><img src="./images/doc-left.gif" alt="2.1. The first row sublist function" border="0"/></a></span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(sublist-by-rows-1 n lst m res result)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_6.htm#IDX95" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>and</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> lst) (<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> res)) (reverse result))  <span class = "comment"  >;<span><a name="sublist-by-rows-1-@a"></a> <a href="documentation.html#sublist-by-rows-@a" target="documentation-frame"><img src="./images/source-mark-red.gif" alt="A linked program source marker to section 2.1:
&#39;The first row sublist function&#39;
Mark char: a" border="0"/></a></span></span>
        ((<a href="../../../../r4rs/r4rs_6.htm#IDX95" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>and</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> lst) (<a href="../../../../r4rs/r4rs_8.htm#IDX177" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">not</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> res))) (reverse (<a href="../../../../r4rs/r4rs_8.htm#IDX245" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cons</font></a> (reverse res) result)))    <span class = "comment"  >;<span><a name="sublist-by-rows-1-@b"></a> <a href="documentation.html#sublist-by-rows-@b" target="documentation-frame"><img src="./images/source-mark-green.gif" alt="A linked program source marker to section 2.1:
&#39;The first row sublist function&#39;
Mark char: b" border="0"/></a></span></span>
        ((<a href="../../../../r4rs/r4rs_8.htm#IDX351" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">=</font></a> m n ) (<a href="general.html#sublist-by-rows-1" title="general" style="{text-decoration: none;}"><font color="#000080">sublist-by-rows-1</font></a> n lst 0 '() (<a href="../../../../r4rs/r4rs_8.htm#IDX245" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cons</font></a> (reverse res) result)))         <span class = "comment"  >;<span><a name="sublist-by-rows-1-@c"></a> <a href="documentation.html#sublist-by-rows-@c" target="documentation-frame"><img src="./images/source-mark-blue.gif" alt="A linked program source marker to section 2.1:
&#39;The first row sublist function&#39;
Mark char: c" border="0"/></a></span></span>
        ((<a href="../../../../r4rs/r4rs_8.htm#IDX354" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&lt;=</font></a> m n) (<a href="general.html#sublist-by-rows-1" title="general" style="{text-decoration: none;}"><font color="#000080">sublist-by-rows-1</font></a> n (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> lst) (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> m 1) (<a href="../../../../r4rs/r4rs_8.htm#IDX245" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cons</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> lst) res) result)) <span class = "comment"  >;<span><a name="sublist-by-rows-1-@d"></a> <a href="documentation.html#sublist-by-rows-@d" target="documentation-frame"><img src="./images/source-mark-black.gif" alt="A linked program source marker to section 2.1:
&#39;The first row sublist function&#39;
Mark char: d" border="0"/></a></span></span>
        (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> (error "sublist-by-rows-1: Should not happen"))))                       

<a name="sublist-by-2columns"></a><span class = "comment"  >;;Return sublists of lst in two column format. Thus each produced sublist is of length 2.
;; Good for presentation of the list in two columns, column by column.
;; In cases there is an uneven number of elements in lst, we add extra (the second parameter).</span>
<a name="sublist-by-2columns"></a><span> <span><a href="cross-reference-index-s.html#sublist-by-2columns" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from sublist-by-2columns to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> <a href="documentation.html#sublist-by-2columns" target="documentation-frame"><img src="./images/doc-left.gif" alt="3.2. A dedicated two column solution" border="0"/></a> &nbsp; <a href="documentation.html#sublist-by-columns" target="documentation-frame"><img src="./images/doc-left-weak.gif" alt="3.3. A more general solution" border="0"/></a></span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(sublist-by-2columns lst extra)</font></b>
 (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> lst)
     '()
  (<a href="../../../../r4rs/r4rs_6.htm#IDX107" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let*</b></a> ((lgt (<a href="../../../../r4rs/r4rs_8.htm#IDX266" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">length</font></a> lst))
         (lst1 (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX362" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">even?</font></a> lgt) lst (<a href="../../../../r4rs/r4rs_8.htm#IDX267" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">append</font></a> lst (<a href="../../../../r4rs/r4rs_8.htm#IDX265" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">list</font></a> extra))))
         (row-sublst (<a href="general.html#sublist-by-rows" title="general" style="{text-decoration: none;}"><font color="#000080">sublist-by-rows</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX378" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">quotient</font></a> (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX362" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">even?</font></a> lgt) lgt (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> 1 lgt)) 2) lst1)) <span class = "comment"  >;<span><a name="sublist-by-2columns-@i"></a> <a href="documentation.html#sublist-by-2columns-@i" target="documentation-frame"><img src="./images/source-mark-tetal.gif" alt="A linked program source marker to section 3.2:
&#39;A dedicated two column solution&#39;
Mark char: i" border="0"/></a></span></span>
        )
    (<a href="../../../../r4rs/r4rs_8.htm#IDX542" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">map</font></a> <span class = "comment"  >;<span><a name="sublist-by-2columns-@j"></a> <a href="documentation.html#sublist-by-2columns-@j" target="documentation-frame"><img src="./images/source-mark-aqua.gif" alt="A linked program source marker to section 3.2:
&#39;A dedicated two column solution&#39;
Mark char: j" border="0"/></a></span></span>
      (<a href="../../../../r4rs/r4rs_6.htm#SEC30" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>lambda</b></a> (e1 e2) (<a href="../../../../r4rs/r4rs_8.htm#IDX265" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">list</font></a> e1 e2))
      (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> row-sublst) (<a href="../../../../r4rs/r4rs_8.htm#IDX256" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cadr</font></a> row-sublst)))))

<a name="sublist-by-columns"></a><span class = "comment"  >;;Return sublists of lst in an n column format. Thus each produced sublist is of length n
;; (the first parameter).
;; In cases there is not enough elements, we add extra (the last parameter).</span>
<a name="sublist-by-columns"></a><span> <span><a href="cross-reference-index-s.html#sublist-by-columns" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from sublist-by-columns to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> <a href="documentation.html#sublist-by-columns" target="documentation-frame"><img src="./images/doc-left.gif" alt="3.3. A more general solution" border="0"/></a></span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(sublist-by-columns n lst extra)</font></b>
 (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> lst)
     '()
  (<a href="../../../../r4rs/r4rs_6.htm#IDX107" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let*</b></a> ((lgt (<a href="../../../../r4rs/r4rs_8.htm#IDX266" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">length</font></a> lst))
         (q (<a href="../../../../r4rs/r4rs_8.htm#IDX378" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">quotient</font></a> lgt n))
         (lst1 (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> (<a href="general.html#multiplum-of" title="general" style="{text-decoration: none;}"><font color="#000080">multiplum-of</font></a> lgt n) lst (<a href="../../../../r4rs/r4rs_8.htm#IDX267" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">append</font></a> lst (<a href="general.html#make-list" title="general" style="{text-decoration: none;}"><font color="#000080">make-list</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX369" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">-</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX368" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">*</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> q 1) n) lgt) extra)))) <span class = "comment"  >;<span><a name="sublist-by-columns-@a"></a> <a href="documentation.html#sublist-by-columns-@a" target="documentation-frame"><img src="./images/source-mark-red.gif" alt="A linked program source marker to section 3.3:
&#39;A more general solution&#39;
Mark char: a" border="0"/></a></span></span>
         (rows (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> (<a href="general.html#multiplum-of" title="general" style="{text-decoration: none;}"><font color="#000080">multiplum-of</font></a> lgt n) q (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> q 1)))
         (row-sublst (<a href="general.html#sublist-by-rows" title="general" style="{text-decoration: none;}"><font color="#000080">sublist-by-rows</font></a> rows lst1)))
    (<a href="general.html#multi-pair" title="general" style="{text-decoration: none;}"><font color="#000080">multi-pair</font></a> row-sublst))))

<a name="multi-pair"></a><span class = "comment"  >;;Pair up first elements, second elements of a list of lists.
;; All first elements of the sublists are handled first, whereafter
;; we take all second elements, etc. 
;; .parameter lst-of-lst A list of lists.
;; .pre-condition All lists in lst-of-list are of equal lengths.</span>
<a name="multi-pair"></a><span> <span><a href="cross-reference-index-m.html#multi-pair" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from multi-pair to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> <a href="documentation.html#sublist-by-columns" target="documentation-frame"><img src="./images/doc-left.gif" alt="3.3. A more general solution" border="0"/></a></span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(multi-pair lst-of-lst)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> lst-of-lst)) '())
        (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((cars (<a href="../../../../r4rs/r4rs_8.htm#IDX542" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">map</font></a> <a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> lst-of-lst))
                    (cdrs (<a href="../../../../r4rs/r4rs_8.htm#IDX542" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">map</font></a> <a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> lst-of-lst)))
                (<a href="../../../../r4rs/r4rs_8.htm#IDX245" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cons</font></a> cars (<a href="general.html#multi-pair" title="general" style="{text-decoration: none;}"><font color="#000080">multi-pair</font></a> cdrs))))))

<a name="sublist-by-predicate"></a><span class = "comment"  >;;Return a list of sublists of elements from lst controlled by an element predicate p.
;; The sublists are formed consequtively by taking elements from lst.  The predicate p decides
;; when to start a new sublist. Thus, when p evaluates to true, we start
;; a new sublist. The predicate p takes as parameters the current
;; elements, the previous element, and the number of elements before the
;; current one, p is not activated on (car lst). 
;; This function generalizes sublist-by-rows.
;; p: (cur prev n) -&gt; boolean</span>
<a name="sublist-by-predicate"></a><span> <span><a href="cross-reference-index-s.html#sublist-by-predicate" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from sublist-by-predicate to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> <a href="documentation.html#sublist-by-predicate" target="documentation-frame"><img src="./images/doc-left.gif" alt="2.2. A more general function" border="0"/></a></span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(sublist-by-predicate lst p)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> lst) '()) <span class = "comment"  >;<span><a name="sublist-by-predicate-@a"></a> <a href="documentation.html#sublist-by-predicate-@a" target="documentation-frame"><img src="./images/source-mark-red.gif" alt="A linked program source marker to section 2.2:
&#39;A more general function&#39;
Mark char: a" border="0"/></a></span></span>
        ((<a href="../../../../r4rs/r4rs_8.htm#IDX351" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">=</font></a> 1 (<a href="../../../../r4rs/r4rs_8.htm#IDX266" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">length</font></a> lst)) (<a href="../../../../r4rs/r4rs_8.htm#IDX265" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">list</font></a> lst))  <span class = "comment"  >;<span><a name="sublist-by-predicate-@b"></a> <a href="documentation.html#sublist-by-predicate-@b" target="documentation-frame"><img src="./images/source-mark-green.gif" alt="A linked program source marker to section 2.2:
&#39;A more general function&#39;
Mark char: b" border="0"/></a></span>special case: sublist the only element.</span>
        (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> (<a href="general.html#sublist-by-predicate-1" title="general" style="{text-decoration: none;}"><font color="#000080">sublist-by-predicate-1</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> lst) (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> lst) p 1 (<a href="../../../../r4rs/r4rs_8.htm#IDX265" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">list</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> lst)) '()))))


<a name="sublist-by-predicate-1"></a><span> <span><a href="cross-reference-index-s.html#sublist-by-predicate-1" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from sublist-by-predicate-1 to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> <a href="documentation.html#sublist-by-predicate" target="documentation-frame"><img src="./images/doc-left.gif" alt="2.2. A more general function" border="0"/></a></span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(sublist-by-predicate-1 lst previous-el p n res result)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_6.htm#IDX95" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>and</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> lst) (<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> res)) (reverse result)) <span class = "comment"  >;<span><a name="sublist-by-predicate-1-@d"></a> <a href="documentation.html#sublist-by-predicate-@d" target="documentation-frame"><img src="./images/source-mark-black.gif" alt="A linked program source marker to section 2.2:
&#39;A more general function&#39;
Mark char: d" border="0"/></a></span></span>
        ((<a href="../../../../r4rs/r4rs_6.htm#IDX95" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>and</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> lst) (<a href="../../../../r4rs/r4rs_8.htm#IDX177" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">not</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> res))) (reverse (<a href="../../../../r4rs/r4rs_8.htm#IDX245" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cons</font></a> (reverse res) result))) <span class = "comment"  >;<span><a name="sublist-by-predicate-1-@e"></a> <a href="documentation.html#sublist-by-predicate-@e" target="documentation-frame"><img src="./images/source-mark-maroon.gif" alt="A linked program source marker to section 2.2:
&#39;A more general function&#39;
Mark char: e" border="0"/></a></span></span>
        ((p (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> lst) previous-el n)   (<a href="general.html#sublist-by-predicate-1" title="general" style="{text-decoration: none;}"><font color="#000080">sublist-by-predicate-1</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> lst) (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> lst) p (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> n 1) (<a href="../../../../r4rs/r4rs_8.htm#IDX265" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">list</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> lst)) (<a href="../../../../r4rs/r4rs_8.htm#IDX245" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cons</font></a> (reverse res) result))) <span class = "comment"  >;<span><a name="sublist-by-predicate-1-@f"></a> <a href="documentation.html#sublist-by-predicate-@f" target="documentation-frame"><img src="./images/source-mark-grey.gif" alt="A linked program source marker to section 2.2:
&#39;A more general function&#39;
Mark char: f" border="0"/></a></span></span>
        (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a>                          (<a href="general.html#sublist-by-predicate-1" title="general" style="{text-decoration: none;}"><font color="#000080">sublist-by-predicate-1</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> lst) (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> lst) p (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> n 1) (<a href="../../../../r4rs/r4rs_8.htm#IDX245" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cons</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> lst) res) result)))) <span class = "comment"  >;<span><a name="sublist-by-predicate-1-@g"></a> <a href="documentation.html#sublist-by-predicate-@g" target="documentation-frame"><img src="./images/source-mark-purple.gif" alt="A linked program source marker to section 2.2:
&#39;A more general function&#39;
Mark char: g" border="0"/></a></span></span>
<a name="remove-duplicates-by-predicate"></a><span class = "comment"  >;;Remove duplicates from lst.
;; A pair of duplicates satisfy the predicate p: (p element element) -&gt; boolean.
;; In case of duplicates, keep the first one in the result.</span>
<a name="remove-duplicates-by-predicate"></a><span> <span><a href="cross-reference-index-r.html#remove-duplicates-by-predicate" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from remove-duplicates-by-predicate to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(remove-duplicates-by-predicate lst p)</font></b>
 (<a href="general.html#remove-duplicates-by-predicate-1" title="general" style="{text-decoration: none;}"><font color="#000080">remove-duplicates-by-predicate-1</font></a> lst p '()))

<a name="remove-duplicates-by-predicate-1"></a><span> <span><a href="cross-reference-index-r.html#remove-duplicates-by-predicate-1" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from remove-duplicates-by-predicate-1 to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(remove-duplicates-by-predicate-1 lst p res)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> lst) (reverse res))
        ((<a href="general.html#member-by-predicate" title="general" style="{text-decoration: none;}"><font color="#000080">member-by-predicate</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> lst) res p) (<a href="general.html#remove-duplicates-by-predicate-1" title="general" style="{text-decoration: none;}"><font color="#000080">remove-duplicates-by-predicate-1</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> lst) p res))
        (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> (<a href="general.html#remove-duplicates-by-predicate-1" title="general" style="{text-decoration: none;}"><font color="#000080">remove-duplicates-by-predicate-1</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> lst) p (<a href="../../../../r4rs/r4rs_8.htm#IDX245" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cons</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> lst) res)))))

<a name="duplicates-by-predicate"></a><span class = "comment"  >;;Return the duplicates in lst. 
;; The duplicates are returned in the order of their fist occurence in lst.
;; Comparison of elements is done by the predicate (p element element) -&gt; boolean.</span>
<a name="duplicates-by-predicate"></a><span> <span><a href="cross-reference-index-d.html#duplicates-by-predicate" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from duplicates-by-predicate to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(duplicates-by-predicate lst p)</font></b>
  (<a href="general.html#duplicates-by-predicate-1" title="general" style="{text-decoration: none;}"><font color="#000080">duplicates-by-predicate-1</font></a> lst p '()))

<a name="duplicates-by-predicate-1"></a><span> <span><a href="cross-reference-index-d.html#duplicates-by-predicate-1" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from duplicates-by-predicate-1 to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(duplicates-by-predicate-1 lst p res)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> lst) (reverse res))
        ((<a href="general.html#member-by-predicate" title="general" style="{text-decoration: none;}"><font color="#000080">member-by-predicate</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> lst) (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> lst) p)
            (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> (<a href="general.html#member-by-predicate" title="general" style="{text-decoration: none;}"><font color="#000080">member-by-predicate</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> lst) res p)        <span class = "comment"  >;always detected as duplicate once</span>
                (<a href="general.html#duplicates-by-predicate-1" title="general" style="{text-decoration: none;}"><font color="#000080">duplicates-by-predicate-1</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> lst) p res)
                (<a href="general.html#duplicates-by-predicate-1" title="general" style="{text-decoration: none;}"><font color="#000080">duplicates-by-predicate-1</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> lst) p (<a href="../../../../r4rs/r4rs_8.htm#IDX245" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cons</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> lst) res))))
        (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> (<a href="general.html#duplicates-by-predicate-1" title="general" style="{text-decoration: none;}"><font color="#000080">duplicates-by-predicate-1</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> lst) p res))))  

<a name="member-by-predicate"></a><span class = "comment"  >;;Is el member of lst by means of the predicate p.
;; el is always passed as the first parameter to p.
;; If el is member, return the suffix of the list in which the first element (and el) satisfy the predicate.
;; Else return #f.
;; The element el and elements of lst are compared by p, el as the first one.
;; p: (el1, el2) -&gt; boolean</span>
<a name="member-by-predicate"></a><span> <span><a href="cross-reference-index-m.html#member-by-predicate" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from member-by-predicate to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(member-by-predicate el lst p)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> lst) #f)
        ((p el (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> lst)) lst)
        (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> (<a href="general.html#member-by-predicate" title="general" style="{text-decoration: none;}"><font color="#000080">member-by-predicate</font></a> el (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> lst) p))))

<a name="list-intersection-by-predicate"></a><span class = "comment"  >;;Return the elements of lst1 an lst2 which belongs to both of the lists.
;; Elements will never occur more than once in the result.
;; Element comparsion is done by pred.
;; Performance: O (length lst1) x (length lst2).
;; .parameter pred: Element x Element -&gt; Boolean.
;; .example (list-intersection '(a b c d a) '(a d) eq?) = (a d)</span>
<a name="list-intersection-by-predicate"></a><span> <span><a href="cross-reference-index-l.html#list-intersection-by-predicate" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from list-intersection-by-predicate to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(list-intersection-by-predicate lst1 lst2 pred)</font></b>
 (<a href="general.html#list-intersection-1" title="general" style="{text-decoration: none;}"><font color="#000080">list-intersection-1</font></a> lst1 lst2 pred '()))

<a name="list-intersection-1"></a><span> <span><a href="cross-reference-index-l.html#list-intersection-1" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from list-intersection-1 to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(list-intersection-1 lst1 lst2 pred res)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> lst1) (<a href="general.html#remove-duplicates-by-predicate" title="general" style="{text-decoration: none;}"><font color="#000080">remove-duplicates-by-predicate</font></a> (reverse res) pred))
        (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> (<a href="../../../../r4rs/r4rs_6.htm#IDX107" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let*</b></a> ((el (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> lst1))
                     (el-member-lst2 (<a href="general.html#member-by-predicate" title="general" style="{text-decoration: none;}"><font color="#000080">member-by-predicate</font></a> el lst2 pred)))
                (<a href="general.html#list-intersection-1" title="general" style="{text-decoration: none;}"><font color="#000080">list-intersection-1</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> lst1) lst2 pred (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> el-member-lst2 (<a href="../../../../r4rs/r4rs_8.htm#IDX245" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cons</font></a> el res) res))))))
  

<a name="cut-list-by-predicate"></a><span class = "comment"  >;;Cut the tail of lst; The tail to be cutted starts with an element which fulfils pred.
;; Notice that the first element which fulfils the predicate is not included in the resulting list.</span>
<a name="cut-list-by-predicate"></a><span> <span><a href="cross-reference-index-c.html#cut-list-by-predicate" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from cut-list-by-predicate to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(cut-list-by-predicate lst pred)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> lst) '())
        ((pred (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> lst)) '())
        (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX245" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cons</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> lst) (<a href="general.html#cut-list-by-predicate" title="general" style="{text-decoration: none;}"><font color="#000080">cut-list-by-predicate</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> lst) pred)))))


<a name="subset-of-by-predicate"></a><span class = "comment"  >;;Return whether every element in set-list-1 (a list) is a member of set-list-2, compared by the comparator comp.
;; This corresponds to a subset operations on sets, represented by a list.
;; comp: el x el -&gt; boolean.</span>
<a name="subset-of-by-predicate"></a><span> <span><a href="cross-reference-index-s.html#subset-of-by-predicate" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from subset-of-by-predicate to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(subset-of-by-predicate set-list-1 set-list-2 comp)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> set-list-1) #t)
        ((<a href="general.html#member-by-predicate" title="general" style="{text-decoration: none;}"><font color="#000080">member-by-predicate</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> set-list-1) set-list-2 comp) (<a href="general.html#subset-of-by-predicate" title="general" style="{text-decoration: none;}"><font color="#000080">subset-of-by-predicate</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> set-list-1) set-list-2 comp))
        (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> #f)))

<a name="index-in-list-by-predicate"></a><span class = "comment"  >;;Return the index of the first occurrence of el in lst. 
;; Return #f is el is not found in lst.
;; Comparison is done by comparator.
;; The index of the first element is 0.</span>
<a name="index-in-list-by-predicate"></a><span> <span><a href="cross-reference-index-i.html#index-in-list-by-predicate" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from index-in-list-by-predicate to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(index-in-list-by-predicate lst el comparator)</font></b>
  (<a href="general.html#index-in-list-by-predicate-1" title="general" style="{text-decoration: none;}"><font color="#000080">index-in-list-by-predicate-1</font></a> lst el comparator 0))

<a name="index-in-list-by-predicate-1"></a><span> <span><a href="cross-reference-index-i.html#index-in-list-by-predicate-1" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from index-in-list-by-predicate-1 to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(index-in-list-by-predicate-1 lst el comparator i)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> lst) #f)
        ((comparator el (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> lst)) i)
        (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> (<a href="general.html#index-in-list-by-predicate-1" title="general" style="{text-decoration: none;}"><font color="#000080">index-in-list-by-predicate-1</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> lst) el comparator (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> i 1)))))




<a name="sublistify"></a><span class = "comment"  >;;Divide the elements of lst into sublists of sublist-length.
;; In case that sublist-length does not divide (length lst) the last
;; sublist will be shorter than the others.
;; .example (sublistify '(1 2 3 4 5 6 7 8 9) 4) = ((1 2 3 4) (5 6 7 8) (9))</span>
<a name="sublistify"></a><span> <span><a href="cross-reference-index-s.html#sublistify" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from sublistify to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(sublistify lst sublist-length)</font></b>
 (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX354" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&lt;=</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX266" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">length</font></a> lst) sublist-length)
     (<a href="../../../../r4rs/r4rs_8.htm#IDX265" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">list</font></a> lst)
     (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((first-sublist (<a href="general.html#list-prefix" title="general" style="{text-decoration: none;}"><font color="#000080">list-prefix</font></a> lst sublist-length))
           (rest-lst (<a href="../../../../r4rs/r4rs_8.htm#IDX269" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">list-tail</font></a> lst sublist-length)))
       (<a href="../../../../r4rs/r4rs_8.htm#IDX245" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cons</font></a> first-sublist
             (<a href="general.html#sublistify" title="general" style="{text-decoration: none;}"><font color="#000080">sublistify</font></a> rest-lst sublist-length)))))

<a name="front-sublist"></a><span class = "comment"  >;;Return the first n elements of lst.
;; This function makes a shallow copy of the first n elements of lst. Thus, it allocates n new cons cells.
;; If n is equal or greater than the length of lst, lst is returned without any copying at all.</span>
<a name="front-sublist"></a><span> <span><a href="cross-reference-index-f.html#front-sublist" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from front-sublist to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(front-sublist lst n)</font></b>
 (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX355" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&gt;=</font></a> n (<a href="../../../../r4rs/r4rs_8.htm#IDX266" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">length</font></a> lst)) lst (<a href="general.html#front-sublist-1" title="general" style="{text-decoration: none;}"><font color="#000080">front-sublist-1</font></a> lst n)))

<a name="front-sublist-1"></a><span class = "comment"  >;A helping operation to front-sublist</span>
<a name="front-sublist-1"></a><span> <span><a href="cross-reference-index-f.html#front-sublist-1" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from front-sublist-1 to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(front-sublist-1 lst n)</font></b>
 (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_8.htm#IDX351" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">=</font></a> n 0) '())
       ((<a href="../../../../r4rs/r4rs_6.htm#IDX95" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>and</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX353" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&gt;</font></a> n 0) (<a href="../../../../r4rs/r4rs_8.htm#IDX177" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">not</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> lst))) (<a href="../../../../r4rs/r4rs_8.htm#IDX245" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cons</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> lst) (<a href="general.html#front-sublist-1" title="general" style="{text-decoration: none;}"><font color="#000080">front-sublist-1</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> lst) (<a href="../../../../r4rs/r4rs_8.htm#IDX369" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">-</font></a> n 1))))
       ((<a href="../../../../r4rs/r4rs_6.htm#IDX95" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>and</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX353" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&gt;</font></a> n 0) (<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> lst)) '())
       (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> (<a href="general.html#laml-error" title="general" style="{text-decoration: none;}"><font color="#000080">laml-error</font></a> "front-sublist-1: Should not happen" lst n))))


<a name="rear-sublist"></a><span class = "comment"  >;;Return the last n elements of lst. 
;; This function returns a reference to an appropriate tail of lst, involving only the last n elements.
;; If n is equal to or larger than (length lst), just return lst.</span>
<a name="rear-sublist"></a><span> <span><a href="cross-reference-index-r.html#rear-sublist" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from rear-sublist to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(rear-sublist lst n)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((lst-lgt (<a href="../../../../r4rs/r4rs_8.htm#IDX266" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">length</font></a> lst)))
    (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX355" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&gt;=</font></a> n lst-lgt)
        lst
        (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((prefix-lgt (<a href="../../../../r4rs/r4rs_8.htm#IDX369" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">-</font></a> lst-lgt n)))
          (<a href="../../../../r4rs/r4rs_8.htm#IDX269" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">list-tail</font></a> lst prefix-lgt)))))


<a name="list-prefix"></a><span class = "comment"  >;;Return the list of the first n elements of lst.
;; If n &gt; (length lst) just return lst. </span>
<a name="list-prefix"></a><span> <span><a href="cross-reference-index-l.html#list-prefix" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from list-prefix to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(list-prefix lst n)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX352" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&lt;</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX266" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">length</font></a> lst) n)
      lst
      (<a href="general.html#list-prefix-1" title="general" style="{text-decoration: none;}"><font color="#000080">list-prefix-1</font></a> lst n)))

<a name="list-prefix-1"></a><span> <span><a href="cross-reference-index-l.html#list-prefix-1" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from list-prefix-1 to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(list-prefix-1 lst n)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX351" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">=</font></a> n 0)
      '()
      (<a href="../../../../r4rs/r4rs_8.htm#IDX245" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cons</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> lst) (<a href="general.html#list-prefix-1" title="general" style="{text-decoration: none;}"><font color="#000080">list-prefix-1</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> lst) (<a href="../../../../r4rs/r4rs_8.htm#IDX369" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">-</font></a> n 1)))))


<a name="list-part"></a><span class = "comment"  >;;Return the sublist consisting of element a to element b of the list lst.
;; Both element number a and b are included in the resulting list. The first element counts as element number 1.
;; .example (list-part 3 5 '(a b c d e f g h)) = (c d e)
;; .pre-condition a &gt;= 1, a &lt;= b, b &lt;= (length lst), and a and b are postive integers.</span>
<a name="list-part"></a><span> <span><a href="cross-reference-index-l.html#list-part" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from list-part to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(list-part a b lst)</font></b>
  (<a href="general.html#list-part-help" title="general" style="{text-decoration: none;}"><font color="#000080">list-part-help</font></a> a b lst 1 (<a href="../../../../r4rs/r4rs_8.htm#IDX266" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">length</font></a> lst) '()))

<a name="list-part-help"></a><span> <span><a href="cross-reference-index-l.html#list-part-help" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from list-part-help to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(list-part-help a b lst  i lgt res)</font></b>
 (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_8.htm#IDX353" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&gt;</font></a> i b) (reverse res))
       ((<a href="../../../../r4rs/r4rs_6.htm#IDX95" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>and</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX355" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&gt;=</font></a> i a) (<a href="../../../../r4rs/r4rs_8.htm#IDX354" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&lt;=</font></a> i b) (<a href="../../../../r4rs/r4rs_8.htm#IDX177" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">not</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> lst))) (<a href="general.html#list-part-help" title="general" style="{text-decoration: none;}"><font color="#000080">list-part-help</font></a> a b (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> lst) (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> i 1) lgt (<a href="../../../../r4rs/r4rs_8.htm#IDX245" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cons</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> lst) res)))
       ((<a href="../../../../r4rs/r4rs_6.htm#IDX95" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>and</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX354" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&lt;=</font></a> i a) (<a href="../../../../r4rs/r4rs_8.htm#IDX177" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">not</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> lst)))  (<a href="general.html#list-part-help" title="general" style="{text-decoration: none;}"><font color="#000080">list-part-help</font></a> a b (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> lst) (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> i 1) lgt res))
       ((<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> lst) (error (<a href="../../../../r4rs/r4rs_8.htm#IDX510" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-append</font></a> "list-part error: " (<a href="general.html#as-string" title="general" style="{text-decoration: none;}"><font color="#000080">as-string</font></a> i))))))


<span class = "comment"  >;;;Vector functions.</span>
<a name="binary-search-in-vector"></a><span class = "comment"  >;;Search for an element el in the sorted vector v.
;; More specifically, el is compared to (sel ve), where ve is a element from the vector v.
;; Comparison is done by the binary predicate el-eq? which works on selected values.
;; Thus (el-eq? (sel x) el) makes sense for an element x in the vector.
;; Ordering in the vector is defined by the binary 'less-than-equal predicate' el-leq?
;; which compares selected values. Thus (el-leq (sel x) (sel y)) makes sense for x and y
;; being elements in the vector v.
;; .parameter v The vector to search in.
;; .parameter el The element to search for in the vector. el is comparabel with (sel ve) for a given vector element.
;; .parameter sel A function that can be applied on vector elements. 
;; .parameter el-eq? An equality function that can be applied on el and on (sel ve) for a given vector element.
;; .parameter el-leq? A less than or equal function that can be applied on el and vector elements (sel ve).
;; .returns An element in the vector, if found as described above, or #f.</span>
<a name="binary-search-in-vector"></a><span> <span><a href="cross-reference-index-b.html#binary-search-in-vector" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from binary-search-in-vector to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(binary-search-in-vector v el sel el-eq? el-leq?)</font></b>
 (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((lgt (<a href="../../../../r4rs/r4rs_8.htm#IDX526" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">vector-length</font></a> v)))
  (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX351" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">=</font></a> 0 (<a href="../../../../r4rs/r4rs_8.htm#IDX526" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">vector-length</font></a> v))
      #f
      (<a href="../../../../r4rs/r4rs_6.htm#IDX120" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>do</b></a> ((up-idx   (<a href="../../../../r4rs/r4rs_8.htm#IDX369" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">-</font></a> lgt 1))
	   (low-idx  0)
	   )
	  ((<a href="../../../../r4rs/r4rs_6.htm#IDX96" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>or</b></a> (el-eq? el (sel (<a href="../../../../r4rs/r4rs_8.htm#IDX527" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">vector-ref</font></a> v (<a href="../../../../r4rs/r4rs_8.htm#IDX378" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">quotient</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> up-idx low-idx) 2))))	<span class = "comment"  >;hit</span>
	       (<a href="../../../../r4rs/r4rs_8.htm#IDX351" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">=</font></a> up-idx low-idx) (<a href="../../../../r4rs/r4rs_8.htm#IDX351" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">=</font></a> up-idx (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> 1 low-idx)) <span class = "comment"  >;narrow interval</span>
	       )
	   (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((el-eq? el (sel (<a href="../../../../r4rs/r4rs_8.htm#IDX527" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">vector-ref</font></a> v (<a href="../../../../r4rs/r4rs_8.htm#IDX378" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">quotient</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> up-idx low-idx) 2)))) <span class = "comment"  >;mid</span>
		  (<a href="../../../../r4rs/r4rs_8.htm#IDX527" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">vector-ref</font></a> v (<a href="../../../../r4rs/r4rs_8.htm#IDX378" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">quotient</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> up-idx low-idx) 2)))
		 ((el-eq? el (sel (<a href="../../../../r4rs/r4rs_8.htm#IDX527" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">vector-ref</font></a> v low-idx))) <span class = "comment"  >;low</span>
		  (<a href="../../../../r4rs/r4rs_8.htm#IDX527" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">vector-ref</font></a> v low-idx))
		 ((el-eq? el (sel (<a href="../../../../r4rs/r4rs_8.htm#IDX527" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">vector-ref</font></a> v up-idx))) <span class = "comment"  >;up</span>
		  (<a href="../../../../r4rs/r4rs_8.htm#IDX527" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">vector-ref</font></a> v up-idx))
		 (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> #f)))
	(<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((el-leq? el (sel (<a href="../../../../r4rs/r4rs_8.htm#IDX527" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">vector-ref</font></a> v (<a href="../../../../r4rs/r4rs_8.htm#IDX378" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">quotient</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> up-idx low-idx) 2))))
               (<a href="../../../../r4rs/r4rs_6.htm#SEC32" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>set!</b></a> up-idx (<a href="../../../../r4rs/r4rs_8.htm#IDX378" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">quotient</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> up-idx low-idx) 2)))
	      (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> 
               (<a href="../../../../r4rs/r4rs_6.htm#SEC32" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>set!</b></a> low-idx (<a href="../../../../r4rs/r4rs_8.htm#IDX378" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">quotient</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> up-idx low-idx) 2))))))))


<span class = "comment"  >;;;Conversion functions. 
;;; In this category we provide a number of useful conversion functions. Several of these are of the form (as-type xxx),
;;; where type determines the target type of the conversion.&lt;p&gt;
;;; This section includes a function number-in-base which converts a decimal number to a number in another number system.</span>
<a name="char-&gt;string"></a><span class = "comment"  >;;Convert a character to a string</span>
<a name="char-&gt;string"></a><span> <span><a href="cross-reference-index-c.html#char-&gt;string" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from char-&gt;string to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(char-&gt;string ch)</font></b>
  (<a href="../../../../r4rs/r4rs_8.htm#IDX483" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">make-string</font></a> 1 ch))


<a name="as-string"></a><span class = "comment"  >;;Convert x to a string.
;; Conversion of numbers, symbols, strings, booleans, characters, vectors, proper lists and improper lists are supported.</span>
<a name="as-string"></a><span> <span><a href="cross-reference-index-a.html#as-string" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from as-string to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(as-string x)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_8.htm#IDX340" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">number?</font></a> x) (<a href="../../../../r4rs/r4rs_8.htm#IDX439" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">number-&gt;string</font></a> x))
        ((<a href="../../../../r4rs/r4rs_8.htm#IDX302" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">symbol?</font></a> x) (symbol->string x))
        ((<a href="../../../../r4rs/r4rs_8.htm#IDX482" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string?</font></a> x) x)
        ((<a href="../../../../r4rs/r4rs_8.htm#IDX179" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">boolean?</font></a> x) 
            (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> x "true" "false"))   <span class = "comment"  >;consider "#t" and "#f" as alternatives</span>
        ((<a href="../../../../r4rs/r4rs_8.htm#IDX452" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">char?</font></a> x) (<a href="general.html#char-&gt;string" title="general" style="{text-decoration: none;}"><font color="#000080">char-&gt;string</font></a> x))
        ((<a href="../../../../r4rs/r4rs_8.htm#IDX264" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">list?</font></a> x)
            (<a href="../../../../r4rs/r4rs_8.htm#IDX510" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-append</font></a> "(" 
               (<a href="general.html#string-merge" title="general" style="{text-decoration: none;}"><font color="#000080">string-merge</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX542" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">map</font></a> <a href="general.html#as-string" title="general" style="{text-decoration: none;}"><font color="#000080">as-string</font></a> x) (<a href="general.html#make-list" title="general" style="{text-decoration: none;}"><font color="#000080">make-list</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX369" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">-</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX266" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">length</font></a> x) 1) " "))
               ")"))
        ((<a href="../../../../r4rs/r4rs_8.htm#IDX521" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">vector?</font></a> x)
          (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((lst (<a href="../../../../r4rs/r4rs_8.htm#IDX532" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">vector-&gt;list</font></a> x)))
            (<a href="../../../../r4rs/r4rs_8.htm#IDX510" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-append</font></a> "#(" 
               (<a href="general.html#string-merge" title="general" style="{text-decoration: none;}"><font color="#000080">string-merge</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX542" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">map</font></a> <a href="general.html#as-string" title="general" style="{text-decoration: none;}"><font color="#000080">as-string</font></a> lst) (<a href="general.html#make-list" title="general" style="{text-decoration: none;}"><font color="#000080">make-list</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX369" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">-</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX266" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">length</font></a> lst) 1) " "))
               ")")))
        ((<a href="../../../../r4rs/r4rs_8.htm#IDX243" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">pair?</font></a> x)
            (<a href="../../../../r4rs/r4rs_8.htm#IDX510" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-append</font></a> "(" 
               (<a href="../../../../r4rs/r4rs_8.htm#IDX540" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">apply</font></a> <a href="../../../../r4rs/r4rs_8.htm#IDX510" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-append</font></a>
                  (<a href="../../../../r4rs/r4rs_8.htm#IDX542" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">map</font></a> (<a href="../../../../r4rs/r4rs_6.htm#SEC30" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>lambda</b></a> (y) (<a href="../../../../r4rs/r4rs_8.htm#IDX510" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-append</font></a> (<a href="general.html#as-string" title="general" style="{text-decoration: none;}"><font color="#000080">as-string</font></a> y) " ")) (<a href="general.html#proper-part" title="general" style="{text-decoration: none;}"><font color="#000080">proper-part</font></a> x))
               )
               " . " (<a href="general.html#as-string" title="general" style="{text-decoration: none;}"><font color="#000080">as-string</font></a> (<a href="general.html#first-improper-part" title="general" style="{text-decoration: none;}"><font color="#000080">first-improper-part</font></a> x))
               ")"))
        (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> "??")))

<a name="as-quoted-string"></a><span class = "comment"  >;;Convert x to a string, in which string constituents themselves are quoted.
;; Good for output and messages, in which strings should appear in string quotes.</span>
<a name="as-quoted-string"></a><span> <span><a href="cross-reference-index-a.html#as-quoted-string" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from as-quoted-string to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(as-quoted-string x)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_8.htm#IDX340" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">number?</font></a> x) (<a href="../../../../r4rs/r4rs_8.htm#IDX439" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">number-&gt;string</font></a> x))
        ((<a href="../../../../r4rs/r4rs_8.htm#IDX302" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">symbol?</font></a> x) (symbol->string x))
        ((<a href="../../../../r4rs/r4rs_8.htm#IDX482" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string?</font></a> x) (<a href="general.html#string-it" title="general" style="{text-decoration: none;}"><font color="#000080">string-it</font></a> x))
        ((<a href="../../../../r4rs/r4rs_8.htm#IDX179" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">boolean?</font></a> x) 
            (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> x "true" "false"))   <span class = "comment"  >;consider "#t" and "#f" as alternatives</span>
        ((<a href="../../../../r4rs/r4rs_8.htm#IDX452" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">char?</font></a> x) (<a href="general.html#char-&gt;string" title="general" style="{text-decoration: none;}"><font color="#000080">char-&gt;string</font></a> x))
        ((<a href="../../../../r4rs/r4rs_8.htm#IDX264" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">list?</font></a> x)
            (<a href="../../../../r4rs/r4rs_8.htm#IDX510" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-append</font></a> "(" 
               (<a href="general.html#string-merge" title="general" style="{text-decoration: none;}"><font color="#000080">string-merge</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX542" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">map</font></a> <a href="general.html#as-quoted-string" title="general" style="{text-decoration: none;}"><font color="#000080">as-quoted-string</font></a> x) (<a href="general.html#make-list" title="general" style="{text-decoration: none;}"><font color="#000080">make-list</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX369" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">-</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX266" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">length</font></a> x) 1) " "))
               ")"))
        ((<a href="../../../../r4rs/r4rs_8.htm#IDX243" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">pair?</font></a> x)
            (<a href="../../../../r4rs/r4rs_8.htm#IDX510" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-append</font></a> "(" 
               (<a href="../../../../r4rs/r4rs_8.htm#IDX540" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">apply</font></a> <a href="../../../../r4rs/r4rs_8.htm#IDX510" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-append</font></a>
                  (<a href="../../../../r4rs/r4rs_8.htm#IDX542" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">map</font></a> (<a href="../../../../r4rs/r4rs_6.htm#SEC30" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>lambda</b></a> (y) (<a href="../../../../r4rs/r4rs_8.htm#IDX510" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-append</font></a> (<a href="general.html#as-quoted-string" title="general" style="{text-decoration: none;}"><font color="#000080">as-quoted-string</font></a> y) " ")) (<a href="general.html#proper-part" title="general" style="{text-decoration: none;}"><font color="#000080">proper-part</font></a> x))
               )
               " . " (<a href="general.html#as-quoted-string" title="general" style="{text-decoration: none;}"><font color="#000080">as-quoted-string</font></a> (<a href="general.html#first-improper-part" title="general" style="{text-decoration: none;}"><font color="#000080">first-improper-part</font></a> x))
               ")"))
        (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> "??")))

<a name="as-symbol"></a><span class = "comment"  >;;Convert x to a symbol. String, symbols, booleans, and characters are supported</span>
<a name="as-symbol"></a><span> <span><a href="cross-reference-index-a.html#as-symbol" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from as-symbol to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(as-symbol x)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_8.htm#IDX302" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">symbol?</font></a> x) x)
        ((<a href="../../../../r4rs/r4rs_8.htm#IDX482" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string?</font></a> x) (<a href="../../../../r4rs/r4rs_8.htm#IDX308" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-&gt;symbol</font></a> x))
        ((<a href="../../../../r4rs/r4rs_8.htm#IDX179" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">boolean?</font></a> x) 
            (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> x (<a href="general.html#as-symbol" title="general" style="{text-decoration: none;}"><font color="#000080">as-symbol</font></a> "true") (<a href="general.html#as-symbol" title="general" style="{text-decoration: none;}"><font color="#000080">as-symbol</font></a> "false")))
        ((<a href="../../../../r4rs/r4rs_8.htm#IDX452" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">char?</font></a> x) (<a href="general.html#as-symbol" title="general" style="{text-decoration: none;}"><font color="#000080">as-symbol</font></a> (<a href="general.html#char-&gt;string" title="general" style="{text-decoration: none;}"><font color="#000080">char-&gt;string</font></a> x)))
        (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> #f)))

<a name="as-number"></a><span class = "comment"  >;;Convert x to a number. Strings, numbers, chars and booleans are supported.
;; Strings with digits are converted using string-&gt;number, chars are converted with char-&gt;integer, true is converted to 1, and false to 0.</span>
<a name="as-number"></a><span> <span><a href="cross-reference-index-a.html#as-number" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from as-number to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(as-number x)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_8.htm#IDX482" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string?</font></a> x) (<a href="../../../../r4rs/r4rs_8.htm#IDX443" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-&gt;number</font></a> x))
        ((<a href="../../../../r4rs/r4rs_8.htm#IDX340" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">number?</font></a> x) x)
        ((<a href="../../../../r4rs/r4rs_8.htm#IDX452" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">char?</font></a> x) (<a href="../../../../r4rs/r4rs_8.htm#IDX469" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">char-&gt;integer</font></a> x))
        ((<a href="../../../../r4rs/r4rs_8.htm#IDX179" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">boolean?</font></a> x) (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> x 1 0))  <span class = "comment"  >;false -&gt; 0, true -&gt; 1</span>
        (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a>
         (error
          (<a href="../../../../r4rs/r4rs_8.htm#IDX510" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-append</font></a> "Cannot convert to number "
                         (<a href="general.html#as-string" title="general" style="{text-decoration: none;}"><font color="#000080">as-string</font></a> x))))))


<a name="as-char"></a><span class = "comment"  >;;Convert x to a character. Integers, strings, booleans and symbols are supported.
;; If x is an integer between 0 and 255 return ASCII char number x. If x is a string return the first character in the string (which is supposed to be non-empty).
;; If x is a boolean return the character #\t for true and #\f for false. If x is a symbol return the first character of the print name of the string. Else return #\?.</span>
<a name="as-char"></a><span> <span><a href="cross-reference-index-a.html#as-char" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from as-char to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(as-char x)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_8.htm#IDX452" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">char?</font></a> x) x)
        ((<a href="../../../../r4rs/r4rs_8.htm#IDX344" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">integer?</font></a> x) 
           (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> (<a href="../../../../r4rs/r4rs_6.htm#IDX95" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>and</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX355" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&gt;=</font></a> x 0) (<a href="../../../../r4rs/r4rs_8.htm#IDX354" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&lt;=</font></a> x 255)) 
               (<a href="../../../../r4rs/r4rs_8.htm#IDX470" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">integer-&gt;char</font></a> x)
               #\?))
        ((<a href="../../../../r4rs/r4rs_8.htm#IDX482" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string?</font></a> x) (<a href="../../../../r4rs/r4rs_8.htm#IDX488" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-ref</font></a> x 0))
        ((<a href="../../../../r4rs/r4rs_8.htm#IDX179" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">boolean?</font></a> x) (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> x #\t #\f))
        ((<a href="../../../../r4rs/r4rs_8.htm#IDX302" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">symbol?</font></a> x)  (<a href="general.html#as-char" title="general" style="{text-decoration: none;}"><font color="#000080">as-char</font></a> (<a href="general.html#as-string" title="general" style="{text-decoration: none;}"><font color="#000080">as-string</font></a> x)))
        (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> #\?)))

<a name="as-list"></a><span class = "comment"  >;;Convert x to a list. 
;; This function converts strings to a list of substring, which in the original string are separated by spaces, newlines, or tabs.
;; .internal-references "more general function" "string-to-list"
;; .example (as-list "xy z abc ") =&gt; ("xy" "z" "abc")</span>
<a name="as-list"></a><span> <span><a href="cross-reference-index-a.html#as-list" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from as-list to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(as-list x)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_8.htm#IDX482" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string?</font></a> x) (<a href="general.html#string-to-list" title="general" style="{text-decoration: none;}"><font color="#000080">string-to-list</font></a> x (<a href="../../../../r4rs/r4rs_8.htm#IDX265" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">list</font></a> #\space (<a href="general.html#as-char" title="general" style="{text-decoration: none;}"><font color="#000080">as-char</font></a> 13) (<a href="general.html#as-char" title="general" style="{text-decoration: none;}"><font color="#000080">as-char</font></a> 10) #\tab)))
        ((<a href="../../../../r4rs/r4rs_8.htm#IDX264" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">list?</font></a> x) x)
        ((<a href="../../../../r4rs/r4rs_8.htm#IDX243" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">pair?</font></a> x) x)
        (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX265" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">list</font></a> x))))

<a name="string-to-list"></a><span class = "comment"  >;;Convert a string to a list.
;; The second parameter is a list of separator characters.</span>
<a name="string-to-list"></a><span> <span><a href="cross-reference-index-s.html#string-to-list" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from string-to-list to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(string-to-list str element-separator-chars)</font></b>
 (<a href="general.html#filter" title="general" style="{text-decoration: none;}"><font color="#000080">filter</font></a> (<a href="general.html#negate" title="general" style="{text-decoration: none;}"><font color="#000080">negate</font></a> <a href="general.html#empty-string?" title="general" style="{text-decoration: none;}"><font color="#000080">empty-string?</font></a>)
  (<a href="general.html#string-to-list-help" title="general" style="{text-decoration: none;}"><font color="#000080">string-to-list-help</font></a> str "" '() element-separator-chars (<a href="../../../../r4rs/r4rs_8.htm#IDX487" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-length</font></a> str))))

<a name="string-to-list-help"></a><span> <span><a href="cross-reference-index-s.html#string-to-list-help" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from string-to-list-help to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(string-to-list-help str next-el res-list element-separator-chars str-lgt)</font></b>
 (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX351" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">=</font></a> 0 str-lgt)
     (reverse (<a href="../../../../r4rs/r4rs_8.htm#IDX245" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cons</font></a> next-el res-list))     <span class = "comment"  >;add last 'rest element: next-el</span>
     (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((next-char (<a href="../../../../r4rs/r4rs_8.htm#IDX488" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-ref</font></a> str 0))
	   (rest-string (<a href="../../../../r4rs/r4rs_8.htm#IDX508" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">substring</font></a> str 1 str-lgt)))
       (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> 
         ((<a href="../../../../r4rs/r4rs_8.htm#IDX273" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">memv</font></a> next-char element-separator-chars) (<a href="general.html#string-to-list-help" title="general" style="{text-decoration: none;}"><font color="#000080">string-to-list-help</font></a> rest-string "" (<a href="../../../../r4rs/r4rs_8.htm#IDX245" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cons</font></a> next-el res-list) element-separator-chars (<a href="../../../../r4rs/r4rs_8.htm#IDX369" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">-</font></a> str-lgt 1)))
         (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> (<a href="general.html#string-to-list-help" title="general" style="{text-decoration: none;}"><font color="#000080">string-to-list-help</font></a> rest-string (<a href="../../../../r4rs/r4rs_8.htm#IDX510" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-append</font></a> next-el (<a href="general.html#as-string" title="general" style="{text-decoration: none;}"><font color="#000080">as-string</font></a> next-char)) res-list element-separator-chars (<a href="../../../../r4rs/r4rs_8.htm#IDX369" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">-</font></a> str-lgt 1)))))))

<a name="as-boolean"></a><span class = "comment"  >;;Convert x to a boolean. The strings "false", "no", and "NO" are converted to #f. Other strings are converted to #t.</span>
<a name="as-boolean"></a><span> <span><a href="cross-reference-index-a.html#as-boolean" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from as-boolean to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(as-boolean x)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_8.htm#IDX482" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string?</font></a> x) (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> (<a href="../../../../r4rs/r4rs_6.htm#IDX96" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>or</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX220" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">equal?</font></a> x "false") (<a href="../../../../r4rs/r4rs_8.htm#IDX220" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">equal?</font></a> x "no") (<a href="../../../../r4rs/r4rs_8.htm#IDX220" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">equal?</font></a> x "NO")) #f #t))
        ((<a href="../../../../r4rs/r4rs_8.htm#IDX179" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">boolean?</font></a> x) x)
        (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> (error "Cannot convert to boolean"))))


<a name="list-to-string"></a><span class = "comment"  >;;Return a string with the elements of str-lst separated by separator.
;; .parameter str-list A list of strings
;; .parameter separator A string which is used to separate the list elements in the resulting string.</span>
<a name="list-to-string"></a><span> <span><a href="cross-reference-index-l.html#list-to-string" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from list-to-string to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(list-to-string str-lst separator)</font></b>
  (<a href="general.html#string-merge" title="general" style="{text-decoration: none;}"><font color="#000080">string-merge</font></a> 
     str-lst
     (<a href="general.html#make-list" title="general" style="{text-decoration: none;}"><font color="#000080">make-list</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX369" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">-</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX266" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">length</font></a> str-lst) 1) separator)))

<a name="turn-into-boolean"></a><span class = "comment"  >;;If x is considered true return #t else #f. 
;; See also as-boolean which is more versatile.
;; Recall that all values except #f, conveniently, act as a true value.</span>
<a name="turn-into-boolean"></a><span> <span><a href="cross-reference-index-t.html#turn-into-boolean" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from turn-into-boolean to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(turn-into-boolean x)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> x #t #f))


<a name="number-in-base"></a><span class = "comment"  >;;Return the decimal number n in base. 
;; .parameter n     A positive decimal integer.
;; .parameter base  The base of the number system. A possitive integer greater than 1.
;; .returns         A string which represents n in the number system with base.</span>
<a name="number-in-base"></a><span> <span><a href="cross-reference-index-n.html#number-in-base" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from number-in-base to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(number-in-base n base)</font></b>
 (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX351" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">=</font></a> n 0) "0"
  (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((ciffer-list (reverse (<a href="general.html#ciffers-in-base" title="general" style="{text-decoration: none;}"><font color="#000080">ciffers-in-base</font></a> n base))))
     (<a href="general.html#ciffer-output" title="general" style="{text-decoration: none;}"><font color="#000080">ciffer-output</font></a> ciffer-list))))

<a name="ciffers-in-base"></a><span> <span><a href="cross-reference-index-c.html#ciffers-in-base" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from ciffers-in-base to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(ciffers-in-base n base)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX351" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">=</font></a> n 0)
      '()
      (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((rem (<a href="../../../../r4rs/r4rs_8.htm#IDX380" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">modulo</font></a> n base))
            (newn (<a href="../../../../r4rs/r4rs_8.htm#IDX378" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">quotient</font></a> n base)))
        (<a href="../../../../r4rs/r4rs_8.htm#IDX245" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cons</font></a> rem (<a href="general.html#ciffers-in-base" title="general" style="{text-decoration: none;}"><font color="#000080">ciffers-in-base</font></a> newn base)))))

<a name="ciffer-output"></a><span> <span><a href="cross-reference-index-c.html#ciffer-output" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from ciffer-output to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(ciffer-output ciffer-list)</font></b>
 (<a href="../../../../r4rs/r4rs_8.htm#IDX540" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">apply</font></a> <a href="../../../../r4rs/r4rs_8.htm#IDX510" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-append</font></a>
    (<a href="../../../../r4rs/r4rs_8.htm#IDX542" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">map</font></a> <a href="general.html#ciffer-translation" title="general" style="{text-decoration: none;}"><font color="#000080">ciffer-translation</font></a> ciffer-list)))

<a name="ciffer-translation"></a><span> <span><a href="cross-reference-index-c.html#ciffer-translation" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from ciffer-translation to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(ciffer-translation c)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_8.htm#IDX354" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&lt;=</font></a> c 9) (<a href="../../../../r4rs/r4rs_8.htm#IDX439" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">number-&gt;string</font></a> c))
        ((<a href="../../../../r4rs/r4rs_6.htm#IDX95" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>and</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX353" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&gt;</font></a> c 9) (<a href="../../../../r4rs/r4rs_8.htm#IDX352" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&lt;</font></a> c 33)) (<a href="../../../../r4rs/r4rs_8.htm#IDX483" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">make-string</font></a> 1 (<a href="../../../../r4rs/r4rs_8.htm#IDX470" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">integer-&gt;char</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> c 87))))
        (t "?")))


<span class = "comment"  >;;;String predicates.</span>
<a name="empty-string?"></a><span class = "comment"  >;;Is the string str empty</span>
<a name="empty-string?"></a><span> <span><a href="cross-reference-index-e.html#empty-string?" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from empty-string? to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(empty-string? str)</font></b>
  (<a href="../../../../r4rs/r4rs_8.htm#IDX351" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">=</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX487" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-length</font></a> str) 0))

<a name="white-space-char-list"></a><span class = "comment"  >;;A list of characters considered as blank space characters</span>
<a name="white-space-char-list"></a><span> <span><a href="cross-reference-index-w.html#white-space-char-list" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from white-space-char-list to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >white-space-char-list</font></b> (<a href="../../../../r4rs/r4rs_8.htm#IDX265" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">list</font></a> #\space (<a href="general.html#as-char" title="general" style="{text-decoration: none;}"><font color="#000080">as-char</font></a> 13) (<a href="general.html#as-char" title="general" style="{text-decoration: none;}"><font color="#000080">as-char</font></a> 10) #\tab))

<a name="blank-string?"></a><span class = "comment"  >;;Is the string str empty or blank (consists of white space)</span>
<a name="blank-string?"></a><span> <span><a href="cross-reference-index-b.html#blank-string?" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from blank-string? to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(blank-string? str)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#IDX96" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>or</b></a> (<a href="general.html#empty-string?" title="general" style="{text-decoration: none;}"><font color="#000080">empty-string?</font></a> str) 
      (<a href="general.html#string-of-char-list?" title="general" style="{text-decoration: none;}"><font color="#000080">string-of-char-list?</font></a> str <a href="general.html#white-space-char-list" title="general" style="{text-decoration: none;}"><font color="#000080">white-space-char-list</font></a>)))

<a name="numeric-string?"></a><span class = "comment"  >;;Returns if the string str is numeric.
;; More specifically, does str consist exclusively of the ciffers 0 through 9.
;; A non-false value of the optional parameter signed? allows an initial '+' or '-' char as well.
;; .form (numeric-string? str [signed?])</span>
<a name="numeric-string?"></a><span> <span><a href="cross-reference-index-n.html#numeric-string?" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from numeric-string? to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(numeric-string? str . optional-parameters)</font></b>
 (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((signed? (optional-parameter 1 optional-parameters #f)))
   (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> signed?
       (<a href="../../../../r4rs/r4rs_6.htm#IDX95" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>and</b></a> (<a href="../../../../r4rs/r4rs_6.htm#IDX96" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>or</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX185" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">eqv?</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX488" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-ref</font></a> str 0) #\+) (<a href="../../../../r4rs/r4rs_8.htm#IDX185" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">eqv?</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX488" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-ref</font></a> str 0) #\-))
            (<a href="general.html#string-of-char-list?" title="general" style="{text-decoration: none;}"><font color="#000080">string-of-char-list?</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX508" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">substring</font></a> str 1 (<a href="../../../../r4rs/r4rs_8.htm#IDX487" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-length</font></a> str) ) (<a href="../../../../r4rs/r4rs_8.htm#IDX265" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">list</font></a> #\0 #\1 #\2 #\3 #\4 #\5 #\6 #\7 #\8 #\9 )))
       (<a href="general.html#string-of-char-list?" title="general" style="{text-decoration: none;}"><font color="#000080">string-of-char-list?</font></a> str (<a href="../../../../r4rs/r4rs_8.htm#IDX265" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">list</font></a> #\0 #\1 #\2 #\3 #\4 #\5 #\6 #\7 #\8 #\9 )))))

<a name="string-of-char-list?"></a><span class = "comment"  >;;Are all characters in str member of char-list (a list of characters).</span>
<a name="string-of-char-list?"></a><span> <span><a href="cross-reference-index-s.html#string-of-char-list?" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from string-of-char-list? to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(string-of-char-list? str char-list)</font></b>
  (<a href="general.html#string-of-char-list-1?" title="general" style="{text-decoration: none;}"><font color="#000080">string-of-char-list-1?</font></a> str char-list 0 (<a href="../../../../r4rs/r4rs_8.htm#IDX487" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-length</font></a> str)))

<a name="string-of-char-list-1?"></a><span> <span><a href="cross-reference-index-s.html#string-of-char-list-1?" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from string-of-char-list-1? to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(string-of-char-list-1? str char-list i lgt)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX351" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">=</font></a> i lgt)
      #t
      (<a href="../../../../r4rs/r4rs_6.htm#IDX95" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>and</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX273" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">memv</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX488" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-ref</font></a> str i) char-list)
           (<a href="general.html#string-of-char-list-1?" title="general" style="{text-decoration: none;}"><font color="#000080">string-of-char-list-1?</font></a> str char-list (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> i 1) lgt))))


<a name="string-of-negative-char-list?"></a><span class = "comment"  >;;Are all characters in str different from the characters in char list (a list of characters).</span>
<a name="string-of-negative-char-list?"></a><span> <span><a href="cross-reference-index-s.html#string-of-negative-char-list?" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from string-of-negative-char-list? to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(string-of-negative-char-list? str char-list)</font></b>
  (<a href="general.html#string-of-negative-char-list-1?" title="general" style="{text-decoration: none;}"><font color="#000080">string-of-negative-char-list-1?</font></a> str char-list 0 (<a href="../../../../r4rs/r4rs_8.htm#IDX487" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-length</font></a> str)))

<a name="string-of-negative-char-list-1?"></a><span> <span><a href="cross-reference-index-s.html#string-of-negative-char-list-1?" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from string-of-negative-char-list-1? to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(string-of-negative-char-list-1? str char-list i lgt)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX351" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">=</font></a> i lgt)
      #t
      (<a href="../../../../r4rs/r4rs_6.htm#IDX95" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>and</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX177" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">not</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX273" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">memv</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX488" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-ref</font></a> str i) char-list))
           (<a href="general.html#string-of-negative-char-list-1?" title="general" style="{text-decoration: none;}"><font color="#000080">string-of-negative-char-list-1?</font></a> str char-list (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> i 1) lgt))))



<span class = "comment"  >;;;Other string functions.
;;; Among the functions in this section you will find string search and replacement functions. </span>
<a name="split-on"></a><span class = "comment"  >;;Return a list of two strings taken from str. ch is a character.
;; The first is the prefix of str up to the first occurence of ch
;; The second is the suffix from ch to the end of str</span>
<a name="split-on"></a><span> <span><a href="cross-reference-index-s.html#split-on" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from split-on to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(split-on ch str)</font></b>
 (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((sp (<a href="general.html#split-point" title="general" style="{text-decoration: none;}"><font color="#000080">split-point</font></a> ch str)))
   (<a href="../../../../r4rs/r4rs_8.htm#IDX265" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">list</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX508" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">substring</font></a> str 0 sp)

         (<a href="../../../../r4rs/r4rs_8.htm#IDX508" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">substring</font></a> str (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> sp 1) (<a href="../../../../r4rs/r4rs_8.htm#IDX487" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-length</font></a> str)))))

<a name="split-point"></a><span class = "comment"  >;;Return the character position where ch occurs the first time in str.
;; If it does not appear, the procedure returns #f.
;; This function allocates some temporary strings, and as such it is not efficient. 
;; Use find-in-string instead.
;; .internal-references "similar string find function" "substring-index"</span>


<a name="split-point"></a><span> <span><a href="cross-reference-index-s.html#split-point" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from split-point to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(split-point ch str)</font></b>
 (<a href="../../../../r4rs/r4rs_8.htm#IDX562" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">call-with-current-continuation</font></a>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC30" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>lambda</b></a> (exit)
   (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_8.htm#IDX220" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">equal?</font></a> str "") #f)
         ((<a href="../../../../r4rs/r4rs_8.htm#IDX185" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">eqv?</font></a> ch (<a href="../../../../r4rs/r4rs_8.htm#IDX488" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-ref</font></a> str 0)) 0)
         (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((res (<a href="general.html#split-point" title="general" style="{text-decoration: none;}"><font color="#000080">split-point</font></a> ch (<a href="../../../../r4rs/r4rs_8.htm#IDX508" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">substring</font></a> str 1 (<a href="../../../../r4rs/r4rs_8.htm#IDX487" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-length</font></a> str)))))
                  (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX177" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">not</font></a> res)
                      (exit #f)
                      (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> 1 res))))))))


<a name="find-in-string"></a><span class = "comment"  >;;Search linearly for the character ch in the string str. 
;; An optional start postion start-post tells at which position to start the search (default is position 0).
;; Return the index of the first occurence of ch, or #f if it does not exist in str.
;; The index of the first character in a string is 0.</span>
<a name="find-in-string"></a><span> <span><a href="cross-reference-index-f.html#find-in-string" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from find-in-string to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(find-in-string str ch . start-pos)</font></b>
 (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((start-pos-1 (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> start-pos) 0 (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> start-pos))))
  (<a href="general.html#find-in-string-1" title="general" style="{text-decoration: none;}"><font color="#000080">find-in-string-1</font></a> str ch start-pos-1 (<a href="../../../../r4rs/r4rs_8.htm#IDX487" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-length</font></a> str))))

<a name="find-in-string-1"></a><span> <span><a href="cross-reference-index-f.html#find-in-string-1" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from find-in-string-1 to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(find-in-string-1 str ch i lgt)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_8.htm#IDX355" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&gt;=</font></a> i lgt) #f)
        ((<a href="../../../../r4rs/r4rs_8.htm#IDX185" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">eqv?</font></a> ch (<a href="../../../../r4rs/r4rs_8.htm#IDX488" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-ref</font></a> str i)) i)
        (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> (<a href="general.html#find-in-string-1" title="general" style="{text-decoration: none;}"><font color="#000080">find-in-string-1</font></a> str ch (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> i 1) lgt))))



<a name="find-in-string-from-end"></a><span class = "comment"  >;;Search linearly for the character ch in the string str, beginning from the rear end of str.
;; Return the index of the last occurence of ch, or #f if it does not exist in str.
;; The index of the first character in a string is 0.</span>
<a name="find-in-string-from-end"></a><span> <span><a href="cross-reference-index-f.html#find-in-string-from-end" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from find-in-string-from-end to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(find-in-string-from-end str ch)</font></b>
 (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((lgt (<a href="../../../../r4rs/r4rs_8.htm#IDX487" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-length</font></a> str)))
  (<a href="general.html#find-in-string-from-end-1" title="general" style="{text-decoration: none;}"><font color="#000080">find-in-string-from-end-1</font></a> str ch (<a href="../../../../r4rs/r4rs_8.htm#IDX369" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">-</font></a> lgt 1) lgt)))

<a name="find-in-string-from-end-1"></a><span> <span><a href="cross-reference-index-f.html#find-in-string-from-end-1" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from find-in-string-from-end-1 to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(find-in-string-from-end-1 str ch i lgt)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_8.htm#IDX352" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&lt;</font></a> i 0) #f)
        ((<a href="../../../../r4rs/r4rs_8.htm#IDX185" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">eqv?</font></a> ch (<a href="../../../../r4rs/r4rs_8.htm#IDX488" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-ref</font></a> str i)) i)
        (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> (<a href="general.html#find-in-string-from-end-1" title="general" style="{text-decoration: none;}"><font color="#000080">find-in-string-from-end-1</font></a> str ch (<a href="../../../../r4rs/r4rs_8.htm#IDX369" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">-</font></a> i 1) lgt))))


<a name="looking-at-substring?"></a><span class = "comment"  >;;Does str contain sub-str as substring, starting at position pos?
;; An efficient implementation without any string copying, only character comparsion.</span>
<a name="looking-at-substring?"></a><span> <span><a href="cross-reference-index-l.html#looking-at-substring?" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from looking-at-substring? to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(looking-at-substring? str pos sub-str)</font></b>
  (<a href="general.html#looking-at-substring-1?" title="general" style="{text-decoration: none;}"><font color="#000080">looking-at-substring-1?</font></a> str pos sub-str 0 (<a href="../../../../r4rs/r4rs_8.htm#IDX487" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-length</font></a> str) (<a href="../../../../r4rs/r4rs_8.htm#IDX487" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-length</font></a> sub-str)))

<a name="looking-at-substring-1?"></a><span> <span><a href="cross-reference-index-l.html#looking-at-substring-1?" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from looking-at-substring-1? to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(looking-at-substring-1? str pos sub-str i lgt1 lgt2)</font></b>
 (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((a (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> i pos)))
  (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_8.htm#IDX351" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">=</font></a> i lgt2) #t)
        ((<a href="../../../../r4rs/r4rs_6.htm#IDX95" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>and</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX352" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&lt;</font></a> a lgt1) (<a href="../../../../r4rs/r4rs_8.htm#IDX352" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&lt;</font></a> i lgt2) (<a href="../../../../r4rs/r4rs_8.htm#IDX185" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">eqv?</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX488" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-ref</font></a> str a) (<a href="../../../../r4rs/r4rs_8.htm#IDX488" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-ref</font></a> sub-str i)))
          (<a href="general.html#looking-at-substring-1?" title="general" style="{text-decoration: none;}"><font color="#000080">looking-at-substring-1?</font></a> str pos sub-str (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> i 1) lgt1 lgt2))
        (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> #f))))

<a name="skip-chars-in-string"></a><span class = "comment"  >;;Starting from char-pos, skip characters in string from char-list.
;; Return the first index higher or equal to start-pos, which contains
;; a character which is NOT in char-list. If start-pos is higher than
;; the maximum legal string index, return start-post.</span>
<a name="skip-chars-in-string"></a><span> <span><a href="cross-reference-index-s.html#skip-chars-in-string" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from skip-chars-in-string to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(skip-chars-in-string str char-list start-pos)</font></b>
  (<a href="general.html#skip-chars-in-string-1" title="general" style="{text-decoration: none;}"><font color="#000080">skip-chars-in-string-1</font></a> str char-list start-pos (<a href="../../../../r4rs/r4rs_8.htm#IDX487" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-length</font></a> str)))

<a name="skip-chars-in-string-1"></a><span> <span><a href="cross-reference-index-s.html#skip-chars-in-string-1" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from skip-chars-in-string-1 to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(skip-chars-in-string-1 str char-list i lgt)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_6.htm#IDX95" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>and</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX352" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&lt;</font></a> i lgt) (<a href="../../../../r4rs/r4rs_8.htm#IDX273" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">memv</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX488" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-ref</font></a> str i) char-list))
          (<a href="general.html#skip-chars-in-string-1" title="general" style="{text-decoration: none;}"><font color="#000080">skip-chars-in-string-1</font></a> str char-list (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> i 1) lgt))
        ((<a href="../../../../r4rs/r4rs_6.htm#IDX95" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>and</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX352" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&lt;</font></a> i lgt) (<a href="../../../../r4rs/r4rs_8.htm#IDX177" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">not</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX273" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">memv</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX488" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-ref</font></a> str i) char-list)))
          i)
        (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> i)))

<a name="string-merge"></a><span class = "comment"  >;;Merge str-list-1 with str-list-2, returning one string.
;; Strings from the first list are merged with the strings from the second list.
;; In case one list is shorter than the other, the strings from the longests lists
;; are concatenated and appended
;; .example (string-merge (list "aa" "bb" "cc") (list "XX" "YY")) =&gt; "aaXXbbYYcc"</span>
<a name="string-merge"></a><span> <span><a href="cross-reference-index-s.html#string-merge" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from string-merge to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(string-merge str-list-1 str-list-2)</font></b>
 (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> str-list-1) (<a href="../../../../r4rs/r4rs_8.htm#IDX540" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">apply</font></a> <a href="../../../../r4rs/r4rs_8.htm#IDX510" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-append</font></a> str-list-2))
       ((<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> str-list-2) (<a href="../../../../r4rs/r4rs_8.htm#IDX540" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">apply</font></a> <a href="../../../../r4rs/r4rs_8.htm#IDX510" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-append</font></a> str-list-1))
       (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX510" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-append</font></a>
              (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> str-list-1) (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> str-list-2)
              (<a href="general.html#string-merge" title="general" style="{text-decoration: none;}"><font color="#000080">string-merge</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> str-list-1) (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> str-list-2))))))

<a name="transliterate"></a><span class = "comment"  >;;In in-string, substitute each occurence of character ch with the string str.
;; As a special case, str may be the empty string, in which case occurrences of the character ch is eliminated from str.</span>
<a name="transliterate"></a><span> <span><a href="cross-reference-index-t.html#transliterate" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from transliterate to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(transliterate in-string ch str)</font></b>
 (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((str-factor (<a href="../../../../r4rs/r4rs_8.htm#IDX363" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">max</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX487" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-length</font></a> str) 1)))
  (<a href="general.html#transliterate-1" title="general" style="{text-decoration: none;}"><font color="#000080">transliterate-1</font></a> in-string 0 (<a href="../../../../r4rs/r4rs_8.htm#IDX487" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-length</font></a> in-string) 
                  (<a href="../../../../r4rs/r4rs_8.htm#IDX483" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">make-string</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX368" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">*</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX487" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-length</font></a> in-string) str-factor) #\space) 0
                  ch str)))

<a name="transliterate-1"></a><span> <span><a href="cross-reference-index-t.html#transliterate-1" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from transliterate-1 to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(transliterate-1 in-string n in-length
         out-string m 
         ch str)</font></b>
  <span class = "comment"  >;n is the position in the input
  ; m is the positin in the output</span>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_8.htm#IDX351" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">=</font></a> n in-length) (<a href="../../../../r4rs/r4rs_8.htm#IDX508" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">substring</font></a> out-string 0 m))
        ((<a href="../../../../r4rs/r4rs_8.htm#IDX352" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&lt;</font></a> n in-length)
           (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((in-char (<a href="../../../../r4rs/r4rs_8.htm#IDX488" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-ref</font></a> in-string n)))
              (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX185" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">eqv?</font></a> in-char ch)
                  (<a href="../../../../r4rs/r4rs_6.htm#IDX117" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>begin</b></a> (<a href="general.html#copy-string-into!" title="general" style="{text-decoration: none;}"><font color="#000080">copy-string-into!</font></a> out-string m str)
                         (<a href="general.html#transliterate-1" title="general" style="{text-decoration: none;}"><font color="#000080">transliterate-1</font></a> in-string (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> n 1) in-length out-string (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> m (<a href="../../../../r4rs/r4rs_8.htm#IDX487" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-length</font></a> str)) ch str))
                  (<a href="../../../../r4rs/r4rs_6.htm#IDX117" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>begin</b></a> (<a href="general.html#copy-string-into!" title="general" style="{text-decoration: none;}"><font color="#000080">copy-string-into!</font></a> out-string m (<a href="general.html#as-string" title="general" style="{text-decoration: none;}"><font color="#000080">as-string</font></a> in-char)) 
                         (<a href="general.html#transliterate-1" title="general" style="{text-decoration: none;}"><font color="#000080">transliterate-1</font></a> in-string (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> n 1) in-length out-string (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> m 1) ch str)))))
        (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> (error "transliterate error")) ))


<a name="delete-string-portion"></a><span class = "comment"  >;;Delete the substring of length lgt from index i in the string str.
;; A non-destructive function which returns the result (a shorter string than the input).
;; i is supposed to be a valid index in str. If lgt is too long for str, we just delete to the end of str.
;; The first character is number 0.</span>
<a name="delete-string-portion"></a><span> <span><a href="cross-reference-index-d.html#delete-string-portion" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from delete-string-portion to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(delete-string-portion str i lgt)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#IDX107" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let*</b></a> ((str-lgt (<a href="../../../../r4rs/r4rs_8.htm#IDX487" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-length</font></a> str))
         (prefix (<a href="../../../../r4rs/r4rs_8.htm#IDX508" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">substring</font></a> str 0 (<a href="../../../../r4rs/r4rs_8.htm#IDX363" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">max</font></a> i 0)))
         (suffix (<a href="../../../../r4rs/r4rs_8.htm#IDX508" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">substring</font></a> str (<a href="../../../../r4rs/r4rs_8.htm#IDX364" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">min</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> i lgt) str-lgt) str-lgt)))
    (<a href="../../../../r4rs/r4rs_8.htm#IDX510" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-append</font></a> prefix suffix)))

<span class = "comment"  >;-----------------------------------------------------------------------------</span>
<a name="replace-string"></a><span class = "comment"  >;;In str1 replace all occurences of str2 with str3 and return the resulting string.
;; str2 is not allowed to be empty.
;; A non-destructive function which leaves all input strings unaffected.</span>
<a name="replace-string"></a><span> <span><a href="cross-reference-index-r.html#replace-string" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from replace-string to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(replace-string str1 str2 str3)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX177" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">not</font></a> (<a href="general.html#empty-string?" title="general" style="{text-decoration: none;}"><font color="#000080">empty-string?</font></a> str2))
      (<a href="general.html#replace-string-1" title="general" style="{text-decoration: none;}"><font color="#000080">replace-string-1</font></a> 0 str1 str2 str3)
      (error (<a href="../../../../r4rs/r4rs_8.htm#IDX510" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-append</font></a> "replace-string: Cannot replace empty string in " str1))))

<a name="replace-string-1"></a><span class = "comment"  >;A helping function of replace-string which replaces from a given index i.</span>
<a name="replace-string-1"></a><span> <span><a href="cross-reference-index-r.html#replace-string-1" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from replace-string-1 to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(replace-string-1 i str1 str2 str3)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((match-index (<a href="general.html#substring-index" title="general" style="{text-decoration: none;}"><font color="#000080">substring-index</font></a> str1 i str2)))
    (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> match-index 
        (<a href="general.html#replace-string-1" title="general" style="{text-decoration: none;}"><font color="#000080">replace-string-1</font></a>
          (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> match-index (<a href="../../../../r4rs/r4rs_8.htm#IDX487" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-length</font></a> str3))
          (<a href="general.html#put-into-string" title="general" style="{text-decoration: none;}"><font color="#000080">put-into-string</font></a> (<a href="general.html#delete-string-portion" title="general" style="{text-decoration: none;}"><font color="#000080">delete-string-portion</font></a> str1 match-index (<a href="../../../../r4rs/r4rs_8.htm#IDX487" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-length</font></a> str2))  match-index str3)
          str2
          str3)
        str1)))


  

<a name="put-around-substring"></a><span class = "comment"  >;;Put pre-putin at pre-index, and post-putit at post-index in the string str.
;; Return the result. Str is not affected.
;; .pre-condition pre-index is less than post-index.</span>
<a name="put-around-substring"></a><span> <span><a href="cross-reference-index-p.html#put-around-substring" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from put-around-substring to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(put-around-substring str pre-index pre-putin post-index post-putin)</font></b>
 (<a href="general.html#put-into-string" title="general" style="{text-decoration: none;}"><font color="#000080">put-into-string</font></a>
    (<a href="general.html#put-into-string" title="general" style="{text-decoration: none;}"><font color="#000080">put-into-string</font></a> str post-index post-putin)
                         pre-index pre-putin))

<a name="put-into-string"></a><span class = "comment"  >;;Before the character with index put in putin-str into str, and return the resulting,
;; extended string. I.e, make room in the resulting string for putin-str, and slide a suffix of str 
;; to the right. Str is left unchanged. The first character is number 0.</span>
<a name="put-into-string"></a><span> <span><a href="cross-reference-index-p.html#put-into-string" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from put-into-string to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(put-into-string str index putin-str)</font></b>
 (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((res (<a href="../../../../r4rs/r4rs_8.htm#IDX483" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">make-string</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX487" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-length</font></a> str) (<a href="../../../../r4rs/r4rs_8.htm#IDX487" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-length</font></a> putin-str)))))
   (<a href="general.html#copy-string-into!" title="general" style="{text-decoration: none;}"><font color="#000080">copy-string-into!</font></a> res 0 (<a href="../../../../r4rs/r4rs_8.htm#IDX508" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">substring</font></a> str 0 index))
   (<a href="general.html#copy-string-into!" title="general" style="{text-decoration: none;}"><font color="#000080">copy-string-into!</font></a> res index putin-str)
   (<a href="general.html#copy-string-into!" title="general" style="{text-decoration: none;}"><font color="#000080">copy-string-into!</font></a> res (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> index (<a href="../../../../r4rs/r4rs_8.htm#IDX487" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-length</font></a> putin-str)) (<a href="../../../../r4rs/r4rs_8.htm#IDX508" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">substring</font></a> str index (<a href="../../../../r4rs/r4rs_8.htm#IDX487" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-length</font></a> str)))
   res))

<a name="embed-substring"></a><span class = "comment"  >;;Embed substring, as found in string, into embed-function.
;; A non-destructive function.
;; .parameter embed-function a function of one parameter, such as em, b.
;; .returns str with the first occurence of substring embedded into an activation of embed-function.
;; .example (embed-substring "LAML" "LAML is programmed in Scheme" em)</span>
<a name="embed-substring"></a><span> <span><a href="cross-reference-index-e.html#embed-substring" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from embed-substring to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(embed-substring substring str embed-function)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#IDX107" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let*</b></a> ((i (<a href="general.html#substring-index" title="general" style="{text-decoration: none;}"><font color="#000080">substring-index</font></a> str 0 <a href="../../../../r4rs/r4rs_8.htm#IDX508" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">substring</font></a>)))
    (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> i
        (<a href="../../../../r4rs/r4rs_6.htm#IDX107" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let*</b></a> ((pruned-str (<a href="general.html#delete-string-portion" title="general" style="{text-decoration: none;}"><font color="#000080">delete-string-portion</font></a> str i (<a href="../../../../r4rs/r4rs_8.htm#IDX487" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-length</font></a> <a href="../../../../r4rs/r4rs_8.htm#IDX508" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">substring</font></a>)))
	       (new-str (<a href="general.html#put-into-string" title="general" style="{text-decoration: none;}"><font color="#000080">put-into-string</font></a> pruned-str i (embed-function <a href="../../../../r4rs/r4rs_8.htm#IDX508" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">substring</font></a>))))
          new-str)
        str)))

<a name="copy-string-into!"></a><span class = "comment"  >;;Copy source into target and overwrite a portion of target. 
;; Both target and source are strings, and i is an integer index.
;; The first char of source becomes chararter number i in the target string.
;; The first character in a string is number 0.
;; Target is mutated by this procedure.
;; If there is not enough room for source in target, only part of the source is copied into a suffix of target.</span>
<a name="copy-string-into!"></a><span> <span><a href="cross-reference-index-c.html#copy-string-into!" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from copy-string-into! to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(copy-string-into! target i source)</font></b>
  (<a href="general.html#copy-string-into-help!" title="general" style="{text-decoration: none;}"><font color="#000080">copy-string-into-help!</font></a> target i (<a href="../../../../r4rs/r4rs_8.htm#IDX487" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-length</font></a> target) source 0 (<a href="../../../../r4rs/r4rs_8.htm#IDX487" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-length</font></a> source)))

<a name="copy-string-into-help!"></a><span> <span><a href="cross-reference-index-c.html#copy-string-into-help!" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from copy-string-into-help! to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(copy-string-into-help! target i target-length source j source-length)</font></b>
  <span class = "comment"  >;A helping operation, doing the real work, of copy-string-into!</span>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_8.htm#IDX351" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">=</font></a> i target-length) target)
        ((<a href="../../../../r4rs/r4rs_8.htm#IDX351" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">=</font></a> j source-length) target)
        ((<a href="../../../../r4rs/r4rs_8.htm#IDX352" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&lt;</font></a> j source-length) 
              (<a href="../../../../r4rs/r4rs_6.htm#IDX117" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>begin</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX490" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-set!</font></a> target i (<a href="../../../../r4rs/r4rs_8.htm#IDX488" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-ref</font></a> source j))
                     (<a href="general.html#copy-string-into-help!" title="general" style="{text-decoration: none;}"><font color="#000080">copy-string-into-help!</font></a> target (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> 1 i) target-length source (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> 1 j) source-length)))))

<a name="substring-index"></a><span class = "comment"  >;;Return the index of the first occurence of find-str in str.
;; The search starts at str-index.
;; The first character in str has index 0.
;; If find-str is not a substring of str, starting the search at str-index, #f is returned.</span>
<a name="substring-index"></a><span> <span><a href="cross-reference-index-s.html#substring-index" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from substring-index to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(substring-index str str-index find-str)</font></b>
 (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((str-length (<a href="../../../../r4rs/r4rs_8.htm#IDX487" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-length</font></a> str))
       (find-str-length (<a href="../../../../r4rs/r4rs_8.htm#IDX487" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-length</font></a> find-str)))
  (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_8.htm#IDX351" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">=</font></a> 0 (<a href="../../../../r4rs/r4rs_8.htm#IDX487" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-length</font></a> find-str)) str-index)  <span class = "comment"  >;new 10.9.98</span>
        ((<a href="../../../../r4rs/r4rs_8.htm#IDX353" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&gt;</font></a> str-index (<a href="../../../../r4rs/r4rs_8.htm#IDX369" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">-</font></a> str-length find-str-length)) #f)
        ((<a href="general.html#substring-index-help" title="general" style="{text-decoration: none;}"><font color="#000080">substring-index-help</font></a> str str-index str-length find-str 0 find-str-length) str-index)
        (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> (<a href="general.html#substring-index" title="general" style="{text-decoration: none;}"><font color="#000080">substring-index</font></a> str (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> 1 str-index) find-str)))))

<a name="substring-index-help"></a><span> <span><a href="cross-reference-index-s.html#substring-index-help" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from substring-index-help to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(substring-index-help str str-index str-length find-str find-str-index find-str-length)</font></b>
  <span class = "comment"  >;return whether find-str matches at postion str-index at str.
  ; I.e., at boolean results from this function
  ; str-length is the length of str.
  ; find-str-length is the length of the remaining part of find-str to match.
  ; find-str-index is the actual index ind find-str.
  ; str-index is the actua index of str.</span>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a>((<a href="../../../../r4rs/r4rs_8.htm#IDX351" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">=</font></a> 0 find-str-length) #t)
       ((<a href="../../../../r4rs/r4rs_8.htm#IDX351" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">=</font></a> str-index str-length) #f)
       ((<a href="../../../../r4rs/r4rs_8.htm#IDX185" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">eqv?</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX488" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-ref</font></a> str str-index) (<a href="../../../../r4rs/r4rs_8.htm#IDX488" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-ref</font></a> find-str find-str-index))
          (<a href="general.html#substring-index-help" title="general" style="{text-decoration: none;}"><font color="#000080">substring-index-help</font></a> str (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> str-index 1) str-length find-str (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> 1 find-str-index) (<a href="../../../../r4rs/r4rs_8.htm#IDX369" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">-</font></a> find-str-length 1)))
       (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> #f)))

<a name="first-sentence-in-string"></a><span class = "comment"  >;;Return the first sentence in str (including a point).
;; The first sentence is running up to the first point followed by space or line termination.</span>
<a name="first-sentence-in-string"></a><span> <span><a href="cross-reference-index-f.html#first-sentence-in-string" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from first-sentence-in-string to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(first-sentence-in-string str)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#IDX107" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let*</b></a> ((point-index (<a href="general.html#first-sentence-split-point" title="general" style="{text-decoration: none;}"><font color="#000080">first-sentence-split-point</font></a> str)))
    (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX340" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">number?</font></a> point-index) (<a href="../../../../r4rs/r4rs_8.htm#IDX508" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">substring</font></a> str 0 (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> 1 point-index)) str)))

<a name="but-first-sentence-of-string"></a><span class = "comment"  >;;Return all but the first sentence in str.</span>
<a name="but-first-sentence-of-string"></a><span> <span><a href="cross-reference-index-b.html#but-first-sentence-of-string" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from but-first-sentence-of-string to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(but-first-sentence-of-string str)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((point-index (<a href="general.html#first-sentence-split-point" title="general" style="{text-decoration: none;}"><font color="#000080">first-sentence-split-point</font></a> str)))
    (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> point-index (<a href="../../../../r4rs/r4rs_8.htm#IDX508" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">substring</font></a> str (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> point-index 2) (<a href="../../../../r4rs/r4rs_8.htm#IDX487" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-length</font></a> str)) "")))

<a name="first-sentence-split-point"></a><span class = "comment"  >;Return the split point of the first sentence in str.
; If no split point can be located, return #f.</span>
<a name="first-sentence-split-point"></a><span> <span><a href="cross-reference-index-f.html#first-sentence-split-point" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from first-sentence-split-point to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(first-sentence-split-point str)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#IDX107" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let*</b></a> ((point-index-0 (<a href="general.html#substring-index" title="general" style="{text-decoration: none;}"><font color="#000080">substring-index</font></a> str 0 ". "))
         (point-index-1 (<a href="general.html#substring-index" title="general" style="{text-decoration: none;}"><font color="#000080">substring-index</font></a> str 0 (<a href="../../../../r4rs/r4rs_8.htm#IDX510" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-append</font></a> "." (<a href="general.html#as-string" title="general" style="{text-decoration: none;}"><font color="#000080">as-string</font></a> (<a href="general.html#as-char" title="general" style="{text-decoration: none;}"><font color="#000080">as-char</font></a> 10)))))
         (point-index-2 (<a href="general.html#substring-index" title="general" style="{text-decoration: none;}"><font color="#000080">substring-index</font></a> str 0 (<a href="../../../../r4rs/r4rs_8.htm#IDX510" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-append</font></a> "." (<a href="general.html#as-string" title="general" style="{text-decoration: none;}"><font color="#000080">as-string</font></a> (<a href="general.html#as-char" title="general" style="{text-decoration: none;}"><font color="#000080">as-char</font></a> 13)))))
         (point-index-min (<a href="general.html#min-special" title="general" style="{text-decoration: none;}"><font color="#000080">min-special</font></a> point-index-0 point-index-1 point-index-2)))
    point-index-min))

<a name="min-special"></a><span> <span><a href="cross-reference-index-m.html#min-special" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from min-special to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(min-special . numbers-or-nulls)</font></b>
  (<a href="general.html#min-special-1" title="general" style="{text-decoration: none;}"><font color="#000080">min-special-1</font></a> numbers-or-nulls #f))

<a name="min-special-1"></a><span> <span><a href="cross-reference-index-m.html#min-special-1" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from min-special-1 to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(min-special-1 numbers-or-nulls res)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> numbers-or-nulls) res)
        ((<a href="../../../../r4rs/r4rs_8.htm#IDX179" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">boolean?</font></a> res) (<a href="general.html#min-special-1" title="general" style="{text-decoration: none;}"><font color="#000080">min-special-1</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> numbers-or-nulls) (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> numbers-or-nulls)))
        ((<a href="../../../../r4rs/r4rs_6.htm#IDX95" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>and</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX340" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">number?</font></a> res) (<a href="../../../../r4rs/r4rs_8.htm#IDX340" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">number?</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> numbers-or-nulls)) (<a href="../../../../r4rs/r4rs_8.htm#IDX352" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&lt;</font></a>  (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> numbers-or-nulls) res))
            (<a href="general.html#min-special-1" title="general" style="{text-decoration: none;}"><font color="#000080">min-special-1</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> numbers-or-nulls) (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> numbers-or-nulls)))
        ((<a href="../../../../r4rs/r4rs_6.htm#IDX95" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>and</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX340" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">number?</font></a> res) (<a href="../../../../r4rs/r4rs_8.htm#IDX340" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">number?</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> numbers-or-nulls)) (<a href="../../../../r4rs/r4rs_8.htm#IDX355" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&gt;=</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> numbers-or-nulls) res))
            (<a href="general.html#min-special-1" title="general" style="{text-decoration: none;}"><font color="#000080">min-special-1</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> numbers-or-nulls) res))
        (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> (<a href="general.html#min-special-1" title="general" style="{text-decoration: none;}"><font color="#000080">min-special-1</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> numbers-or-nulls) res))))

<a name="strip-initial-characters"></a><span class = "comment"  >;;Strip initial occurences of chars from char-list from string. Returns the empty string if given the empty string.
;; This function makes intermediate substrings, and as such it is not efficient.</span>
<a name="strip-initial-characters"></a><span> <span><a href="cross-reference-index-s.html#strip-initial-characters" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from strip-initial-characters to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(strip-initial-characters char-list string)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX351" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">=</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX487" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-length</font></a> <a href="../../../../r4rs/r4rs_8.htm#IDX486" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string</font></a>) 0)
      ""
      (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX273" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">memv</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX488" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-ref</font></a> <a href="../../../../r4rs/r4rs_8.htm#IDX486" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string</font></a> 0) char-list)
          (<a href="general.html#strip-initial-characters" title="general" style="{text-decoration: none;}"><font color="#000080">strip-initial-characters</font></a> char-list (<a href="../../../../r4rs/r4rs_8.htm#IDX508" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">substring</font></a> <a href="../../../../r4rs/r4rs_8.htm#IDX486" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string</font></a> 1 (<a href="../../../../r4rs/r4rs_8.htm#IDX487" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-length</font></a> <a href="../../../../r4rs/r4rs_8.htm#IDX486" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string</font></a>)))
          <a href="../../../../r4rs/r4rs_8.htm#IDX486" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string</font></a>)))

<a name="strip-trailing-characters"></a><span class = "comment"  >;;Strip trailing occurences of the characters in char-list from string. </span>
<a name="strip-trailing-characters"></a><span> <span><a href="cross-reference-index-s.html#strip-trailing-characters" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from strip-trailing-characters to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(strip-trailing-characters char-list string)</font></b>
 (<a href="../../../../r4rs/r4rs_6.htm#IDX112" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>letrec</b></a> ((last-non-char-list-index 
	   (<a href="../../../../r4rs/r4rs_6.htm#SEC30" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>lambda</b></a> (i)
	     (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_8.htm#IDX352" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&lt;</font></a> i 0) i)
		   ((<a href="../../../../r4rs/r4rs_8.htm#IDX273" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">memv</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX488" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-ref</font></a> <a href="../../../../r4rs/r4rs_8.htm#IDX486" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string</font></a> i) char-list)
                      (last-non-char-list-index (<a href="../../../../r4rs/r4rs_8.htm#IDX369" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">-</font></a> i 1)))
		   (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> i)))) <span class = "comment"  >;char i is not in char-list</span>
         )
   (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((i (last-non-char-list-index (<a href="../../../../r4rs/r4rs_8.htm#IDX369" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">-</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX487" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-length</font></a> <a href="../../../../r4rs/r4rs_8.htm#IDX486" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string</font></a>) 1)))
        )
     (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX352" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&lt;</font></a> i 0)
	 ""
       (<a href="../../../../r4rs/r4rs_8.htm#IDX508" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">substring</font></a> <a href="../../../../r4rs/r4rs_8.htm#IDX486" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string</font></a> 0 (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> i 1))))))


<a name="strip-initial-spaces"></a><span class = "comment"  >;;Strip all initial space characters and lineshifting characters from string.</span>
<a name="strip-initial-spaces"></a><span> <span><a href="cross-reference-index-s.html#strip-initial-spaces" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from strip-initial-spaces to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(strip-initial-spaces string)</font></b>
  (<a href="general.html#strip-initial-characters" title="general" style="{text-decoration: none;}"><font color="#000080">strip-initial-characters</font></a> 
     (<a href="../../../../r4rs/r4rs_8.htm#IDX265" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">list</font></a> #\space (<a href="../../../../r4rs/r4rs_8.htm#IDX470" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">integer-&gt;char</font></a> 10) (<a href="../../../../r4rs/r4rs_8.htm#IDX470" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">integer-&gt;char</font></a> 13) (<a href="../../../../r4rs/r4rs_8.htm#IDX470" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">integer-&gt;char</font></a> 9) (<a href="../../../../r4rs/r4rs_8.htm#IDX470" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">integer-&gt;char</font></a> 12))
     <a href="../../../../r4rs/r4rs_8.htm#IDX486" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string</font></a>))
      

<a name="quote-string"></a><span class = "comment"  >;con-par is in the html library file</span>



<a name="quote-string"></a><span> <span><a href="cross-reference-index-q.html#quote-string" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from quote-string to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >quote-string</font></b> (<a href="general.html#as-string" title="general" style="{text-decoration: none;}"><font color="#000080">as-string</font></a> #\"))

<a name="string-it"></a><span class = "comment"  >;;embed the string x in double string quotes</span>
<a name="string-it"></a><span> <span><a href="cross-reference-index-s.html#string-it" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from string-it to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(string-it x)</font></b>
  (<a href="../../../../r4rs/r4rs_8.htm#IDX510" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-append</font></a> <a href="general.html#quote-string" title="general" style="{text-decoration: none;}"><font color="#000080">quote-string</font></a>  x <a href="general.html#quote-string" title="general" style="{text-decoration: none;}"><font color="#000080">quote-string</font></a>))

<a name="single-quote-string"></a><span> <span><a href="cross-reference-index-s.html#single-quote-string" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from single-quote-string to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >single-quote-string</font></b> (<a href="general.html#as-string" title="general" style="{text-decoration: none;}"><font color="#000080">as-string</font></a> #\'))

<a name="string-it-single"></a><span class = "comment"  >;;embed the string x in single string quotes</span>
<a name="string-it-single"></a><span> <span><a href="cross-reference-index-s.html#string-it-single" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from string-it-single to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(string-it-single x)</font></b>
  (<a href="../../../../r4rs/r4rs_8.htm#IDX510" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-append</font></a> <a href="general.html#single-quote-string" title="general" style="{text-decoration: none;}"><font color="#000080">single-quote-string</font></a> x <a href="general.html#single-quote-string" title="general" style="{text-decoration: none;}"><font color="#000080">single-quote-string</font></a>))

<a name="exchange-chars-in-str!"></a><span class = "comment"  >;;Exchange destructively char n and m in str. First character is number 0.
;; Not a function, thus no return value.</span>
<a name="exchange-chars-in-str!"></a><span> <span><a href="cross-reference-index-e.html#exchange-chars-in-str!" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from exchange-chars-in-str! to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(exchange-chars-in-str! str n m)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((remember-char (<a href="../../../../r4rs/r4rs_8.htm#IDX488" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-ref</font></a> str m)))
    (<a href="../../../../r4rs/r4rs_8.htm#IDX490" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-set!</font></a> str m (<a href="../../../../r4rs/r4rs_8.htm#IDX488" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-ref</font></a> str n))
    (<a href="../../../../r4rs/r4rs_8.htm#IDX490" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-set!</font></a> str n remember-char)))

<a name="ensure-final-character"></a><span class = "comment"  >;;Ensure that the last character in str (a string) is ch (a char)</span>
<a name="ensure-final-character"></a><span> <span><a href="cross-reference-index-e.html#ensure-final-character" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from ensure-final-character to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(ensure-final-character str ch)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((lgt (<a href="../../../../r4rs/r4rs_8.htm#IDX487" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-length</font></a> str)))
    (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> (<a href="../../../../r4rs/r4rs_6.htm#IDX95" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>and</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX353" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&gt;</font></a> lgt 0)
             (<a href="../../../../r4rs/r4rs_8.htm#IDX185" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">eqv?</font></a> ch (<a href="../../../../r4rs/r4rs_8.htm#IDX488" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-ref</font></a> str (<a href="../../../../r4rs/r4rs_8.htm#IDX369" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">-</font></a> lgt 1))))
         str
         (<a href="../../../../r4rs/r4rs_8.htm#IDX510" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-append</font></a> str (<a href="general.html#as-string" title="general" style="{text-decoration: none;}"><font color="#000080">as-string</font></a> ch)))))

<a name="repeat-string"></a><span class = "comment"  >;;Repeat the string str n times.
;; If n equals 0, return the empty string. 
;; Causes a fatal error if n is negative.</span>
<a name="repeat-string"></a><span> <span><a href="cross-reference-index-r.html#repeat-string" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from repeat-string to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(repeat-string str n)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_8.htm#IDX352" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&lt;</font></a> n 0) (error (<a href="../../../../r4rs/r4rs_8.htm#IDX510" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-append</font></a> "repeat-string with negative repeat count is not supported: " (<a href="general.html#as-string" title="general" style="{text-decoration: none;}"><font color="#000080">as-string</font></a> n))))
        ((<a href="../../../../r4rs/r4rs_8.htm#IDX351" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">=</font></a> n 0) "")
        (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX510" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-append</font></a> str (<a href="general.html#repeat-string" title="general" style="{text-decoration: none;}"><font color="#000080">repeat-string</font></a> str (<a href="../../../../r4rs/r4rs_8.htm#IDX369" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">-</font></a> n 1))))))

<a name="unescape-text"></a><span class = "comment"  >;;Unescape text with the escape character esc-char.
;; A pending escape character in text is just ignored.
;; Unescaping is the process of replacing a two-character text sequence ESC CHAR with CHAR.
;; .parameter text The input text string
;; .parameter esc-char The escape character. A Scheme char.
;; .example ab$c  -&gt; abc
;; .example $.xy  -&gt; .xy
;; .example $$xy  -&gt; $xy
;; .example $$$$x -&gt; $$x
;; .example xy$   -&gt; xy</span>
<a name="unescape-text"></a><span> <span><a href="cross-reference-index-u.html#unescape-text" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from unescape-text to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(unescape-text text esc-char)</font></b>
 (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((text-lgt (<a href="../../../../r4rs/r4rs_8.htm#IDX487" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-length</font></a> text)))
  (<a href="general.html#unescape-1" title="general" style="{text-decoration: none;}"><font color="#000080">unescape-1</font></a> text esc-char (<a href="../../../../r4rs/r4rs_8.htm#IDX483" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">make-string</font></a> text-lgt) 0 0 text-lgt #f)))

<a name="unescape-1"></a><span class = "comment"  >;The procedure which does the real work of unescape-text.
; from-text is the original input text.
; esc-char is the escape character. 
; to-text is the resulting text, gradually mutated by this procedure.
; i is index in from-text and j is index in to-text
; from-text-length is the length of from-text.
; escape? is true if the next character in from-text is escaped. In that
; case, the next character will always appear in the to-text.</span>
<a name="unescape-1"></a><span> <span><a href="cross-reference-index-u.html#unescape-1" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from unescape-1 to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(unescape-1 from-text esc-char to-text i j from-text-lgt escape?)</font></b>
 (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_8.htm#IDX351" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">=</font></a> i from-text-lgt) (<a href="../../../../r4rs/r4rs_8.htm#IDX508" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">substring</font></a> to-text 0 j))
       (escape?  <span class = "comment"  >;previous char was escpae char.</span>
          (<a href="../../../../r4rs/r4rs_8.htm#IDX490" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-set!</font></a> to-text j (<a href="../../../../r4rs/r4rs_8.htm#IDX488" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-ref</font></a> from-text i)) 
          (<a href="general.html#unescape-1" title="general" style="{text-decoration: none;}"><font color="#000080">unescape-1</font></a> from-text esc-char to-text (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> i 1) (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> j 1) from-text-lgt #f))
       ((<a href="../../../../r4rs/r4rs_8.htm#IDX185" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">eqv?</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX488" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-ref</font></a> from-text i) esc-char)
          (<a href="general.html#unescape-1" title="general" style="{text-decoration: none;}"><font color="#000080">unescape-1</font></a> from-text esc-char to-text (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> i 1) j from-text-lgt #t))
       (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a>
          (<a href="../../../../r4rs/r4rs_8.htm#IDX490" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-set!</font></a> to-text j (<a href="../../../../r4rs/r4rs_8.htm#IDX488" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-ref</font></a> from-text i)) 
          (<a href="general.html#unescape-1" title="general" style="{text-decoration: none;}"><font color="#000080">unescape-1</font></a> from-text esc-char to-text (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> i 1) (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> j 1) from-text-lgt #f))))


<span class = "comment"  >;;;Functions that change letter case in string.
;;; Here comes a number of functions which changes the letter case of a string.
;;; In general we recommend use of the non-destructive versions of the functions, thus
;;; encouraging a clean, functional programming style. Due a difference between mutable and
;;; immutable strings, we have experienced problems with the destructive procedures in MzScheme.</span>
<span class = "comment"  >; Capitalizing characters and strings.</span>
<a name="capitalize-string"></a><span class = "comment"  >;;Mutate str to have an initial capital character. 
;; A destructive procedure. See capitalize-string-nd for a non-destructive variant.
;; .internal-references "non-destructive variant" "capitalize-string-nd"</span>
<a name="capitalize-string"></a><span> <span><a href="cross-reference-index-c.html#capitalize-string" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from capitalize-string to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(capitalize-string str)</font></b>
  (<a href="../../../../r4rs/r4rs_8.htm#IDX490" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-set!</font></a> str 0 (<a href="general.html#capitalize-char" title="general" style="{text-decoration: none;}"><font color="#000080">capitalize-char</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX488" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-ref</font></a> str 0)))
  str)

<a name="capitalize-string-nd"></a><span class = "comment"  >;;Return str with capital, initial character. 
;; A non-destructive variant of capitalize-string.
;; .internal-references "destructive variant" "capitalize-string"</span>
<a name="capitalize-string-nd"></a><span> <span><a href="cross-reference-index-c.html#capitalize-string-nd" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from capitalize-string-nd to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(capitalize-string-nd str)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((res (<a href="../../../../r4rs/r4rs_8.htm#IDX518" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-copy</font></a> str)))
    (<a href="../../../../r4rs/r4rs_8.htm#IDX490" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-set!</font></a> res 0 (<a href="general.html#capitalize-char" title="general" style="{text-decoration: none;}"><font color="#000080">capitalize-char</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX488" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-ref</font></a> str 0)))
    res))

<a name="capitalize-char"></a><span class = "comment"  >;if it makes sense, return the capital character corresponding to ch.
; else, just return ch</span>
<a name="capitalize-char"></a><span> <span><a href="cross-reference-index-c.html#capitalize-char" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from capitalize-char to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(capitalize-char ch)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((char-code (<a href="../../../../r4rs/r4rs_8.htm#IDX469" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">char-&gt;integer</font></a> ch)))
    (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> (<a href="general.html#lower-case-letter-code?" title="general" style="{text-decoration: none;}"><font color="#000080">lower-case-letter-code?</font></a> char-code)
        (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((offset (<a href="general.html#small-capital-offset" title="general" style="{text-decoration: none;}"><font color="#000080">small-capital-offset</font></a> char-code)))
          (<a href="../../../../r4rs/r4rs_8.htm#IDX470" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">integer-&gt;char</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> char-code offset)))
        ch)))

<a name="lower-case-letter-code?"></a><span> <span><a href="cross-reference-index-l.html#lower-case-letter-code?" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from lower-case-letter-code? to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(lower-case-letter-code? n)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#IDX96" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>or</b></a> (<a href="../../../../r4rs/r4rs_6.htm#IDX95" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>and</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX355" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&gt;=</font></a> n 97) (<a href="../../../../r4rs/r4rs_8.htm#IDX354" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&lt;=</font></a> n 122)) (<a href="../../../../r4rs/r4rs_8.htm#IDX351" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">=</font></a> n 230) (<a href="../../../../r4rs/r4rs_8.htm#IDX351" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">=</font></a> n 248) (<a href="../../../../r4rs/r4rs_8.htm#IDX351" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">=</font></a> n 229)))

<a name="small-capital-offset"></a><span class = "comment"  >;in all cases, the distance between lower and upper case letters are -32 in the ASCII table</span>
<a name="small-capital-offset"></a><span> <span><a href="cross-reference-index-s.html#small-capital-offset" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from small-capital-offset to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(small-capital-offset n)</font></b>
 (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_6.htm#IDX95" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>and</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX355" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&gt;=</font></a> n 97) (<a href="../../../../r4rs/r4rs_8.htm#IDX354" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&lt;=</font></a> n 122)) -32)
       ((<a href="../../../../r4rs/r4rs_8.htm#IDX351" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">=</font></a> n 230) -32)
       ((<a href="../../../../r4rs/r4rs_8.htm#IDX351" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">=</font></a> n 248) -32)
       ((<a href="../../../../r4rs/r4rs_8.htm#IDX351" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">=</font></a> n 229) -32)
       (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> 0)))

<span class = "comment"  >;-----------------------------------------------------------------------------
; Upcasing all characters in a string</span>
<a name="upcase-string"></a><span class = "comment"  >;;Upcase all characters in str. This function is non-destructive, i.e., it does not change the parameter str.</span>
<a name="upcase-string"></a><span> <span><a href="cross-reference-index-u.html#upcase-string" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from upcase-string to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(upcase-string str)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((res (<a href="../../../../r4rs/r4rs_8.htm#IDX483" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">make-string</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX487" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-length</font></a> str) #\space)))
    (<a href="general.html#upcase-string-help!" title="general" style="{text-decoration: none;}"><font color="#000080">upcase-string-help!</font></a> str res 0 (<a href="../../../../r4rs/r4rs_8.htm#IDX487" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-length</font></a> str))))

<a name="upcase-string-help!"></a><span> <span><a href="cross-reference-index-u.html#upcase-string-help!" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from upcase-string-help! to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(upcase-string-help! input output i lgt)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_8.htm#IDX355" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&gt;=</font></a> i lgt) output)
        (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX490" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-set!</font></a> output i (<a href="general.html#capitalize-char" title="general" style="{text-decoration: none;}"><font color="#000080">capitalize-char</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX488" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-ref</font></a> input i)))
              (<a href="general.html#upcase-string-help!" title="general" style="{text-decoration: none;}"><font color="#000080">upcase-string-help!</font></a> input output (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> i 1) lgt))))

<span class = "comment"  >;-----------------------------------------------------------------------------
;
; Downcasing all characters in a string</span>
<a name="downcase-string"></a><span class = "comment"  >;;Downcase all characters in str. This function is non-destructive, i.e., it does not change the parameter str.</span>
<a name="downcase-string"></a><span> <span><a href="cross-reference-index-d.html#downcase-string" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from downcase-string to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(downcase-string str)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((res (<a href="../../../../r4rs/r4rs_8.htm#IDX483" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">make-string</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX487" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-length</font></a> str) #\space)))
    (<a href="general.html#downcase-string-help!" title="general" style="{text-decoration: none;}"><font color="#000080">downcase-string-help!</font></a> str res 0 (<a href="../../../../r4rs/r4rs_8.htm#IDX487" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-length</font></a> str))))

<a name="downcase-string-help!"></a><span> <span><a href="cross-reference-index-d.html#downcase-string-help!" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from downcase-string-help! to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(downcase-string-help! input output i lgt)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_8.htm#IDX355" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&gt;=</font></a> i lgt) output)
        (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX490" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-set!</font></a> output i (<a href="general.html#decapitalize-char" title="general" style="{text-decoration: none;}"><font color="#000080">decapitalize-char</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX488" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-ref</font></a> input i)))
              (<a href="general.html#downcase-string-help!" title="general" style="{text-decoration: none;}"><font color="#000080">downcase-string-help!</font></a> input output (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> i 1) lgt))))

<span class = "comment"  >;-----------------------------------------------------------------------------
;
; decapitalizing characters and strings.</span>
<a name="decapitalize-string"></a><span class = "comment"  >;;Mutate str to have lower case, initial character. 
;; A destructive procedure. See decapitalize-string-nd for a non-destructive variant.
;; .internal-references "non-destructive variant" "decapitalize-string-nd"</span>
<a name="decapitalize-string"></a><span> <span><a href="cross-reference-index-d.html#decapitalize-string" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from decapitalize-string to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(decapitalize-string str)</font></b>
  (<a href="../../../../r4rs/r4rs_8.htm#IDX490" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-set!</font></a> str 0 (<a href="general.html#decapitalize-char" title="general" style="{text-decoration: none;}"><font color="#000080">decapitalize-char</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX488" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-ref</font></a> str 0)))
  str)

<a name="decapitalize-string-nd"></a><span class = "comment"  >;;Return str with lower case, initial character. 
;; A non-destructive variant of decapitalize-string.
;; .internal-references "destructive variant" "decapitalize-string"</span>
<a name="decapitalize-string-nd"></a><span> <span><a href="cross-reference-index-d.html#decapitalize-string-nd" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from decapitalize-string-nd to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(decapitalize-string-nd str)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((res (<a href="../../../../r4rs/r4rs_8.htm#IDX518" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-copy</font></a> str)))
    (<a href="../../../../r4rs/r4rs_8.htm#IDX490" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-set!</font></a> res 0 (<a href="general.html#decapitalize-char" title="general" style="{text-decoration: none;}"><font color="#000080">decapitalize-char</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX488" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-ref</font></a> str 0)))
    res))

<a name="decapitalize-char"></a><span class = "comment"  >;If it makes sense, return the lower case character corresponding to ch.
; else, just return ch.</span>
<a name="decapitalize-char"></a><span> <span><a href="cross-reference-index-d.html#decapitalize-char" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from decapitalize-char to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(decapitalize-char ch)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((char-code (<a href="../../../../r4rs/r4rs_8.htm#IDX469" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">char-&gt;integer</font></a> ch)))
    (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> (<a href="general.html#upper-case-letter-code?" title="general" style="{text-decoration: none;}"><font color="#000080">upper-case-letter-code?</font></a> char-code)
        (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((offset (<a href="general.html#large-capital-offset" title="general" style="{text-decoration: none;}"><font color="#000080">large-capital-offset</font></a> char-code)))
          (<a href="../../../../r4rs/r4rs_8.htm#IDX470" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">integer-&gt;char</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> char-code offset)))
        ch)))

<a name="upper-case-letter-code?"></a><span> <span><a href="cross-reference-index-u.html#upper-case-letter-code?" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from upper-case-letter-code? to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(upper-case-letter-code? n)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#IDX96" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>or</b></a> (<a href="../../../../r4rs/r4rs_6.htm#IDX95" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>and</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX355" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&gt;=</font></a> n 65) (<a href="../../../../r4rs/r4rs_8.htm#IDX354" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&lt;=</font></a> n 90)) (<a href="../../../../r4rs/r4rs_8.htm#IDX351" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">=</font></a> n 198) (<a href="../../../../r4rs/r4rs_8.htm#IDX351" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">=</font></a> n 216) (<a href="../../../../r4rs/r4rs_8.htm#IDX351" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">=</font></a> n 197)))

<a name="large-capital-offset"></a><span> <span><a href="cross-reference-index-l.html#large-capital-offset" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from large-capital-offset to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(large-capital-offset n)</font></b>
 <span class = "comment"  >;in all cases, the distance between lower and upper case letters are -32 in the ASCII table</span>
 (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_6.htm#IDX95" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>and</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX355" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&gt;=</font></a> n 65) (<a href="../../../../r4rs/r4rs_8.htm#IDX354" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&lt;=</font></a> n 90)) 32)
       ((<a href="../../../../r4rs/r4rs_8.htm#IDX351" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">=</font></a> n 198) 32)
       ((<a href="../../../../r4rs/r4rs_8.htm#IDX351" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">=</font></a> n 216) 32)
       ((<a href="../../../../r4rs/r4rs_8.htm#IDX351" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">=</font></a> n 197) 32)
       (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> 0)))

<span class = "comment"  >;---------------------------------------------------------------------------------------------------</span>
<span class = "comment"  >;;;Message displaying and error handling procedures.
;;; Most message or error functions accept a list of messages which are string-converted and
;;; space separated before outputted.</span>
<a name="laml-aggregate-messages"></a><span class = "comment"  >;Aggreate the messages in list to a single message-string.
; Applies as-string before space separated concatenation.</span>
<a name="laml-aggregate-messages"></a><span> <span><a href="cross-reference-index-l.html#laml-aggregate-messages" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from laml-aggregate-messages to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(laml-aggregate-messages message-list)</font></b>
 (<a href="general.html#string-merge" title="general" style="{text-decoration: none;}"><font color="#000080">string-merge</font></a> 
  (<a href="../../../../r4rs/r4rs_8.htm#IDX542" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">map</font></a> <a href="general.html#as-string" title="general" style="{text-decoration: none;}"><font color="#000080">as-string</font></a> message-list)
  (<a href="general.html#make-list" title="general" style="{text-decoration: none;}"><font color="#000080">make-list</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX369" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">-</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX266" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">length</font></a> message-list) 1) " ")))

<a name="display-warning"></a><span class = "comment"  >;;Display a warning message line on standard output via the Scheme display function.
;; This is not a fatal error</span>
<a name="display-warning"></a><span> <span><a href="cross-reference-index-d.html#display-warning" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from display-warning to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(display-warning . messages)</font></b>
  (<a href="../../../../r4rs/r4rs_8.htm#IDX630" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">display</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX510" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-append</font></a> "Warning: " (<a href="general.html#laml-aggregate-messages" title="general" style="{text-decoration: none;}"><font color="#000080">laml-aggregate-messages</font></a> messages))) (<a href="../../../../r4rs/r4rs_8.htm#IDX640" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">newline</font></a>))

<a name="display-error"></a><span class = "comment"  >;;Display an error message - in terms of messages - and stop the program. 
;; This is a fatal event.</span>
<a name="display-error"></a><span> <span><a href="cross-reference-index-d.html#display-error" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from display-error to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(display-error . messages)</font></b>
  (error (<a href="general.html#laml-aggregate-messages" title="general" style="{text-decoration: none;}"><font color="#000080">laml-aggregate-messages</font></a> messages)))

<a name="display-message"></a><span class = "comment"  >;;Display messages on standard output.
;; Not a warning, and not fatal by any means.</span>
<a name="display-message"></a><span> <span><a href="cross-reference-index-d.html#display-message" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from display-message to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(display-message . messages)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#IDX117" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>begin</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX630" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">display</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX510" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-append</font></a> (<a href="general.html#laml-aggregate-messages" title="general" style="{text-decoration: none;}"><font color="#000080">laml-aggregate-messages</font></a> messages))) (<a href="../../../../r4rs/r4rs_8.htm#IDX640" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">newline</font></a>)))


<a name="laml-error"></a><span class = "comment"  >;;Stop the program with messages. 
;; This procedures takes an arbitrary number of parameters, which are string converted and string-appended
;; to the final error message.</span>
<a name="laml-error"></a><span> <span><a href="cross-reference-index-l.html#laml-error" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from laml-error to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(laml-error . messages)</font></b>
  (error (<a href="general.html#laml-aggregate-messages" title="general" style="{text-decoration: none;}"><font color="#000080">laml-aggregate-messages</font></a> messages)))


<a name="errors-among-conditions"></a><span class = "comment"  >;;Return a list of error message strings for those conditions that are true.
;; The function returns #f in case no errors are found.
;; There are no errors if all conditions evaluate to #f, and in this case returns the #f.
;; err-condition-message-list is a property list (of even length) of error-condition error messages pairs.
;; This function checks the conditions and returns a concatenated list of error messages.
;; If no error conditions are found, return #f.</span>
<a name="errors-among-conditions"></a><span> <span><a href="cross-reference-index-e.html#errors-among-conditions" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from errors-among-conditions to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(errors-among-conditions . err-condition-message-list)</font></b>
  (<a href="general.html#errors-among-conditions-1" title="general" style="{text-decoration: none;}"><font color="#000080">errors-among-conditions-1</font></a> err-condition-message-list #f '()))

<a name="errors-among-conditions-1"></a><span> <span><a href="cross-reference-index-e.html#errors-among-conditions-1" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from errors-among-conditions-1 to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(errors-among-conditions-1 err-condition-message-list errors-found accumulated-error-messages)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> err-condition-message-list) (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> errors-found (reverse accumulated-error-messages) #f))
        (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((error-condition (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> err-condition-message-list))
                    (error-message (<a href="../../../../r4rs/r4rs_8.htm#IDX256" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cadr</font></a> err-condition-message-list)))
                (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> error-condition 
                    (<a href="general.html#errors-among-conditions-1" title="general" style="{text-decoration: none;}"><font color="#000080">errors-among-conditions-1</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX254" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cddr</font></a> err-condition-message-list) #t (<a href="../../../../r4rs/r4rs_8.htm#IDX245" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cons</font></a> error-message accumulated-error-messages))
                    (<a href="general.html#errors-among-conditions-1" title="general" style="{text-decoration: none;}"><font color="#000080">errors-among-conditions-1</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX254" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cddr</font></a> err-condition-message-list) errors-found accumulated-error-messages))))
  ))




<span class = "comment"  >;;;File name components.</span>
<a name="file-name-sans-extension"></a><span class = "comment"  >;;Return the filename component sans the final extension.
;; The extension, in a file name, is the part that follows the last `.'.
;; If no dot character is found the function returns file-name</span>
<a name="file-name-sans-extension"></a><span> <span><a href="cross-reference-index-f.html#file-name-sans-extension" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from file-name-sans-extension to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(file-name-sans-extension file-name)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((extension-pos (<a href="general.html#find-in-string-from-end" title="general" style="{text-decoration: none;}"><font color="#000080">find-in-string-from-end</font></a> file-name #\.)))
    (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> extension-pos
        (<a href="../../../../r4rs/r4rs_8.htm#IDX508" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">substring</font></a> file-name 0 extension-pos)
        file-name)))

<a name="file-name-proper"></a><span class = "comment"  >;;Return the part of file-name without extension and without an initial path.
;; Works as expected even there are dots in the initial path.
;; .example (file-name-proper "/xxx/yyy/zzz.eee") = "zzz".</span>
<a name="file-name-proper"></a><span> <span><a href="cross-reference-index-f.html#file-name-proper" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from file-name-proper to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(file-name-proper file-name)</font></b>
 (<a href="../../../../r4rs/r4rs_6.htm#IDX107" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let*</b></a> ((extension-pos (<a href="general.html#find-in-string-from-end" title="general" style="{text-decoration: none;}"><font color="#000080">find-in-string-from-end</font></a> file-name #\.))
        (forward-slash-pos (<a href="general.html#find-in-string-from-end" title="general" style="{text-decoration: none;}"><font color="#000080">find-in-string-from-end</font></a> file-name #\/))
        (backward-slash-pos (<a href="general.html#find-in-string-from-end" title="general" style="{text-decoration: none;}"><font color="#000080">find-in-string-from-end</font></a> file-name #\\))
        (max-slash-pos (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_6.htm#IDX95" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>and</b></a> forward-slash-pos backward-slash-pos) (<a href="../../../../r4rs/r4rs_8.htm#IDX363" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">max</font></a> forward-slash-pos backward-slash-pos))
                             (forward-slash-pos forward-slash-pos)
                             (backward-slash-pos backward-slash-pos)
                             (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> -1)))
        (extension-pos-1 (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> (<a href="../../../../r4rs/r4rs_6.htm#IDX95" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>and</b></a> extension-pos (<a href="../../../../r4rs/r4rs_8.htm#IDX353" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&gt;</font></a> extension-pos max-slash-pos)) extension-pos #f))
      )
  (<a href="../../../../r4rs/r4rs_8.htm#IDX508" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">substring</font></a>
      file-name
      (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> max-slash-pos 1)
      (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> extension-pos-1 extension-pos-1 (<a href="../../../../r4rs/r4rs_8.htm#IDX487" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-length</font></a> file-name)))))


<a name="file-name-extension"></a><span class = "comment"  >;;Return the extension of file-name. If there is no extension, return the empty string.
;; The extension, in a file name, is the part that follows the last `.'.
;; This function handles dots in the initial path properly.</span>
<a name="file-name-extension"></a><span> <span><a href="cross-reference-index-f.html#file-name-extension" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from file-name-extension to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(file-name-extension file-name)</font></b>
 (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((extension-pos (<a href="general.html#find-in-string-from-end" title="general" style="{text-decoration: none;}"><font color="#000080">find-in-string-from-end</font></a> file-name #\.))
       (forward-slash-pos (<a href="general.html#find-in-string-from-end" title="general" style="{text-decoration: none;}"><font color="#000080">find-in-string-from-end</font></a> file-name #\/))
       (backward-slash-pos (<a href="general.html#find-in-string-from-end" title="general" style="{text-decoration: none;}"><font color="#000080">find-in-string-from-end</font></a> file-name #\\)))
  (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_6.htm#IDX95" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>and</b></a> extension-pos forward-slash-pos (<a href="../../../../r4rs/r4rs_8.htm#IDX353" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&gt;</font></a> extension-pos forward-slash-pos))
            (<a href="../../../../r4rs/r4rs_8.htm#IDX508" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">substring</font></a> file-name (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> extension-pos 1) (<a href="../../../../r4rs/r4rs_8.htm#IDX487" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-length</font></a> file-name)))
        ((<a href="../../../../r4rs/r4rs_6.htm#IDX95" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>and</b></a> extension-pos forward-slash-pos (<a href="../../../../r4rs/r4rs_8.htm#IDX354" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&lt;=</font></a> extension-pos forward-slash-pos))
            "")
        ((<a href="../../../../r4rs/r4rs_6.htm#IDX95" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>and</b></a> extension-pos backward-slash-pos (<a href="../../../../r4rs/r4rs_8.htm#IDX353" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&gt;</font></a> extension-pos backward-slash-pos))
             (<a href="../../../../r4rs/r4rs_8.htm#IDX508" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">substring</font></a> file-name (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> extension-pos 1) (<a href="../../../../r4rs/r4rs_8.htm#IDX487" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-length</font></a> file-name)))
        ((<a href="../../../../r4rs/r4rs_6.htm#IDX95" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>and</b></a> extension-pos backward-slash-pos (<a href="../../../../r4rs/r4rs_8.htm#IDX354" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&lt;=</font></a> extension-pos backward-slash-pos))
             "")
        (extension-pos (<a href="../../../../r4rs/r4rs_8.htm#IDX508" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">substring</font></a> file-name (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> extension-pos 1) (<a href="../../../../r4rs/r4rs_8.htm#IDX487" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-length</font></a> file-name)))
        (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> ""))))


<a name="file-name-initial-path"></a><span class = "comment"  >;;Return the initial path of the file-name.
;; The initial path of a file name is the prefix of the file name without the proper file name
;; and without the extension. The initial path ends in a forward of backward slash, or it is empty.</span>
<a name="file-name-initial-path"></a><span> <span><a href="cross-reference-index-f.html#file-name-initial-path" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from file-name-initial-path to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(file-name-initial-path file-name)</font></b>
 (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((extension-pos (<a href="general.html#find-in-string-from-end" title="general" style="{text-decoration: none;}"><font color="#000080">find-in-string-from-end</font></a> file-name #\.))
       (forward-slash-pos (<a href="general.html#find-in-string-from-end" title="general" style="{text-decoration: none;}"><font color="#000080">find-in-string-from-end</font></a> file-name #\/))
       (backward-slash-pos (<a href="general.html#find-in-string-from-end" title="general" style="{text-decoration: none;}"><font color="#000080">find-in-string-from-end</font></a> file-name #\\)))
  (<a href="../../../../r4rs/r4rs_8.htm#IDX508" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">substring</font></a> 
    file-name
    0
    (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_6.htm#IDX95" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>and</b></a> forward-slash-pos backward-slash-pos) (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> 1 (<a href="../../../../r4rs/r4rs_8.htm#IDX363" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">max</font></a> forward-slash-pos backward-slash-pos)))
	  (forward-slash-pos (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> 1 forward-slash-pos))
	  (backward-slash-pos (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> 1 backward-slash-pos))
	  (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> 0))
  )))

<a name="absolute-file-path?"></a><span class = "comment"  >;;Return whether x - a string - represents an absolute path to a file.</span>
<a name="absolute-file-path?"></a><span> <span><a href="cross-reference-index-a.html#absolute-file-path?" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from absolute-file-path? to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(absolute-file-path? x)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((forward-slash-pos (<a href="general.html#find-in-string" title="general" style="{text-decoration: none;}"><font color="#000080">find-in-string</font></a> x #\/))
        (backward-slash-pos (<a href="general.html#find-in-string" title="general" style="{text-decoration: none;}"><font color="#000080">find-in-string</font></a> x #\\))
        (colon-pos (<a href="general.html#find-in-string" title="general" style="{text-decoration: none;}"><font color="#000080">find-in-string</font></a> x #\:)))
     (<a href="../../../../r4rs/r4rs_6.htm#IDX96" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>or</b></a> (<a href="../../../../r4rs/r4rs_6.htm#IDX95" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>and</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX340" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">number?</font></a> forward-slash-pos) (<a href="../../../../r4rs/r4rs_8.htm#IDX351" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">=</font></a> 0 forward-slash-pos))
         (<a href="../../../../r4rs/r4rs_6.htm#IDX95" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>and</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX340" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">number?</font></a> colon-pos) (<a href="../../../../r4rs/r4rs_8.htm#IDX351" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">=</font></a> 1 colon-pos)))))

<a name="parent-directory"></a><span class = "comment"  >;;Return the name of the parent directory of dir (a string), or #f if dir is the root directory.</span>
<a name="parent-directory"></a><span> <span><a href="cross-reference-index-p.html#parent-directory" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from parent-directory to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(parent-directory dir)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#IDX107" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let*</b></a> ((dir1 (<a href="general.html#ensure-final-character" title="general" style="{text-decoration: none;}"><font color="#000080">ensure-final-character</font></a> dir #\/))
         (lgt (<a href="../../../../r4rs/r4rs_8.htm#IDX487" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-length</font></a> dir1))
         (dir2 (<a href="../../../../r4rs/r4rs_8.htm#IDX508" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">substring</font></a> dir1 0 (<a href="../../../../r4rs/r4rs_8.htm#IDX363" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">max</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX369" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">-</font></a> lgt 1) 0)))  <span class = "comment"  >;dir without ending slash</span>
         (forward-slash-pos (<a href="general.html#find-in-string-from-end" title="general" style="{text-decoration: none;}"><font color="#000080">find-in-string-from-end</font></a> dir2 #\/))
         (backward-slash-pos (<a href="general.html#find-in-string-from-end" title="general" style="{text-decoration: none;}"><font color="#000080">find-in-string-from-end</font></a> dir2 #\\)))
   (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_6.htm#IDX95" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>and</b></a> forward-slash-pos backward-slash-pos (<a href="../../../../r4rs/r4rs_8.htm#IDX355" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&gt;=</font></a> forward-slash-pos backward-slash-pos))
             (<a href="../../../../r4rs/r4rs_8.htm#IDX508" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">substring</font></a> dir2 0 (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> 1 forward-slash-pos)))
         ((<a href="../../../../r4rs/r4rs_6.htm#IDX95" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>and</b></a> forward-slash-pos backward-slash-pos (<a href="../../../../r4rs/r4rs_8.htm#IDX355" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&gt;=</font></a> backward-slash-pos forward-slash-pos))
             (<a href="../../../../r4rs/r4rs_8.htm#IDX508" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">substring</font></a> dir2 0 (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> 1 backward-slash-pos)))
         (forward-slash-pos
             (<a href="../../../../r4rs/r4rs_8.htm#IDX508" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">substring</font></a> dir2 0 (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> 1 forward-slash-pos)))
         (backward-slash-pos
             (<a href="../../../../r4rs/r4rs_8.htm#IDX508" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">substring</font></a> dir2 0 (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> 1 backward-slash-pos)))
         (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> #f))))         

<a name="directory-level-difference"></a><span class = "comment"  >;;Return the number of directory levels in between dir1 and dir2.
;; If dir1 is not a subdirectory of dir2, or dir2 is not a subdirectory of dir1 return #f.
;; .example (directory-level-difference "/x/x/z/v/" "/x/x/") = 2
;; .example (directory-level-difference "/x/x/" "/x/x/z/v/") = -2</span>
<a name="directory-level-difference"></a><span> <span><a href="cross-reference-index-d.html#directory-level-difference" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from directory-level-difference to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(directory-level-difference dir1 dir2)</font></b>
 (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((dir1-lc (<a href="general.html#downcase-string" title="general" style="{text-decoration: none;}"><font color="#000080">downcase-string</font></a> dir1))
       (dir2-lc (<a href="general.html#downcase-string" title="general" style="{text-decoration: none;}"><font color="#000080">downcase-string</font></a> dir2)))
  (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((res1 (<a href="general.html#directory-level-difference-1" title="general" style="{text-decoration: none;}"><font color="#000080">directory-level-difference-1</font></a> dir1-lc dir2-lc 0))
        (res2 (<a href="general.html#directory-level-difference-1" title="general" style="{text-decoration: none;}"><font color="#000080">directory-level-difference-1</font></a> dir2-lc dir1-lc 0)))
    (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_6.htm#IDX95" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>and</b></a> res1 (<a href="../../../../r4rs/r4rs_8.htm#IDX340" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">number?</font></a> res1)) res1)
          ((<a href="../../../../r4rs/r4rs_6.htm#IDX95" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>and</b></a> res2 (<a href="../../../../r4rs/r4rs_8.htm#IDX340" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">number?</font></a> res2)) (<a href="../../../../r4rs/r4rs_8.htm#IDX369" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">-</font></a> res2))
          (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> #f)))))

<a name="directory-level-difference-1"></a><span> <span><a href="cross-reference-index-d.html#directory-level-difference-1" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from directory-level-difference-1 to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(directory-level-difference-1 dir1 dir2 n)</font></b>
 (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((parent-dir-1 (<a href="general.html#parent-directory" title="general" style="{text-decoration: none;}"><font color="#000080">parent-directory</font></a> dir1)))
   (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_6.htm#IDX95" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>and</b></a> dir1 dir2 (<a href="../../../../r4rs/r4rs_8.htm#IDX220" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">equal?</font></a> dir1 dir2)) n)
         ((<a href="../../../../r4rs/r4rs_6.htm#IDX95" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>and</b></a> parent-dir-1 (<a href="../../../../r4rs/r4rs_8.htm#IDX482" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string?</font></a> parent-dir-1)) (<a href="general.html#directory-level-difference-1" title="general" style="{text-decoration: none;}"><font color="#000080">directory-level-difference-1</font></a> parent-dir-1 dir2 (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> n 1)))
         ((<a href="../../../../r4rs/r4rs_8.htm#IDX177" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">not</font></a> parent-dir-1) #f))))

<a name="relative-path-to-path-list"></a><span class = "comment"  >;;Given a relative file path, return a list of path constituents.
;; A relative file path is not allowed to start with a slash.
;; This function does only support forward slashes.
;; .example (relative-path-to-path-list "xxx/yyy/zzz/") = ("xxx" "yyy" "zzz")
;; .example (relative-path-to-path-list "xxx/yyy/zzz") = ("xxx" "yyy" "zzz")
;; .example (relative-path-to-path-list "xxx") = ("xxx")</span>
<a name="relative-path-to-path-list"></a><span> <span><a href="cross-reference-index-r.html#relative-path-to-path-list" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from relative-path-to-path-list to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(relative-path-to-path-list dir)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#IDX107" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let*</b></a> ((dir1 (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX185" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">eqv?</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX488" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-ref</font></a> dir (<a href="../../../../r4rs/r4rs_8.htm#IDX369" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">-</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX487" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-length</font></a> dir) 1)) #\/)
                   (<a href="../../../../r4rs/r4rs_8.htm#IDX508" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">substring</font></a> dir 0 (<a href="../../../../r4rs/r4rs_8.htm#IDX369" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">-</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX487" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-length</font></a> dir) 1))
                   dir))  <span class = "comment"  >;no trailing slash</span>
         (lgt (<a href="../../../../r4rs/r4rs_8.htm#IDX487" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-length</font></a> dir1))
         (forward-slash-pos (<a href="general.html#find-in-string" title="general" style="{text-decoration: none;}"><font color="#000080">find-in-string</font></a> dir1 #\/)))
    (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> forward-slash-pos
        (<a href="../../../../r4rs/r4rs_8.htm#IDX245" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cons</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX508" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">substring</font></a> dir1 0 forward-slash-pos)
              (<a href="general.html#relative-path-to-path-list" title="general" style="{text-decoration: none;}"><font color="#000080">relative-path-to-path-list</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX508" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">substring</font></a> dir1 (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> 1 forward-slash-pos) lgt)))
        (<a href="../../../../r4rs/r4rs_8.htm#IDX265" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">list</font></a> dir1))))

<a name="ensure-directory-existence!"></a><span class = "comment"  >;;Ensure that the directory with path (string-append prefix-dir file-and-ext) exists.
;; If necessary, create dir in prefix-dir.</span>
<a name="ensure-directory-existence!"></a><span> <span><a href="cross-reference-index-e.html#ensure-directory-existence!" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from ensure-directory-existence! to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(ensure-directory-existence! prefix-dir dir)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX177" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">not</font></a> (directory-exists? (<a href="../../../../r4rs/r4rs_8.htm#IDX510" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-append</font></a> prefix-dir dir)))
      (make-directory-in-directory prefix-dir dir)))

<a name="ensure-directory-path-existence!"></a><span class = "comment"  >;;Ensure that the relative path, as represented by dir, exists in prefix-dir.
;; Creates the necessary directories in prefix-dir.</span>
<a name="ensure-directory-path-existence!"></a><span> <span><a href="cross-reference-index-e.html#ensure-directory-path-existence!" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from ensure-directory-path-existence! to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(ensure-directory-path-existence! prefix-dir dir)</font></b>
 (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((path-list (<a href="general.html#relative-path-to-path-list" title="general" style="{text-decoration: none;}"><font color="#000080">relative-path-to-path-list</font></a> dir)))
   (<a href="general.html#ensure-directory-path-existence-1!" title="general" style="{text-decoration: none;}"><font color="#000080">ensure-directory-path-existence-1!</font></a> prefix-dir path-list)))

<a name="ensure-directory-path-existence-1!"></a><span> <span><a href="cross-reference-index-e.html#ensure-directory-path-existence-1!" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from ensure-directory-path-existence-1! to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(ensure-directory-path-existence-1! prefix-dir path-list)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX177" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">not</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> path-list))
      (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((first-path (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> path-list)))
         (<a href="general.html#ensure-directory-existence!" title="general" style="{text-decoration: none;}"><font color="#000080">ensure-directory-existence!</font></a> prefix-dir first-path)
         (<a href="general.html#ensure-directory-path-existence-1!" title="general" style="{text-decoration: none;}"><font color="#000080">ensure-directory-path-existence-1!</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX510" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-append</font></a> prefix-dir first-path "/") (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> path-list)))))

<a name="ensure-non-existing-file-in-dir"></a><span class = "comment"  >;;Ensure that the file f (proper name and extension) is non-existing in the directory d.
;; If not, add a numeric suffix to the proper name of f.
;; Return the possibly modified file name (proper name and extension).</span>
<a name="ensure-non-existing-file-in-dir"></a><span> <span><a href="cross-reference-index-e.html#ensure-non-existing-file-in-dir" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from ensure-non-existing-file-in-dir to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(ensure-non-existing-file-in-dir f d)</font></b>
 (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX177" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">not</font></a> (file-exists? (<a href="../../../../r4rs/r4rs_8.htm#IDX510" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-append</font></a> d f)))
     f
     (<a href="general.html#ensure-non-existing-file-in-dir-1" title="general" style="{text-decoration: none;}"><font color="#000080">ensure-non-existing-file-in-dir-1</font></a> f d 1)))

<a name="ensure-non-existing-file-in-dir-1"></a><span> <span><a href="cross-reference-index-e.html#ensure-non-existing-file-in-dir-1" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from ensure-non-existing-file-in-dir-1 to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(ensure-non-existing-file-in-dir-1 f d i)</font></b>
 (<a href="../../../../r4rs/r4rs_6.htm#IDX107" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let*</b></a> ((pf (<a href="general.html#file-name-proper" title="general" style="{text-decoration: none;}"><font color="#000080">file-name-proper</font></a> f))
        (ef (<a href="general.html#file-name-extension" title="general" style="{text-decoration: none;}"><font color="#000080">file-name-extension</font></a> f))
        (nm (<a href="../../../../r4rs/r4rs_8.htm#IDX510" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-append</font></a> pf "-" (<a href="general.html#as-string" title="general" style="{text-decoration: none;}"><font color="#000080">as-string</font></a> i) "." ef))
        (path (<a href="../../../../r4rs/r4rs_8.htm#IDX510" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-append</font></a> d nm))
      )
 (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX177" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">not</font></a> (file-exists? path))
     nm
     (<a href="general.html#ensure-non-existing-file-in-dir-1" title="general" style="{text-decoration: none;}"><font color="#000080">ensure-non-existing-file-in-dir-1</font></a> f d (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> i 1)))))

<a name="normalize-relative-file-path"></a><span class = "comment"  >;;Normalize the relative file path, path, for redundant .. levels.</span>
<a name="normalize-relative-file-path"></a><span> <span><a href="cross-reference-index-n.html#normalize-relative-file-path" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from normalize-relative-file-path to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(normalize-relative-file-path path)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#IDX107" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let*</b></a> ((path-list (<a href="general.html#relative-path-to-path-list" title="general" style="{text-decoration: none;}"><font color="#000080">relative-path-to-path-list</font></a> path))
         (reverse-path-list (reverse path-list))
        )
    (<a href="general.html#list-to-string" title="general" style="{text-decoration: none;}"><font color="#000080">list-to-string</font></a> (reverse (<a href="general.html#normalize-relative-file-path-1" title="general" style="{text-decoration: none;}"><font color="#000080">normalize-relative-file-path-1</font></a> reverse-path-list 0)) "/")))

<a name="normalize-relative-file-path-1"></a><span> <span><a href="cross-reference-index-n.html#normalize-relative-file-path-1" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from normalize-relative-file-path-1 to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(normalize-relative-file-path-1 rev-path-list n)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_6.htm#IDX95" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>and</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> rev-path-list) (<a href="../../../../r4rs/r4rs_8.htm#IDX353" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&gt;</font></a> n 0)) (<a href="general.html#laml-error" title="general" style="{text-decoration: none;}"><font color="#000080">laml-error</font></a> "Cannot normlize path"))
        ((<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> rev-path-list) '())
        ((<a href="../../../../r4rs/r4rs_8.htm#IDX220" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">equal?</font></a> ".." (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> rev-path-list)) 
            (<a href="general.html#normalize-relative-file-path-1" title="general" style="{text-decoration: none;}"><font color="#000080">normalize-relative-file-path-1</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> rev-path-list) (<a href="../../../../r4rs/r4rs_8.htm#IDX367" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">+</font></a> n 1)))
        ((<a href="../../../../r4rs/r4rs_8.htm#IDX353" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&gt;</font></a> n 0) (<a href="general.html#normalize-relative-file-path-1" title="general" style="{text-decoration: none;}"><font color="#000080">normalize-relative-file-path-1</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> rev-path-list) (<a href="../../../../r4rs/r4rs_8.htm#IDX369" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">-</font></a> n 1)))
        (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX245" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cons</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> rev-path-list) (<a href="general.html#normalize-relative-file-path-1" title="general" style="{text-decoration: none;}"><font color="#000080">normalize-relative-file-path-1</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> rev-path-list) n)))))


<span class = "comment"  >;;;Other functions. 
;;; Here follows a set of miscellaneous functions.</span>
<a name="re-break"></a><span class = "comment"  >;;A quite special HTML line breaking function.
;; Html format str, either with br og p tags between lines.
;; depends on break-at-all from decoding stuff. 
;; Should perhaps be in the convenience library???</span>
<a name="re-break"></a><span> <span><a href="cross-reference-index-r.html#re-break" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from re-break to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(re-break str)</font></b>
 (<a href="../../../../r4rs/r4rs_6.htm#IDX112" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>letrec</b></a> ((line-breaker (break-at-all #\newline)))  <span class = "comment"  >;from decoding stuff</span>
  (<a href="../../../../r4rs/r4rs_6.htm#IDX107" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let*</b></a> ((lines (line-breaker str))
         (line-lengths (<a href="../../../../r4rs/r4rs_8.htm#IDX542" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">map</font></a> <a href="../../../../r4rs/r4rs_8.htm#IDX487" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-length</font></a> lines))
         (max-line-length (<a href="general.html#max-int-list" title="general" style="{text-decoration: none;}"><font color="#000080">max-int-list</font></a> line-lengths)))
   (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX353" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&gt;</font></a> max-line-length 120)
       (<a href="../../../../r4rs/r4rs_8.htm#IDX540" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">apply</font></a> <a href="../../../../r4rs/r4rs_8.htm#IDX510" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-append</font></a> 
          (<a href="../../../../r4rs/r4rs_8.htm#IDX542" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">map</font></a> (<a href="../../../../r4rs/r4rs_6.htm#SEC30" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>lambda</b></a> (ln) (<a href="../../../../r4rs/r4rs_8.htm#IDX510" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-append</font></a> ln "&lt;p&gt;")) lines))
       (<a href="../../../../r4rs/r4rs_8.htm#IDX540" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">apply</font></a> <a href="../../../../r4rs/r4rs_8.htm#IDX510" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-append</font></a> 
          (<a href="../../../../r4rs/r4rs_8.htm#IDX542" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">map</font></a> (<a href="../../../../r4rs/r4rs_6.htm#SEC30" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>lambda</b></a> (ln) (<a href="../../../../r4rs/r4rs_8.htm#IDX510" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-append</font></a> ln "&lt;br&gt;")) lines))))))

<a name="max-int-list"></a><span> <span><a href="cross-reference-index-m.html#max-int-list" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from max-int-list to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(max-int-list lst)</font></b>
 (<a href="general.html#max-int-list-help" title="general" style="{text-decoration: none;}"><font color="#000080">max-int-list-help</font></a> lst 0))
 
<a name="max-int-list-help"></a><span> <span><a href="cross-reference-index-m.html#max-int-list-help" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from max-int-list-help to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(max-int-list-help lst res)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX261" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">null?</font></a> lst) 
      res
      (<a href="general.html#max-int-list-help" title="general" style="{text-decoration: none;}"><font color="#000080">max-int-list-help</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX249" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cdr</font></a> lst) (<a href="../../../../r4rs/r4rs_8.htm#IDX363" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">max</font></a> res (<a href="../../../../r4rs/r4rs_8.htm#IDX247" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">car</font></a> lst)))))


<a name="cr"></a><span class = "comment"  >;;Return a CR string</span>
<a name="cr"></a><span> <span><a href="cross-reference-index-c.html#cr" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from cr to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >cr</font></b> (<a href="general.html#as-string" title="general" style="{text-decoration: none;}"><font color="#000080">as-string</font></a> #\newline))

<a name="newline-string"></a><span class = "comment"  >;;Return a CR string.
;; Please notice that there is a conflict between this function and the MzScheme url.ss net stuff.
;; (We should get rid of this function in LAML).</span>
<a name="newline-string"></a><span> <span><a href="cross-reference-index-n.html#newline-string" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from newline-string to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(newline-string)</font></b>
  (<a href="general.html#as-string" title="general" style="{text-decoration: none;}"><font color="#000080">as-string</font></a> #\newline))


<span class = "comment"  >;Functions earlier in the cgi library</span>
<a name="save-a-list"></a><span class = "comment"  >;;Save the alist on a file named filename. Filename is assumed to be a full path to the file.</span>
<a name="save-a-list"></a><span> <span><a href="cross-reference-index-s.html#save-a-list" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from save-a-list to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(save-a-list alist filename)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> (file-exists? filename)   <span class = "comment"  >;new 31.3.2000</span>
       (delete-file filename))
  (<a href="../../../../r4rs/r4rs_8.htm#IDX588" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">with-output-to-file</font></a> filename
     (<a href="../../../../r4rs/r4rs_6.htm#SEC30" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>lambda</b></a> () (<a href="../../../../r4rs/r4rs_8.htm#IDX626" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">write</font></a> alist))))

<a name="unique-timed-file-name"></a><span class = "comment"  >;;Return a unique file name with prefix. The suffic becomes the current-time i seconds representation</span>
<a name="unique-timed-file-name"></a><span> <span><a href="cross-reference-index-u.html#unique-timed-file-name" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from unique-timed-file-name to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(unique-timed-file-name prefix)</font></b>
  (<a href="../../../../r4rs/r4rs_8.htm#IDX510" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-append</font></a> prefix (<a href="../../../../r4rs/r4rs_8.htm#IDX439" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">number-&gt;string</font></a> (current-time))))

<a name="file-append"></a><span class = "comment"  >;;Append x to file-name. The file is assumed to contain a Lisp list. x is added (actually pre-pended) to the list on the file,
;; and the file is written back. The ordering of the elements in the file list is not assumed to be important.
;; As a precondition, the file named file-name is assumed to exists.</span>
<a name="file-append"></a><span> <span><a href="cross-reference-index-f.html#file-append" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from file-append to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(file-append file-name x)</font></b>
 (<a href="../../../../r4rs/r4rs_6.htm#IDX107" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let*</b></a> ((port (<a href="../../../../r4rs/r4rs_8.htm#IDX595" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">open-input-file</font></a> file-name))
        (contents (<a href="../../../../r4rs/r4rs_8.htm#IDX599" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">read</font></a> port))
        (new-contents (<a href="../../../../r4rs/r4rs_8.htm#IDX267" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">append</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX265" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">list</font></a> x) contents)))
  (<a href="../../../../r4rs/r4rs_8.htm#IDX597" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">close-input-port</font></a> port)
  (delete-file file-name)  <span class = "comment"  >;new!</span>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((output-port (<a href="../../../../r4rs/r4rs_8.htm#IDX596" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">open-output-file</font></a> file-name)))
    (<a href="../../../../r4rs/r4rs_8.htm#IDX626" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">write</font></a> new-contents output-port)
    (<a href="../../../../r4rs/r4rs_8.htm#IDX598" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">close-output-port</font></a> output-port))))

<a name="file-read"></a><span class = "comment"  >;;redefinition of file-read from general. A more general version.
;; Read the first Lisp expression from file-name.
;; With an optional second parameter, read form number n from file.
;; .form (file-read file-name [n])
;; .pre-condition Assume that there are at least n forms on file</span>
<a name="file-read"></a><span> <span><a href="cross-reference-index-f.html#file-read" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from file-read to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(file-read file-name . optional-parameter-list)</font></b>
 (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((n (optional-parameter 1 optional-parameter-list 1))
       (port (<a href="../../../../r4rs/r4rs_8.htm#IDX595" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">open-input-file</font></a> file-name))
      )
   <span class = "comment"  >;read n-1 forms</span>
   (<a href="../../../../r4rs/r4rs_8.htm#IDX544" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">for-each</font></a> (<a href="../../../../r4rs/r4rs_6.htm#SEC30" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>lambda</b></a> (n)  (<a href="../../../../r4rs/r4rs_8.htm#IDX599" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">read</font></a> port)) (<a href="general.html#number-interval" title="general" style="{text-decoration: none;}"><font color="#000080">number-interval</font></a> 1 (<a href="../../../../r4rs/r4rs_8.htm#IDX369" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">-</font></a> n 1)))

   (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((contents (<a href="../../../../r4rs/r4rs_8.htm#IDX599" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">read</font></a> port)))
     (<a href="../../../../r4rs/r4rs_8.htm#IDX597" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">close-input-port</font></a> port)
     contents)))

<a name="file-read-all"></a><span class = "comment"  >;;Read all Lisp expression from file-name.
;; This function returns these forms as a list of top level forms from the file.</span>
<a name="file-read-all"></a><span> <span><a href="cross-reference-index-f.html#file-read-all" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from file-read-all to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(file-read-all file-name)</font></b>
 (<a href="../../../../r4rs/r4rs_6.htm#IDX107" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let*</b></a> ((port (<a href="../../../../r4rs/r4rs_8.htm#IDX595" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">open-input-file</font></a> file-name))
        (contents (<a href="general.html#file-read-all-1" title="general" style="{text-decoration: none;}"><font color="#000080">file-read-all-1</font></a> port '())))
   (<a href="../../../../r4rs/r4rs_8.htm#IDX597" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">close-input-port</font></a> port)
   (reverse contents)))

<a name="file-read-all-1"></a><span> <span><a href="cross-reference-index-f.html#file-read-all-1" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from file-read-all-1 to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(file-read-all-1 port res)</font></b>
 (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((form (<a href="../../../../r4rs/r4rs_8.htm#IDX599" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">read</font></a> port)))
   (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX616" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">eof-object?</font></a> form)
       res
       (<a href="general.html#file-read-all-1" title="general" style="{text-decoration: none;}"><font color="#000080">file-read-all-1</font></a> port (<a href="../../../../r4rs/r4rs_8.htm#IDX245" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">cons</font></a> form res)))))

<a name="file-write"></a><span class = "comment"  >;;Write the list expression x to the file named file-name. 
;; The writing is done using the Scheme write function.
;; .parameter x An arbitrary value that can be written with write.
;; .parameter filename The name of the file (a string).</span>
<a name="file-write"></a><span> <span><a href="cross-reference-index-f.html#file-write" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from file-write to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(file-write x file-name)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> (file-exists? file-name) (delete-file file-name))
  (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((output-port (<a href="../../../../r4rs/r4rs_8.htm#IDX596" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">open-output-file</font></a> file-name)))
    (<a href="../../../../r4rs/r4rs_8.htm#IDX626" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">write</font></a> x output-port)
    (<a href="../../../../r4rs/r4rs_8.htm#IDX598" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">close-output-port</font></a> output-port)))

<a name="save-on-file"></a><span class = "comment"  >;;Displays the first parameter x on a file named filename.
;; This is a minor convenience function, and an alternative to using the standard Scheme output functions.
;; .parameter x The string to be written.
;; .parameter filename The name of the file (a string).</span>
<a name="save-on-file"></a><span> <span><a href="cross-reference-index-s.html#save-on-file" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from save-on-file to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(save-on-file x filename)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> (file-exists? filename) 
       (delete-file filename))
  (<a href="../../../../r4rs/r4rs_8.htm#IDX588" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">with-output-to-file</font></a> filename
     (<a href="../../../../r4rs/r4rs_6.htm#SEC30" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>lambda</b></a> () (<a href="../../../../r4rs/r4rs_8.htm#IDX630" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">display</font></a> x))))


<a name="id-1"></a><span class = "comment"  >;;The identify function of one parameter</span>
<a name="id-1"></a><span> <span><a href="cross-reference-index-i.html#id-1" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from id-1 to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(id-1 x)</font></b> x)




<a name="multiplum-of"></a><span class = "comment"  >;;Is a (the first par) a multiplum of b (the last par)?</span>
<a name="multiplum-of"></a><span> <span><a href="cross-reference-index-m.html#multiplum-of" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from multiplum-of to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> <a href="documentation.html#sublist-by-columns" target="documentation-frame"><img src="./images/doc-left.gif" alt="3.3. A more general solution" border="0"/></a></span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(multiplum-of a b)</font></b>
  (<a href="../../../../r4rs/r4rs_8.htm#IDX351" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">=</font></a> 0 (<a href="../../../../r4rs/r4rs_8.htm#IDX379" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">remainder</font></a> a b)))



<a name="copy-text-file"></a><span class = "comment"  >;;Copy the text file in from-path to the file in to-path. 
;; A quick and dirty solution by reading and writing strings to and from files.
;; If the destination file exists you must pass a third parameter, overwrite, with the value #t</span>
<a name="copy-text-file"></a><span> <span><a href="cross-reference-index-c.html#copy-text-file" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from copy-text-file to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(copy-text-file from-path to-path overwrite?)</font></b>
  (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> (<a href="../../../../r4rs/r4rs_6.htm#IDX95" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>and</b></a> (file-exists? to-path) overwrite?) (delete-file to-path))
  (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((contents (<a href="file-read.html#read-text-file" title="file-read" style="{text-decoration: none;}"><font color="#000080">read-text-file</font></a> from-path)))
    (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX177" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">not</font></a> (file-exists? to-path))
        (<a href="file-read.html#write-text-file" title="file-read" style="{text-decoration: none;}"><font color="#000080">write-text-file</font></a> contents to-path)
        (error (<a href="../../../../r4rs/r4rs_8.htm#IDX510" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-append</font></a> "copy-a-file: Overwriting an existing file requires a third overwrite #t parameter: " to-path)))))


<a name="copy-files"></a><span class = "comment"  >;;Copy each of the files in the list files from source-dir to target-dir.
;; Both source-dir and target-dir ends in a slash.
;; If the optional boolean parameter warn-if-non-existing-source is #t a non-fatal warning is issued
;; if the source file does not exist. The the boolean parameter is #f, a fatal error will occur.
;; .form (copy-files files source-dir target-dir [warn-if-non-existing-source])</span>
<a name="copy-files"></a><span> <span><a href="cross-reference-index-c.html#copy-files" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from copy-files to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(copy-files files source-dir target-dir . optional-parameter-list)</font></b>
 (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((warn-if-non-existing-source (optional-parameter 1 optional-parameter-list #f)))
  (<a href="../../../../r4rs/r4rs_6.htm#IDX112" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>letrec</b></a> ((copy-a-file 
            (<a href="../../../../r4rs/r4rs_6.htm#SEC30" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>lambda</b></a> (f)
             (<a href="../../../../r4rs/r4rs_6.htm#SEC35" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>let</b></a> ((target-file (<a href="../../../../r4rs/r4rs_8.htm#IDX510" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-append</font></a> target-dir f))
                   (source-file (<a href="../../../../r4rs/r4rs_8.htm#IDX510" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-append</font></a> source-dir f))
                  )
               (<a href="../../../../r4rs/r4rs_6.htm#SEC31" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>if</b></a> (<a href="../../../../r4rs/r4rs_6.htm#IDX95" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>and</b></a> (file-exists? target-file) (file-exists? source-file)) (delete-file target-file))
               (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((file-exists? source-file) (copy-file source-file target-file))
                     (warn-if-non-existing-source (<a href="general.html#display-warning" title="general" style="{text-decoration: none;}"><font color="#000080">display-warning</font></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX510" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">string-append</font></a> "Could not copy the file " source-file)))
                     (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> (<a href="general.html#laml-error" title="general" style="{text-decoration: none;}"><font color="#000080">laml-error</font></a> "copy-file: Source does not exist:" source-file)))))))
   (<a href="../../../../r4rs/r4rs_8.htm#IDX544" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">for-each</font></a> copy-a-file files))))


<a name="min-max-limited"></a><span class = "comment"  >;;Ensure that the number x is in between min and max, or that min or max is returned.
;; More specifically, if x is not between min and max, the closest of min and max is returned.
;; .precondition min &lt;= max</span>
<a name="min-max-limited"></a><span> <span><a href="cross-reference-index-m.html#min-max-limited" target="control-frame"><img src="./images/small-green-up-triangle.gif" alt="In general: Link from min-max-limited to it&#39;s cross reference table entry" border="0"/></a> &nbsp;</span> </span><br/>(<a href="../../../../r4rs/r4rs_7.htm#SEC42" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>define</b></a> <b><font color = "#ff0000"  >(min-max-limited x min max)</font></b>
 (<a href="../../../../r4rs/r4rs_6.htm#SEC34" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>cond</b></a> ((<a href="../../../../r4rs/r4rs_8.htm#IDX352" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&lt;</font></a> x <a href="../../../../r4rs/r4rs_8.htm#IDX364" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">min</font></a>) <a href="../../../../r4rs/r4rs_8.htm#IDX364" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">min</font></a>)
        ((<a href="../../../../r4rs/r4rs_6.htm#IDX95" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>and</b></a> (<a href="../../../../r4rs/r4rs_8.htm#IDX354" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&lt;=</font></a> <a href="../../../../r4rs/r4rs_8.htm#IDX364" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">min</font></a> x) (<a href="../../../../r4rs/r4rs_8.htm#IDX354" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&lt;=</font></a> x <a href="../../../../r4rs/r4rs_8.htm#IDX363" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">max</font></a>)) x)
        ((<a href="../../../../r4rs/r4rs_8.htm#IDX353" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">&gt;</font></a> x <a href="../../../../r4rs/r4rs_8.htm#IDX363" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">max</font></a>) <a href="../../../../r4rs/r4rs_8.htm#IDX363" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">max</font></a>)
        (<a href="../../../../r4rs/r4rs_6.htm#IDX82" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><b>else</b></a> (<a href="general.html#laml-error" title="general" style="{text-decoration: none;}"><font color="#000080">laml-error</font></a> "min-max-limited: Should not happen!" x <a href="../../../../r4rs/r4rs_8.htm#IDX364" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">min</font></a> <a href="../../../../r4rs/r4rs_8.htm#IDX363" style="{text-decoration: none;}" target="documentation-frame" title="R4RS Scheme form"><font color="#a64700">max</font></a>))))
    
</pre></font><div>&nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p></div></body></html>