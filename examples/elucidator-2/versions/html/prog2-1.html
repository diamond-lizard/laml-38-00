<html><head><link href="stylesheets/program.css" rel="stylesheet" title="program" type="text/css" /> <title>Source file</title></head><body bgcolor="#ddffdd" text="#000000" link="#000000" vlink="#000000" style="background:#ddffdd;background-position:top right;background-repeat:no-repeat;background-attachment:fixed;background-image:url(&#39;images/vers-1-2.gif&#39;);"><span><img src="./images/gray-left-arrow-large-blank.gif" title="" alt="" border="0" /> &nbsp; <a href="prog2-2.html"><img src="./images/gray-right-arrow-large.gif" title="The next version (2)" alt="" border="0" /></a></span><font size="2"><pre><a name="zip"></a><div class="schemedoc-definition-comment">;; Zip the two lists lst1 and lst2 by means of z.</div><a name="zip"></a><span><span><a href="prog2-1-LARGE.html#zip"><img src="./images/small-square.gif" title="Show source file in large font" alt="" border="0" /></a></span> <span><a href="cross-reference-index.html#zip" target="control-frame"><img src="./images/small-green-up-triangle.gif" title="In prog2: Link from zip to it&#39;s cross reference table entry" alt="" border="0" /></a></span> <a href="documentation.html#composing" target="documentation-frame"><img src="./images/doc-left.gif" title="3.2. Function composition" alt="" border="0" /></a> <a href="documentation.html#evol1" target="documentation-frame"><img src="./images/doc-left.gif" title="5.1. How the program evolved..." alt="" border="0" /></a> <span><img src="./images/no-pass-sign.gif" title="Dead End - Not in next version (2)" alt="" border="0" /></span> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" target="documentation-frame" title="R5RS Scheme form">define</a> <span class="signature">(zip z lst1 lst2)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" target="documentation-frame" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" target="documentation-frame" title="R5RS Scheme form">null?</a> lst1)
      '()
      (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" target="documentation-frame" title="R5RS Scheme form">cons</a> 
        (z (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" target="documentation-frame" title="R5RS Scheme form">car</a> lst1) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" target="documentation-frame" title="R5RS Scheme form">car</a> lst2))
        (<a class="applied-name" href="prog2-1.html#zip" title="prog2, version 1">zip</a> z (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" target="documentation-frame" title="R5RS Scheme form">cdr</a> lst1) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" target="documentation-frame" title="R5RS Scheme form">cdr</a> lst2)))))

<a name="compose"></a><div class="schemedoc-definition-comment">;; Compose a list of functions to a single function.
;; Each function in the list takes a single parameter.
;; Handles the typical case of two functions manually to achieve
;; better efficiency.
;; .precondition f-list is a proper list of length ast least one.</div><a name="compose"></a><span><span><a href="prog2-1-LARGE.html#compose"><img src="./images/small-square.gif" title="Show source file in large font" alt="" border="0" /></a></span> <span><a href="cross-reference-index.html#compose" target="control-frame"><img src="./images/small-green-up-triangle.gif" title="In prog2: Link from compose to it&#39;s cross reference table entry" alt="" border="0" /></a></span> <a href="documentation.html#composing" target="documentation-frame"><img src="./images/doc-left.gif" title="3.2. Function composition" alt="" border="0" /></a> <a href="documentation.html#evol1" target="documentation-frame"><img src="./images/doc-left-point.gif" title="5.1. How the program evolved..." alt="" border="0" /></a> <a href="documentation.html#to-do" target="documentation-frame"><img src="./images/doc-left.gif" title="5.2. Still work to do" alt="" border="0" /></a> <span><img src="./images/no-pass-sign.gif" title="Dead End - Not in next version (2)" alt="" border="0" /></span> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" target="documentation-frame" title="R5RS Scheme form">define</a> <span class="signature">(compose . f-list)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" target="documentation-frame" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX235" target="documentation-frame" title="R5RS Scheme form">=</a> 1 (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX333" target="documentation-frame" title="R5RS Scheme form">length</a> f-list)) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" target="documentation-frame" title="R5RS Scheme form">car</a> f-list)) <span class="comment">; <span><a name="compose-@b"></a> <a href="documentation.html#composing-@b" target="documentation-frame"><img src="./images/source-mark-green.gif" title="A linked program source marker to section 3.2:
&#39;Function composition&#39;
Mark char: b" alt="" border="0" /></a></span></span><br />        ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX235" target="documentation-frame" title="R5RS Scheme form">=</a> 2 (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX333" target="documentation-frame" title="R5RS Scheme form">length</a> f-list)) <span class="comment">; <span><a name="compose-@c"></a> <a href="documentation.html#composing-@c" target="documentation-frame"><img src="./images/source-mark-blue.gif" title="A linked program source marker to section 3.2:
&#39;Function composition&#39;
Mark char: c" alt="" border="0" /></a></span></span><br />	 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" target="documentation-frame" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">f</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" target="documentation-frame" title="R5RS Scheme form">car</a> f-list)) 
	       (<span class="local-name-binding">g</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" target="documentation-frame" title="R5RS Scheme form">cadr</a> f-list)))
	   (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" target="documentation-frame" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">x</span>) (f (g x)))))
        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" target="documentation-frame" title="R5RS Scheme form">else</a>  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" target="documentation-frame" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">x</span>)     <span class="comment">; <span><a name="compose-@d"></a> <a href="documentation.html#composing-@d" target="documentation-frame"><img src="./images/source-mark-black.gif" title="A linked program source marker to section 3.2:
&#39;Function composition&#39;
Mark char: d" alt="" border="0" /></a></span></span><br />		 ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" target="documentation-frame" title="R5RS Scheme form">car</a> f-list)
		  ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX411" target="documentation-frame" title="R5RS Scheme form">apply</a> <a class="applied-name" href="prog2-1.html#compose" title="prog2, version 1">compose</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" target="documentation-frame" title="R5RS Scheme form">cdr</a> f-list)) x))))))

<a name="filter"></a><div class="schemedoc-definition-comment">;; Filter lst by pred.</div><a name="filter"></a><span><span><a href="prog2-1-LARGE.html#filter"><img src="./images/small-square.gif" title="Show source file in large font" alt="" border="0" /></a></span> <span><a href="cross-reference-index.html#filter" target="control-frame"><img src="./images/small-green-up-triangle.gif" title="In prog2: Link from filter to it&#39;s cross reference table entry" alt="" border="0" /></a></span> <a href="documentation.html#filtering" target="documentation-frame"><img src="./images/doc-left.gif" title="3.1. Filtering" alt="" border="0" /></a> <a href="documentation.html#evol1" target="documentation-frame"><img src="./images/doc-left-point.gif" title="5.1. How the program evolved..." alt="" border="0" /></a> <span><img src="./images/no-pass-sign.gif" title="Dead End - Not in next version (2)" alt="" border="0" /></span> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" target="documentation-frame" title="R5RS Scheme form">define</a> <span class="signature">(filter pred lst)</span>
 (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX335" target="documentation-frame" title="R5RS Scheme form">reverse</a> <span class="comment">; <span><a name="filter-@a"></a> <a href="documentation.html#filtering-@a" target="documentation-frame"><img src="./images/source-mark-red.gif" title="A linked program source marker to section 3.1:
&#39;Filtering&#39;
Mark char: a" alt="" border="0" /></a></span></span><br />  (<a class="applied-name" href="prog2-1.html#filter-help" title="prog2, version 1">filter-help</a> pred lst '())))

<a name="filter-help"></a><span class="comment">; The function that does the real filtering.
; A tail recursive function</span><br /><a name="filter-help"></a><span><span><a href="prog2-1-LARGE.html#filter-help"><img src="./images/small-square.gif" title="Show source file in large font" alt="" border="0" /></a></span> <span><a href="cross-reference-index.html#filter-help" target="control-frame"><img src="./images/small-green-up-triangle.gif" title="In prog2: Link from filter-help to it&#39;s cross reference table entry" alt="" border="0" /></a></span> <a href="documentation.html#filtering" target="documentation-frame"><img src="./images/doc-left.gif" title="3.1. Filtering" alt="" border="0" /></a> <a href="documentation.html#evol1" target="documentation-frame"><img src="./images/doc-left-point.gif" title="5.1. How the program evolved..." alt="" border="0" /></a> <span><img src="./images/no-pass-sign.gif" title="Dead End - Not in next version (2)" alt="" border="0" /></span> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" target="documentation-frame" title="R5RS Scheme form">define</a> <span class="signature">(filter-help pred lst res)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" target="documentation-frame" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" target="documentation-frame" title="R5RS Scheme form">null?</a> lst) res)  
        ((pred (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" target="documentation-frame" title="R5RS Scheme form">car</a> lst)) 
           (<a class="applied-name" href="prog2-1.html#filter-help" title="prog2, version 1">filter-help</a> pred (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" target="documentation-frame" title="R5RS Scheme form">cdr</a> lst)  (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" target="documentation-frame" title="R5RS Scheme form">cons</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" target="documentation-frame" title="R5RS Scheme form">car</a> lst) res))) 
        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" target="documentation-frame" title="R5RS Scheme form">else</a> 
           (<a class="applied-name" href="prog2-1.html#filter-help" title="prog2, version 1">filter-help</a> pred (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" target="documentation-frame" title="R5RS Scheme form">cdr</a> lst)  res))))

<a name="generate-leq"></a><div class="schemedoc-definition-comment">;; Generate a less than or equal predicate from the enumeration-order.
;; If p is the generated predicate, (p x y) is true if and only if
;; (selector x) comes before (or at the same position) as (selector y)
;; in the enumeration-order. Thus, (selector x) is assumed to give a
;; value in enumeration-order. Comparison with elements in the enumeration-list
;; is done with el-eq?
;; .form (generate-leq enumeration-order selector [el-eq?])</div><a name="generate-leq"></a><span><span><a href="prog2-1-LARGE.html#generate-leq"><img src="./images/small-square.gif" title="Show source file in large font" alt="" border="0" /></a></span> <span><a href="cross-reference-index.html#generate-leq" target="control-frame"><img src="./images/small-green-up-triangle.gif" title="In prog2: Link from generate-leq to it&#39;s cross reference table entry" alt="" border="0" /></a></span> <a href="documentation.html#enum-order" target="documentation-frame"><img src="./images/doc-left.gif" title="3.3. Enumeration ordering" alt="" border="0" /></a> <a href="documentation.html#enum-order-again" target="documentation-frame"><img src="./images/doc-left-point.gif" title="4.1. Enumeration ordering" alt="" border="0" /></a> <span><img src="./images/no-pass-sign.gif" title="Dead End - Not in next version (2)" alt="" border="0" /></span> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" target="documentation-frame" title="R5RS Scheme form">define</a> <span class="signature">(generate-leq enumeration-order selector . optional-parameter-list)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" target="documentation-frame" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">el-eq?</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#optional-parameter" target="documentation-frame" title="Manual: general">optional-parameter</a> 1 optional-parameter-list <a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" target="documentation-frame" title="R5RS Scheme form">eq?</a>)))
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" target="documentation-frame" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">x</span> <span class="local-name-binding">y</span>)
     <span class="comment">; x and y supposed to be elements in enumeration order</span><br />     (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" target="documentation-frame" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">x-index</span> (<a class="applied-name" href="prog2-1.html#list-index" title="prog2, version 1">list-index</a> (selector x) enumeration-order el-eq?))
           (<span class="local-name-binding">y-index</span> (<a class="applied-name" href="prog2-1.html#list-index" title="prog2, version 1">list-index</a> (selector y) enumeration-order el-eq?)))
       (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX238" target="documentation-frame" title="R5RS Scheme form">&lt;=</a> x-index y-index)))))

<a name="list-index"></a><span class="comment">; A helping function of generate-leq.
; Return the position of e in lst. First is 1
; compare with el-eq?
; if e is not member of lst return (+ 1 (length lst))</span><br /><a name="list-index"></a><span><span><a href="prog2-1-LARGE.html#list-index"><img src="./images/small-square.gif" title="Show source file in large font" alt="" border="0" /></a></span> <span><a href="cross-reference-index.html#list-index" target="control-frame"><img src="./images/small-green-up-triangle.gif" title="In prog2: Link from list-index to it&#39;s cross reference table entry" alt="" border="0" /></a></span> <a href="documentation.html#enum-order" target="documentation-frame"><img src="./images/doc-left.gif" title="3.3. Enumeration ordering" alt="" border="0" /></a> <a href="documentation.html#enum-order-again" target="documentation-frame"><img src="./images/doc-left-point.gif" title="4.1. Enumeration ordering" alt="" border="0" /></a> <span><a href="prog2-2.html#list-index"><img src="./images/gray-right-arrow.gif" title="The next version (2)" alt="" border="0" /></a></span> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" target="documentation-frame" title="R5RS Scheme form">define</a> <span class="signature">(list-index e lst el-eq?)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" target="documentation-frame" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" target="documentation-frame" title="R5RS Scheme form">null?</a> lst) 1)
       ((el-eq? (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" target="documentation-frame" title="R5RS Scheme form">car</a> lst) e) 1)
       (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" target="documentation-frame" title="R5RS Scheme form">else</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX249" target="documentation-frame" title="R5RS Scheme form">+</a> 1 (<a class="applied-name" href="prog2-1.html#list-index" title="prog2, version 1">list-index</a> e (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" target="documentation-frame" title="R5RS Scheme form">cdr</a> lst) el-eq?)))))


<a name="other-source-list"></a><span class="comment">; A list of functions from the other souce program</span><br /><a name="other-source-list"></a><span><span><a href="prog2-1-LARGE.html#other-source-list"><img src="./images/small-square.gif" title="Show source file in large font" alt="" border="0" /></a></span> <span><a href="cross-reference-index.html#other-source-list" target="control-frame"><img src="./images/small-green-up-triangle.gif" title="In prog2: Link from other-source-list to it&#39;s cross reference table entry" alt="" border="0" /></a></span> <span><img src="./images/no-pass-sign.gif" title="Dead End - Not in next version (2)" alt="" border="0" /></span> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" target="documentation-frame" title="R5RS Scheme form">define</a> <span class="signature">other-source-list</span>
  (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" target="documentation-frame" title="R5RS Scheme form">list</a> <a class="applied-name" href="prog1-1.html#fac" title="prog1, version 1">fac</a> <a class="applied-name" href="prog1-1.html#head" title="prog1, version 1">head</a> <a class="applied-name" href="prog1-1.html#tail" title="prog1, version 1">tail</a>))  
</pre></font><div>&nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p></div></body></html>