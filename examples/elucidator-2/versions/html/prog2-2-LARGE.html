<html><head><link href="stylesheets/program.css" rel="stylesheet" title="program" type="text/css" /> <title>Source file</title></head><body bgcolor="#ddffdd" text="#000000" link="#000000" vlink="#000000" style="background:#ddffdd;background-position:top right;background-repeat:no-repeat;background-attachment:fixed;background-image:url(&#39;images/vers-2-2.gif&#39;);"><span><a href="prog2-1-LARGE.html"><img src="./images/gray-left-arrow-large.gif" title="The previous version (1)" alt="" border="0" /></a> &nbsp; </span><font size="3"><pre><a name="zip-lists"></a><div class="schemedoc-definition-comment">;; Zip the two lists lst1 and lst2 by means of z.</div><a name="zip-lists"></a><span><span><a href="prog2-2.html#zip-lists"><img src="./images/small-square.gif" title="Show source file in small font" alt="" border="0" /></a></span> <span><a href="cross-reference-index.html#zip-lists" target="control-frame"><img src="./images/small-green-up-triangle.gif" title="In prog2: Link from zip-lists to it&#39;s cross reference table entry" alt="" border="0" /></a></span> <a href="documentation.html#composing" target="documentation-frame"><img src="./images/doc-left.gif" title="3.2. Function composition" alt="" border="0" /></a> <a href="documentation.html#evol1" target="documentation-frame"><img src="./images/doc-left.gif" title="5.1. How the program evolved..." alt="" border="0" /></a> <span><span><a href="prog2-1-LARGE.html#zip"><img src="./images/gray-left-arrow.gif" title="The previous version (1) named zip" alt="" border="0" /></a> <img src="./images/renamed.gif" title="Probably a renaming of zip from version 1" alt="" border="0" /></span></span> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" target="documentation-frame" title="R5RS Scheme form">define</a> <span class="signature">(zip-lists z lst1 lst2)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" target="documentation-frame" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" target="documentation-frame" title="R5RS Scheme form">null?</a> lst1)
      '()
      (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" target="documentation-frame" title="R5RS Scheme form">cons</a> 
        (z (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" target="documentation-frame" title="R5RS Scheme form">car</a> lst1) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" target="documentation-frame" title="R5RS Scheme form">car</a> lst2))
        (zip z (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" target="documentation-frame" title="R5RS Scheme form">cdr</a> lst1) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" target="documentation-frame" title="R5RS Scheme form">cdr</a> lst2)))))

<a name="compose-functions"></a><div class="schemedoc-definition-comment">;; Compose a list of functions to a single function.
;; Each function in the list takes a single parameter.
;; Handles the typical case of two functions manually to achieve
;; better efficiency.
;; .precondition f-list is a proper list of length ast least one.</div><a name="compose-functions"></a><span><span><a href="prog2-2.html#compose-functions"><img src="./images/small-square.gif" title="Show source file in small font" alt="" border="0" /></a></span> <span><a href="cross-reference-index.html#compose-functions" target="control-frame"><img src="./images/small-green-up-triangle.gif" title="In prog2: Link from compose-functions to it&#39;s cross reference table entry" alt="" border="0" /></a></span> <a href="documentation.html#composing" target="documentation-frame"><img src="./images/doc-left.gif" title="3.2. Function composition" alt="" border="0" /></a> <a href="documentation.html#evol1" target="documentation-frame"><img src="./images/doc-left.gif" title="5.1. How the program evolved..." alt="" border="0" /></a> <a href="documentation.html#to-do" target="documentation-frame"><img src="./images/doc-left.gif" title="5.2. Still work to do" alt="" border="0" /></a> <span><img src="./images/new.gif" title="New in this version (2)" alt="" border="0" /></span> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" target="documentation-frame" title="R5RS Scheme form">define</a> <span class="signature">(compose-functions . f-list)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" target="documentation-frame" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX235" target="documentation-frame" title="R5RS Scheme form">=</a> 1 (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX333" target="documentation-frame" title="R5RS Scheme form">length</a> f-list)) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" target="documentation-frame" title="R5RS Scheme form">car</a> f-list)) <span class="comment">; <span><a name="compose-functions-@b"></a> @b</span></span><br />        ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX235" target="documentation-frame" title="R5RS Scheme form">=</a> 2 (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX333" target="documentation-frame" title="R5RS Scheme form">length</a> f-list)) <span class="comment">; <span><a name="compose-functions-@c"></a> @c</span></span><br />	 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" target="documentation-frame" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">f</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" target="documentation-frame" title="R5RS Scheme form">car</a> f-list)) 
	       (<span class="local-name-binding">g</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" target="documentation-frame" title="R5RS Scheme form">cadr</a> f-list)))
	   (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" target="documentation-frame" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">x</span>) (f (g x)))))
        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" target="documentation-frame" title="R5RS Scheme form">else</a>  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" target="documentation-frame" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">x</span>)     <span class="comment">; <span><a name="compose-functions-@d"></a> @d</span></span><br />		 ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" target="documentation-frame" title="R5RS Scheme form">car</a> f-list)
		  ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX411" target="documentation-frame" title="R5RS Scheme form">apply</a> <a class="applied-name" href="prog2-2-LARGE.html#compose-functions" title="prog2">compose-functions</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" target="documentation-frame" title="R5RS Scheme form">cdr</a> f-list)) x))))))





<a name="list-index"></a><span class="comment">; A helping function of generate-leq.
; Return the position of e in lst. First is 1
; compare with el-eq?
; if e is not member of lst return (+ 1 (length lst))</span><br /><a name="list-index"></a><span><span><a href="prog2-2.html#list-index"><img src="./images/small-square.gif" title="Show source file in small font" alt="" border="0" /></a></span> <span><a href="cross-reference-index.html#list-index" target="control-frame"><img src="./images/small-green-up-triangle.gif" title="In prog2: Link from list-index to it&#39;s cross reference table entry" alt="" border="0" /></a></span> <a href="documentation.html#enum-order" target="documentation-frame"><img src="./images/doc-left.gif" title="3.3. Enumeration ordering" alt="" border="0" /></a>  <span><span><a href="prog2-1-LARGE.html#list-index"><img src="./images/gray-left-arrow.gif" title="The previous version (1) which is identical with the current version." alt="" border="0" /></a></span></span> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" target="documentation-frame" title="R5RS Scheme form">define</a> <span class="signature">(list-index e lst el-eq?)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" target="documentation-frame" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" target="documentation-frame" title="R5RS Scheme form">null?</a> lst) 1)
       ((el-eq? (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" target="documentation-frame" title="R5RS Scheme form">car</a> lst) e) 1)
       (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" target="documentation-frame" title="R5RS Scheme form">else</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX249" target="documentation-frame" title="R5RS Scheme form">+</a> 1 (<a class="applied-name" href="prog2-2-LARGE.html#list-index" title="prog2">list-index</a> e (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" target="documentation-frame" title="R5RS Scheme form">cdr</a> lst) el-eq?)))))  
</pre></font><div>&nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p></div></body></html>