<html><head><link href="../../../../../css-stylesheets/elucidator/program.css" rel="stylesheet" title="program" type="text/css" /> <title>Source file</title></head><body bgcolor="#ffffff" text="#000000" link="#000000" vlink="#000000"><font size="2"><pre><span class="comment">; =&gt;man/calendar.laml</span><br />
<div class="schemedoc-abstract-comment">;;;; This is a tool for generation of calendars, which can be shown in an Internet Browser. 
;;;; The stuff in this file relies on the XHTML 1.0 transitional mirror together with the XHTML
;;;; convenience library. Thus, in order to use this calendar tool, you should load libraries in the following way (besides the fundamental LAML library):
;;;; &lt;pre&gt;
;;;;   (laml-style "simple-xhtml1.0-transitional-validating") 
;;;;   (lib-load "xhtml1.0-convenience.scm") &lt;br&gt;
;;;;   (load (string-append laml-dir "tools/calendar/xml-in-laml/calendar.scm")) &lt;br&gt;
;;;; &lt;/pre&gt; &lt;p&gt;
;;;;
;;;;
;;;; The main function of the tool is &lt;kbd&gt;calendar&lt;/kbd&gt;. The function &lt;kbd&gt;week-calendar&lt;/kbd&gt; is also a top-level function.
;;;; Besides these two functions, it is important to understand the input format of appointments in the calendar.
;;;; Also, there are a number of constants, which affect the appearance of the calendar. &lt;p&gt;
;;;;
;;;;
;;;; This tools requires input in terms of calendar events, which are assumed to be hold the the Scheme
;;;; variabel &lt;kbd&gt;calendar-events&lt;/kbd&gt;. In other words, you must define this variable to a value which represents a list of calendar event.
;;;; Below, in section 1, we explain the calendar event format. &lt;p&gt;
;;;;
;;;;
;;;; Besides the general LAML stuff (laml.scm) and the XHTML mirror libraries (mentioned above) this tools requires the libraries
;;;; &lt;a href = "../../../../lib/man/color.html"&gt;color.scm&lt;/a&gt;, &lt;a href="../../../../lib/man/time.html"&gt;time.scm&lt;/a&gt; and &lt;a href="../../../../lib/man/file-read.html"&gt;file-read.scm&lt;/a&gt; (all from directory lib in the LAML distribution).
;;;; The required libraries are not loaded by the tool itself. Notice however, that the loading example given above also includes
;;;; loading of color, time and file-read (because they are loaded by &lt;a href="../../../../styles/man/simple-xhtml1.0-transitional-validating.html"&gt;simple-xhtml1.0-transitional-validating&lt;/a&gt;). &lt;p&gt;
;;;;
;;;;
;;;; The font size of the calendar entries is controlled by CSS.
;;;; You can either link to a CSS file, or embed a CSS clause in the head of your HTML element.
;;;; The following CSS clauses is an example: 
;;;; &lt;pre&gt;&lt;kbd&gt;  (style 'type "text/css" "TABLE.calendar-table TD { font-size: 7pt; }")&lt;/kbd&gt;&lt;/pre&gt; &lt;p&gt;
;;;; A clause like this should be a constituent of the HTML head element.&lt;p&gt;
;;;;
;;;; Please take look at the &lt;a href = "../../../../examples/calendar-xml/index.html"&gt;calendar examples&lt;/a&gt;.&lt;p&gt;
;;;;
;;;; At www.cs.aau.dk we support a &lt;a href="http://www.cs.aau.dk/~normark/cgi-bin/calendar/calendar-entry.cgi"&gt;LAML web calendar service&lt;/a&gt; which will generate a calendar for you based on web input.
;;;; You are welcome to try it out.</div>
<div class="schemedoc-abstract-comment">;;;; .title Reference Manual of the LAML Calendar Tool - XHTML</div>
<span class="comment">; The LAML library and programs are written by Kurt Normark, Aalborg University, Denmark.
; Copyright (C) 2002  Kurt Normark, normark@s.auc.dk.
;
; This program is free software; you can redistribute it and/or modify
; it under the terms of the GNU General Public License as published by
; the Free Software Foundation; either version 2 of the License, or
; (at your option) any later version.
;
; This program is distributed in the hope that it will be useful,
; but WITHOUT ANY WARRANTY; without even the implied warranty of
; MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
; GNU General Public License for more details.
;
; You should have received a copy of the GNU General Public License
; along with this program; if not, write to the Free Software
; Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA</span><br />

<span class="comment">; LOG:
; 21.12.98:
; Changed such that multiple appointments on a single day get their own colors.
; boil-together has been changed to return color-frames instead of a simple text.
; The color-function in month-column has been changed to use background colors now that each appointment has its color-frame</span><br />

<span class="comment">; 5.2.98: We introduced a new week separation which looks real good in Internet Explorer 4.0, but not as good in Netscape 4.01.</span><br />
<span class="comment">; 4.10.02: Converted to XHTML</span><br />
<span class="comment">; 16.8.2005: Generalized to more than two columns (before and after noon).</span><br />

<div class="schemedoc-section-comment">;;; About the format of calendar input. 
;;; The calendar input must be present in a variable named &lt;kbd&gt;calendar-events&lt;/kbd&gt;.
;;; &lt;kbd&gt;calendar-events&lt;/kbd&gt; must be defined externally to the calendar tool.
;;; &lt;kbd&gt;calendar-events&lt;/kbd&gt; is a list of appointments.
;;; A single appointment is, in turn, a list. Thus &lt;kbd&gt;calendar-events&lt;/kbd&gt; is a list of lists.&lt;p&gt;
;;;
;;; The detailed format of an appointment is the following: &lt;br&gt;
;;;
;;; &lt;pre&gt;   (start-time end-time brief-description long-description color url) &lt;/pre&gt;
;;;
;;; Start-time and end-time are integers (a number of seconds since january 1, 1970).
;;; The function time-encoding from the &lt;a href="../../../../lib/man/time.html"&gt;time library&lt;/a&gt; is useful for construction of these
;;; numbers.&lt;p&gt;
;;;
;;; Brief-description is a string, the contents of which goes into the calendar.
;;; Long-description is a longer description of the event. The long description is supposed to contain the brief description as well.
;;; The long description is currently used as a popup title text of a calendar event presentation. 
;;; In addition, the long description is shown instead of the brief description in a week calendar. &lt;p&gt;
;;;
;;; Color is a RGB color.
;;; The color can be given in all formats accepted by the function &lt;a href = "../../../../lib/man/color.html#rgb-color-encoding"&gt;rgb-color-encoding&lt;/a&gt; from the LAML color library.
;;; You can also use the color constants of the &lt;a href = "../../../../lib/man/color.html"&gt;LAML color library&lt;/a&gt;. &lt;p&gt;
;;;
;;; Finally, url is an URL, to which we link from the calendar entry. If it is the empty string, no link will be made.</div>


<span class="comment">; ---------------------------------------------------------------------------------------------------------------</span><br />
<div class="schemedoc-section-comment">;;; Event selection functions. 
;;; The event selector functions define accessors into a calendar appointment.</div>
<a name="event-start-time"></a><a name="event-start-time"></a><span><a href="../calendar.html#event-start-time"><img src="../../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(event-start-time e)</span> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX337" title="R5RS Scheme form">list-ref</a> e 0))

<a name="event-end-time"></a><a name="event-end-time"></a><span><a href="../calendar.html#event-end-time"><img src="../../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(event-end-time e)</span> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX337" title="R5RS Scheme form">list-ref</a> e 1))

<a name="event-brief-text"></a><a name="event-brief-text"></a><span><a href="../calendar.html#event-brief-text"><img src="../../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(event-brief-text e)</span> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX337" title="R5RS Scheme form">list-ref</a> e 2))

<a name="event-long-text"></a><a name="event-long-text"></a><span><a href="../calendar.html#event-long-text"><img src="../../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(event-long-text e)</span> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX337" title="R5RS Scheme form">list-ref</a> e 3))

<a name="event-color"></a><a name="event-color"></a><span><a href="../calendar.html#event-color"><img src="../../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(event-color e)</span> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX337" title="R5RS Scheme form">list-ref</a> e 4))

<a name="event-url"></a><a name="event-url"></a><span><a href="../calendar.html#event-url"><img src="../../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(event-url e)</span> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX337" title="R5RS Scheme form">list-ref</a> e 5))



<a name="event-interval"></a><span></span>(<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(event-interval e)</span> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> (<a class="applied-name" href="calendar-1.html#event-start-time" title="calendar">event-start-time</a> e) (<a class="applied-name" href="calendar-1.html#event-end-time" title="calendar">event-end-time</a> e)))


<span class="comment">; ---------------------------------------------------------------------------------------------------------------</span><br />
<div class="schemedoc-section-comment">;;; Calendar parameters. 
;;; In this section we find a number of variables which control the calendar appearance.</div>
<a name="calendar-font-size"></a><span class="comment">; The calendar font size. Default value is 1.
;  Not used any more. The font size is controlled by a CSS clause, external to the calendar fragment. </span><br /><a name="calendar-font-size"></a><span></span>(<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">calendar-font-size</span> 1)

<a name="week-separator-of-calendar"></a><a name="week-separator-of-calendar"></a><span><a href="../calendar.html#week-separator-of-calendar"><img src="../../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">week-separator-of-calendar</span> 'thin) <a name="week-sep"></a><span class="comment">; alternative: 'thick</span><br />
<a name="week-sep"></a><span></span>(<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(week-sep)</span> 
  (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> <a class="applied-name" href="calendar-1.html#week-separator-of-calendar" title="calendar">week-separator-of-calendar</a> 'thin) "")
        ((<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> <a class="applied-name" href="calendar-1.html#week-separator-of-calendar" title="calendar">week-separator-of-calendar</a> 'thick) (<a class="schemedoc-name" href="../../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#hr" title="Manual: xhtml10-transitional-mirror">hr</a>))
        (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (error "Calendar: week separator problems"))))

<a name="month-width"></a><a name="month-width"></a><span><a href="../calendar.html#month-width"><img src="../../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">month-width</span> 150)

<a name="calendar-division-of-day"></a><a name="calendar-division-of-day"></a><span><a href="../calendar.html#calendar-division-of-day"><img src="../../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">calendar-division-of-day</span>
  (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">noon-time</span> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX254" title="R5RS Scheme form">/</a> <a class="schemedoc-name" href="../../../../../lib/man/time.html#seconds-in-a-day" title="Manual: time">seconds-in-a-day</a> 2)))
    (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> 0 (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> noon-time 1)) (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> noon-time (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> <a class="schemedoc-name" href="../../../../../lib/man/time.html#seconds-in-a-day" title="Manual: time">seconds-in-a-day</a> 1)))))


<span class="comment">; ---------------------------------------------------------------------------------------------------------------</span><br />
<a name="calendar-background-color"></a><a name="calendar-background-color"></a><span><a href="../calendar.html#calendar-background-color"><img src="../../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">calendar-background-color</span> <a class="schemedoc-name" href="../../../../../lib/man/color.html#white" title="Manual: color">white</a>)

<span class="comment">; </span><br />
<a name="interval-overlap?"></a><span class="comment">; is there an overlap between the intervals, each of which is a list (x y), x &lt;= y.
; function of general interest</span><br /><a name="interval-overlap?"></a><span></span>(<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(interval-overlap? interval-1 interval-2)</span>
  (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">i1-start</span> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> interval-1))
        (<span class="local-name-binding">i1-end</span> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cadr</a> interval-1))
        (<span class="local-name-binding">i2-start</span> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> interval-2))
        (<span class="local-name-binding">i2-end</span> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cadr</a> interval-2)))
   (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX118" title="R5RS Scheme form">or</a> (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX238" title="R5RS Scheme form">&lt;=</a> i2-start i1-end) (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX238" title="R5RS Scheme form">&lt;=</a> i1-end i2-end))
       (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX238" title="R5RS Scheme form">&lt;=</a> i1-start i2-end) (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX238" title="R5RS Scheme form">&lt;=</a> i2-end i1-end))
       <span class="comment">; embedding</span><br />       (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX238" title="R5RS Scheme form">&lt;=</a> i2-start i1-start) (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX238" title="R5RS Scheme form">&lt;=</a> i1-end i2-end))
       (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX238" title="R5RS Scheme form">&lt;=</a> i1-start i2-start) (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX238" title="R5RS Scheme form">&lt;=</a> i2-end i1-end)))))

<a name="part-of-day-interval"></a><span class="comment">; Return a second count interval from calendar-division-of-day, as of year, month and day.
; The first interval is numbered 1. 
; The size of n is coupled to the length of calendar-division-of-day.</span><br /><a name="part-of-day-interval"></a><span></span>(<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(part-of-day-interval year month day n)</span>
 (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">start</span> (<a class="schemedoc-name" href="../../../../../lib/man/time.html#second-count" title="Manual: time">second-count</a> year month day 0 0 0))
        (<span class="local-name-binding">division-interval</span> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX337" title="R5RS Scheme form">list-ref</a> <a class="applied-name" href="calendar-1.html#calendar-division-of-day" title="calendar">calendar-division-of-day</a> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> n 1)))
       )
   (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> start (<a class="schemedoc-name" href="../../../../../lib/man/general.html#first" title="Manual: general">first</a> division-interval)) (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> start (<a class="schemedoc-name" href="../../../../../lib/man/general.html#second" title="Manual: general">second</a> division-interval))))) 


<a name="first-half-day-interval"></a><span class="comment">; Return an interval of first half day.  From 00:00 to 12:00</span><br /><a name="first-half-day-interval"></a><span></span>(<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(first-half-day-interval year month day)</span>
 (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">start</span> (<a class="schemedoc-name" href="../../../../../lib/man/time.html#second-count" title="Manual: time">second-count</a> year month day 0 0 0)))
    (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> start (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> start (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX258" title="R5RS Scheme form">quotient</a> <a class="schemedoc-name" href="../../../../../lib/man/time.html#seconds-in-a-day" title="Manual: time">seconds-in-a-day</a> 2)) 1))))

<a name="second-half-day-interval"></a><span class="comment">; Return an interval of second half day. From 12:00 to 24:00</span><br /><a name="second-half-day-interval"></a><span></span>(<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(second-half-day-interval year month day)</span>
 (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">start</span> (<a class="schemedoc-name" href="../../../../../lib/man/time.html#second-count" title="Manual: time">second-count</a> year month day 0 0 0)))
    (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> start (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX258" title="R5RS Scheme form">quotient</a> <a class="schemedoc-name" href="../../../../../lib/man/time.html#seconds-in-a-day" title="Manual: time">seconds-in-a-day</a> 2)) (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> start <a class="schemedoc-name" href="../../../../../lib/man/time.html#seconds-in-a-day" title="Manual: time">seconds-in-a-day</a>) 1))))

<a name="month-list"></a><span class="comment">; Return a list of the form (y . m). There are number-of-months entries in the list</span><br /><a name="month-list"></a><span></span>(<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(month-list from-month year number-of-months)</span>
 (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">y-m-l</span> (<a class="applied-name" href="calendar-1.html#year-month-list" title="calendar">year-month-list</a> year from-month number-of-months)))
  (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">y-m</span>) (con (<a class="schemedoc-name" href="../../../../../lib/man/time.html#get-month-name" title="Manual: time">get-month-name</a> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> y-m)) " " (<a class="schemedoc-name" href="../../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> y-m))))
    y-m-l)))

<a name="make-second-counts"></a><span class="comment">; enumerate the second counts of month in year</span><br /><a name="make-second-counts"></a><span></span>(<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(make-second-counts month year)</span>
  (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">day</span>)
          (<a class="schemedoc-name" href="../../../../../lib/man/time.html#second-count" title="Manual: time">second-count</a> year month day 0 0 0))  <span class="comment">; !!</span><br />    (<a class="schemedoc-name" href="../../../../../lib/man/general.html#number-interval" title="Manual: general">number-interval</a> 1 (<a class="schemedoc-name" href="../../../../../lib/man/time.html#days-in-month" title="Manual: time">days-in-month</a> month year))))


<a name="cal-table"></a><span></span>(<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(cal-table border cell-width-list cell-color-function weekend? cell-font-size list-of-list)</span>
  (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">bdr</span> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> 'border (<a class="schemedoc-name" href="../../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> border))))
   (<a class="schemedoc-name" href="../../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#table" title="Manual: xhtml10-transitional-mirror">table</a> 'class "calendar-table" bdr
    (<a class="schemedoc-name" href="../../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#tbody" title="Manual: xhtml10-transitional-mirror">tbody</a>
     (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX237" title="R5RS Scheme form">&gt;</a> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX333" title="R5RS Scheme form">length</a> <a class="applied-name" href="calendar-1.html#calendar-division-of-day" title="calendar">calendar-division-of-day</a>) 1) (<a class="applied-name" href="calendar-1.html#calendar-division-presentation" title="calendar">calendar-division-presentation</a>) '())
     (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> 
       (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">row</span>)
         (<a class="schemedoc-name" href="../../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#tr" title="Manual: xhtml10-transitional-mirror">tr</a> 
           (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">cell</span> <span class="local-name-binding">width</span> <span class="local-name-binding">color-1</span>)
                  (<a class="schemedoc-name" href="../../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#td" title="Manual: xhtml10-transitional-mirror">td</a> 'bgcolor (<a class="schemedoc-name" href="../../../../../lib/man/color.html#rgb-color-encoding" title="Manual: color">rgb-color-encoding</a> color-1)
		      (<a class="schemedoc-name" href="../../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#div" title="Manual: xhtml10-transitional-mirror">div</a> 'css:width (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> (<a class="schemedoc-name" href="../../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> width) "px") (<a class="applied-name" href="calendar-1.html#present-cell" title="calendar">present-cell</a> cell cell-font-size))
		      (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (weekend? row) (<a class="schemedoc-name" href="../../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#hr" title="Manual: xhtml10-transitional-mirror">hr</a>) '())))
                row cell-width-list (cell-color-function row))))
       list-of-list)))))

<a name="calendar-division-presentation"></a><span></span>(<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(calendar-division-presentation)</span>
  (<a class="schemedoc-name" href="../../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#tr" title="Manual: xhtml10-transitional-mirror">tr</a> (<a class="schemedoc-name" href="../../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#td" title="Manual: xhtml10-transitional-mirror">td</a>) (<a class="schemedoc-name" href="../../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#td" title="Manual: xhtml10-transitional-mirror">td</a>) (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">i</span>) (<a class="schemedoc-name" href="../../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#td" title="Manual: xhtml10-transitional-mirror">td</a> (<a class="schemedoc-name" href="../../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#center" title="Manual: xhtml10-transitional-mirror">center</a> (<a class="schemedoc-name" href="../../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#font" title="Manual: xhtml10-transitional-mirror">font</a> 'size "1" (<a class="applied-name" href="calendar-1.html#hour-minute-interval-presentation" title="calendar">hour-minute-interval-presentation</a> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX337" title="R5RS Scheme form">list-ref</a> <a class="applied-name" href="calendar-1.html#calendar-division-of-day" title="calendar">calendar-division-of-day</a> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> i 1))))))) (<a class="schemedoc-name" href="../../../../../lib/man/general.html#number-interval" title="Manual: general">number-interval</a> 1 (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX333" title="R5RS Scheme form">length</a> <a class="applied-name" href="calendar-1.html#calendar-division-of-day" title="calendar">calendar-division-of-day</a>)))))

<a name="hour-minute-interval-presentation"></a><span></span>(<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(hour-minute-interval-presentation from-to-second-list)</span>
  (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">from-second-count</span> (<a class="schemedoc-name" href="../../../../../lib/man/general.html#first" title="Manual: general">first</a> from-to-second-list))
         (<span class="local-name-binding">to-second-count</span> (<a class="schemedoc-name" href="../../../../../lib/man/general.html#second" title="Manual: general">second</a> from-to-second-list))
         (<span class="local-name-binding">from-hour-minute</span> (<a class="schemedoc-name" href="../../../../../lib/man/time.html#hours-minutes-seconds-decode" title="Manual: time">hours-minutes-seconds-decode</a> from-second-count))
         (<span class="local-name-binding">to-hour-minute</span> (<a class="schemedoc-name" href="../../../../../lib/man/time.html#hours-minutes-seconds-decode" title="Manual: time">hours-minutes-seconds-decode</a> to-second-count))
        )
    (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> (<a class="applied-name" href="calendar-1.html#two-ciffers" title="calendar">two-ciffers</a> (<a class="schemedoc-name" href="../../../../../lib/man/general.html#first" title="Manual: general">first</a> from-hour-minute)) <a class="schemedoc-name" href="../../../../../lib/xml-in-laml/man/xml-in-laml.html#_" title="Manual: xml-in-laml">_</a> ":" <a class="schemedoc-name" href="../../../../../lib/xml-in-laml/man/xml-in-laml.html#_" title="Manual: xml-in-laml">_</a> (<a class="applied-name" href="calendar-1.html#two-ciffers" title="calendar">two-ciffers</a> (<a class="schemedoc-name" href="../../../../../lib/man/general.html#second" title="Manual: general">second</a> from-hour-minute)) "-" (<a class="applied-name" href="calendar-1.html#two-ciffers" title="calendar">two-ciffers</a> (<a class="schemedoc-name" href="../../../../../lib/man/general.html#first" title="Manual: general">first</a> to-hour-minute)) <a class="schemedoc-name" href="../../../../../lib/xml-in-laml/man/xml-in-laml.html#_" title="Manual: xml-in-laml">_</a> ":" <a class="schemedoc-name" href="../../../../../lib/xml-in-laml/man/xml-in-laml.html#_" title="Manual: xml-in-laml">_</a> (<a class="applied-name" href="calendar-1.html#two-ciffers" title="calendar">two-ciffers</a> (<a class="schemedoc-name" href="../../../../../lib/man/general.html#second" title="Manual: general">second</a> to-hour-minute)))))

<a name="two-ciffers"></a><span class="comment">; Return a string of (at least) two characters given a non-negative integer n. Pad with '0'.</span><br /><a name="two-ciffers"></a><span></span>(<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(two-ciffers n)</span>
  (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX236" title="R5RS Scheme form">&lt;</a> n 10) (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> "0" (<a class="schemedoc-name" href="../../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> n)))
        (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="schemedoc-name" href="../../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> n))))

<a name="present-cell"></a><span class="comment">; Jeg har taget (as-string) væk rundt om cell - det giver problemer på uge numre...</span><br /><a name="present-cell"></a><span></span>(<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(present-cell cell size)</span>
  cell) <span class="comment">; earlier (font-size size cell) - does not validate. Cannot have font around table structure</span><br />
<a name="find-all"></a><span class="comment">; return all elements of list which satiesfy the predicate p
; general</span><br /><a name="find-all"></a><span></span>(<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(find-all p lst)</span>
  (<a class="applied-name" href="calendar-1.html#find-all-help" title="calendar">find-all-help</a> p lst '()))

<a name="find-all-help"></a><span></span>(<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(find-all-help p lst res)</span>
  (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> lst) (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX335" title="R5RS Scheme form">reverse</a> res))
        ((p (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> lst)) (<a class="applied-name" href="calendar-1.html#find-all-help" title="calendar">find-all-help</a> p (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> lst) (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> lst) res)))
        (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="applied-name" href="calendar-1.html#find-all-help" title="calendar">find-all-help</a> p (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> lst) res))))


<a name="tasks"></a><span class="comment">; Return the text of a day in a calendar, given year, month, day and day-part. 
; Searches in calendar-events.
; part-of-day addresses a (relative) time interval in the calendar-division-of-day, and it is an integer (1 or larger).
; In the original version of this tool (before Aug 16, 2005) part-of-day was either 1 or 2 (before or after noon).</span><br /><a name="tasks"></a><span></span>(<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(tasks year month day part-of-day)</span>
 (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">cal-interval</span> (<a class="applied-name" href="calendar-1.html#part-of-day-interval" title="calendar">part-of-day-interval</a> year month day part-of-day))
        (<span class="local-name-binding">matching-events</span> 
          (<a class="applied-name" href="calendar-1.html#find-all" title="calendar">find-all</a>
             (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">e</span>) (<a class="applied-name" href="calendar-1.html#interval-overlap?" title="calendar">interval-overlap?</a> cal-interval (<a class="applied-name" href="calendar-1.html#event-interval" title="calendar">event-interval</a> e)))
             calendar-events))
        (<span class="local-name-binding">wnc</span> (<a class="applied-name" href="calendar-1.html#week-number-contribution" title="calendar">week-number-contribution</a> year month day part-of-day)))
  (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX200" title="R5RS Scheme form">equal?</a> "" wnc)
      (<a class="applied-name" href="calendar-1.html#boil-together" title="calendar">boil-together</a> matching-events "")
      (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> (<a class="schemedoc-name" href="../../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a> wnc) (<a class="applied-name" href="calendar-1.html#boil-together" title="calendar">boil-together</a> matching-events "")))))



<a name="week-number-contribution"></a><span></span>(<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(week-number-contribution year month day part-of-day)</span>
  (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX235" title="R5RS Scheme form">=</a> 1 part-of-day)
      (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">sc</span> (<a class="schemedoc-name" href="../../../../../lib/man/time.html#second-count" title="Manual: time">second-count</a> year month day 0 0 0))
             (<span class="local-name-binding">day-number</span> (<a class="schemedoc-name" href="../../../../../lib/man/time.html#weekday-number" title="Manual: time">weekday-number</a> sc)))
        (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX235" title="R5RS Scheme form">=</a> 1 day-number) <span class="comment">; monday</span><br />            (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">week-num</span> (<a class="schemedoc-name" href="../../../../../lib/man/time.html#danish-week-number" title="Manual: time">danish-week-number</a> sc)))
              (<a class="schemedoc-name" href="../../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> week-num))
            ""))
      ""))


<a name="boil-together"></a><span class="comment">; aggreates the matching event to a single string, use separator sep between entries.</span><br /><a name="boil-together"></a><span></span>(<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(boil-together matching-events sep)</span>
  (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> matching-events)
      (<a class="schemedoc-name" href="../../../../../lib/man/xhtml10-convenience.html#space" title="Manual: xhtml10-convenience">space</a> 1)
      (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">res</span>  (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">s</span>)
			 (con s sep))
		       (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">e</span>) 
                             (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">brief-txt</span> (<a class="applied-name" href="calendar-1.html#event-brief-text" title="calendar">event-brief-text</a> e))
                                    (<span class="local-name-binding">al</span> (<a class="applied-name" href="calendar-1.html#level-of-attention" title="calendar">level-of-attention</a> brief-txt))
                                    (<span class="local-name-binding">unattensioned-brief-txt</span> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX391" title="R5RS Scheme form">substring</a> brief-txt 0 (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX378" title="R5RS Scheme form">string-length</a> brief-txt) al)))
                                  )
                              (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a>  (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX237" title="R5RS Scheme form">&gt;</a> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX378" title="R5RS Scheme form">string-length</a> (<a class="applied-name" href="calendar-1.html#event-url" title="calendar">event-url</a> e)) 0) 
				   (<a class="schemedoc-name" href="../../../../../lib/man/xhtml10-convenience.html#color-frame" title="Manual: xhtml10-convenience">color-frame</a>  (<a class="applied-name" href="calendar-1.html#attention-deco" title="calendar">attention-deco</a> al (<a class="schemedoc-name" href="../../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#a" title="Manual: xhtml10-transitional-mirror">a</a> 'href (<a class="applied-name" href="calendar-1.html#event-url" title="calendar">event-url</a> e) 'title (<a class="applied-name" href="calendar-1.html#event-long-text" title="calendar">event-long-text</a> e) unattensioned-brief-txt)) (<a class="applied-name" href="calendar-1.html#event-color" title="calendar">event-color</a> e))
				   (<a class="schemedoc-name" href="../../../../../lib/man/xhtml10-convenience.html#color-frame" title="Manual: xhtml10-convenience">color-frame</a>  (<a class="applied-name" href="calendar-1.html#attention-deco" title="calendar">attention-deco</a> al (<a class="schemedoc-name" href="../../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#span" title="Manual: xhtml10-transitional-mirror">span</a> unattensioned-brief-txt 'title (<a class="applied-name" href="calendar-1.html#event-long-text" title="calendar">event-long-text</a> e))) (<a class="applied-name" href="calendar-1.html#event-color" title="calendar">event-color</a> e)) )))
			    (sort-list matching-events <a class="applied-name" href="calendar-1.html#event-leq?" title="calendar">event-leq?</a>)))))
	res)))

<a name="level-of-attention"></a><span></span>(<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(level-of-attention str)</span>
  (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">len</span> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX378" title="R5RS Scheme form">string-length</a> str))
         (<span class="local-name-binding">c</span> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> len 1))
         (<span class="local-name-binding">d</span> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> len 2))
         (<span class="local-name-binding">e</span> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> len 3)))
    (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX239" title="R5RS Scheme form">&gt;=</a> len 3) (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX196" title="R5RS Scheme form">eqv?</a> #\! (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX379" title="R5RS Scheme form">string-ref</a> str c)) (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX196" title="R5RS Scheme form">eqv?</a> #\! (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX379" title="R5RS Scheme form">string-ref</a> str d)) (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX196" title="R5RS Scheme form">eqv?</a> #\! (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX379" title="R5RS Scheme form">string-ref</a> str e))) 3)
          ((<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX239" title="R5RS Scheme form">&gt;=</a> len 2) (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX196" title="R5RS Scheme form">eqv?</a> #\! (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX379" title="R5RS Scheme form">string-ref</a> str c)) (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX196" title="R5RS Scheme form">eqv?</a> #\! (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX379" title="R5RS Scheme form">string-ref</a> str d))) 2)
          ((<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX239" title="R5RS Scheme form">&gt;=</a> len 1) (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX196" title="R5RS Scheme form">eqv?</a> #\! (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX379" title="R5RS Scheme form">string-ref</a> str c))) 1)
          (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> 0))))

<a name="attention-deco"></a><span></span>(<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(attention-deco level x)</span>
  (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX235" title="R5RS Scheme form">=</a> level 0) x)
        ((<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX235" title="R5RS Scheme form">=</a> level 1) (<a class="schemedoc-name" href="../../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#span" title="Manual: xhtml10-transitional-mirror">span</a> x (<a class="schemedoc-name" href="../../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#b" title="Manual: xhtml10-transitional-mirror">b</a> (<a class="schemedoc-name" href="../../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#font" title="Manual: xhtml10-transitional-mirror">font</a> 'color (<a class="schemedoc-name" href="../../../../../lib/man/color.html#rgb-color-encoding" title="Manual: color">rgb-color-encoding</a> 255 0 0) 'size "2" "!"))))
        ((<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX235" title="R5RS Scheme form">=</a> level 2) (<a class="schemedoc-name" href="../../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#span" title="Manual: xhtml10-transitional-mirror">span</a> x (<a class="schemedoc-name" href="../../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#b" title="Manual: xhtml10-transitional-mirror">b</a> (<a class="schemedoc-name" href="../../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#font" title="Manual: xhtml10-transitional-mirror">font</a> 'color (<a class="schemedoc-name" href="../../../../../lib/man/color.html#rgb-color-encoding" title="Manual: color">rgb-color-encoding</a> 255 0 0) 'size "3" "!!"))))
        ((<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX237" title="R5RS Scheme form">&gt;</a> level 2) (<a class="schemedoc-name" href="../../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#span" title="Manual: xhtml10-transitional-mirror">span</a> (<a class="schemedoc-name" href="../../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#b" title="Manual: xhtml10-transitional-mirror">b</a> x (<a class="schemedoc-name" href="../../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#font" title="Manual: xhtml10-transitional-mirror">font</a> 'color (<a class="schemedoc-name" href="../../../../../lib/man/color.html#rgb-color-encoding" title="Manual: color">rgb-color-encoding</a> 255 0 0) 'size "4" "!!!")) 'css:text-decoration "blink"))))

<a name="attention-deco-week"></a><span></span>(<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(attention-deco-week level x)</span>
  (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX235" title="R5RS Scheme form">=</a> level 0) x)
        ((<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX235" title="R5RS Scheme form">=</a> level 1) (<a class="schemedoc-name" href="../../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#span" title="Manual: xhtml10-transitional-mirror">span</a> x (<a class="schemedoc-name" href="../../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#b" title="Manual: xhtml10-transitional-mirror">b</a> (<a class="schemedoc-name" href="../../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#font" title="Manual: xhtml10-transitional-mirror">font</a> 'color (<a class="schemedoc-name" href="../../../../../lib/man/color.html#rgb-color-encoding" title="Manual: color">rgb-color-encoding</a> 255 0 0) 'size "4" "!"))))
        ((<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX235" title="R5RS Scheme form">=</a> level 2) (<a class="schemedoc-name" href="../../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#span" title="Manual: xhtml10-transitional-mirror">span</a> x (<a class="schemedoc-name" href="../../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#b" title="Manual: xhtml10-transitional-mirror">b</a> (<a class="schemedoc-name" href="../../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#font" title="Manual: xhtml10-transitional-mirror">font</a> 'color (<a class="schemedoc-name" href="../../../../../lib/man/color.html#rgb-color-encoding" title="Manual: color">rgb-color-encoding</a> 255 0 0) 'size "5" "!!"))))
        ((<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX237" title="R5RS Scheme form">&gt;</a> level 2) (<a class="schemedoc-name" href="../../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#span" title="Manual: xhtml10-transitional-mirror">span</a> (<a class="schemedoc-name" href="../../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#b" title="Manual: xhtml10-transitional-mirror">b</a> x (<a class="schemedoc-name" href="../../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#font" title="Manual: xhtml10-transitional-mirror">font</a> 'color (<a class="schemedoc-name" href="../../../../../lib/man/color.html#rgb-color-encoding" title="Manual: color">rgb-color-encoding</a> 255 0 0) 'size "6" "!!!")) 'css:text-decoration "blink"))))
 

<a name="event-leq?"></a><span class="comment">; Is calendar event e1 less than or equal to calendar event e2</span><br /><a name="event-leq?"></a><span></span>(<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(event-leq? e1 e2)</span>
  (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX238" title="R5RS Scheme form">&lt;=</a> (<a class="applied-name" href="calendar-1.html#event-start-time" title="calendar">event-start-time</a> e1) (<a class="applied-name" href="calendar-1.html#event-start-time" title="calendar">event-start-time</a> e2)))
    

<a name="the-event-color"></a><span class="comment">; Given a particular calendar interval, cal-interval, which is day-number (redundant),
; return the color asked for in the event-list</span><br /><a name="the-event-color"></a><span></span>(<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(the-event-color cal-interval day-number)</span>
  (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">matching-events</span> 
          (<a class="applied-name" href="calendar-1.html#find-all" title="calendar">find-all</a>
             (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">e</span>) (<a class="applied-name" href="calendar-1.html#interval-overlap?" title="calendar">interval-overlap?</a> cal-interval (<a class="applied-name" href="calendar-1.html#event-interval" title="calendar">event-interval</a> e)))
             calendar-events)))
    (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> matching-events)
        (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX246" title="R5RS Scheme form">even?</a> day-number) <a class="schemedoc-name" href="../../../../../lib/man/color.html#green1" title="Manual: color">green1</a> <a class="schemedoc-name" href="../../../../../lib/man/color.html#green2" title="Manual: color">green2</a>)
        (<a class="applied-name" href="calendar-1.html#event-color" title="calendar">event-color</a> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> matching-events)))))  


<a name="month-column"></a><span class="comment">; Return a HTML table for month in year.
; if today-info? is true, emphasize today in red.
; number-of-divisions is an integer that gives the number of calendar divisions of a single 24 hour period (a day and a night).</span><br /><a name="month-column"></a><span></span>(<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(month-column month year today-info? number-of-divisions)</span>
 (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">days</span> (<a class="schemedoc-name" href="../../../../../lib/man/time.html#days-in-month" title="Manual: time">days-in-month</a> month year))
       (<span class="local-name-binding">half-column-width</span> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX258" title="R5RS Scheme form">quotient</a> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> <a class="applied-name" href="calendar-1.html#month-width" title="calendar">month-width</a> 40) 2))  <span class="comment">; not used any more</span><br />       (<span class="local-name-binding">other-columns-width</span> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX258" title="R5RS Scheme form">quotient</a> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> <a class="applied-name" href="calendar-1.html#month-width" title="calendar">month-width</a> 40) number-of-divisions))
      )
  (<a class="applied-name" href="calendar-1.html#cal-table" title="calendar">cal-table</a> 0 
    <span class="comment">; width list</span><br />    (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX334" title="R5RS Scheme form">append</a> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> 20 20) (<a class="schemedoc-name" href="../../../../../lib/man/general.html#make-list" title="Manual: general">make-list</a> number-of-divisions other-columns-width))
    
    <span class="comment">; background color function</span><br />    (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">row</span>)
     (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX200" title="R5RS Scheme form">equal?</a> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> row) (<a class="applied-name" href="calendar-1.html#week-sep" title="calendar">week-sep</a>))
      (<a class="schemedoc-name" href="../../../../../lib/man/general.html#make-list" title="Manual: general">make-list</a> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> number-of-divisions 2) (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> <a class="applied-name" href="calendar-1.html#week-separator-of-calendar" title="calendar">week-separator-of-calendar</a> 'thin) <a class="schemedoc-name" href="../../../../../lib/man/color.html#grey1" title="Manual: color">grey1</a> <a class="schemedoc-name" href="../../../../../lib/man/color.html#black" title="Manual: color">black</a>))         <span class="comment">; WEEK SEPARATOR</span><br />      (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">day</span> (<a class="schemedoc-name" href="../../../../../lib/man/general.html#as-number" title="Manual: general">as-number</a> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cadr</a> row)))
             (<span class="local-name-binding">start-time</span> (<a class="schemedoc-name" href="../../../../../lib/man/time.html#second-count" title="Manual: time">second-count</a> year month day 0 0 0))
             (<span class="local-name-binding">end-time</span> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> start-time <a class="schemedoc-name" href="../../../../../lib/man/time.html#seconds-in-a-day" title="Manual: time">seconds-in-a-day</a>))
             (<span class="local-name-binding">today</span> (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> today-info? (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX239" title="R5RS Scheme form">&gt;=</a> (current-time) start-time) (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX238" title="R5RS Scheme form">&lt;=</a> (current-time) end-time)))
             (<span class="local-name-binding">event-color-1</span> (<a class="applied-name" href="calendar-1.html#the-event-color" title="calendar">the-event-color</a> (<a class="applied-name" href="calendar-1.html#first-half-day-interval" title="calendar">first-half-day-interval</a> year month day)  day))       <span class="comment">; not used in this version</span><br />             (<span class="local-name-binding">event-color-2</span> (<a class="applied-name" href="calendar-1.html#the-event-color" title="calendar">the-event-color</a> (<a class="applied-name" href="calendar-1.html#second-half-day-interval" title="calendar">second-half-day-interval</a> year month day) day))      <span class="comment">; not used in this version</span><br />            )
        (<a class="applied-name" href="calendar-1.html#background-color-list" title="calendar">background-color-list</a> number-of-divisions (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX246" title="R5RS Scheme form">even?</a> day) today))))

    <span class="comment">; week separator predicate: NOT USED ANY MORE. SEPARATORS AFTER SUNDAY HOW HAS THEIR OWN ROW. THUS ALWAYS FALSE</span><br />    (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">row</span>) #f)

    <span class="comment">; font-size</span><br />    <a class="applied-name" href="calendar-1.html#calendar-font-size" title="calendar">calendar-font-size</a>

    (<a class="applied-name" href="calendar-1.html#month-list-with-week-separators" title="calendar">month-list-with-week-separators</a> (<a class="applied-name" href="calendar-1.html#make-second-counts" title="calendar">make-second-counts</a> month year) days year month number-of-divisions)

)))

<a name="background-color-list"></a><span></span>(<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(background-color-list number-of-divisions even? today?)</span>
  (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX334" title="R5RS Scheme form">append</a> 
    (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> (today? (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> <a class="schemedoc-name" href="../../../../../lib/man/color.html#red" title="Manual: color">red</a> <a class="schemedoc-name" href="../../../../../lib/man/color.html#red" title="Manual: color">red</a>))
          (even? (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> <a class="schemedoc-name" href="../../../../../lib/man/color.html#green1" title="Manual: color">green1</a> <a class="schemedoc-name" href="../../../../../lib/man/color.html#green1" title="Manual: color">green1</a>))
          (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a>  (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> <a class="schemedoc-name" href="../../../../../lib/man/color.html#green2" title="Manual: color">green2</a> <a class="schemedoc-name" href="../../../../../lib/man/color.html#green2" title="Manual: color">green2</a>)))

    (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> even? (<a class="schemedoc-name" href="../../../../../lib/man/general.html#make-list" title="Manual: general">make-list</a> number-of-divisions <a class="schemedoc-name" href="../../../../../lib/man/color.html#green1" title="Manual: color">green1</a>)  (<a class="schemedoc-name" href="../../../../../lib/man/general.html#make-list" title="Manual: general">make-list</a> number-of-divisions <a class="schemedoc-name" href="../../../../../lib/man/color.html#green2" title="Manual: color">green2</a>))))


<a name="month-list-with-week-separators"></a><span class="comment">; Given the second-count-list for a month, return a list of (second-count brief-weekday day tasks-1 tasks-2 ... ) for each day in month if year.
; The parameter month is supposed to have days number of days.
; Week separators are returned as (0 "" "" "" "" ...), made by the function make-week-separator.</span><br /><a name="month-list-with-week-separators"></a><span></span>(<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(month-list-with-week-separators second-count-list days year month number-of-divisions)</span>
  (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">entries</span>  (<a class="schemedoc-name" href="../../../../../lib/man/general.html#map2" title="Manual: general">map2</a> (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">day</span> <span class="local-name-binding">sec-count</span>)
                            (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX334" title="R5RS Scheme form">append</a> 
                              (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> sec-count (<a class="schemedoc-name" href="../../../../../lib/man/time.html#brief-weekday" title="Manual: time">brief-weekday</a> sec-count) (<a class="schemedoc-name" href="../../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> day))
                              (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">n</span>) (<a class="applied-name" href="calendar-1.html#tasks" title="calendar">tasks</a> year month day n)) (<a class="schemedoc-name" href="../../../../../lib/man/general.html#number-interval" title="Manual: general">number-interval</a> 1 number-of-divisions))  <span class="comment">; tasks of the number-of-divisions periods</span><br />                            )
                         )
                         (<a class="schemedoc-name" href="../../../../../lib/man/general.html#number-interval" title="Manual: general">number-interval</a> 1 days)
                         second-count-list
                        ))
         (<span class="local-name-binding">entries-with-sep</span> (<a class="applied-name" href="calendar-1.html#week-separator-extend" title="calendar">week-separator-extend</a> entries number-of-divisions))
        )
   (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> <a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> entries-with-sep)))

<a name="week-separator-extend"></a><span class="comment">; Introduce week separators into entries</span><br /><a name="week-separator-extend"></a><span></span>(<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(week-separator-extend entries number-of-divisions)</span>
  (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> entries) '())
        ((<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX235" title="R5RS Scheme form">=</a> 7 (<a class="schemedoc-name" href="../../../../../lib/man/time.html#weekday-number" title="Manual: time">weekday-number</a> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">caar</a> entries)))
          (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> entries)
                (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="applied-name" href="calendar-1.html#make-week-separator" title="calendar">make-week-separator</a> number-of-divisions)
                      (<a class="applied-name" href="calendar-1.html#week-separator-extend" title="calendar">week-separator-extend</a> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> entries) number-of-divisions))))
        (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> entries) (<a class="applied-name" href="calendar-1.html#week-separator-extend" title="calendar">week-separator-extend</a> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> entries) number-of-divisions)))))

<a name="make-week-separator"></a><span></span>(<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(make-week-separator number-of-divisions)</span>
  (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> 0 (<a class="schemedoc-name" href="../../../../../lib/man/general.html#make-list" title="Manual: general">make-list</a> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> 2 number-of-divisions) (<a class="applied-name" href="calendar-1.html#week-sep" title="calendar">week-sep</a>))))

<a name="year-month-list"></a><span class="comment">; enumerate years and months, starting from start-year and start-month. The entries in the list
; are of the form (y . m). The length of the list is number-of-months</span><br /><a name="year-month-list"></a><span></span>(<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(year-month-list start-year start-month number-of-months)</span>
  (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX235" title="R5RS Scheme form">=</a> 0 number-of-months) '())
        ((<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX235" title="R5RS Scheme form">=</a> start-month 12) (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> start-year start-month) (<a class="applied-name" href="calendar-1.html#year-month-list" title="calendar">year-month-list</a> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> 1 start-year) 1 (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> number-of-months 1))))
        ((<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX236" title="R5RS Scheme form">&lt;</a> start-month 12) (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> start-year start-month) (<a class="applied-name" href="calendar-1.html#year-month-list" title="calendar">year-month-list</a> start-year (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> 1 start-month) (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> number-of-months 1)))) 
        (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (error "year-month-list problem"))))

<div class="schemedoc-section-comment">;;; The main calendar function. 
;;; In this section we find the most important function at all, the calendar function which generates a calendar.</div>
<a name="calendar"></a><a name="calendar"></a><span><a href="../calendar.html#calendar"><img src="../../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(calendar year from-month number-of-months . optional-parameter-list)</span>
 (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">show-today?</span> (<a class="schemedoc-name" href="../../../../../lib/man/general.html#optional-parameter" title="Manual: general">optional-parameter</a> 1 optional-parameter-list #f))
       (<span class="local-name-binding">number-of-divisions</span> (<a class="schemedoc-name" href="../../../../../lib/man/general.html#optional-parameter" title="Manual: general">optional-parameter</a> 2 optional-parameter-list 2))
      )
  (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX235" title="R5RS Scheme form">=</a> number-of-divisions (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX333" title="R5RS Scheme form">length</a> <a class="applied-name" href="calendar-1.html#calendar-division-of-day" title="calendar">calendar-division-of-day</a>)))
      (<a class="schemedoc-name" href="../../../../../lib/man/general.html#laml-error" title="Manual: general">laml-error</a> "calendar: the value of number-of-divisions must be equal to the length of the list calendar-division-of-day" number-of-divisions (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX333" title="R5RS Scheme form">length</a> <a class="applied-name" href="calendar-1.html#calendar-division-of-day" title="calendar">calendar-division-of-day</a>)))
  (<a class="schemedoc-name" href="../../../../../lib/man/xhtml10-convenience.html#table-2" title="Manual: xhtml10-convenience">table-2</a> 1 (<a class="schemedoc-name" href="../../../../../lib/man/general.html#make-list" title="Manual: general">make-list</a> number-of-months <a class="applied-name" href="calendar-1.html#month-width" title="calendar">month-width</a>)
             (<a class="schemedoc-name" href="../../../../../lib/man/general.html#make-list" title="Manual: general">make-list</a> number-of-months <a class="applied-name" href="calendar-1.html#calendar-background-color" title="calendar">calendar-background-color</a>)
             (<a class="applied-name" href="calendar-1.html#month-list" title="calendar">month-list</a> from-month year number-of-months)
     (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> 
        (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">y-m</span>) (<a class="applied-name" href="calendar-1.html#month-column" title="calendar">month-column</a> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> y-m) (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> y-m) show-today? number-of-divisions)) (<a class="applied-name" href="calendar-1.html#year-month-list" title="calendar">year-month-list</a> year from-month number-of-months))))))

<a name="xml-error-truncation-length"></a><span></span>(<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">xml-error-truncation-length</span> 1000)

<a name="week-tasks"></a><span class="comment">; part-of-day addresses a (relative) time interval in the calendar-division-of-day, and it is an integer (1 or larger).</span><br /><a name="week-tasks"></a><span></span>(<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(week-tasks year month day part-of-day)</span>
 (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">cal-interval</span> (<a class="applied-name" href="calendar-1.html#part-of-day-interval" title="calendar">part-of-day-interval</a> year month day part-of-day))
        (<span class="local-name-binding">matching-events</span> 
          (<a class="applied-name" href="calendar-1.html#find-all" title="calendar">find-all</a>
             (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">e</span>) (<a class="applied-name" href="calendar-1.html#interval-overlap?" title="calendar">interval-overlap?</a> cal-interval (<a class="applied-name" href="calendar-1.html#event-interval" title="calendar">event-interval</a> e)))
             calendar-events))
        (<span class="local-name-binding">wnc</span> ""))
  (<a class="schemedoc-name" href="../../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#div" title="Manual: xhtml10-transitional-mirror">div</a> (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX200" title="R5RS Scheme form">equal?</a> "" wnc) "" (<a class="schemedoc-name" href="../../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#em" title="Manual: xhtml10-transitional-mirror">em</a> wnc)) (<a class="applied-name" href="calendar-1.html#boil-together-week" title="calendar">boil-together-week</a> matching-events ""))))

<a name="boil-together-week"></a><span class="comment">; aggreates the matching event to a single string, use separator sep between entries.
; A variant of boil-together.</span><br /><a name="boil-together-week"></a><span></span>(<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(boil-together-week matching-events sep)</span>
  (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> matching-events)
      (<a class="schemedoc-name" href="../../../../../lib/man/xhtml10-convenience.html#space" title="Manual: xhtml10-convenience">space</a> 1)
      (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">res</span>  (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">s</span>)
			 (con s sep))
		       (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> 
                          (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">e</span>) 
                           (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">brief-txt</span> (<a class="applied-name" href="calendar-1.html#event-brief-text" title="calendar">event-brief-text</a> e))
                                  (<span class="local-name-binding">al</span> (<a class="applied-name" href="calendar-1.html#level-of-attention" title="calendar">level-of-attention</a> brief-txt))
                                  (<span class="local-name-binding">unattensioned-brief-txt</span> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX391" title="R5RS Scheme form">substring</a> brief-txt 0 (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX378" title="R5RS Scheme form">string-length</a> brief-txt) al)))
                                 )
                            (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a>  (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX237" title="R5RS Scheme form">&gt;</a> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX378" title="R5RS Scheme form">string-length</a> (<a class="applied-name" href="calendar-1.html#event-url" title="calendar">event-url</a> e)) 0) 
				 (<a class="schemedoc-name" href="../../../../../lib/man/xhtml10-convenience.html#color-frame" title="Manual: xhtml10-convenience">color-frame</a>  (<a class="applied-name" href="calendar-1.html#attention-deco-week" title="calendar">attention-deco-week</a> al (<a class="schemedoc-name" href="../../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#a" title="Manual: xhtml10-transitional-mirror">a</a> 'href (<a class="applied-name" href="calendar-1.html#event-url" title="calendar">event-url</a> e)  (<a class="applied-name" href="calendar-1.html#event-long-text" title="calendar">event-long-text</a> e))) (<a class="applied-name" href="calendar-1.html#event-color" title="calendar">event-color</a> e))
				 (<a class="schemedoc-name" href="../../../../../lib/man/xhtml10-convenience.html#color-frame" title="Manual: xhtml10-convenience">color-frame</a>  (<a class="applied-name" href="calendar-1.html#attention-deco-week" title="calendar">attention-deco-week</a> al (<a class="schemedoc-name" href="../../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#span" title="Manual: xhtml10-transitional-mirror">span</a> (<a class="applied-name" href="calendar-1.html#event-long-text" title="calendar">event-long-text</a> e) )) (<a class="applied-name" href="calendar-1.html#event-color" title="calendar">event-color</a> e)) )))
			    (sort-list matching-events <a class="applied-name" href="calendar-1.html#event-leq?" title="calendar">event-leq?</a>) ))))
	res)))


<a name="week-calendar"></a><a name="week-calendar"></a><span><a href="../calendar.html#week-calendar"><img src="../../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(week-calendar t0 . optional-parameter-list)</span>
 (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">number-of-divisions</span> (<a class="schemedoc-name" href="../../../../../lib/man/general.html#optional-parameter" title="Manual: general">optional-parameter</a> 1 optional-parameter-list 2))
       (<span class="local-name-binding">week-cal-column-width</span> (<a class="schemedoc-name" href="../../../../../lib/man/general.html#optional-parameter" title="Manual: general">optional-parameter</a> 2 optional-parameter-list 200))
      )
  (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">dec-t0</span> (<a class="schemedoc-name" href="../../../../../lib/man/time.html#time-decode" title="Manual: time">time-decode</a> t0))
         (<span class="local-name-binding">wdn</span> (<a class="schemedoc-name" href="../../../../../lib/man/time.html#weekday-number" title="Manual: time">weekday-number</a> t0))
         (<span class="local-name-binding">day-start</span> (<a class="schemedoc-name" href="../../../../../lib/man/time.html#time-encode" title="Manual: time">time-encode</a> (<a class="schemedoc-name" href="../../../../../lib/man/time.html#year-of-time" title="Manual: time">year-of-time</a> dec-t0) (<a class="schemedoc-name" href="../../../../../lib/man/time.html#month-of-time" title="Manual: time">month-of-time</a> dec-t0) (<a class="schemedoc-name" href="../../../../../lib/man/time.html#day-of-time" title="Manual: time">day-of-time</a> dec-t0) 0 0 0))
         (<span class="local-name-binding">week-start</span> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> day-start (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX250" title="R5RS Scheme form">*</a> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> wdn 1) <a class="schemedoc-name" href="../../../../../lib/man/time.html#seconds-in-a-day" title="Manual: time">seconds-in-a-day</a>)))
         (<span class="local-name-binding">decoded-week-start</span> (<a class="schemedoc-name" href="../../../../../lib/man/time.html#time-decode" title="Manual: time">time-decode</a> week-start))
         (<span class="local-name-binding">week-end</span> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX250" title="R5RS Scheme form">*</a> 7 <a class="schemedoc-name" href="../../../../../lib/man/time.html#seconds-in-a-day" title="Manual: time">seconds-in-a-day</a>) week-start) 1))
         (<span class="local-name-binding">week-start-time-list</span> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">i</span>) (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> week-start (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX250" title="R5RS Scheme form">*</a> i <a class="schemedoc-name" href="../../../../../lib/man/time.html#seconds-in-a-day" title="Manual: time">seconds-in-a-day</a>))) (<a class="schemedoc-name" href="../../../../../lib/man/general.html#number-interval" title="Manual: general">number-interval</a> 0 6)))
         (<span class="local-name-binding">weekday-list</span> (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> <a class="schemedoc-name" href="../../../../../man/laml.html#language-preference" title="Manual: laml">language-preference</a> 'english)
                           (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> "Monday" "Tuesday" "Wednesday" "Thursday" "Friday" "Saturday" "Sunday")
                           (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> "Mandag" "Tirsdag" "Onsdag" "Torsdag" "Fredag" "L&#248;rdag" "S&#248;ndag")
                       ))
         (<span class="local-name-binding">weekday-assoc-list</span> (<a class="schemedoc-name" href="../../../../../lib/man/general.html#pair-up" title="Manual: general">pair-up</a> weekday-list week-start-time-list))
        )
   (<a class="schemedoc-name" href="../../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#div" title="Manual: xhtml10-transitional-mirror">div</a>
     (<a class="schemedoc-name" href="../../../../../man/laml.html#text-choice" title="Manual: laml">text-choice</a> "Ugestart: " "Start of week: ") (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> (<a class="schemedoc-name" href="../../../../../lib/man/time.html#date-time" title="Manual: time">date-time</a> week-start)) (<a class="schemedoc-name" href="../../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#br" title="Manual: xhtml10-transitional-mirror">br</a>)
     (<a class="schemedoc-name" href="../../../../../man/laml.html#text-choice" title="Manual: laml">text-choice</a> "Ugenummer: " "Week number: ") (<a class="schemedoc-name" href="../../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> (<a class="schemedoc-name" href="../../../../../lib/man/time.html#danish-week-number" title="Manual: time">danish-week-number</a> week-start)) (<a class="schemedoc-name" href="../../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#p" title="Manual: xhtml10-transitional-mirror">p</a>)

     (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">other-columns-width</span> week-cal-column-width))     
      (<a class="applied-name" href="calendar-1.html#cal-table" title="calendar">cal-table</a>
       1 

       <span class="comment">; width list</span><br />       (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX334" title="R5RS Scheme form">append</a> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> 100 50) (<a class="schemedoc-name" href="../../../../../lib/man/general.html#make-list" title="Manual: general">make-list</a> number-of-divisions other-columns-width))

       <span class="comment">; background color function</span><br />       (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">row</span>)
         (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">weekday</span> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> row))
                (<span class="local-name-binding">start-time</span> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX343" title="R5RS Scheme form">assoc</a> weekday weekday-assoc-list)))
                (<span class="local-name-binding">cur-time</span> (current-time)))
          (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX238" title="R5RS Scheme form">&lt;=</a> start-time cur-time) (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX238" title="R5RS Scheme form">&lt;=</a> cur-time (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> start-time <a class="schemedoc-name" href="../../../../../lib/man/time.html#seconds-in-a-day" title="Manual: time">seconds-in-a-day</a>)))
                    (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX334" title="R5RS Scheme form">append</a> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> <a class="schemedoc-name" href="../../../../../lib/man/color.html#red" title="Manual: color">red</a> <a class="schemedoc-name" href="../../../../../lib/man/color.html#red" title="Manual: color">red</a>) (<a class="schemedoc-name" href="../../../../../lib/man/general.html#make-list" title="Manual: general">make-list</a> number-of-divisions <a class="schemedoc-name" href="../../../../../lib/man/color.html#green2" title="Manual: color">green2</a>)))
                (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="schemedoc-name" href="../../../../../lib/man/general.html#make-list" title="Manual: general">make-list</a> (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> 2 number-of-divisions) <a class="schemedoc-name" href="../../../../../lib/man/color.html#green2" title="Manual: color">green2</a>)))))

       (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">row</span>) #f) <span class="comment">; not relevant</span><br />
       3  <span class="comment">; font size</span><br />
       <span class="comment">; content list</span><br />       (<a class="schemedoc-name" href="../../../../../lib/man/general.html#map2" title="Manual: general">map2</a> (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">weekday</span> <span class="local-name-binding">daystart-time</span>)
               (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">decoded-daystart-time</span> (<a class="schemedoc-name" href="../../../../../lib/man/time.html#time-decode" title="Manual: time">time-decode</a> daystart-time))
                      (<span class="local-name-binding">day</span> (<a class="schemedoc-name" href="../../../../../lib/man/time.html#day-of-time" title="Manual: time">day-of-time</a> decoded-daystart-time))
                      (<span class="local-name-binding">month</span> (<a class="schemedoc-name" href="../../../../../lib/man/time.html#month-of-time" title="Manual: time">month-of-time</a> decoded-daystart-time))
                      (<span class="local-name-binding">year</span> (<a class="schemedoc-name" href="../../../../../lib/man/time.html#year-of-time" title="Manual: time">year-of-time</a> decoded-daystart-time))
                     )
                 (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX334" title="R5RS Scheme form">append</a> 
                   (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> weekday (<a class="schemedoc-name" href="../../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> day))
                   (<a class="scheme-procedure-name" href="../../../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> (<a class="scheme-syntax-name" href="../../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">n</span>) (<a class="applied-name" href="calendar-1.html#week-tasks" title="calendar">week-tasks</a> year month day n)) (<a class="schemedoc-name" href="../../../../../lib/man/general.html#number-interval" title="Manual: general">number-interval</a> 1 number-of-divisions))  <span class="comment">; week-tasks of the number-of-divisions periods</span><br />                 )
               )
             )
             weekday-list  week-start-time-list)))))))
</pre></font><div>&nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p></div></body></html>