<html><head><link href="stylesheets/program.css" rel="stylesheet" title="program" type="text/css"/> <title>Source file</title></head><body bgcolor = "#ffd2ff" text = "#000000" link = "#000000" vlink = "#000000"  ><font size = "3"  ><pre><div class = "schemedoc-section-comment"  >;;; The program copies numbered wav files, to the files, as described by the
;;; -.spk file generated by leno in the internal directory.
;;; Change the constants in the section below.
;;; Put this file in a directory together with the sound clips.
;;; The program copies the sound clips from the current directory to the parent directory (../),
;;; performing the necessary renamings. It only copies those files, such as 1.wav, 2.wav, which actually
;;; are located in the directory.</div>
(<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX468" target="documentation-frame" title="R5RS Scheme form">load</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX392" target="documentation-frame" title="R5RS Scheme form">string-append</a> laml-dir "laml.scm"))

<a name="max-file-name-length"></a><span class = "comment"  >; ---------------------------------------------------------------------------------------------------
; PARAMETERS - USER SETTINGS</span><br/>
<a name="max-file-name-length"></a><span><span><a href="new-sound-copy.laml.html#max-file-name-length"><img src="./images/small-square.gif" title="Show source file in small font" alt="" border="0"/></a></span> <span><a href="cross-reference-index-m.html#max-file-name-length" target="control-frame"><img src="./images/small-green-up-triangle.gif" title="In new-sound-copy.laml: Link from max-file-name-length to it&#39;s cross reference table entry" alt="" border="0"/></a></span> </span><br/>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" target="documentation-frame" title="R5RS Scheme form">define</a> <span class = "signature"  >max-file-name-length</span> 64)

<a name="lecture-id"></a><span class = "comment"  >; CHANGE SETTINGS IN THIS SECTION OF THE PROGRAM</span><br/>
<a name="lecture-id"></a><span><span><a href="new-sound-copy.laml.html#lecture-id"><img src="./images/small-square.gif" title="Show source file in small font" alt="" border="0"/></a></span> <span><a href="cross-reference-index-l.html#lecture-id" target="control-frame"><img src="./images/small-green-up-triangle.gif" title="In new-sound-copy.laml: Link from lecture-id to it&#39;s cross reference table entry" alt="" border="0"/></a></span> <a href="documentation.html#leno-sound" target="documentation-frame"><img src="./images/doc-left-weak.gif" title="5.2. A LENO material with audio" alt="" border="0"/></a></span><br/>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" target="documentation-frame" title="R5RS Scheme form">define</a> <span class = "signature"  >lecture-id</span> 'single-audio)  

<a name="note-source-directory"></a><span class = "comment"  >; The relative path from the sound source dir (current dir) to the note source directory.</span><br/><a name="note-source-directory"></a><span><span><a href="new-sound-copy.laml.html#note-source-directory"><img src="./images/small-square.gif" title="Show source file in small font" alt="" border="0"/></a></span> <span><a href="cross-reference-index-n.html#note-source-directory" target="control-frame"><img src="./images/small-green-up-triangle.gif" title="In new-sound-copy.laml: Link from note-source-directory to it&#39;s cross reference table entry" alt="" border="0"/></a></span> <a href="documentation.html#leno-sound" target="documentation-frame"><img src="./images/doc-left-weak.gif" title="5.2. A LENO material with audio" alt="" border="0"/></a></span><br/>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" target="documentation-frame" title="R5RS Scheme form">define</a> <span class = "signature"  >note-source-directory</span> "../../")   

<a name="sound-extension"></a><span><span><a href="new-sound-copy.laml.html#sound-extension"><img src="./images/small-square.gif" title="Show source file in small font" alt="" border="0"/></a></span> <span><a href="cross-reference-index-s.html#sound-extension" target="control-frame"><img src="./images/small-green-up-triangle.gif" title="In new-sound-copy.laml: Link from sound-extension to it&#39;s cross reference table entry" alt="" border="0"/></a></span> <a href="documentation.html#leno-sound" target="documentation-frame"><img src="./images/doc-left-weak.gif" title="5.2. A LENO material with audio" alt="" border="0"/></a></span><br/>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" target="documentation-frame" title="R5RS Scheme form">define</a> <span class = "signature"  >sound-extension</span> "wav") 


<a name="wave-file-numbers-from-current-dir"></a><span class = "comment"  >; END USER SETTINGS.
; ------------------------------------------------------------------</span><br/>
<a name="wave-file-numbers-from-current-dir"></a><span><span><a href="new-sound-copy.laml.html#wave-file-numbers-from-current-dir"><img src="./images/small-square.gif" title="Show source file in small font" alt="" border="0"/></a></span> <span><a href="cross-reference-index-w.html#wave-file-numbers-from-current-dir" target="control-frame"><img src="./images/small-green-up-triangle.gif" title="In new-sound-copy.laml: Link from wave-file-numbers-from-current-dir to it&#39;s cross reference table entry" alt="" border="0"/></a></span> </span><br/>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" target="documentation-frame" title="R5RS Scheme form">define</a> <span class = "signature"  >(wave-file-numbers-from-current-dir)</span>
 (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX121" target="documentation-frame" title="R5RS Scheme form">let</a> ((<span class = "local-name-binding"  >files</span> (directory-list (<a class="schemedoc-name" href="../../../man/laml.html#startup-directory" target="documentation-frame" title="Manual: laml">startup-directory</a>))))
  (<a class="schemedoc-name" href="../../../lib/man/general.html#filter" target="documentation-frame" title="Manual: general">filter</a> (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX98" target="documentation-frame" title="R5RS Scheme form">lambda</a> (<span class = "local-name-binding"  >x</span>) x)
   (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX412" target="documentation-frame" title="R5RS Scheme form">map</a> (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX98" target="documentation-frame" title="R5RS Scheme form">lambda</a> (<span class = "local-name-binding"  >fn</span>) 
          (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX103" target="documentation-frame" title="R5RS Scheme form">if</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#numeric-string?" target="documentation-frame" title="Manual: general">numeric-string?</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#file-name-proper" target="documentation-frame" title="Manual: general">file-name-proper</a> fn))
	      (<a class="schemedoc-name" href="../../../lib/man/general.html#as-number" target="documentation-frame" title="Manual: general">as-number</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#file-name-proper" target="documentation-frame" title="Manual: general">file-name-proper</a> fn))
	    #f))
        files))))

<a name="wave-file-numbers"></a><span><span><a href="new-sound-copy.laml.html#wave-file-numbers"><img src="./images/small-square.gif" title="Show source file in small font" alt="" border="0"/></a></span> <span><a href="cross-reference-index-w.html#wave-file-numbers" target="control-frame"><img src="./images/small-green-up-triangle.gif" title="In new-sound-copy.laml: Link from wave-file-numbers to it&#39;s cross reference table entry" alt="" border="0"/></a></span> </span><br/>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" target="documentation-frame" title="R5RS Scheme form">define</a> <span class = "signature"  >wave-file-numbers</span> (<a class="applied-name" href="new-sound-copy.laml-LARGE.html#wave-file-numbers-from-current-dir" title="new-sound-copy.laml">wave-file-numbers-from-current-dir</a>))


<a name="speak-info-list"></a><span><span><a href="new-sound-copy.laml.html#speak-info-list"><img src="./images/small-square.gif" title="Show source file in small font" alt="" border="0"/></a></span> <span><a href="cross-reference-index-s.html#speak-info-list" target="control-frame"><img src="./images/small-green-up-triangle.gif" title="In new-sound-copy.laml: Link from speak-info-list to it&#39;s cross reference table entry" alt="" border="0"/></a></span> </span><br/>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" target="documentation-frame" title="R5RS Scheme form">define</a> <span class = "signature"  >speak-info-list</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#file-read" target="documentation-frame" title="Manual: general">file-read</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX392" target="documentation-frame" title="R5RS Scheme form">string-append</a> (<a class="schemedoc-name" href="../../../man/laml.html#startup-directory" target="documentation-frame" title="Manual: laml">startup-directory</a>) <a class="applied-name" href="new-sound-copy.laml-LARGE.html#note-source-directory" title="new-sound-copy.laml">note-source-directory</a> "internal/" (<a class="schemedoc-name" href="../../../lib/man/general.html#as-string" target="documentation-frame" title="Manual: general">as-string</a> <a class="applied-name" href="new-sound-copy.laml-LARGE.html#lecture-id" title="new-sound-copy.laml">lecture-id</a>) "." "spk")))

(<a class="schemedoc-name" href="../../../lib/man/general.html#display-message" target="documentation-frame" title="Manual: general">display-message</a> "THE NEW LENO SHOW-AND-SPEAK SOUND UTILTIY PROGRAM.")

(<a class="schemedoc-name" href="../../../lib/man/general.html#display-message" target="documentation-frame" title="Manual: general">display-message</a> "Moving and renaming files to parent directory")

<a name="find-sound-entry"></a><span><span><a href="new-sound-copy.laml.html#find-sound-entry"><img src="./images/small-square.gif" title="Show source file in small font" alt="" border="0"/></a></span> <span><a href="cross-reference-index-f.html#find-sound-entry" target="control-frame"><img src="./images/small-green-up-triangle.gif" title="In new-sound-copy.laml: Link from find-sound-entry to it&#39;s cross reference table entry" alt="" border="0"/></a></span> </span><br/>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" target="documentation-frame" title="R5RS Scheme form">define</a> <span class = "signature"  >(find-sound-entry n speak-info-list)</span>
 (<a class="schemedoc-name" href="../../../lib/man/general.html#find-in-list" target="documentation-frame" title="Manual: general">find-in-list</a>
   (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX98" target="documentation-frame" title="R5RS Scheme form">lambda</a> (<span class = "local-name-binding"  >e</span>)
     (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX121" target="documentation-frame" title="R5RS Scheme form">let</a> ((<span class = "local-name-binding"  >sound-number</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX337" target="documentation-frame" title="R5RS Scheme form">list-ref</a> e 9)))
       (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX235" target="documentation-frame" title="R5RS Scheme form">=</a> n sound-number)))
   speak-info-list))

(<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX413" target="documentation-frame" title="R5RS Scheme form">for-each</a>
  (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX98" target="documentation-frame" title="R5RS Scheme form">lambda</a> (<span class = "local-name-binding"  >n</span>)
    (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX122" target="documentation-frame" title="R5RS Scheme form">let*</a> ((<span class = "local-name-binding"  >sound-entry</span> (<a class="applied-name" href="new-sound-copy.laml-LARGE.html#find-sound-entry" title="new-sound-copy.laml">find-sound-entry</a> n <a class="applied-name" href="new-sound-copy.laml-LARGE.html#speak-info-list" title="new-sound-copy.laml">speak-info-list</a>))
           (<span class = "local-name-binding"  >sound-name</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX337" target="documentation-frame" title="R5RS Scheme form">list-ref</a> sound-entry 6))
           (<span class = "local-name-binding"  >sound-name-ext</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX392" target="documentation-frame" title="R5RS Scheme form">string-append</a> sound-name "." <a class="applied-name" href="new-sound-copy.laml-LARGE.html#sound-extension" title="new-sound-copy.laml">sound-extension</a>))
           (<span class = "local-name-binding"  >wav-name</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX392" target="documentation-frame" title="R5RS Scheme form">string-append</a> "../" sound-name-ext))
           (<span class = "local-name-binding"  >orig-name</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX392" target="documentation-frame" title="R5RS Scheme form">string-append</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-string" target="documentation-frame" title="Manual: general">as-string</a> n) "." <a class="applied-name" href="new-sound-copy.laml-LARGE.html#sound-extension" title="new-sound-copy.laml">sound-extension</a>))
          )

      (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX103" target="documentation-frame" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX237" target="documentation-frame" title="R5RS Scheme form">&gt;</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX378" target="documentation-frame" title="R5RS Scheme form">string-length</a> sound-name-ext) <a class="applied-name" href="new-sound-copy.laml-LARGE.html#max-file-name-length" title="new-sound-copy.laml">max-file-name-length</a>)
          (error (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX392" target="documentation-frame" title="R5RS Scheme form">string-append</a> "File name length exceeded: " sound-name-ext)))

      (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX103" target="documentation-frame" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX304" target="documentation-frame" title="R5RS Scheme form">not</a> (file-exists? wav-name))
        (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX125" target="documentation-frame" title="R5RS Scheme form">begin</a> <span class = "comment"  >; move file</span><br/>          (<a class="schemedoc-name" href="../../../lib/man/general.html#display-message" target="documentation-frame" title="Manual: general">display-message</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-string" target="documentation-frame" title="Manual: general">as-string</a> n))
          (copy-file orig-name wav-name)
          (delete-file orig-name)
        )
        (<a class="schemedoc-name" href="../../../lib/man/general.html#display-warning" target="documentation-frame" title="Manual: general">display-warning</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX392" target="documentation-frame" title="R5RS Scheme form">string-append</a> "The file " sound-name  "." <a class="applied-name" href="new-sound-copy.laml-LARGE.html#sound-extension" title="new-sound-copy.laml">sound-extension</a> " exists - cannot overwrite")))))
  <a class="applied-name" href="new-sound-copy.laml-LARGE.html#wave-file-numbers" title="new-sound-copy.laml">wave-file-numbers</a>)

(<a class="schemedoc-name" href="../../../lib/man/general.html#display-message" target="documentation-frame" title="Manual: general">display-message</a> "Done")
    










</pre></font><div>&nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p></div></body></html>