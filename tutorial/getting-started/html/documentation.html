<html><head><link href="stylesheets/documentation.css" rel="stylesheet" title="documentation" type="text/css" /> <title>documentation</title></head><body bgcolor="#ffecd9" text="#000000" link="#000000" vlink="#000000"><a name="START"></a><h1><font color="#0000ff">Getting started with LAML</font></h1><h3><span>Kurt N&#248;rmark   &copy;</span> &nbsp; &nbsp; normark@cs.aau.dk <br /> Department of Computer Science, Aalborg University</h3><p></p><div class="elucidator-abstract"><b>Abstract.</b> This is a chapter that is indented to introduce the most fundamental aspects of LAML. It is part of the overall elucidative tutorial of the LAML software package. In later parts of the tutorial we will come back to many of the issues, which are introduced in this chapter. </div><div>&nbsp; <p></p></div><div class="elucidator-section"><a name="intro"></a><div><a href="documentation.html#START"><img src="./images/small-up.gif" title="" alt="" border="0" /></a> <img src="./images/small-prev-blind.gif" title="" alt="" border="0" /> <a href="documentation.html#factorials"><img src="./images/small-next.gif" title="Factorial pages" alt="" border="0" /></a></div><div><b><font size="5"><span>1 &nbsp; &nbsp; Introduction</span></font></b></div><div class="body-normal"><p>We will here assume that you successfully have downloaded and installed LAML on your computer. Now it is time to use it. It will be good for you if you already have some Scheme experience, but it is also possible to learn Scheme while you go along. There are many ways to do so. We have developed a <a href="http://www.cs.auc.dk/~normark/prog3-03/html/notes/index.html" target="schemeedu">web-based material about functional programming with Scheme</a> which you may consider. This particular material is with web programming examples, which are oriented toward LAML.</p> <p>This tutorial, and the other tutorials, are elucidative programs. The frame you are reading now contains the tutorial text. The other frame, which is usually shown to the right of the current frame, is intended to show programs. The upper right menu presents all the programs of this tutorial. The mutual navigation between documentation and program is one of the key ideas of elucidative programming. For more info about elucidative programming click one of the yellow question mark icon in the top control frame.</p> <p>Please notice that you can navigate from a Scheme program to a relevant place in the Scheme report, by clicking on the bold face keywords or the (slightly) <font color="#a64700">brown</font> procedure/function names. You can also navigate to LAML manual pages by clicking on the (slightly) <font color="#005a00">dark green</font> procedure/function names. Such names appear in both the tutorial text and in the programs. Also notice that all the circle shaped color marks - called <em>source markers</em> - can be navigated. <em>Try out the elucidative navigation possibilities right away!</em></p></div><div style="margin-left:10px;"></div></div><div>&nbsp; <p></p></div><div class="elucidator-section"><a name="factorials"></a><div><a href="documentation.html#START"><img src="./images/small-up.gif" title="" alt="" border="0" /></a> <a href="documentation.html#intro"><img src="./images/small-prev.gif" title="Introduction" alt="" border="0" /></a> <a href="documentation.html#laml-processing-sec"><img src="./images/small-next.gif" title="LAML processing" alt="" border="0" /></a></div><div><b><font size="5"><span>2 &nbsp; &nbsp; Factorial pages</span></font></b></div><div class="body-normal">We start with a couple of versions of a simple web page which shows a table of factorial numbers.</div><div style="margin-left:10px;"><font size="2"><span>2.1 &nbsp; &nbsp; <a href="documentation.html#fac-1" target="documentation-frame"><font color="#000000">A factorial page</font></a></span></font> <br /> <font size="2"><span>2.2 &nbsp; &nbsp; <a href="documentation.html#fac-2" target="documentation-frame"><font color="#000000">Another factorial page</font></a></span></font> <br /></div></div><div>&nbsp; <p></p></div><div class="elucidator-entry"><a name="fac-1"></a><div class="elucidator-entry-head"><a href="documentation.html#factorials"><img src="./images/small-up.gif" title="Factorial pages" alt="" border="0" /></a> <img src="./images/small-prev-blind.gif" title="" alt="" border="0" /> <a href="documentation.html#fac-2"><img src="./images/small-next.gif" title="Another factorial page" alt="" border="0" /></a>  <br /> <b><font size="4"><span>2.1 &nbsp; &nbsp; A factorial page</span></font></b></div><div class="body-normal"><p>In this section we will be concerned with generation of one of more HTML pages from a LAML source document. Let us start with a simple example. We wish to make a web page that display the first few factorial numbers:</p> <blockquote>1!, 2!, 3!, ...,</blockquote> <p>Please take a look at the <a class="program-file-reference-strong" href="fac-1-1-LARGE.html" target="program-frame" title="Link to program file: fac-1">fac-1</a> page (click on the red name to see the program) which corresponds directly to the <kbd>fac-1</kbd> document in <a href="../../../examples/tutorial/getting-started/index.html" target="program-frame" title="LAML example"><font color="#000000">the &#39;getting started&#39; examples.</font></a> You should also take a look at <a href="../../../examples/tutorial/getting-started/fac-1.html" target="program-frame" title="LAML example"><font color="#000000">the page which is generated by the program</font></a>.</p> <p>The first line loads &quot;laml.scm&quot; from your LAML installation. The value of <span class="none-reference">laml-dir</span> is transferred from the context (by a shell script, by Emacs, or by other means) and it is bound at <em>LAML installation time</em>. The value of <span class="none-reference">laml-dir</span> is the directory path to your LAML installation.</p> <p>The second line uses a LAML style <span class="none-reference">simple-xhtml1.0-transitional-validating</span>. In this case we are using a style that allows us to use the XHTML1.0 transitional mirror functions. The use of this style takes responsibility to load the relevant libraries. As we will see later, other LAML styles are more substantial, in the sense that they offer more than just function that supports HTML counterparts. Such more substantial document styles typically generate HTML contents based on high level specifications at the level of XML.</p> <p>Following that we activate  <a class="manual-reference" href="../../../man/laml.html#begin-laml" target="program-frame" title="Manual: laml">begin-laml</a> which marks ending of the loading part, and the beginning of the real document part of the program.</p> <p>Next follows the recursive factorial function <a class="program-reference-strong" href="fac-1-1-LARGE.html#fac" target="program-frame" title="fac-1">fac</a>. This is the usual factorial function, which you probably have seen many times before.</p> <p>The middle big part of the example shows a call to <a class="manual-reference" href="../../../man/laml.html#write-xml" target="program-frame" title="Manual: laml">write-xml</a>. (You can click on the name to see its SchemeDoc interface documentation). The <a class="manual-reference" href="../../../man/laml.html#write-xml" target="program-frame" title="Manual: laml">write-xml</a> procedure comes from the <a class="manual-file-reference-strong" href="../../../man/laml.html" target="program-frame" title="Link to SchmeDoc manual: laml">laml.scm</a> library, and it renders and writes a HTML fragment onto some file. If no file name is passed, it writes the file on <kbd>fac-1.html</kbd>, because the proper source name of the example is <kbd>fac-1</kbd>. This is a common behavior of many LAML programs/documents. The first parameter <kbd>&#39;(raw prolog)</kbd> is a list of properties; Here we ask for raw writing of the HTML fragment. We also ask for the generation of a document prolog (document type definition). Alternatively we could, for instance, pass <kbd>&#39;(pp prolog epilog)</kbd> which asks for HTML pretty printing, document prolog (as given by the function <a class="manual-reference" href="../../../man/laml.html#standard-prolog" target="program-frame" title="Manual: laml">standard-prolog</a> ), and document epilog (as given by the function <a class="manual-reference" href="../../../man/laml.html#standard-epilog" target="program-frame" title="Manual: laml">standard-epilog</a> ).</p> <p>The expression</p> <blockquote><pre style="font-size:11px;">(html 
  (head 
    (title &quot;Factorials&quot;))
  (body
    (h1 &quot;Factorials&quot;)

    (table &#39;border &quot;1&quot;
     (tbody
      (tr 
        (td &quot;1&quot;) (td (fac 1)))
      (tr 
        (td &quot;2&quot;) (td (fac 2)))
      (tr 
        (td &quot;3&quot;) (td (fac 3)))
      (tr 
        (td &quot;4&quot;) (td (fac 4)))))
 ))</pre></blockquote> <p>uses quite a few of the so-called mirror functions: <a class="manual-reference" href="../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#html" target="program-frame" title="Manual: xhtml10-transitional-mirror">html</a>, <a class="manual-reference" href="../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#head" target="program-frame" title="Manual: xhtml10-transitional-mirror">head</a>, <a class="manual-reference" href="../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#body" target="program-frame" title="Manual: xhtml10-transitional-mirror">body</a>, <a class="manual-reference" href="../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#h1" target="program-frame" title="Manual: xhtml10-transitional-mirror">h1</a>, <a class="manual-reference" href="../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#table" target="program-frame" title="Manual: xhtml10-transitional-mirror">table</a>, <a class="manual-reference" href="../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#tbody" target="program-frame" title="Manual: xhtml10-transitional-mirror">tbody</a>, <a class="manual-reference" href="../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#tr" target="program-frame" title="Manual: xhtml10-transitional-mirror">tr</a>, and <a class="manual-reference" href="../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#td" target="program-frame" title="Manual: xhtml10-transitional-mirror">td</a>. These functions correspond directly to the elements (tags) of HTML. The expression is evaluated to some internal structure (not shown in full)</p> <blockquote><pre style="font-size:11px;">(ast &quot;html&quot; 
  ((ast &quot;head&quot; 
    ((ast &quot;title&quot; (&quot;Factorials&quot;) () double)) () double) ... )
  () double)</pre></blockquote> which can be rendered (linearized to normal HTML text) as <blockquote><pre style="font-size:11px;">&lt;html&gt;
  &lt;head&gt;&lt;title&gt;Factorials&lt;/title&gt;&lt;/head&gt;
  &lt;body&gt;&lt;h1&gt;Factorials&lt;/h1&gt; 
    &lt;table border = &quot;1&quot;&gt;
     &lt;tbody&gt;
      &lt;tr&gt;&lt;td&gt;1&lt;/td&gt; &lt;td&gt;1&lt;/td&gt;&lt;/tr&gt; 
      &lt;tr&gt;&lt;td&gt;2&lt;/td&gt; &lt;td&gt;2&lt;/td&gt;&lt;/tr&gt; 
      &lt;tr&gt;&lt;td&gt;3&lt;/td&gt; &lt;td&gt;6&lt;/td&gt;&lt;/tr&gt;
      &lt;tr&gt;&lt;td&gt;4&lt;/td&gt; &lt;td&gt;24&lt;/td&gt;&lt;/tr&gt;
     &lt;/tbody&gt;
    &lt;/table&gt;
  &lt;/body&gt;
&lt;/html&gt;</pre></blockquote> <p>In the context of our example, <a class="program-file-reference-strong" href="fac-1-1-LARGE.html" target="program-frame" title="Link to program file: fac-1">fac-1</a>, the function  <a class="manual-reference" href="../../../man/laml.html#write-xml" target="program-frame" title="Manual: laml">write-xml</a> will do the rendering.</p> <p>Notice that the numbers returned by <kbd>(fac 1)</kbd>, <kbd>(fac 2)</kbd>, <kbd>(fac 3)</kbd>, and <kbd>(fac 4)</kbd> are automatically converted to text strings by the mirror functions.</p> <p>Finally, the expression (<a class="manual-reference" href="../../../man/laml.html#end-laml" target="program-frame" title="Manual: laml">end-laml</a>) says goodbye in a gentle way, and it reports about time consumption. The procedure <a class="manual-reference" href="../../../man/laml.html#end-laml" target="program-frame" title="Manual: laml">end-laml</a> initiates the final part of the document validation, and it is able to check the links in the document).</p> <p>We process the LAML document by simply running it as a Scheme program. As mentioned, a tiny bit of contextual information is passed to the Scheme interpreter: <kbd>laml-dir</kbd>, the name of the source file (<a class="manual-reference" href="../../../man/laml.html#source-filename-without-extension" target="program-frame" title="Manual: laml">source-filename-without-extension</a>), and the directory in which the file is located (<a class="manual-reference" href="../../../man/laml.html#startup-directory" target="program-frame" title="Manual: laml">startup-directory</a>).</p> <p>The best and the easiest way to process the document is from <a href="http://www.gnu.org/software/emacs/emacs.html" target="emacs">Emacs</a>, where the Emacs LAML mode binds the <kbd>C-c C-o</kbd> (Control c followed by Control o) key to an Emacs command <kbd>laml-process-current-buffer</kbd> that activates your Scheme interpreter. LAML mode in Emacs also offers a menu with a number of useful commands. Try it out on the files in the example directory!</p> <p> You can also, from Emacs, activate <kbd>M-x run-laml-interactively</kbd> and then issue the command</p> <blockquote><kbd>(laml &quot;fac-1&quot;)</kbd></blockquote> <p>You also find <kbd>run-laml-interactively</kbd> in the Tools &gt; Laml menu of Emacs.</p> <p>You can also just start your Scheme system, define <kbd>laml-dir</kbd> and the contextual information, and then load the laml program by <kbd>(load &quot;fac-1.laml&quot;)</kbd>. See <a href="../../../index.html#starting-laml-non-emacs" target="program-frame">additional details</a> on this mode of activation.</p> <p>Finally, you can activate LAML from a command prompt (shell) in both Windows and Unix. Locate yourself in the appropriate directory and say</p> <blockquote><kbd><b>&gt;</b> laml fac-1.laml</kbd></blockquote> <p>The prefix <b>&gt;</b> denotes the prompt, so do not write that part yourself! Consult the <kbd>laml</kbd> (or <kbd>laml.exe</kbd> ) command in the <kbd>bin</kbd> directory of your local LAML directory, and make sure that it is executable (in Unix), and that the <kbd>bin</kbd> directory of your LAML system is in your path.</p></div></div><div class="elucidator-entry"><a name="fac-2"></a><div class="elucidator-entry-head"><a href="documentation.html#factorials"><img src="./images/small-up.gif" title="Factorial pages" alt="" border="0" /></a> <a href="documentation.html#fac-1"><img src="./images/small-prev.gif" title="A factorial page" alt="" border="0" /></a> <img src="./images/small-next-blind.gif" title="" alt="" border="0" />  <br /> <b><font size="4"><span>2.2 &nbsp; &nbsp; Another factorial page</span></font></b></div><div class="body-normal"><p>We will make another version of the program which is more general. Instead of asking for <kbd>(fib 1)</kbd> .. <kbd>(fib</kbd> 4) we will iterate over the first 50 numbers using the idea of mapping a function on the elements of a list. Please take a look at the <a class="program-file-reference-strong" href="fac-2-1-LARGE.html" target="program-frame" title="Link to program file: fac-2">fac-2</a> page, which also is part of <a href="../../../examples/tutorial/getting-started/index.html" target="program-frame" title="LAML example"><font color="#000000">the &#39;getting started&#39; examples.</font></a> The <a href="../../../examples/tutorial/getting-started/fac-2.html" target="program-frame" title="LAML example"><font color="#000000">generated HTML page</font></a> can be seen here. Notice that we ask for pretty printed HTML rendering via the first parameter of <a class="manual-reference" href="../../../man/laml.html#write-xml" target="program-frame" title="Manual: laml">write-xml</a>. You may wish to take a look at the source of the generated HTML page.</p> <p>The innermost mapping in <a class="program-file-reference-strong" href="fac-2-1-LARGE.html" target="program-frame" title="Link to program file: fac-2">fac-2</a> applies the function</p> <blockquote><pre style="font-size:11px;">(lambda (n) 
  (list (td (as-string n))
        (td (as-string (fac n)))))</pre></blockquote> <p>on the list (1 .. 50). The function <a class="manual-reference" href="../../../lib/man/general.html#number-interval" target="program-frame" title="Manual: general">number-interval</a> is one of functions from the LAML general library. The innermost mapping produces a list like</p> <blockquote><pre style="font-size:11px;">(
 (&quot;&lt;td&gt;1&lt;/td&gt;&quot; &quot;&lt;td&gt;1&lt;/td&gt;&quot;)
 (&quot;&lt;td&gt;2&lt;/td&gt;&quot; &quot;&lt;td&gt;2&lt;/td&gt;&quot;)
 (&quot;&lt;td&gt;3&lt;/td&gt;&quot; &quot;&lt;td&gt;6&lt;/td&gt;&quot;)
 (&quot;&lt;td&gt;4&lt;/td&gt;&quot; &quot;&lt;td&gt;24&lt;/td&gt;&quot;)
 ...
   
 )</pre></blockquote> <p>Actually, the elements are not HTML strings, but instances of internal abstract syntax trees which can be rendered as the HTML strings shown above.</p> <p>The outermost mapping applies the <a class="manual-reference" href="../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#tr" target="program-frame" title="Manual: xhtml10-transitional-mirror">tr</a> function on the rows. In this situation it is crucial that the contents of an HTML mirror function can be a list of contents elements. (This aspect of the mirror functions is discussed thoroughly in <a href="../../html-mirrors/html-mirrors.html" target="_top">another section of the LAML tutorial</a> ). The outermost mapping produces</p> <blockquote><pre style="font-size:11px;">(
 &quot;&lt;tr&gt;&lt;td&gt;1&lt;/td&gt; &lt;td&gt;1&lt;/td&gt;&lt;/tr&gt;&quot;
 &quot;&lt;tr&gt;&lt;td&gt;2&lt;/td&gt; &lt;td&gt;2&lt;/td&gt;&lt;/tr&gt;&quot;
 &quot;&lt;tr&gt;&lt;td&gt;3&lt;/td&gt; &lt;td&gt;6&lt;/td&gt;&lt;/tr&gt;&quot;
 &quot;&lt;tr&gt;&lt;td&gt;4&lt;/td&gt; &lt;td&gt;24&lt;/td&gt;&lt;/tr&gt;&quot;
 ...
 )</pre></blockquote> <p>Again - the elements of the list are actually syntax trees. This list serves as contents to <a class="manual-reference" href="../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#tbody" target="program-frame" title="Manual: xhtml10-transitional-mirror">tbody</a>, which is a constituent of the  <a class="manual-reference" href="../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#table" target="program-frame" title="Manual: xhtml10-transitional-mirror">table</a> function.</p></div></div><div class="elucidator-section"><a name="laml-processing-sec"></a><div><a href="documentation.html#START"><img src="./images/small-up.gif" title="" alt="" border="0" /></a> <a href="documentation.html#factorials"><img src="./images/small-prev.gif" title="Factorial pages" alt="" border="0" /></a> <a href="documentation.html#bookmark-section"><img src="./images/small-next.gif" title="Bookmarks" alt="" border="0" /></a></div><div><b><font size="5"><span>3 &nbsp; &nbsp; LAML processing</span></font></b></div><div class="body-normal">In this section we will discuss a few important LAML processing topics, including the concept <em>LAML load safeness</em> .</div><div style="margin-left:10px;"><font size="2"><span>3.1 &nbsp; &nbsp; <a href="documentation.html#laml-processing" target="documentation-frame"><font color="#000000">LAML processing</font></a></span></font> <br /></div></div><div>&nbsp; <p></p></div><div class="elucidator-entry"><a name="laml-processing"></a><div class="elucidator-entry-head"><a href="documentation.html#laml-processing-sec"><img src="./images/small-up.gif" title="LAML processing" alt="" border="0" /></a> <img src="./images/small-prev-blind.gif" title="" alt="" border="0" /> <img src="./images/small-next-blind.gif" title="" alt="" border="0" />  <br /> <b><font size="4"><span>3.1 &nbsp; &nbsp; LAML processing</span></font></b></div><div class="body-normal"><p>As discussed on the  <a href="../../../index.html#processing" target="laml-software">LAML software home page</a>,  LAML processing can be activated in different ways.</p> <p>Personally, I almost always initiate LAML processing from Emacs, using the Emacs command <kbd>laml-process-current-buffer</kbd> (which is bound to <kbd>C-c C-o</kbd> in the Emacs setup of the LAML distribution if you use the hygienic key binding mode. If you use the original key binding mode, you just type <kbd>C-o</kbd>).</p> <p>Sometimes, it is attractive to initiate LAML processing by means of the function <a class="manual-reference" href="../../../man/laml.html#laml" target="program-frame" title="Manual: laml">laml</a>. We have, for instance, arranged that all LAML examples in all tutorial example directories can be re-processed automatically. The LAML examples related to &#39;getting started&#39;, are processed by the script  <a class="program-file-reference-strong" href="process-all.laml-1-LARGE.html" target="program-frame" title="Link to program file: process-all.laml">process-all.laml</a>.  The function  <a class="program-reference-strong" href="process-all.laml-1-LARGE.html#process-list" target="program-frame" title="process-all.laml">process-list</a> processes a list of laml files. The actual processing is done at the location of the <a class="manual-reference" href="../../../man/laml.html#laml" target="program-frame" title="Manual: laml">laml</a> procedure (<span><a href="process-all.laml-1-LARGE.html#process-list-@a" target="program-frame"><img src="./images/source-mark-red.gif" title="A link to a program source marker in process-list" alt="" border="0" /></a><a name="laml-processing-@a"></a></span>).</p> <p>In general, we want to be able to write</p> <blockquote><pre style="font-size:11px;">(laml-cd &quot;dir&quot;)
(laml &quot;file&quot;)
(laml-cd &quot;..&quot;)</pre></blockquote> <p>in order to process &#39;file.laml&#39; in &#39;dir&#39;. For that to succeed it is important that all kinds of file access in &#39;file.laml&#39; is relative to the LAML <a class="manual-reference" href="../../../man/laml.html#startup-directory" target="program-frame" title="Manual: laml">startup-directory</a>. In the example above,  <a class="manual-reference" href="../../../man/laml.html#laml-cd" target="program-frame" title="Manual: laml">laml-cd</a> sets the startup-directory. When the &#39;outer level&#39; of LAML processing start, we always transfer knowledge about the current directory (the startup directory) to the LAML processor.</p> <p>We have decided, at an early point in time, that all file access is handled explicitly. In principle we always access files via use of full file path information. This stands as a contrast to using load path (ala Emacs load paths, or java class paths).</p> <p>We say that a LAML program is  <b><em>LAML load safe</em></b>,  if each and every file access (inclusive file loading) is either absolute, or relative to the startup directory. The function  <a class="manual-reference" href="../../../man/laml.html#in-startup-directory" target="program-frame" title="Manual: laml">in-startup-directory</a>  is handy in this respect. When we write something like</p> <blockquote><pre style="font-size:11px;"><span>(<a class="manual-reference" href="../../../lib/man/file-read.html#read-text-file" target="program-frame" title="Manual: file-read">read-text-file</a> (<a class="manual-reference" href="../../../man/laml.html#in-startup-directory" target="program-frame" title="Manual: laml">in-startup-directory</a> &quot;file.txt&quot;))</span></pre></blockquote> <p>or</p> <blockquote><pre style="font-size:11px;"><span>(load (<a class="manual-reference" href="../../../man/laml.html#in-startup-directory" target="program-frame" title="Manual: laml">in-startup-directory</a>  &quot;file.scm&quot;))</span></pre></blockquote> <p>we ensure that &#39;file.txt&#39; and &#39;file.scm&#39; are accessed relative to the LAML startup directory.</p> <p>There are more LAML processing examples in <a href="../../../examples/processing/index.html" target="ex-proc">examples/processing/</a> in the LAML distribution.</p></div></div><div class="elucidator-section"><a name="bookmark-section"></a><div><a href="documentation.html#START"><img src="./images/small-up.gif" title="" alt="" border="0" /></a> <a href="documentation.html#laml-processing-sec"><img src="./images/small-prev.gif" title="LAML processing" alt="" border="0" /></a> <a href="documentation.html#epilogue-sec"><img src="./images/small-next.gif" title="Epilogue" alt="" border="0" /></a></div><div><b><font size="5"><span>4 &nbsp; &nbsp; Bookmarks</span></font></b></div><div class="body-normal"><p>We now approach a much more realistic problem, namely the handling of bookmarks. If you like to see LAML in play with some Scheme programs, you are invited to read through the details. If not, you may safely proceed to <a href="../../html-mirrors/html-mirrors.html" target="_top">the chapter on mirror function</a>, which is the next part of the tutorial.</p></div><div style="margin-left:10px;"><font size="2"><span>4.1 &nbsp; &nbsp; <a href="documentation.html#bookmarks" target="documentation-frame"><font color="#000000">Bookmark administration</font></a></span></font> <br /> <font size="2"><span>4.2 &nbsp; &nbsp; <a href="documentation.html#frameset-section" target="documentation-frame"><font color="#000000">The frameset section</font></a></span></font> <br /> <font size="2"><span>4.3 &nbsp; &nbsp; <a href="documentation.html#sel-constr" target="documentation-frame"><font color="#000000">Bookmark selectors and constructor</font></a></span></font> <br /> <font size="2"><span>4.4 &nbsp; &nbsp; <a href="documentation.html#left-frame-section" target="documentation-frame"><font color="#000000">The left frame</font></a></span></font> <br /> <font size="2"><span>4.5 &nbsp; &nbsp; <a href="documentation.html#right-frame" target="documentation-frame"><font color="#000000">The right frame</font></a></span></font> <br /></div></div><div>&nbsp; <p></p></div><div class="elucidator-entry"><a name="bookmarks"></a><div class="elucidator-entry-head"><a href="documentation.html#bookmark-section"><img src="./images/small-up.gif" title="Bookmarks" alt="" border="0" /></a> <img src="./images/small-prev-blind.gif" title="" alt="" border="0" /> <a href="documentation.html#frameset-section"><img src="./images/small-next.gif" title="The frameset section" alt="" border="0" /></a>  <br /> <b><font size="4"><span>4.1 &nbsp; &nbsp; Bookmark administration</span></font></b></div><div class="body-normal"><p>In this section we will develop a LAML program that produce a set of interrelated web pages. The program manages a collection of bookmarks. The program is called <a class="program-file-reference-strong" href="bookmark-1-LARGE.html" target="program-frame" title="Link to program file: bookmark">bookmark</a> .</p> <p>The example is rather typical, because it is based on data that are represented in a simple data structure. The data represent some facts and relationships which we want to display on a web page.</p> <p>As concrete motivation we can observe that it is not practical to bind bookmarks to a single machine, nor to a single browser. I use several different machines, on both the Unix and the Windows platform, and I use different browsers too. Therefore I maintain my bookmarks as a data structure, from which I generate a HTML presentation of the bookmarks.</p> <p>Let us assume that each bookmark is of the form</p> <blockquote><pre style="font-size:11px;">(bookmark &quot;title&quot; &quot;category&quot; &quot;comment&quot;)</pre></blockquote> <p>Thus, a bookmark is a four tuple of a symbol, a bookmark category string, and a comment. The collection of bookmarks, which we represent in a file, is a list of bookmark entries with no particular ordering imposed. Given such a list, we will here make a bookmark browser, such as <a href="../../../examples/tutorial/getting-started/bookmarks.html" target="program-frame" title="LAML example"><font color="#000000">this one</font></a>.</p> <p>The sample bookmark data file is available as <a class="program-file-reference-strong" href="bookmark-data-1-LARGE.html" target="program-frame" title="Link to program file: bookmark-data">bookmark-data</a>.</p> <p>In the start of the program, in <a class="program-reference-weak" href="bookmark-1-LARGE.html#loading-section" target="program-frame" title="bookmark">loading-section</a> we load the XML related libraries. Notice that we do <em>not</em> load simple-xhtml1.0-transitional-validating as we did in the factorial examples discussed above. The reason is that we need more control over the exact set of libraries to load for this example. We both need XHTML transitional and XHTML frameset. The file <kbd>xhtml1.0-convenience.scm</kbd> holds a bunch of auxiliary stuff that I have developed through the years.</p> <p>There is a huge overlap among the HTML mirror functions in XHTML transitional and XHTML frameset. In <a class="program-reference-weak" href="bookmark-1-LARGE.html#frameset-alias-section" target="program-frame" title="bookmark">frameset-alias-section</a> we provide direct access to a few HTML mirror functions from the XHTML frameset library, via use of the so-called xhtml10-frameset <em>language map</em>. We also assign <a class="manual-reference" href="../../../lib/xml-in-laml/man/xml-in-laml.html#xml-check-language-overlap?" target="program-frame" title="Manual: xml-in-laml">xml-check-language-overlap?</a> to #f. If we do not do so, LAML will discover the massive overlap between the frameset and the transitional mirror functions, and give a lot of (non-fatal) warnings. The transitional library &#39;wins&#39; and &#39;dominates&#39;, because it is loaded after the frameset library in <a class="program-reference-weak" href="bookmark-1-LARGE.html#loading-section" target="program-frame" title="bookmark">loading-section</a>.</p></div></div><div class="elucidator-entry"><a name="frameset-section"></a><div class="elucidator-entry-head"><a href="documentation.html#bookmark-section"><img src="./images/small-up.gif" title="Bookmarks" alt="" border="0" /></a> <a href="documentation.html#bookmarks"><img src="./images/small-prev.gif" title="Bookmark administration" alt="" border="0" /></a> <a href="documentation.html#sel-constr"><img src="./images/small-next.gif" title="Bookmark selectors and constructor" alt="" border="0" /></a>  <br /> <b><font size="4"><span>4.2 &nbsp; &nbsp; The frameset section</span></font></b></div><div class="body-normal"><p>The bookmark browser will be constructed as a frameset of two frames. Thus, there are three programming tasks involved: The construction of frameset, the left hand frame, and the right hand frame. In this section we describe the frameset task, which is the more simple one. In the two next sections we describe the programming of the two frames.</p> <p>We first define the variable <a class="program-reference-strong" href="bookmark-1-LARGE.html#frame-width-list" target="program-frame" title="bookmark">frame-width-list</a> which defines the widths of the browsers &#39;column&#39; frames. Next in the section <a class="program-reference-strong" href="bookmark-1-LARGE.html#frameset-page" target="program-frame" title="bookmark">frameset-page</a> we generate the frameset page. This is a page with head (<span><a href="bookmark-1-LARGE.html#frameset-page-@a" target="program-frame"><img src="./images/source-mark-red.gif" title="A link to a program source marker in frameset-page" alt="" border="0" /></a><a name="frameset-section-@a"></a></span>), title (<span><a href="bookmark-1-LARGE.html#frameset-page-@b" target="program-frame"><img src="./images/source-mark-green.gif" title="A link to a program source marker in frameset-page" alt="" border="0" /></a><a name="frameset-section-@b"></a></span>), and two frames (<span><a href="bookmark-1-LARGE.html#frameset-page-@c" target="program-frame"><img src="./images/source-mark-blue.gif" title="A link to a program source marker in frameset-page" alt="" border="0" /></a><a name="frameset-section-@c"></a></span>). Both the head, title, and the frame forms are applications of the aliased XHTML mirror functions. Frames are named (for mutual reference purposes) and sourced (in order to bring up other web pages in the frames). Notice the use of <a class="program-reference-weak" href="bookmark-1-LARGE.html#frame-width-list" target="program-frame" title="bookmark">frame-width-list</a> (at <span><a href="bookmark-1-LARGE.html#frameset-page-@d" target="program-frame"><img src="./images/source-mark-black.gif" title="A link to a program source marker in frameset-page" alt="" border="0" /></a><a name="frameset-section-@d"></a></span>): we use the function <a class="manual-reference" href="../../../lib/man/general.html#list-to-string" target="program-frame" title="Manual: general">list-to-string</a> to create a comma separated value of the <span class="none-reference">cols</span> attribute. The resulting frameset is written to a HTML file of the same name as the source LAML file. This is the default behavior of the <a class="manual-reference" href="../../../man/laml.html#write-xml" target="program-frame" title="Manual: laml">write-xml</a> procedure. Thus, if the source document is located in <span class="none-reference">index.laml</span>, the frameset will be written to <span class="none-reference">index.html</span> .</p> <p>We see that we make  <a class="program-reference-strong" href="bookmark-1-LARGE.html#empty-pages" target="program-frame" title="bookmark">empty frame pages</a> using <a class="program-reference-strong" href="bookmark-1-LARGE.html#make-empty-page!" target="program-frame" title="bookmark">make-empty-page!</a>. These empty pages will later in the program be overwritten by more useful frame pages.</p></div></div><div class="elucidator-entry"><a name="sel-constr"></a><div class="elucidator-entry-head"><a href="documentation.html#bookmark-section"><img src="./images/small-up.gif" title="Bookmarks" alt="" border="0" /></a> <a href="documentation.html#frameset-section"><img src="./images/small-prev.gif" title="The frameset section" alt="" border="0" /></a> <a href="documentation.html#left-frame-section"><img src="./images/small-next.gif" title="The left frame" alt="" border="0" /></a>  <br /> <b><font size="4"><span>4.3 &nbsp; &nbsp; Bookmark selectors and constructor</span></font></b></div><div class="body-normal"><p>It is always a good idea to access data in an abstract fashion. In this way we do not bind our program to a concrete data representation. As a consequence, we define four bookmark selector functions:</p> <ul><li><a class="program-reference-strong" href="bookmark-1-LARGE.html#bookmark-title-of" target="program-frame" title="bookmark">bookmark-title-of</a></li> <li><a class="program-reference-strong" href="bookmark-1-LARGE.html#bookmark-url-of" target="program-frame" title="bookmark">bookmark-url-of</a></li> <li><a class="program-reference-strong" href="bookmark-1-LARGE.html#bookmark-category-of" target="program-frame" title="bookmark">bookmark-category-of</a></li> <li><a class="program-reference-strong" href="bookmark-1-LARGE.html#bookmark-comment-of" target="program-frame" title="bookmark">bookmark-comment-of</a></li></ul> <p>In addition, we construct a bookmark by means of the constructor function <a class="program-reference-strong" href="bookmark-1-LARGE.html#make-bookmark" target="program-frame" title="bookmark">make-bookmark</a>.</p></div></div><div class="elucidator-entry"><a name="left-frame-section"></a><div class="elucidator-entry-head"><a href="documentation.html#bookmark-section"><img src="./images/small-up.gif" title="Bookmarks" alt="" border="0" /></a> <a href="documentation.html#sel-constr"><img src="./images/small-prev.gif" title="Bookmark selectors and constructor" alt="" border="0" /></a> <a href="documentation.html#right-frame"><img src="./images/small-next.gif" title="The right frame" alt="" border="0" /></a>  <br /> <b><font size="4"><span>4.4 &nbsp; &nbsp; The left frame</span></font></b></div><div class="body-normal"><p>The left frame is produced by the function <a class="program-reference-strong" href="bookmark-1-LARGE.html#present-categories" target="program-frame" title="bookmark">present-categories</a> which is called in the program section <a class="program-reference-strong" href="bookmark-1-LARGE.html#left-frame-page" target="program-frame" title="bookmark">left-frame-page</a>. The <a class="manual-reference" href="../../../lib/man/xhtml10-convenience.html#font-1" target="program-frame" title="Manual: xhtml10-convenience">font-1</a> function is a convenience function which requires a font size and a color. Alternatively we could have used the XHTML <a class="manual-reference" href="../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#font" target="program-frame" title="Manual: xhtml10-transitional-mirror">font</a> mirror function directly with appropriate attributes. In LAML, colors can be represented as RGB values in various ways. As an example, <kbd>&#39;(255 0 0)</kbd> represents red. Please consult the function <a class="manual-reference" href="../../../lib/man/color.html#rgb-color-encoding" target="program-frame" title="Manual: color">rgb-color-encoding</a> in the LAML color library for details on the handling of colors in LAML.</p> <p>The function <a class="program-reference-strong" href="bookmark-1-LARGE.html#present-categories" target="program-frame" title="bookmark">present-categories</a> takes a bookmark list, <span class="none-reference">bml</span>, as parameter. The value of the variable <a class="program-reference-strong" href="bookmark-1-LARGE.html#bookmarks" target="program-frame" title="bookmark">bookmarks</a> is passed as actual parameter to this function. The bookmarks as such come from a file, such as <a class="program-file-reference-strong" href="bookmark-data-1-LARGE.html" target="program-frame" title="Link to program file: bookmark-data">bookmark-data</a>, as it appears in the definition of the variable <a class="program-reference-strong" href="bookmark-1-LARGE.html#bookmarks" target="program-frame" title="bookmark">bookmarks</a>.</p> <p>Let us now take a closer look at the function <a class="program-reference-strong" href="bookmark-1-LARGE.html#present-categories" target="program-frame" title="bookmark">present-categories</a>, which is called in <a class="program-reference-weak" href="bookmark-1-LARGE.html#left-frame-page" target="program-frame" title="bookmark">left-frame-page</a>. It first extracts all bookmark categories by mapping the selector function <a class="program-reference-weak" href="bookmark-1-LARGE.html#bookmark-category-of" target="program-frame" title="bookmark">bookmark-category-of</a> on the bookmark list bml (<span><a href="bookmark-1-LARGE.html#present-categories-@a" target="program-frame"><img src="./images/source-mark-red.gif" title="A link to a program source marker in present-categories" alt="" border="0" /></a><a name="left-frame-section-@a"></a></span>). This will typically create a list with a lot of duplicates, because each category of bookmarks, in general, will contain many individual bookmarks. Therefore we remove the duplicates from the category list (<span><a href="bookmark-1-LARGE.html#present-categories-@b" target="program-frame"><img src="./images/source-mark-green.gif" title="A link to a program source marker in present-categories" alt="" border="0" /></a><a name="left-frame-section-@b"></a></span>).</p> <p>In the body of <a class="program-reference-strong" href="bookmark-1-LARGE.html#present-categories" target="program-frame" title="bookmark">present-categories</a> we render anchors to the bookmark file (as they are presented in the right frame). This is done my mapping (<span><a href="bookmark-1-LARGE.html#present-categories-@c" target="program-frame"><img src="./images/source-mark-blue.gif" title="A link to a program source marker in present-categories" alt="" border="0" /></a><a name="left-frame-section-@c"></a></span>) a specially made, simple lambda function on the sorted and downcased category list. Notice that the downcasing is done in the comparator function (the lambda expression) in order not to change the letter case of the anchor names as such. (Doing so causes a result, which will not work in Netscape and Mozilla, but it is OK in MS explorer). The lambda function returns targeted hyper references. Notices that we rely on anchor names (in terms of the categories), which we assume will be found in the <span class="none-reference">bookmarks.html</span> file. As such it will probably be a requirement that the category names of the bookmarks are without spaces or other kinds of white space.</p></div></div><div class="elucidator-entry"><a name="right-frame"></a><div class="elucidator-entry-head"><a href="documentation.html#bookmark-section"><img src="./images/small-up.gif" title="Bookmarks" alt="" border="0" /></a> <a href="documentation.html#left-frame-section"><img src="./images/small-prev.gif" title="The left frame" alt="" border="0" /></a> <img src="./images/small-next-blind.gif" title="" alt="" border="0" />  <br /> <b><font size="4"><span>4.5 &nbsp; &nbsp; The right frame</span></font></b></div><div class="body-normal"><p>The right frame contains the bookmarks as such. We decide that it will hold the bookmarks as subitems to their categories. Thus, we go for a bookmark page which looks like:</p> <pre>
    cat1
      bookmark-1
      bookmark-2
      bookmark-3
    
    cat2
      bookmark-4
      bookmark-5
      bookmark-6</pre> <p>The first task is to order the bookmarks according to their categories. This is done in the &#39;top level function&#39; <a class="program-reference-strong" href="bookmark-1-LARGE.html#present-bookmarks" target="program-frame" title="bookmark">present-bookmarks</a>. The ordering is done by the Scheme/LAML <a class="manual-reference" href="../../../lib/compatibility/man/mzscheme-compat.html#sort-list" target="program-frame" title="Manual: mzscheme-compat">sort-list</a> function (<span><a href="bookmark-1-LARGE.html#present-bookmarks-@a" target="program-frame"><img src="./images/source-mark-red.gif" title="A link to a program source marker in present-bookmarks" alt="" border="0" /></a><a name="right-frame-@a"></a></span>) which is one of the so-called compatibility functions of LAML (non-standard functions which LAML assumes can be defined on all platforms on which LAML is used. Collections of these functions for various Scheme systems and platforms are found in <a href="../../../lib/compatibility/"><kbd>lib/compatibility</kbd></a> in your LAML distribution). The crucial parameter in the call of <a class="manual-reference" href="../../../lib/compatibility/man/mzscheme-compat.html#sort-list" target="program-frame" title="Manual: mzscheme-compat">sort-list</a> is the comparison function (<span><a href="bookmark-1-LARGE.html#present-bookmarks-@i" target="program-frame"><img src="./images/source-mark-tetal.gif" title="A link to a program source marker in present-bookmarks" alt="" border="0" /></a><a name="right-frame-@i"></a></span>), which is given two bookmarks bm1 and bm2 to compare. Bookmark <span class="none-reference">bm1</span> is less than <span class="none-reference">bm2</span> if <span class="none-reference">bm1</span> &#39;s downcased category is less than <span class="none-reference">bm2</span> &#39;s downcased category.</p> <p>Now <a class="program-reference-strong" href="bookmark-1-LARGE.html#present-bookmarks-1" target="program-frame" title="bookmark">present-bookmarks-1</a> takes over the rest of the presentation work. The main challenge in <a class="program-reference-strong" href="bookmark-1-LARGE.html#present-bookmarks-1" target="program-frame" title="bookmark">present-bookmarks-1</a> is to present the bookmark category in front of only the first bookmark in a given category. This is somewhat tricky. Our functional solution is the following. In the last two lines of <a class="program-reference-strong" href="bookmark-1-LARGE.html#present-bookmarks" target="program-frame" title="bookmark">present-bookmarks</a> we use two list: the sorted bookmarks (<span><a href="bookmark-1-LARGE.html#present-bookmarks-@c" target="program-frame"><img src="./images/source-mark-blue.gif" title="A link to a program source marker in present-bookmarks" alt="" border="0" /></a><a name="right-frame-@c"></a></span>) and a right shifted copy of it (<span><a href="bookmark-1-LARGE.html#present-bookmarks-@d" target="program-frame"><img src="./images/source-mark-black.gif" title="A link to a program source marker in present-bookmarks" alt="" border="0" /></a><a name="right-frame-@d"></a></span>). If we assume that (b1 b2 b3 b4 b5) is the list of sorted bookmarks, the right shifted copy is (x b1 b2 b3 b4). <span class="none-reference">x</span> is a special <a class="program-reference-strong" href="bookmark-1-LARGE.html#sentinel-bookmark" target="program-frame" title="bookmark">sentinel-bookmark</a> .</p> <p>Now given these two lists</p> <pre>
      (b1 b2 b3 b4 b5)
      (x  b1 b2 b3 b4)</pre> <p>as <span class="none-reference">bml</span> and <span class="none-reference">prev-bml</span> in <a class="program-reference-strong" href="bookmark-1-LARGE.html#present-bookmarks-1" target="program-frame" title="bookmark">present-bookmarks-1</a>, we emit a category header if the category of <span class="none-reference">bm</span> is not equal to the category of bm-pre (<span><a href="bookmark-1-LARGE.html#present-bookmarks-1-@a" target="program-frame"><img src="./images/source-mark-red.gif" title="A link to a program source marker in present-bookmarks-1" alt="" border="0" /></a><a name="right-frame-@a"></a></span>). This can be done by mapping a function (<span><a href="bookmark-1-LARGE.html#present-bookmarks-1-@b" target="program-frame"><img src="./images/source-mark-green.gif" title="A link to a program source marker in present-bookmarks-1" alt="" border="0" /></a><a name="right-frame-@b"></a></span>) over the two lists. As it should be clear, the sentinel bookmark is of a different category than <span class="none-reference">b1</span>, thus causing the first category to appear in front of the very first bookmark.</p> <p>The presentation of a single bookmark is simple; It is done by <a class="program-reference-strong" href="bookmark-1-LARGE.html#present-a-bookmark" target="program-frame" title="bookmark">present-a-bookmark</a>. Notice how the bookmark comment is used as the title attribute of the anchor tag (<span><a href="bookmark-1-LARGE.html#present-a-bookmark-@j" target="program-frame"><img src="./images/source-mark-aqua.gif" title="A link to a program source marker in present-a-bookmark" alt="" border="0" /></a><a name="right-frame-@j"></a></span>).</p> <p>The right frame is written in the program section <a class="program-reference-strong" href="bookmark-1-LARGE.html#right-frame-page" target="program-frame" title="bookmark">right-frame-page</a>.</p></div></div><div class="elucidator-section"><a name="epilogue-sec"></a><div><a href="documentation.html#START"><img src="./images/small-up.gif" title="" alt="" border="0" /></a> <a href="documentation.html#bookmark-section"><img src="./images/small-prev.gif" title="Bookmarks" alt="" border="0" /></a> <img src="./images/small-next-blind.gif" title="" alt="" border="0" /></div><div><b><font size="5"><span>5 &nbsp; &nbsp; Epilogue</span></font></b></div><div class="body-normal">We will summarize what we have learned here, and what we will be concerned with next.</div><div style="margin-left:10px;"><font size="2"><span>5.1 &nbsp; &nbsp; <a href="documentation.html#epilogue" target="documentation-frame"><font color="#000000">Epilogue</font></a></span></font> <br /></div></div><div>&nbsp; <p></p></div><div class="elucidator-entry"><a name="epilogue"></a><div class="elucidator-entry-head"><a href="documentation.html#epilogue-sec"><img src="./images/small-up.gif" title="Epilogue" alt="" border="0" /></a> <img src="./images/small-prev-blind.gif" title="" alt="" border="0" /> <img src="./images/small-next-blind.gif" title="" alt="" border="0" />  <br /> <b><font size="4"><span>5.1 &nbsp; &nbsp; Epilogue</span></font></b></div><div class="body-normal"><p>In this chapter of the tutorial we have studied some applications of LAML, in which some data, in various data structures, are presented on web pages. First we showed how a function, <span class="none-reference">fac</span>, can be mapped on a list of numbers, and not least how to present the results on a web page. Next we showed a real-life task, namely how to generate a frame-based web page for a collection of bookmarks.</p> <p>We have encountered various HTML mirror functions already. In the <a href="../../html-mirrors/html-mirrors.html" target="_top">next chapter of the tutorial</a> we will more systematically study the mirror functions of HTML. This insight can be used generally for all XML languages that are supported by LAML.</p> <p>In general, you can navigate between neighbor chapters of the tutorial by using the right arrow icon in the top banner of this window.</p></div></div><div>&nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p></div></body></html>