<html><head><link href="../../../css-stylesheets/elucidator/program.css" rel="stylesheet" title="program" type="text/css" /> <title>Source file</title></head><body bgcolor="#ffffff" text="#000000" link="#000000" vlink="#000000"><font size="2"><pre><span class="comment">; =&gt;man/svg-extensions.sdoc</span><br />

<div class="schemedoc-abstract-comment">;;;; .title       The SVG Extension Library
;;;; .author      Kurt NÅ¯rmark
;;;; .affiliation Department of Computer Science, Aalborg University
;;;; This library provides a number of SVG abstractions on top of the SVG mirror library.
;;;; The primary abstractions are related to drawing of graph-like structures, composed of
;;;; nodes and edges.  
;;;; There exists a set of &lt;a href="../../examples/svg-extensions/index.html"&gt;examples&lt;/a&gt; which accompany
;;;; the paper &lt;a href = "http://www.cs.auc.dk/~normark/laml/papers/svg-open-2007/paper.html"&gt; A Graph Library Extension of SVG&lt;/a&gt;.</div>
<span class="comment">; General XML-in-LAML settings</span><br />(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> <a class="schemedoc-name" href="../../../lib/xml-in-laml/man/xml-in-laml.html#compact-end-tag-rendering?" title="Manual: xml-in-laml">compact-end-tag-rendering?</a> #f)
(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> <a class="schemedoc-name" href="../../../lib/xml-in-laml/man/xml-in-laml.html#use-empty-tags-for-elements-without-contents" title="Manual: xml-in-laml">use-empty-tags-for-elements-without-contents</a> #t)


<a name="current-animation-type"></a><span class="comment">; Determines the currently used animation type.
; One of the symbols none, step-buttons-reveal, step-buttons-walk-through, node-emphasize, or edge-emphasize.
; May also be a list of these symbols.</span><br /><a name="current-animation-type"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">current-animation-type</span> 'none)

<span class="comment">; An additional propertype for the auto animation type.
; The time before the first step.
; (define auto-animation-type-start 0)</span><br />
<span class="comment">; An additional propertype for the auto animation type.
; The number of seconds per step.
; (define auto-animation-type-seconds-per-step 1)</span><br />

<div class="schemedoc-section-comment">;;; SVG configuration constants.
;;; A number of constants. Most of the constant details of the graph library extension of SVG.</div>
<a name="svg-language"></a><a name="svg-language"></a><span><a href="../svg-extensions.html#svg-language"><img src="../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">svg-language</span> 'svg11)

<a name="standard-svg-1-1-element-attributes"></a><a name="standard-svg-1-1-element-attributes"></a><span><a href="../svg-extensions.html#standard-svg-1-1-element-attributes"><img src="../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">standard-svg-1-1-element-attributes</span>
  (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> 'version "1.1"
        'baseProfile "full"
        'xmlns "http://www.w3.org/2000/svg"
        'xmlns:xlink "http://www.w3.org/1999/xlink"))

<a name="emphasis-color"></a><a name="emphasis-color"></a><span><a href="../svg-extensions.html#emphasis-color"><img src="../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">emphasis-color</span> "red")

<a name="button-color"></a><a name="button-color"></a><span><a href="../svg-extensions.html#button-color"><img src="../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">button-color</span> "grey")

<a name="expl-dur"></a><a name="expl-dur"></a><span><a href="../svg-extensions.html#expl-dur"><img src="../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">expl-dur</span> "1s")

<a name="node-dur"></a><a name="node-dur"></a><span><a href="../svg-extensions.html#node-dur"><img src="../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">node-dur</span> "1s")

<a name="edge-dur"></a><a name="edge-dur"></a><span><a href="../svg-extensions.html#edge-dur"><img src="../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">edge-dur</span> "1s")

<a name="edge-move-dur"></a><a name="edge-move-dur"></a><span><a href="../svg-extensions.html#edge-move-dur"><img src="../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">edge-move-dur</span> "3s")

<a name="disappear-dur"></a><a name="disappear-dur"></a><span><a href="../svg-extensions.html#disappear-dur"><img src="../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">disappear-dur</span> "0.5s")

<a name="infinite"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">infinite</span> 1000000)

<div class="schemedoc-section-comment">;;; Graph Abstractions.
;;; The major SVG abstractions of this library allows convenient drawing of graphs, in terms of (text) nodes and edges.</div>
<a name="svg-graph"></a><a name="svg-graph"></a><span><a href="../svg-extensions.html#svg-graph"><img src="../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">svg-graph</span> 
 (<a class="schemedoc-name" href="../../../lib/xml-in-laml/man/xml-in-laml.html#xml-in-laml-abstraction" title="Manual: xml-in-laml">xml-in-laml-abstraction</a>
   (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">cont</span> <span class="local-name-binding">attr</span>)
     (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">from-step</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-number" title="Manual: general">as-number</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#defaulted-get-prop" title="Manual: general">defaulted-get-prop</a> 'from-step attr 0)))   <span class="comment">; svg-graph attributes</span><br />            (<span class="local-name-binding">to-step</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-number" title="Manual: general">as-number</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#defaulted-get-prop" title="Manual: general">defaulted-get-prop</a> 'to-step attr 0)))
            (<span class="local-name-binding">button-x</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-number" title="Manual: general">as-number</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#defaulted-get-prop" title="Manual: general">defaulted-get-prop</a> 'button-x attr 0)))
            (<span class="local-name-binding">button-y</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-number" title="Manual: general">as-number</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#defaulted-get-prop" title="Manual: general">defaulted-get-prop</a> 'button-y attr 24)))
            
            <span class="comment">; Information from explanations</span><br />            (<span class="local-name-binding">explanations-ast</span> (<a class="schemedoc-name" href="../../../lib/xml-in-laml/man/xml-in-laml.html#traverse-and-collect-first-from-ast" title="Manual: xml-in-laml">traverse-and-collect-first-from-ast</a> cont (<a class="schemedoc-name" href="../../../lib/xml-in-laml/man/xml-in-laml.html#ast-of-type?" title="Manual: xml-in-laml">ast-of-type?</a> 'element-name "explanations") <a class="schemedoc-name" href="../../../lib/man/general.html#id-1" title="Manual: general">id-1</a>))
            (<span class="local-name-binding">explanation-font-size</span> (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> explanations-ast (<a class="schemedoc-name" href="../../../lib/xml-in-laml/man/xml-in-laml.html#ast-attribute" title="Manual: xml-in-laml">ast-attribute</a> explanations-ast 'font-size 20) #f))
            (<span class="local-name-binding">explanation-x</span> (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> explanations-ast (<a class="schemedoc-name" href="../../../lib/man/general.html#as-number" title="Manual: general">as-number</a> (<a class="schemedoc-name" href="../../../lib/xml-in-laml/man/xml-in-laml.html#ast-attribute" title="Manual: xml-in-laml">ast-attribute</a> explanations-ast 'x 100)) #f))
            (<span class="local-name-binding">explanation-y</span> (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> explanations-ast (<a class="schemedoc-name" href="../../../lib/man/general.html#as-number" title="Manual: general">as-number</a> (<a class="schemedoc-name" href="../../../lib/xml-in-laml/man/xml-in-laml.html#ast-attribute" title="Manual: xml-in-laml">ast-attribute</a> explanations-ast 'y 24 )) #f))
            (<span class="local-name-binding">explanation-width</span> (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> explanations-ast (<a class="schemedoc-name" href="../../../lib/man/general.html#as-number" title="Manual: general">as-number</a> (<a class="schemedoc-name" href="../../../lib/xml-in-laml/man/xml-in-laml.html#ast-attribute" title="Manual: xml-in-laml">ast-attribute</a> explanations-ast 'width 500)) #f))
            (<span class="local-name-binding">explanation-height</span> (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> explanations-ast (<a class="schemedoc-name" href="../../../lib/man/general.html#as-number" title="Manual: general">as-number</a> (<a class="schemedoc-name" href="../../../lib/xml-in-laml/man/xml-in-laml.html#ast-attribute" title="Manual: xml-in-laml">ast-attribute</a> explanations-ast 'height 50)) #f))
            (<span class="local-name-binding">explanation-list</span> 
             (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> explanations-ast 
              (<a class="schemedoc-name" href="../../../lib/xml-in-laml/man/xml-in-laml.html#traverse-and-collect-all-from-ast" title="Manual: xml-in-laml">traverse-and-collect-all-from-ast</a> explanations-ast (<a class="schemedoc-name" href="../../../lib/xml-in-laml/man/xml-in-laml.html#ast-of-type?" title="Manual: xml-in-laml">ast-of-type?</a> 'element-name "explanation")
                 (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">expl-ast</span>)
                   (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-number" title="Manual: general">as-number</a> (<a class="schemedoc-name" href="../../../lib/xml-in-laml/man/xml-in-laml.html#ast-attribute" title="Manual: xml-in-laml">ast-attribute</a> expl-ast 'step)) (<a class="schemedoc-name" href="../../../lib/xml-in-laml/man/xml-in-laml.html#ast-subtrees" title="Manual: xml-in-laml">ast-subtrees</a> expl-ast))))
              '()))
            (<span class="local-name-binding">explanation-clause</span> 
              (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> explanations-ast 
                       (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX118" title="R5RS Scheme form">or</a> (<a class="applied-name" href="svg-extensions-1.html#animation-includes?" title="svg-extensions">animation-includes?</a> 'step-buttons-reveal) (<a class="applied-name" href="svg-extensions-1.html#animation-includes?" title="svg-extensions">animation-includes?</a> 'step-buttons-walk-through) 
                           (<a class="applied-name" href="svg-extensions-1.html#animation-includes?" title="svg-extensions">animation-includes?</a> 'step-buttons-walk-through-edge-motion)))
                        (<a class="applied-name" href="svg-extensions-1.html#make-explanation-clause" title="svg-extensions">make-explanation-clause</a> explanation-list explanation-x explanation-y explanation-width explanation-height
                                           explanation-font-size from-step to-step))
                    ((<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> explanations-ast (<a class="applied-name" href="svg-extensions-1.html#animation-includes?" title="svg-extensions">animation-includes?</a> 'auto))
                        (<a class="applied-name" href="svg-extensions-1.html#make-explanation-clause-auto" title="svg-extensions">make-explanation-clause-auto</a> explanation-list explanation-x explanation-y explanation-width explanation-height
                                           explanation-font-size from-step to-step))
                   (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> '())))

            (<span class="local-name-binding">animation-control</span> 
              (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX118" title="R5RS Scheme form">or</a> (<a class="applied-name" href="svg-extensions-1.html#animation-includes?" title="svg-extensions">animation-includes?</a> 'step-buttons-reveal) (<a class="applied-name" href="svg-extensions-1.html#animation-includes?" title="svg-extensions">animation-includes?</a> 'step-buttons-walk-through) (<a class="applied-name" href="svg-extensions-1.html#animation-includes?" title="svg-extensions">animation-includes?</a> 'step-buttons-walk-through-edge-motion))
                       (<a class="applied-name" href="svg-extensions-1.html#make-animation-control-clause" title="svg-extensions">make-animation-control-clause</a> button-x button-y from-step to-step))
                    (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> '())))

            (<span class="local-name-binding">g-attributes</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#property-subset" title="Manual: general">property-subset</a> attr '()))  <span class="comment">; the empty list of attribute</span><br />            (<span class="local-name-binding">g-cont</span>   <span class="comment">; Content without explanations</span><br />              (<a class="schemedoc-name" href="../../../lib/man/general.html#filter" title="Manual: general">filter</a> (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">cnt</span>) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="schemedoc-name" href="../../../lib/xml-in-laml/man/xml-in-laml.html#ast?" title="Manual: xml-in-laml">ast?</a> cnt) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX200" title="R5RS Scheme form">equal?</a> (<a class="schemedoc-name" href="../../../lib/xml-in-laml/man/xml-in-laml.html#ast-element-name" title="Manual: xml-in-laml">ast-element-name</a> cnt) "explanations")))) cont))
           )
    (g (<a class="applied-name" href="svg-extensions-1.html#open-arrow-def" title="svg-extensions">open-arrow-def</a> 20 15)  (<a class="applied-name" href="svg-extensions-1.html#open-diamond-def" title="svg-extensions">open-diamond-def</a> 30 22.5) (<a class="applied-name" href="svg-extensions-1.html#filled-arrow-def" title="svg-extensions">filled-arrow-def</a> 20 15)  (<a class="applied-name" href="svg-extensions-1.html#filled-diamond-def" title="svg-extensions">filled-diamond-def</a> 30 22.5)
       animation-control explanation-clause
       g-cont g-attributes)
   ))
   (<a class="schemedoc-name" href="../../../lib/xml-in-laml/man/xml-in-laml.html#required-implied-attributes" title="Manual: xml-in-laml">required-implied-attributes</a> '() '(from-step to-step button-x button-y)
                                      "svg-graph"
    )
   "svg-graph"
   <a class="applied-name" href="svg-extensions-1.html#svg-language" title="svg-extensions">svg-language</a>))




<a name="make-animation-control-clause"></a><span class="comment">; Define the triangular backward and forward control. 
; Place first button at x,y.</span><br /><a name="make-animation-control-clause"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(make-animation-control-clause x y from-step to-step)</span>
   (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">y</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> y 8)))  <span class="comment">; for nicer alignment with explanation</span><br />    (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> 
     (g   <span class="comment">; FIRST BUTTON</span><br />
       <span class="comment">; forward triangle</span><br />      (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">x</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> x 50))
           )

         (<a class="applied-name" href="svg-extensions-1.html#triangle" title="svg-extensions">triangle</a> x (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> y 12)  (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> x 24) y x (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> y 12) 
           'fill <a class="applied-name" href="svg-extensions-1.html#button-color" title="svg-extensions">button-color</a> 'id (<a class="applied-name" href="svg-extensions-1.html#animation-forward-button-name" title="svg-extensions">animation-forward-button-name</a> from-step) 'css:visibility "visible"
           (<a class="applied-name" href="svg-extensions-1.html#show-setting-upon" title="svg-extensions">show-setting-upon</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> from-step 1) 'backward) <span class="comment">; click on (+ from-step 1) button in backward direction will
; make this triangle visible</span><br />           (<a class="applied-name" href="svg-extensions-1.html#hide-setting-upon" title="svg-extensions">hide-setting-upon</a> from-step 'forward)        <span class="comment">; click on from-step (this) button in forward direction will
; hide this button </span><br />          )))

     <span class="comment">; MIDDLE SECTION BUTTONS - initially all hidden</span><br />     (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">step</span>)
             (g
               <span class="comment">; backward triangle</span><br />               (<a class="applied-name" href="svg-extensions-1.html#triangle" title="svg-extensions">triangle</a> x y  (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> x 24) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> y 12) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> x 24) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> y 12) 
                         'fill <a class="applied-name" href="svg-extensions-1.html#button-color" title="svg-extensions">button-color</a> 'id (<a class="applied-name" href="svg-extensions-1.html#animation-backward-button-name" title="svg-extensions">animation-backward-button-name</a> step) 'css:visibility "hidden"
                 (<a class="applied-name" href="svg-extensions-1.html#show-setting-upon" title="svg-extensions">show-setting-upon</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> step 1) 'forward) (<a class="applied-name" href="svg-extensions-1.html#show-setting-upon" title="svg-extensions">show-setting-upon</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> step 1) 'backward)                         
                 (<a class="applied-name" href="svg-extensions-1.html#hide-setting-upon" title="svg-extensions">hide-setting-upon</a> step 'forward) (<a class="applied-name" href="svg-extensions-1.html#hide-setting-upon" title="svg-extensions">hide-setting-upon</a> step 'backward) 
              )

              <span class="comment">; forward triangle</span><br />              (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">x</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> x 50)))
                 (<a class="applied-name" href="svg-extensions-1.html#triangle" title="svg-extensions">triangle</a> x (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> y 12)  (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> x 24) y x (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> y 12) 
                           'fill <a class="applied-name" href="svg-extensions-1.html#button-color" title="svg-extensions">button-color</a> 'id (<a class="applied-name" href="svg-extensions-1.html#animation-forward-button-name" title="svg-extensions">animation-forward-button-name</a> step) 'css:visibility "hidden"
                   (<a class="applied-name" href="svg-extensions-1.html#show-setting-upon" title="svg-extensions">show-setting-upon</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> step 1) 'forward) (<a class="applied-name" href="svg-extensions-1.html#show-setting-upon" title="svg-extensions">show-setting-upon</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> step 1) 'backward)                         
                   (<a class="applied-name" href="svg-extensions-1.html#hide-setting-upon" title="svg-extensions">hide-setting-upon</a> step 'forward) (<a class="applied-name" href="svg-extensions-1.html#hide-setting-upon" title="svg-extensions">hide-setting-upon</a> step 'backward)                         
               ))

            ))
           (<a class="schemedoc-name" href="../../../lib/man/general.html#number-interval" title="Manual: general">number-interval</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> from-step 1) to-step)) <span class="comment">; (- to-step 1)</span><br />
     (g <span class="comment">; LAST BUTTON
; backward triangle</span><br />        (<a class="applied-name" href="svg-extensions-1.html#triangle" title="svg-extensions">triangle</a> x y  (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> x 24) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> y 12) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> x 24) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> y 12) 
                 'fill <a class="applied-name" href="svg-extensions-1.html#button-color" title="svg-extensions">button-color</a> 'id (<a class="applied-name" href="svg-extensions-1.html#animation-backward-button-name" title="svg-extensions">animation-backward-button-name</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> to-step 1)) 'css:visibility "hidden"
                 (<a class="applied-name" href="svg-extensions-1.html#show-setting-upon" title="svg-extensions">show-setting-upon</a> to-step 'forward) <span class="comment">; (- to-step 1)</span><br />                 (<a class="applied-name" href="svg-extensions-1.html#hide-setting-upon" title="svg-extensions">hide-setting-upon</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> to-step 1) 'backward)
        )

     )
   )))

<a name="show-setting-upon"></a><span class="comment">; set clause that causes controls to be shown when at step in direction.</span><br /><a name="show-setting-upon"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(show-setting-upon step direction)</span>
  (set 'attributeType "CSS" 
                'attributeName "visibility" 'to "visible"
                'begin 
                (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a>
                    (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> direction 'forward) (<a class="applied-name" href="svg-extensions-1.html#animation-forward-button-name" title="svg-extensions">animation-forward-button-name</a> step))
                          ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> direction 'backward) (<a class="applied-name" href="svg-extensions-1.html#animation-backward-button-name" title="svg-extensions">animation-backward-button-name</a> step))
                          (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#laml-error" title="Manual: general">laml-error</a> "show-setting-upon: direction must be either forward or backward" direction)))
                     "." "click") 'fill "freeze"))

<a name="hide-setting-upon"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(hide-setting-upon step direction)</span> 
  (set 'attributeType "CSS" 
                'attributeName "visibility" 'to "hidden"
                'begin 
                (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a>
                    (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> direction 'forward) (<a class="applied-name" href="svg-extensions-1.html#animation-forward-button-name" title="svg-extensions">animation-forward-button-name</a> step))
                          ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> direction 'backward) (<a class="applied-name" href="svg-extensions-1.html#animation-backward-button-name" title="svg-extensions">animation-backward-button-name</a> step))
                          (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#laml-error" title="Manual: general">laml-error</a> "show-setting-upon: direction must be either forward or backward" direction)))
                     "." "click") 'fill "freeze"))


<a name="svg-node"></a><a name="svg-node"></a><span><a href="../svg-extensions.html#svg-node"><img src="../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">svg-node</span>
 (<a class="schemedoc-name" href="../../../lib/xml-in-laml/man/xml-in-laml.html#xml-in-laml-positional-abstraction" title="Manual: xml-in-laml">xml-in-laml-positional-abstraction</a> 3 0
   (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">shape-path-function</span> <span class="local-name-binding">x</span> <span class="local-name-binding">y</span> <span class="local-name-binding">cont</span> <span class="local-name-binding">attr</span>)
     (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">id</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#defaulted-get-prop" title="Manual: general">defaulted-get-prop</a> 'id attr #f))
            (<span class="local-name-binding">font-size</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-number" title="Manual: general">as-number</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#defaulted-get-prop" title="Manual: general">defaulted-get-prop</a> 'font-size attr 30)))     <span class="comment">; Abstraction specific attributes</span><br />            (<span class="local-name-binding">font-family</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#defaulted-get-prop" title="Manual: general">defaulted-get-prop</a> 'font-family attr "times-roman"))  <span class="comment">; "courier-new"</span><br />            (<span class="local-name-binding">text-color</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#defaulted-get-prop" title="Manual: general">defaulted-get-prop</a> 'text-color attr "black"))
            (<span class="local-name-binding">text-align</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#defaulted-get-prop" title="Manual: general">defaulted-get-prop</a> 'text-align attr "cc"))
            (<span class="local-name-binding">bg-color</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#defaulted-get-prop" title="Manual: general">defaulted-get-prop</a> 'bg-color attr "white"))
            (<span class="local-name-binding">locator</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#defaulted-get-prop" title="Manual: general">defaulted-get-prop</a> 'lc attr "cc"))
            (<span class="local-name-binding">min-width</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-number" title="Manual: general">as-number</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#defaulted-get-prop" title="Manual: general">defaulted-get-prop</a> 'min-width attr 0)))
            (<span class="local-name-binding">min-height</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-number" title="Manual: general">as-number</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#defaulted-get-prop" title="Manual: general">defaulted-get-prop</a> 'min-height attr 0)))
            (<span class="local-name-binding">delta-width</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-number" title="Manual: general">as-number</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#defaulted-get-prop" title="Manual: general">defaulted-get-prop</a> 'delta-width attr 0)))
            (<span class="local-name-binding">delta-height</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-number" title="Manual: general">as-number</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#defaulted-get-prop" title="Manual: general">defaulted-get-prop</a> 'delta-height attr 0)))
            (<span class="local-name-binding">step</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-number" title="Manual: general">as-number</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#defaulted-get-prop" title="Manual: general">defaulted-get-prop</a> 'step attr 0)))
            (<span class="local-name-binding">rect-attributes</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#property-subset" title="Manual: general">property-subset</a> attr '(stroke-width stroke stroke-dasharray stroke-offset opacity stroke-opacity rx ry)))   <span class="comment">; SVG attributes</span><br />            (<span class="local-name-binding">text-attributes</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#property-subset" title="Manual: general">property-subset</a> attr '(font-style)))

            (<span class="local-name-binding">label-dx</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-number" title="Manual: general">as-number</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#defaulted-get-prop" title="Manual: general">defaulted-get-prop</a> 'ldx attr 0)))
            (<span class="local-name-binding">label-dy</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-number" title="Manual: general">as-number</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#defaulted-get-prop" title="Manual: general">defaulted-get-prop</a> 'ldy attr 0)))

            (<span class="local-name-binding">w</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX247" title="R5RS Scheme form">max</a> (<a class="applied-name" href="svg-extensions-1.html#measured-text-width" title="svg-extensions">measured-text-width</a> cont font-size font-family) min-width) delta-width))     <span class="comment">; Width and height</span><br />            (<span class="local-name-binding">h</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX247" title="R5RS Scheme form">max</a> (<a class="applied-name" href="svg-extensions-1.html#measured-text-height" title="svg-extensions">measured-text-height</a> cont font-size font-family) min-height) delta-height))

            (<span class="local-name-binding">displacement-vector</span> (<a class="applied-name" href="svg-extensions-1.html#rectangle-adjustment" title="svg-extensions">rectangle-adjustment</a> locator w h))
            (<span class="local-name-binding">dx</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> displacement-vector))
            (<span class="local-name-binding">dy</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> displacement-vector))

            (<span class="local-name-binding">cr-x</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> x dx))    <span class="comment">; Calculated x and y coordinates of rectangle</span><br />            (<span class="local-name-binding">cr-y</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> y dy))

            (<span class="local-name-binding">text-x-y-clause</span> (<a class="applied-name" href="svg-extensions-1.html#text-x-y" title="svg-extensions">text-x-y</a> cr-x cr-y w h font-size text-align label-dx label-dy))
            (<span class="local-name-binding">group-animation-clause</span>
             (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">step-from</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-number" title="Manual: general">as-number</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#defaulted-get-prop" title="Manual: general">defaulted-get-prop</a> 'step-from attr step)))    <span class="comment">; step-from .. step-to:  reaveal in this interval</span><br />                    (<span class="local-name-binding">step-to</span>   (<a class="schemedoc-name" href="../../../lib/man/general.html#as-number" title="Manual: general">as-number</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#defaulted-get-prop" title="Manual: general">defaulted-get-prop</a> 'step-to attr <a class="applied-name" href="svg-extensions-1.html#infinite" title="svg-extensions">infinite</a>)))  
                   )
              (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX237" title="R5RS Scheme form">&gt;</a> step-from step-to) (<a class="schemedoc-name" href="../../../lib/man/general.html#laml-error" title="Manual: general">laml-error</a> "step-from must be less than or equal to step-to" step-from step-to))
              (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="applied-name" href="svg-extensions-1.html#animation-includes?" title="svg-extensions">animation-includes?</a> 'step-buttons-reveal) <span class="comment">; only step, not steps</span><br />                       (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a>
                        (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX237" title="R5RS Scheme form">&gt;</a> step-from 0) 
                            (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> 'css:visibility "visible" 'css:opacity 0)
                            (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> 'css:visibility "visible" 'css:opacity 1))
                        <span class="comment">; going forward</span><br />                       (animate 'attributeType "CSS" 'attributeName "opacity" <span class="comment">; APPEARING</span><br />                                (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> 'from 0 'to 1) 'dur <a class="applied-name" href="svg-extensions-1.html#edge-dur" title="svg-extensions">edge-dur</a>  'fill "freeze" 
                                'begin (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> (<a class="applied-name" href="svg-extensions-1.html#animation-forward-button-name" title="svg-extensions">animation-forward-button-name</a> step-from) "." "click"))
                       (animate 'attributeType "CSS" 'attributeName "opacity" <span class="comment">; DISAPPEARING</span><br />                                (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> 'from 1 'to 0) 'dur <a class="applied-name" href="svg-extensions-1.html#edge-dur" title="svg-extensions">edge-dur</a>  'fill "freeze" 
                                'begin (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> (<a class="applied-name" href="svg-extensions-1.html#animation-forward-button-name" title="svg-extensions">animation-forward-button-name</a> step-to) "." "click"))

                       <span class="comment">; going backward</span><br />                       (animate 'attributeType "CSS" 'attributeName "opacity" <span class="comment">; APPEARING</span><br />                                (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> 'from 0 'to 1) 'dur <a class="applied-name" href="svg-extensions-1.html#disappear-dur" title="svg-extensions">disappear-dur</a>  'fill "freeze" 
                                'begin (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> (<a class="applied-name" href="svg-extensions-1.html#animation-backward-button-name" title="svg-extensions">animation-backward-button-name</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> step-to 1)) "." "click"))
                       (animate 'attributeType "CSS" 'attributeName "opacity" <span class="comment">; DISAPPEARING</span><br />                                (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> 'from 1 'to 0) 'dur <a class="applied-name" href="svg-extensions-1.html#disappear-dur" title="svg-extensions">disappear-dur</a>  'fill "freeze" 
                                'begin (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> (<a class="applied-name" href="svg-extensions-1.html#animation-backward-button-name" title="svg-extensions">animation-backward-button-name</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> step-from 1)) "." "click"))
                        ))

                     ((<a class="applied-name" href="svg-extensions-1.html#animation-includes?" title="svg-extensions">animation-includes?</a> 'auto)
                       (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">start-time</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-number" title="Manual: general">as-number</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#second" title="Manual: general">second</a> <a class="applied-name" href="svg-extensions-1.html#current-animation-type" title="svg-extensions">current-animation-type</a>)))
                             (<span class="local-name-binding">seconds-pr-step</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-number" title="Manual: general">as-number</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#third" title="Manual: general">third</a> <a class="applied-name" href="svg-extensions-1.html#current-animation-type" title="svg-extensions">current-animation-type</a>))))
                        (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a>
			 (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX237" title="R5RS Scheme form">&gt;</a> step-from 0) 
			     (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> 'css:visibility "visible" 'css:opacity 0)
			     (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> 'css:visibility "visible" 'css:opacity 1))
					<span class="comment">; going forward</span><br />			 (animate 'attributeType "CSS" 'attributeName "opacity"	<span class="comment">; APPEARING</span><br />				  (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> 'from 0 'to 1) 'dur <a class="applied-name" href="svg-extensions-1.html#edge-dur" title="svg-extensions">edge-dur</a>  'fill "freeze" 
				  'begin (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> start-time (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX250" title="R5RS Scheme form">*</a> step-from seconds-pr-step)))

			 )))
                    (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> '()))))
            (<span class="local-name-binding">rect-animation-clause-node-emphasize</span> 
              (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="applied-name" href="svg-extensions-1.html#animation-includes?" title="svg-extensions">animation-includes?</a> 'node-emphasize)
                       (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a>
                         (animate 'attributeType "XML" 'attributeName "fill" 'from bg-color 'to <a class="applied-name" href="svg-extensions-1.html#emphasis-color" title="svg-extensions">emphasis-color</a> 'dur <a class="applied-name" href="svg-extensions-1.html#node-dur" title="svg-extensions">node-dur</a> 
                                  'begin "mouseover" 'fill "freeze")
                         (animate 'attributeType "XML" 'attributeName "fill" 'from <a class="applied-name" href="svg-extensions-1.html#emphasis-color" title="svg-extensions">emphasis-color</a> 'to bg-color 'dur <a class="applied-name" href="svg-extensions-1.html#disappear-dur" title="svg-extensions">disappear-dur</a>
                                  'begin "mouseout" 'fill "freeze")
                       ))
                    (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> '())))
            (<span class="local-name-binding">rect-animation-clause-buttons-walk-through</span>
             (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">steps-given</span> (<a class="applied-name" href="svg-extensions-1.html#as-number-list" title="svg-extensions">as-number-list</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#defaulted-get-prop" title="Manual: general">defaulted-get-prop</a> 'steps attr ""))) <span class="comment">; the empty list if steps not supplied.</span><br />                    (<span class="local-name-binding">steps</span> (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> steps-given)) steps-given)
                                (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> step)))))
               (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX118" title="R5RS Scheme form">or</a> (<a class="applied-name" href="svg-extensions-1.html#animation-includes?" title="svg-extensions">animation-includes?</a> 'step-buttons-walk-through) (<a class="applied-name" href="svg-extensions-1.html#animation-includes?" title="svg-extensions">animation-includes?</a> 'step-buttons-walk-through-edge-motion))
                      (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">step</span>)
                             (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a>
                              (<a class="applied-name" href="svg-extensions-1.html#node-emphasize" title="svg-extensions">node-emphasize</a> bg-color (<a class="applied-name" href="svg-extensions-1.html#animation-forward-button-name" title="svg-extensions">animation-forward-button-name</a> step))

                              (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX239" title="R5RS Scheme form">&gt;=</a> step 1) 
                                  (<a class="applied-name" href="svg-extensions-1.html#node-deemphasize" title="svg-extensions">node-deemphasize</a> bg-color (<a class="applied-name" href="svg-extensions-1.html#animation-forward-button-name" title="svg-extensions">animation-forward-button-name</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> step 1)))
                                  '())

                              (<a class="applied-name" href="svg-extensions-1.html#node-deemphasize" title="svg-extensions">node-deemphasize</a> bg-color (<a class="applied-name" href="svg-extensions-1.html#animation-backward-button-name" title="svg-extensions">animation-backward-button-name</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> step 1)))

                              (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX239" title="R5RS Scheme form">&gt;=</a> step 1) 
                                  (<a class="applied-name" href="svg-extensions-1.html#node-emphasize" title="svg-extensions">node-emphasize</a> bg-color (<a class="applied-name" href="svg-extensions-1.html#animation-backward-button-name" title="svg-extensions">animation-backward-button-name</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> step 2)))
                                  '())
                              )) steps))
                     (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> '())))
            
           ))
       (g group-animation-clause
          (shape-path-function cr-x cr-y w h 
             rect-attributes                           <span class="comment">; LAML flattens all lists passed as rest parameters to shape-path-function</span><br />             'stroke-width "1" 'stroke "black" 'fill bg-color (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> id (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> 'id id) '()) 
              rect-animation-clause-node-emphasize rect-animation-clause-buttons-walk-through)
          (text  text-attributes 'font-family font-family 'font-size font-size
                 'stroke text-color 'color text-color 'fill text-color
                 text-x-y-clause 
                 cont
                 )
          )))
    (<a class="schemedoc-name" href="../../../lib/xml-in-laml/man/xml-in-laml.html#required-implied-attributes" title="Manual: xml-in-laml">required-implied-attributes</a> '() '(id font-size font-family text-color text-align bg-color lc min-width min-height delta-width delta-height
                                       stroke-width stroke stroke-dasharray stroke-offset rx ry font-style step steps step-from step-to)
                                      "svg-node"
    )
    "svg-node"
    <a class="applied-name" href="svg-extensions-1.html#svg-language" title="svg-extensions">svg-language</a>))



<span class="comment">; (define shaped-svg-node 
; (xml-in-laml-positional-abstraction 3 0
;   (lambda (x y shape-path-fn cont attr)
;     ...)))</span><br />
<a name="empty-svg-node"></a><a name="empty-svg-node"></a><span><a href="../svg-extensions.html#empty-svg-node"><img src="../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">empty-svg-node</span>
 (<a class="schemedoc-name" href="../../../lib/xml-in-laml/man/xml-in-laml.html#xml-in-laml-positional-abstraction" title="Manual: xml-in-laml">xml-in-laml-positional-abstraction</a> 2 0
   (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">x</span> <span class="local-name-binding">y</span> <span class="local-name-binding">cont</span> <span class="local-name-binding">attr</span>)
      (<a class="applied-name" href="svg-extensions-1.html#svg-node" title="svg-extensions">svg-node</a> <a class="applied-name" href="svg-extensions-1.html#rectangular" title="svg-extensions">rectangular</a> x y "" 'stroke "none" attr))))

<a name="node-emphasize"></a><span class="comment">; Convert a string of the form "n-m" to the list '(n m). n and m are both positive integers.
; (define (string-to-number-interval str)
;  (map as-number (split-on #\- str)))</span><br />  


<a name="node-emphasize"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(node-emphasize bg-color-before but)</span>
  (animate 'attributeType "XML" 'attributeName "fill" 
           'from bg-color-before 'to <a class="applied-name" href="svg-extensions-1.html#emphasis-color" title="svg-extensions">emphasis-color</a> 'dur <a class="applied-name" href="svg-extensions-1.html#node-dur" title="svg-extensions">node-dur</a> 'fill "freeze" 
           'begin (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> but "." "click")))

<a name="node-deemphasize"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(node-deemphasize bg-color-after but)</span>
  (animate 'attributeType "XML" 'attributeName "fill" 
           'to bg-color-after 'from <a class="applied-name" href="svg-extensions-1.html#emphasis-color" title="svg-extensions">emphasis-color</a> 'dur <a class="applied-name" href="svg-extensions-1.html#disappear-dur" title="svg-extensions">disappear-dur</a> 'fill "freeze" 
           'begin (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> but "." "click")))

<a name="as-number-list"></a><span class="comment">; Given a comma separated string of numbers, such as "1,2,3" return a list of numbers, such as (1 2 3).</span><br /><a name="as-number-list"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(as-number-list comma-string)</span>
  (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> <a class="schemedoc-name" href="../../../lib/man/general.html#as-number" title="Manual: general">as-number</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#string-to-list" title="Manual: general">string-to-list</a> comma-string (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> #\,))))

<a name="svg-composite-node"></a><a name="svg-composite-node"></a><span><a href="../svg-extensions.html#svg-composite-node"><img src="../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">svg-composite-node</span>
 (<a class="schemedoc-name" href="../../../lib/xml-in-laml/man/xml-in-laml.html#xml-in-laml-positional-abstraction" title="Manual: xml-in-laml">xml-in-laml-positional-abstraction</a> 3 0
   (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">x</span> <span class="local-name-binding">y</span> <span class="local-name-binding">inner-graph</span> <span class="local-name-binding">cont</span> <span class="local-name-binding">attr</span>)
     (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> (
            (<span class="local-name-binding">bg-color</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#defaulted-get-prop" title="Manual: general">defaulted-get-prop</a> 'bg-color attr "white"))      <span class="comment">; Abstraction specific attributes</span><br />            (<span class="local-name-binding">locator</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#defaulted-get-prop" title="Manual: general">defaulted-get-prop</a> 'lc attr "cc"))
            (<span class="local-name-binding">padding</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-number" title="Manual: general">as-number</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#defaulted-get-prop" title="Manual: general">defaulted-get-prop</a> 'padding attr 0)))
            (<span class="local-name-binding">step</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-number" title="Manual: general">as-number</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#defaulted-get-prop" title="Manual: general">defaulted-get-prop</a> 'step attr 0)))
            (<span class="local-name-binding">steps-given</span> (<a class="applied-name" href="svg-extensions-1.html#as-number-list" title="svg-extensions">as-number-list</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#defaulted-get-prop" title="Manual: general">defaulted-get-prop</a> 'steps attr "")))  <span class="comment">; the empty list if steps not supplied.</span><br />            (<span class="local-name-binding">steps</span> (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> steps-given)) steps-given)
                         (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> step))))

            (<span class="local-name-binding">rect-attributes</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#property-subset" title="Manual: general">property-subset</a> attr '(stroke-width stroke stroke-dasharray stroke-offset rx ry)))     <span class="comment">; SVG attributes</span><br />
            (<span class="local-name-binding">min-max-x-y</span> (<a class="applied-name" href="svg-extensions-1.html#find-min-max-x-y" title="svg-extensions">find-min-max-x-y</a> inner-graph)) <span class="comment">; a list of four numbers: the minimum left-top coordinate and the maximum right-bottom coordinates</span><br />            (<span class="local-name-binding">inner-x</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#first" title="Manual: general">first</a> min-max-x-y))
            (<span class="local-name-binding">inner-y</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#second" title="Manual: general">second</a> min-max-x-y))
            (<span class="local-name-binding">width-of-inner-graph</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#third" title="Manual: general">third</a> min-max-x-y) (<a class="schemedoc-name" href="../../../lib/man/general.html#first" title="Manual: general">first</a> min-max-x-y)))     <span class="comment">; Width and height</span><br />            (<span class="local-name-binding">height-of-inner-graph</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#fourth" title="Manual: general">fourth</a> min-max-x-y) (<a class="schemedoc-name" href="../../../lib/man/general.html#second" title="Manual: general">second</a> min-max-x-y)))

            (<span class="local-name-binding">width-of-composite</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-number" title="Manual: general">as-number</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#defaulted-get-prop" title="Manual: general">defaulted-get-prop</a> 'width attr width-of-inner-graph)))      <span class="comment">; Given attribute. The exact width of the composite node. Not required.</span><br />            (<span class="local-name-binding">height-of-composite</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX250" title="R5RS Scheme form">*</a> height-of-inner-graph (<a class="applied-name" href="svg-extensions-1.html#divide" title="svg-extensions">divide</a> width-of-composite width-of-inner-graph)))  <span class="comment">; Calcuated - preserves the aspect ratio.</span><br />
            (<span class="local-name-binding">displacement-vector</span> (<a class="applied-name" href="svg-extensions-1.html#rectangle-adjustment" title="svg-extensions">rectangle-adjustment</a> locator (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> width-of-composite (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX250" title="R5RS Scheme form">*</a> 2 padding)) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> height-of-composite (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX250" title="R5RS Scheme form">*</a> 2 padding))))
            (<span class="local-name-binding">dx</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> displacement-vector))
            (<span class="local-name-binding">dy</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> displacement-vector))

            (<span class="local-name-binding">cr-x</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> x dx))    <span class="comment">; Calculated x and y coordinates of rectangle</span><br />            (<span class="local-name-binding">cr-y</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> y dy))

            (<span class="local-name-binding">group-animation-clause</span>
              (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="applied-name" href="svg-extensions-1.html#animation-includes?" title="svg-extensions">animation-includes?</a> 'step-buttons-reveal) <span class="comment">; only step, not steps</span><br />                       (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a>
                        (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX237" title="R5RS Scheme form">&gt;</a> step 0) 
                            (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> 'css:visibility "visible" 'css:opacity 0)
                            (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> 'css:visibility "visible" 'css:opacity 1))
                        (animate 'attributeType "CSS" 'attributeName "opacity" <span class="comment">; APPEARING</span><br />                                 'from 0 'to 1 'dur <a class="applied-name" href="svg-extensions-1.html#node-dur" title="svg-extensions">node-dur</a> 'fill "freeze" 
                                 'begin (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> (<a class="applied-name" href="svg-extensions-1.html#animation-forward-button-name" title="svg-extensions">animation-forward-button-name</a> step) "." "click"))
                        (animate 'attributeType "CSS" 'attributeName "opacity" <span class="comment">; DISAPPEARING</span><br />                                 'from 1 'to 0 'dur <a class="applied-name" href="svg-extensions-1.html#disappear-dur" title="svg-extensions">disappear-dur</a>  'fill "freeze"
                                 'begin (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> (<a class="applied-name" href="svg-extensions-1.html#animation-backward-button-name" title="svg-extensions">animation-backward-button-name</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> step 1)) "." "click"))
                        ))
                    (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> '())))
            (<span class="local-name-binding">rect-animation-clause-buttons-walk-through</span>
              (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX118" title="R5RS Scheme form">or</a> (<a class="applied-name" href="svg-extensions-1.html#animation-includes?" title="svg-extensions">animation-includes?</a> 'step-buttons-walk-through) (<a class="applied-name" href="svg-extensions-1.html#animation-includes?" title="svg-extensions">animation-includes?</a> 'step-buttons-walk-through-edge-motion))
                      (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">step</span>)
                       (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a>
                        (<a class="applied-name" href="svg-extensions-1.html#node-emphasize" title="svg-extensions">node-emphasize</a> bg-color (<a class="applied-name" href="svg-extensions-1.html#animation-forward-button-name" title="svg-extensions">animation-forward-button-name</a> step))

                        (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX239" title="R5RS Scheme form">&gt;=</a> step 1) 
                            (<a class="applied-name" href="svg-extensions-1.html#node-deemphasize" title="svg-extensions">node-deemphasize</a> bg-color (<a class="applied-name" href="svg-extensions-1.html#animation-forward-button-name" title="svg-extensions">animation-forward-button-name</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> step 1)))
                            '())

                        (<a class="applied-name" href="svg-extensions-1.html#node-deemphasize" title="svg-extensions">node-deemphasize</a> bg-color (<a class="applied-name" href="svg-extensions-1.html#animation-backward-button-name" title="svg-extensions">animation-backward-button-name</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> step 1)))

                        (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX239" title="R5RS Scheme form">&gt;=</a> step 1) 
                            (<a class="applied-name" href="svg-extensions-1.html#node-emphasize" title="svg-extensions">node-emphasize</a> bg-color (<a class="applied-name" href="svg-extensions-1.html#animation-backward-button-name" title="svg-extensions">animation-backward-button-name</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> step 2)))
                            '())
                        )) steps)   
                    )
                    (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> '())))

           )
         (g group-animation-clause
          (rect rect-attributes 'x cr-x 'y cr-y
                'width (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> width-of-composite (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX250" title="R5RS Scheme form">*</a> 2 padding)) 'height (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> height-of-composite (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX250" title="R5RS Scheme form">*</a> 2 padding))
                'stroke-width "1" 'stroke "black" 'fill bg-color
                rect-animation-clause-buttons-walk-through
               )
          (g 'transform (<a class="applied-name" href="svg-extensions-1.html#svg-translate" title="svg-extensions">svg-translate</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> cr-x padding) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> cr-y padding) )
            (g 'transform (<a class="applied-name" href="svg-extensions-1.html#svg-scale" title="svg-extensions">svg-scale</a> (<a class="applied-name" href="svg-extensions-1.html#divide" title="svg-extensions">divide</a> width-of-composite width-of-inner-graph))  
               (g 'transform (<a class="applied-name" href="svg-extensions-1.html#svg-translate" title="svg-extensions">svg-translate</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> inner-x) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> inner-y)) inner-graph))))))
          

    (<a class="schemedoc-name" href="../../../lib/xml-in-laml/man/xml-in-laml.html#required-implied-attributes" title="Manual: xml-in-laml">required-implied-attributes</a> '() '(step steps padding width bg-color lc min-width min-height 
                                       stroke-width stroke stroke-dasharray stroke-offset rx ry font-style)
                                      "svg-compositie-node"
    )
    "svg-composite-node"
    <a class="applied-name" href="svg-extensions-1.html#svg-language" title="svg-extensions">svg-language</a>))


<a name="svg-edge"></a><a name="svg-edge"></a><span><a href="../svg-extensions.html#svg-edge"><img src="../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(svg-edge . parameters)</span>
  (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX239" title="R5RS Scheme form">&gt;=</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX333" title="R5RS Scheme form">length</a> parameters) 4)
                  (<a class="schemedoc-name" href="../../../lib/xml-in-laml/man/xml-in-laml.html#ast?" title="Manual: xml-in-laml">ast?</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#first" title="Manual: general">first</a> parameters)) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX374" title="R5RS Scheme form">string?</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#second" title="Manual: general">second</a> parameters))
                  (<a class="schemedoc-name" href="../../../lib/xml-in-laml/man/xml-in-laml.html#ast?" title="Manual: xml-in-laml">ast?</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#third" title="Manual: general">third</a> parameters)) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX374" title="R5RS Scheme form">string?</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#fourth" title="Manual: general">fourth</a> parameters)))
           (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX411" title="R5RS Scheme form">apply</a> <a class="applied-name" href="svg-extensions-1.html#svg-edge-original" title="svg-extensions">svg-edge-original</a> parameters))
        ((<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX239" title="R5RS Scheme form">&gt;=</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX333" title="R5RS Scheme form">length</a> parameters) 2) (<a class="schemedoc-name" href="../../../lib/xml-in-laml/man/xml-in-laml.html#ast?" title="Manual: xml-in-laml">ast?</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#first" title="Manual: general">first</a> parameters)) (<a class="schemedoc-name" href="../../../lib/xml-in-laml/man/xml-in-laml.html#ast?" title="Manual: xml-in-laml">ast?</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#second" title="Manual: general">second</a> parameters)))
           (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX411" title="R5RS Scheme form">apply</a> <a class="applied-name" href="svg-extensions-1.html#svg-edge-new" title="svg-extensions">svg-edge-new</a> parameters))
        (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#laml-error" title="Manual: general">laml-error</a> "svg-edge: Either (svg-edge node con node con ...) or (svg-edge node node ...)."))))

<a name="svg-edge-original"></a><span class="comment">; The variant of svg-edge, with four required, position parameters. No optional connectors can be supplied in attributes.</span><br /><a name="svg-edge-original"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">svg-edge-original</span>
 (<a class="schemedoc-name" href="../../../lib/xml-in-laml/man/xml-in-laml.html#xml-in-laml-positional-abstraction" title="Manual: xml-in-laml">xml-in-laml-positional-abstraction</a> 4 0
   (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">from-node</span> <span class="local-name-binding">from-connector</span> <span class="local-name-binding">to-node</span> <span class="local-name-binding">to-connector</span> <span class="local-name-binding">cont</span> <span class="local-name-binding">attr</span>)
     (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">arrow</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#defaulted-get-prop" title="Manual: general">defaulted-get-prop</a> 'arrow attr "no"))   <span class="comment">; Abstraction specific attributes</span><br />            (<span class="local-name-binding">from-id</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#defaulted-get-prop" title="Manual: general">defaulted-get-prop</a> 'from-id attr #f))
            (<span class="local-name-binding">to-id</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#defaulted-get-prop" title="Manual: general">defaulted-get-prop</a> 'to-id attr #f))
            (<span class="local-name-binding">step</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-number" title="Manual: general">as-number</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#defaulted-get-prop" title="Manual: general">defaulted-get-prop</a> 'step attr 0)))

            (<span class="local-name-binding">font-size</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-number" title="Manual: general">as-number</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#defaulted-get-prop" title="Manual: general">defaulted-get-prop</a> 'font-size attr 30)))     <span class="comment">; Label attributes</span><br />            (<span class="local-name-binding">font-family</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#defaulted-get-prop" title="Manual: general">defaulted-get-prop</a> 'font-family attr "times-roman"))
            (<span class="local-name-binding">font-style</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#defaulted-get-prop" title="Manual: general">defaulted-get-prop</a> 'font-style attr "normal"))  
            (<span class="local-name-binding">text-color</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#defaulted-get-prop" title="Manual: general">defaulted-get-prop</a> 'text-color attr "black")) 

            (<span class="local-name-binding">label-dx</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-number" title="Manual: general">as-number</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#defaulted-get-prop" title="Manual: general">defaulted-get-prop</a> 'ldx attr 0)))
            (<span class="local-name-binding">label-dy</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-number" title="Manual: general">as-number</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#defaulted-get-prop" title="Manual: general">defaulted-get-prop</a> 'ldy attr 0)))

            (<span class="local-name-binding">edge-style</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-symbol" title="Manual: general">as-symbol</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#defaulted-get-prop" title="Manual: general">defaulted-get-prop</a> 'style attr "straight")))
            (<span class="local-name-binding">dx</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-number" title="Manual: general">as-number</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#defaulted-get-prop" title="Manual: general">defaulted-get-prop</a> 'dx attr 0)))
            (<span class="local-name-binding">dy</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-number" title="Manual: general">as-number</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#defaulted-get-prop" title="Manual: general">defaulted-get-prop</a> 'dy attr 0)))

            (<span class="local-name-binding">from-pair</span> (<a class="applied-name" href="svg-extensions-1.html#x-y-of-node" title="svg-extensions">x-y-of-node</a> from-node from-id from-connector))
            (<span class="local-name-binding">x1</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> from-pair) dx)) (<span class="local-name-binding">y1</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> from-pair) dy))
            (<span class="local-name-binding">to-pair</span> (<a class="applied-name" href="svg-extensions-1.html#x-y-of-node" title="svg-extensions">x-y-of-node</a> to-node to-id to-connector))
            (<span class="local-name-binding">x2</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> to-pair) dx)) (<span class="local-name-binding">y2</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> to-pair) dy))
            (<span class="local-name-binding">break-path</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#defaulted-get-prop" title="Manual: general">defaulted-get-prop</a> 'break-path attr #f))
            (<span class="local-name-binding">edge-break-segment</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#defaulted-get-prop" title="Manual: general">defaulted-get-prop</a> 'break-path attr (<a class="applied-name" href="svg-extensions-1.html#edge-break-segment" title="svg-extensions">edge-break-segment</a> edge-style x1 y1 x2 y2)))
            (<span class="local-name-binding">line-attr</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#property-subset" title="Manual: general">property-subset</a> attr '(stroke stroke-width stroke-dasharray stroke-dashoffset stroke-linecap)))   <span class="comment">; </span><br />            (<span class="local-name-binding">forward-line-id</span> (<a class="applied-name" href="svg-extensions-1.html#unique-symbol" title="svg-extensions">unique-symbol</a> "line"))
            (<span class="local-name-binding">reverse-line-id</span> (<a class="applied-name" href="svg-extensions-1.html#unique-symbol" title="svg-extensions">unique-symbol</a> "line"))
            (<span class="local-name-binding">stroke-width</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-number" title="Manual: general">as-number</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#defaulted-get-prop" title="Manual: general">defaulted-get-prop</a> 'stroke-width attr 1)))
            (<span class="local-name-binding">stroke</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#defaulted-get-prop" title="Manual: general">defaulted-get-prop</a> 'stroke attr "black"))
            (<span class="local-name-binding">duration</span> (<a class="applied-name" href="svg-extensions-1.html#ensure-as-seconds" title="svg-extensions">ensure-as-seconds</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#defaulted-get-prop" title="Manual: general">defaulted-get-prop</a> 'dur attr <a class="applied-name" href="svg-extensions-1.html#edge-move-dur" title="svg-extensions">edge-move-dur</a>))) 

            (<span class="local-name-binding">arrow-clause</span>
               (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX118" title="R5RS Scheme form">or</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX200" title="R5RS Scheme form">equal?</a> arrow "yes") (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX200" title="R5RS Scheme form">equal?</a> arrow "true") (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX200" title="R5RS Scheme form">equal?</a> arrow "filled-triangle") (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX200" title="R5RS Scheme form">equal?</a> arrow "triangle")) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> 'marker-end "url(#FilledArrowhead)"))
                     ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX200" title="R5RS Scheme form">equal?</a> arrow "open-triangle") (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> 'marker-end "url(#OpenArrowhead)") )
                     ((<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX118" title="R5RS Scheme form">or</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX200" title="R5RS Scheme form">equal?</a> arrow "diamond") (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX200" title="R5RS Scheme form">equal?</a> arrow "filled-diamond")) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> 'marker-end "url(#FilledDiamond)"))
                     ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX200" title="R5RS Scheme form">equal?</a> arrow "open-diamond") (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> 'marker-end "url(#OpenDiamond)"))
                     (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> '())) )

            (<span class="local-name-binding">group-animation-clause</span>
             (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">step-from</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-number" title="Manual: general">as-number</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#defaulted-get-prop" title="Manual: general">defaulted-get-prop</a> 'step-from attr step)))    <span class="comment">; step-from .. step-to:  reaveal in this interval</span><br />                   (<span class="local-name-binding">step-to</span>   (<a class="schemedoc-name" href="../../../lib/man/general.html#as-number" title="Manual: general">as-number</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#defaulted-get-prop" title="Manual: general">defaulted-get-prop</a> 'step-to attr <a class="applied-name" href="svg-extensions-1.html#infinite" title="svg-extensions">infinite</a>)))    
                  )
              (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX237" title="R5RS Scheme form">&gt;</a> step-from step-to) (<a class="schemedoc-name" href="../../../lib/man/general.html#laml-error" title="Manual: general">laml-error</a> "step-from must be less than or equal to step-to" step-from step-to))
              (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="applied-name" href="svg-extensions-1.html#animation-includes?" title="svg-extensions">animation-includes?</a> 'step-buttons-reveal)  <span class="comment">; only step, not steps</span><br />                      (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a>  
                       (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX237" title="R5RS Scheme form">&gt;</a> step-from 0)
                           (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> 'css:visibility "visible" 'css:opacity 0)
                           (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> 'css:visibility "visible" 'css:opacity 1))

                       <span class="comment">; going forward</span><br />                       (animate 'attributeType "CSS" 'attributeName "opacity" <span class="comment">; APPEARING</span><br />                                (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> 'from 0 'to 1) 'dur <a class="applied-name" href="svg-extensions-1.html#edge-dur" title="svg-extensions">edge-dur</a>  'fill "freeze" 
                                'begin (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> (<a class="applied-name" href="svg-extensions-1.html#animation-forward-button-name" title="svg-extensions">animation-forward-button-name</a> step-from) "." "click"))
                       (animate 'attributeType "CSS" 'attributeName "opacity" <span class="comment">; DISAPPEARING</span><br />                                (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> 'from 1 'to 0) 'dur <a class="applied-name" href="svg-extensions-1.html#edge-dur" title="svg-extensions">edge-dur</a>  'fill "freeze" 
                                'begin (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> (<a class="applied-name" href="svg-extensions-1.html#animation-forward-button-name" title="svg-extensions">animation-forward-button-name</a> step-to) "." "click"))

                       <span class="comment">; going backward</span><br />                       (animate 'attributeType "CSS" 'attributeName "opacity" <span class="comment">; APPEARING</span><br />                                (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> 'from 0 'to 1) 'dur <a class="applied-name" href="svg-extensions-1.html#disappear-dur" title="svg-extensions">disappear-dur</a>  'fill "freeze" 
                                'begin (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> (<a class="applied-name" href="svg-extensions-1.html#animation-backward-button-name" title="svg-extensions">animation-backward-button-name</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> step-to 1)) "." "click"))
                       (animate 'attributeType "CSS" 'attributeName "opacity" <span class="comment">; DISAPPEARING</span><br />                                (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> 'from 1 'to 0) 'dur <a class="applied-name" href="svg-extensions-1.html#disappear-dur" title="svg-extensions">disappear-dur</a>  'fill "freeze" 
                                'begin (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> (<a class="applied-name" href="svg-extensions-1.html#animation-backward-button-name" title="svg-extensions">animation-backward-button-name</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> step-from 1)) "." "click"))

                       ))
                    ((<a class="applied-name" href="svg-extensions-1.html#animation-includes?" title="svg-extensions">animation-includes?</a> 'auto)
                     (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">start-time</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-number" title="Manual: general">as-number</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#second" title="Manual: general">second</a> <a class="applied-name" href="svg-extensions-1.html#current-animation-type" title="svg-extensions">current-animation-type</a>)))
                           (<span class="local-name-binding">seconds-pr-step</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-number" title="Manual: general">as-number</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#third" title="Manual: general">third</a> <a class="applied-name" href="svg-extensions-1.html#current-animation-type" title="svg-extensions">current-animation-type</a>))))
                       (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a>
                        (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX237" title="R5RS Scheme form">&gt;</a> step-from 0) 
                            (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> 'css:visibility "visible" 'css:opacity 0)
                            (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> 'css:visibility "visible" 'css:opacity 1))
                       (animate 'attributeType "CSS" 'attributeName "opacity" <span class="comment">; APPEARING</span><br />                                (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> 'from 0 'to 1) 'dur <a class="applied-name" href="svg-extensions-1.html#edge-dur" title="svg-extensions">edge-dur</a>  'fill "freeze" 
                                'begin (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> start-time (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX250" title="R5RS Scheme form">*</a> step-from seconds-pr-step))))

                        ))
                    (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> '()))))
            (<span class="local-name-binding">line-animation-clause-edge-emphasize</span>
              (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="applied-name" href="svg-extensions-1.html#animation-includes?" title="svg-extensions">animation-includes?</a> 'edge-emphasize)
                      (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a>
                         (animate 'attributeType "XML" 'attributeName "stroke-width" 'from stroke-width 'to (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX250" title="R5RS Scheme form">*</a> 4 stroke-width) 
                                  'dur <a class="applied-name" href="svg-extensions-1.html#edge-dur" title="svg-extensions">edge-dur</a> 'begin "mouseover" 'fill "freeze")
                         (animate 'attributeType "XML" 'attributeName "stroke-width" 'to stroke-width 'from (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX250" title="R5RS Scheme form">*</a> 4 stroke-width)
                                  'dur <a class="applied-name" href="svg-extensions-1.html#disappear-dur" title="svg-extensions">disappear-dur</a> 'begin "mouseout" 'fill "freeze")

                         (animate 'attributeType "XML" 'attributeName "stroke" 'from stroke 'to <a class="applied-name" href="svg-extensions-1.html#emphasis-color" title="svg-extensions">emphasis-color</a> 
                                  'dur <a class="applied-name" href="svg-extensions-1.html#edge-dur" title="svg-extensions">edge-dur</a> 'begin "mouseover" 'fill "freeze")
                         (animate 'attributeType "XML" 'attributeName "stroke" 'to stroke 'from <a class="applied-name" href="svg-extensions-1.html#emphasis-color" title="svg-extensions">emphasis-color</a>
                                  'dur <a class="applied-name" href="svg-extensions-1.html#disappear-dur" title="svg-extensions">disappear-dur</a> 'begin "mouseout" 'fill "freeze")
                       ))
                    (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> '())))
            (<span class="local-name-binding">line-animation-clause-buttons-walk-through</span>
             (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">steps-given</span> (<a class="applied-name" href="svg-extensions-1.html#as-number-list" title="svg-extensions">as-number-list</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#defaulted-get-prop" title="Manual: general">defaulted-get-prop</a> 'steps attr ""))) <span class="comment">; the empty list if steps not supplied.</span><br />                    (<span class="local-name-binding">steps</span> (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> steps-given)) steps-given)
                                (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> step))))
                  )
               (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="applied-name" href="svg-extensions-1.html#animation-includes?" title="svg-extensions">animation-includes?</a> 'step-buttons-walk-through)
                      (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">step</span>)
                             (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> 
                              (<a class="applied-name" href="svg-extensions-1.html#edge-emphasize" title="svg-extensions">edge-emphasize</a> stroke stroke-width (<a class="applied-name" href="svg-extensions-1.html#animation-forward-button-name" title="svg-extensions">animation-forward-button-name</a> step))
                              (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX239" title="R5RS Scheme form">&gt;=</a> step 1) 
                                  (<a class="applied-name" href="svg-extensions-1.html#edge-deemphasize" title="svg-extensions">edge-deemphasize</a> stroke stroke-width (<a class="applied-name" href="svg-extensions-1.html#animation-forward-button-name" title="svg-extensions">animation-forward-button-name</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> step 1)))
                                  '())
                              (<a class="applied-name" href="svg-extensions-1.html#edge-deemphasize" title="svg-extensions">edge-deemphasize</a> stroke stroke-width (<a class="applied-name" href="svg-extensions-1.html#animation-backward-button-name" title="svg-extensions">animation-backward-button-name</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> step 1)))
                              (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX239" title="R5RS Scheme form">&gt;=</a> step 1)
                                  (<a class="applied-name" href="svg-extensions-1.html#edge-emphasize" title="svg-extensions">edge-emphasize</a> stroke stroke-width (<a class="applied-name" href="svg-extensions-1.html#animation-backward-button-name" title="svg-extensions">animation-backward-button-name</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> step 2)))
                                  '())
                              )) steps))
                     (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> '()))))
            (<span class="local-name-binding">group-animation-clause-edge-motion</span>
             (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">steps-given</span> (<a class="applied-name" href="svg-extensions-1.html#as-number-list" title="svg-extensions">as-number-list</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#defaulted-get-prop" title="Manual: general">defaulted-get-prop</a> 'steps attr ""))) <span class="comment">; the empty list if steps not supplied.</span><br />                    (<span class="local-name-binding">steps</span> (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> steps-given)) steps-given)
                                (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> step))))
                  )
              (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="applied-name" href="svg-extensions-1.html#animation-includes?" title="svg-extensions">animation-includes?</a> 'step-buttons-walk-through-edge-motion)
                      (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">step</span>)
                       (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> 
                        (<a class="applied-name" href="svg-extensions-1.html#edge-move" title="svg-extensions">edge-move</a> forward-line-id  (<a class="applied-name" href="svg-extensions-1.html#animation-forward-button-name" title="svg-extensions">animation-forward-button-name</a> step) duration)
                        (<a class="applied-name" href="svg-extensions-1.html#edge-move" title="svg-extensions">edge-move</a> reverse-line-id  (<a class="applied-name" href="svg-extensions-1.html#animation-backward-button-name" title="svg-extensions">animation-backward-button-name</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> step 1)) duration)
                        )) steps)
                     )
                    (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> '()))))

           )
       (g group-animation-clause group-animation-clause-edge-motion
          (path 'id forward-line-id line-attr 'fill "none"
                'd (<a class="applied-name" href="svg-extensions-1.html#am-p" title="svg-extensions">am-p</a> x1 y1 (<a class="applied-name" href="svg-extensions-1.html#append-path" title="svg-extensions">append-path</a> edge-break-segment (<a class="applied-name" href="svg-extensions-1.html#al-p" title="svg-extensions">al-p</a> x2 y2 (<a class="applied-name" href="svg-extensions-1.html#e-p" title="svg-extensions">e-p</a>))))
                'stroke stroke 'stroke-width stroke-width                                                               <span class="comment">; defaults due to keep-first attributes in SVG</span><br />                arrow-clause line-animation-clause-edge-emphasize line-animation-clause-buttons-walk-through)
          (path 'id reverse-line-id line-attr 'fill "none" 'css:visibility "hidden"
                'd (<a class="applied-name" href="svg-extensions-1.html#am-p" title="svg-extensions">am-p</a> x2 y2 (<a class="applied-name" href="svg-extensions-1.html#append-path" title="svg-extensions">append-path</a> edge-break-segment (<a class="applied-name" href="svg-extensions-1.html#al-p" title="svg-extensions">al-p</a> x1 y1 (<a class="applied-name" href="svg-extensions-1.html#e-p" title="svg-extensions">e-p</a>)))) 
                'stroke stroke 'stroke-width stroke-width
                arrow-clause line-animation-clause-edge-emphasize line-animation-clause-buttons-walk-through)
          (text 'font-family font-family 'font-size font-size 'font-style font-style
                'stroke text-color 'color text-color 'fill text-color
                'x (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> x1 (<a class="applied-name" href="svg-extensions-1.html#divide" title="svg-extensions">divide</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> x2 x1) 2)) label-dx) 'y (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> y1 (<a class="applied-name" href="svg-extensions-1.html#divide" title="svg-extensions">divide</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> y2 y1) 2)) label-dy)
                cont)
       )))

   (<a class="schemedoc-name" href="../../../lib/xml-in-laml/man/xml-in-laml.html#required-implied-attributes" title="Manual: xml-in-laml">required-implied-attributes</a> '() '(from-id to-id arrow stroke-width stroke stroke-dasharray
                                      stroke-linecap stroke-dashoffset step steps step-from step-to
                                      dx dy ldx ldy break-path style font-size font-style text-color dur)
                                "svg-edge"
   )
   "svg-edge"
   <a class="applied-name" href="svg-extensions-1.html#svg-language" title="svg-extensions">svg-language</a>))

<a name="svg-edge-new"></a><span class="comment">; The variant of svg-edge, with two required, position parameters and optional connectors supplied in attributes.</span><br /><a name="svg-edge-new"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">svg-edge-new</span>
 (<a class="schemedoc-name" href="../../../lib/xml-in-laml/man/xml-in-laml.html#xml-in-laml-positional-abstraction" title="Manual: xml-in-laml">xml-in-laml-positional-abstraction</a> 2 0
   (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">from-node</span> <span class="local-name-binding">to-node</span> <span class="local-name-binding">cont</span> <span class="local-name-binding">attr</span>)
    (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">from-id</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#defaulted-get-prop" title="Manual: general">defaulted-get-prop</a> 'from-id attr #f))   <span class="comment">; ids: only in case of composite nodes. Not central. </span><br />           (<span class="local-name-binding">to-id</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#defaulted-get-prop" title="Manual: general">defaulted-get-prop</a> 'to-id attr #f))
           (<span class="local-name-binding">from-connector</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#defaulted-get-prop" title="Manual: general">defaulted-get-prop</a> 'from-connector attr (<a class="applied-name" href="svg-extensions-1.html#default-connection-between" title="svg-extensions">default-connection-between</a> from-node from-id to-node to-id)))
           (<span class="local-name-binding">to-connector</span>   (<a class="schemedoc-name" href="../../../lib/man/general.html#defaulted-get-prop" title="Manual: general">defaulted-get-prop</a> 'to-connector attr   (<a class="applied-name" href="svg-extensions-1.html#default-connection-between" title="svg-extensions">default-connection-between</a> to-node to-id from-node from-id))) )
       (<a class="applied-name" href="svg-extensions-1.html#svg-edge" title="svg-extensions">svg-edge</a> from-node from-connector to-node to-connector cont attr)))))

<a name="default-connection-between"></a><span class="comment">; Return a connection point of node, calculated in relation to the (x,y) coordinate of other-node.
; Redefined below.</span><br /><a name="default-connection-between"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(default-connection-between node node-id other-node other-id)</span>
  (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">node-xy</span> (<a class="applied-name" href="svg-extensions-1.html#basis-x-y-of-node" title="svg-extensions">basis-x-y-of-node</a> node node-id))
         (<span class="local-name-binding">x</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> node-xy))  <span class="comment">; (x,y) of bounding rectangle</span><br />         (<span class="local-name-binding">y</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> node-xy))

         (<span class="local-name-binding">other-xy</span> (<a class="applied-name" href="svg-extensions-1.html#basis-x-y-of-node" title="svg-extensions">basis-x-y-of-node</a> other-node other-id))
         (<span class="local-name-binding">ox</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> other-xy))
         (<span class="local-name-binding">oy</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> other-xy))
        )
    (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a>
      (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX235" title="R5RS Scheme form">=</a> x ox) "c")
            ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX237" title="R5RS Scheme form">&gt;</a> x ox) "l")
            ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX236" title="R5RS Scheme form">&lt;</a> x ox) "r"))
      (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX235" title="R5RS Scheme form">=</a> y oy) "c")
            ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX237" title="R5RS Scheme form">&gt;</a> y oy) "t")
            ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX236" title="R5RS Scheme form">&lt;</a> y oy) "b")))))

<a name="default-connection-between"></a><span class="comment">; Redefined.
; Return a connection point of node, calculated in relation to the (x,y) coordinate of other-node.
; 45 degree version of the version above.</span><br /><a name="default-connection-between"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(default-connection-between node node-id other-node other-id)</span>
  (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">node-xy</span> (<a class="applied-name" href="svg-extensions-1.html#basis-x-y-of-node" title="svg-extensions">basis-x-y-of-node</a> node node-id))
         (<span class="local-name-binding">x</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> node-xy))
         (<span class="local-name-binding">y</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> node-xy))

         (<span class="local-name-binding">other-xy</span> (<a class="applied-name" href="svg-extensions-1.html#basis-x-y-of-node" title="svg-extensions">basis-x-y-of-node</a> other-node other-id))
         (<span class="local-name-binding">ox</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> other-xy))
         (<span class="local-name-binding">oy</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> other-xy))
 
         (<span class="local-name-binding">xot</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> ox x))  <span class="comment">; (ox,oy) translated such that (x,y) is origo</span><br />         (<span class="local-name-binding">yot</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> oy y))
        )
    (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a>
      (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX239" title="R5RS Scheme form">&gt;=</a> xot (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> yot)) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX239" title="R5RS Scheme form">&gt;=</a> xot yot))     "rc")  <span class="comment">; 1</span><br />            ((<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX238" title="R5RS Scheme form">&lt;=</a> xot yot)     (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX239" title="R5RS Scheme form">&gt;=</a> xot (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> yot))) "cb")  <span class="comment">; 2</span><br />            ((<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX238" title="R5RS Scheme form">&lt;=</a> xot yot)     (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX238" title="R5RS Scheme form">&lt;=</a> xot (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> yot))) "lc")  <span class="comment">; 3</span><br />            ((<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX238" title="R5RS Scheme form">&lt;=</a> xot (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> yot)) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX239" title="R5RS Scheme form">&gt;=</a> xot yot))     "ct")  <span class="comment">; 4</span><br />            (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#laml-error" title="Manual: general">laml-error</a> "default-connection-between: Should not happen"))))))
   

<a name="svg-edge-broken"></a><a name="svg-edge-broken"></a><span><a href="../svg-extensions.html#svg-edge-broken"><img src="../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">svg-edge-broken</span>
 (<a class="schemedoc-name" href="../../../lib/xml-in-laml/man/xml-in-laml.html#xml-in-laml-positional-abstraction" title="Manual: xml-in-laml">xml-in-laml-positional-abstraction</a> 5 0
   (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">from-node</span> <span class="local-name-binding">from-connector</span> <span class="local-name-binding">to-node</span> <span class="local-name-binding">to-connector</span> <span class="local-name-binding">node-break-list</span> <span class="local-name-binding">cont</span> <span class="local-name-binding">attr</span>)
     (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">break-path</span> (<a class="applied-name" href="svg-extensions-1.html#node-list-to-edge-break-path" title="svg-extensions">node-list-to-edge-break-path</a> node-break-list)))
       (<a class="applied-name" href="svg-extensions-1.html#svg-edge" title="svg-extensions">svg-edge</a> from-node from-connector to-node to-connector cont attr 'break-path break-path)))))


<a name="edge-break-segment"></a><span class="comment">; Given edge-style (a symbol: straight, hv, or vh) return an appropriate edge-break-segment</span><br /><a name="edge-break-segment"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(edge-break-segment edge-style x1 y1 x2 y2)</span>
  (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> edge-style 'straight) (<a class="applied-name" href="svg-extensions-1.html#e-p" title="svg-extensions">e-p</a>))
        ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> edge-style 'hv) (<a class="applied-name" href="svg-extensions-1.html#rh-p" title="svg-extensions">rh-p</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> x2 x1) (<a class="applied-name" href="svg-extensions-1.html#e-p" title="svg-extensions">e-p</a>)))
        ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> edge-style 'vh) (<a class="applied-name" href="svg-extensions-1.html#rv-p" title="svg-extensions">rv-p</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> y2 y1) (<a class="applied-name" href="svg-extensions-1.html#e-p" title="svg-extensions">e-p</a>)))
        (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#laml-error" title="Manual: general">laml-error</a> "edge-break-segment: Unknown edge style" edge-style))))

<a name="node-list-to-edge-break-path"></a><span class="comment">; Transform a list nodes to an (absolute) SVG path through the center points of the nodes in svg-node-list.</span><br /><a name="node-list-to-edge-break-path"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(node-list-to-edge-break-path node-list)</span>
  (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> node-list) (<a class="applied-name" href="svg-extensions-1.html#e-p" title="svg-extensions">e-p</a>))
        (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">node</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> node-list))
                     (<span class="local-name-binding">x-y</span> (<a class="applied-name" href="svg-extensions-1.html#x-y-of-node" title="svg-extensions">x-y-of-node</a> node #f "cc")))
                (<a class="applied-name" href="svg-extensions-1.html#al-p" title="svg-extensions">al-p</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> x-y) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> x-y)
                      (<a class="applied-name" href="svg-extensions-1.html#node-list-to-edge-break-path" title="svg-extensions">node-list-to-edge-break-path</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> node-list)))))))

<a name="edge-move"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(edge-move line-id but-name duration)</span>
 (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">anim-id</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> "anim-" line-id)))
  (circle 'r 8 'cx 0 'cy 0 'fill <a class="applied-name" href="svg-extensions-1.html#emphasis-color" title="svg-extensions">emphasis-color</a> 'stroke <a class="applied-name" href="svg-extensions-1.html#emphasis-color" title="svg-extensions">emphasis-color</a> 'css:visibility "hidden"
    (set 'attributeType "CSS" 'attributeName "visibility" 'to "visible" 'begin (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> but-name "." "click"))
    (animateMotion 'id anim-id 'dur duration 'rotate "auto" <span class="comment">; 'repeatCount "indefinite"  'fill "freeze"</span><br />      'begin (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> but-name "." "click")  <span class="comment">;  </span><br />      (mpath 'xlink:href (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> "#" line-id)))
    (set 'attributeType "CSS" 'attributeName "visibility" 'to "hidden" 'begin (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> anim-id ".end")))))


<a name="edge-emphasize"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(edge-emphasize stroke-before stroke-width-before but-name)</span>
 (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a>
  (animate 'attributeType "XML" 'attributeName "stroke" 'from stroke-before 'to <a class="applied-name" href="svg-extensions-1.html#emphasis-color" title="svg-extensions">emphasis-color</a> 
           'dur <a class="applied-name" href="svg-extensions-1.html#edge-dur" title="svg-extensions">edge-dur</a> 'fill "freeze" 
           'begin (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> but-name "." "click"))
  (animate 'attributeType "XML" 'attributeName "stroke-width" 'from stroke-width-before 'to (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX247" title="R5RS Scheme form">max</a> 5 (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX250" title="R5RS Scheme form">*</a> 2 stroke-width-before)) 
           'dur <a class="applied-name" href="svg-extensions-1.html#edge-dur" title="svg-extensions">edge-dur</a> 'fill "freeze" 
           'begin (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> but-name "." "click"))))

<a name="edge-deemphasize"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(edge-deemphasize stroke-before stroke-width-before but-name)</span>
 (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a>
   (animate 'attributeType "XML"  'attributeName "stroke" 'to stroke-before 
            'from <a class="applied-name" href="svg-extensions-1.html#emphasis-color" title="svg-extensions">emphasis-color</a> 'dur <a class="applied-name" href="svg-extensions-1.html#disappear-dur" title="svg-extensions">disappear-dur</a> 'fill "freeze" 
            'begin (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> but-name "." "click"))
   (animate 'attributeType "XML"  'attributeName "stroke-width" 'to stroke-width-before 
            'from (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX247" title="R5RS Scheme form">max</a> 5 (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX250" title="R5RS Scheme form">*</a> 2 stroke-width-before)) 'dur <a class="applied-name" href="svg-extensions-1.html#disappear-dur" title="svg-extensions">disappear-dur</a> 'fill "freeze" 
            'begin (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> but-name "." "click"))
 )
)
  


<a name="text-x-y"></a><span class="comment">; This function positions the text in a rect-node.
; Calculcate the text x, y coordinate relative to the rectangles x,y coordinates (cr-x, cr-y), width w, and height h,
; and the text alignment locator.
; ldx and ldy reflex manual fine tuning of the text position
; Return an svg attribute list of x, y and text-anchor.</span><br /><a name="text-x-y"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(text-x-y cr-x cr-y w h font-size text-align-locator ldx ldy)</span>
  (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">hl</span> (<a class="applied-name" href="svg-extensions-1.html#horizontal-locator" title="svg-extensions">horizontal-locator</a> text-align-locator))
         (<span class="local-name-binding">vl</span> (<a class="applied-name" href="svg-extensions-1.html#vertical-locator" title="svg-extensions">vertical-locator</a> text-align-locator))
         (<span class="local-name-binding">wh</span> (<a class="applied-name" href="svg-extensions-1.html#divide" title="svg-extensions">divide</a> w 2))
         (<span class="local-name-binding">hh</span> (<a class="applied-name" href="svg-extensions-1.html#divide" title="svg-extensions">divide</a> h 2))
         (<span class="local-name-binding">hor-contribution</span> 
           (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> hl 'c) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> 'x (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> cr-x wh) ldx) 'text-anchor "middle"))
                 ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> hl 'l) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> 'x (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> cr-x 5) ldx) 'text-anchor "start"))
                 ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> hl 'r) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> 'x (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> cr-x w (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> 5)) ldx) 'text-anchor "end"))))
         (<span class="local-name-binding">ver-contribution</span> 
           (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> vl 'c) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> 'y (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> cr-y hh (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX258" title="R5RS Scheme form">quotient</a> font-size 2))  (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> 5)) ldy)))
                 ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> vl 't) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> 'y (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> cr-y font-size) ldy)))
                 ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> vl 'b) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> 'y (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a>  (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> cr-y h (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> 5)) ldy)))))
        )
    (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX334" title="R5RS Scheme form">append</a> hor-contribution ver-contribution)))

<a name="open-arrow-def"></a><span class="comment">; -----------------------------------------------------------------------------------------------------
; defs clauses with various arrow definition.
; Not a good solution to the arrow problem, because all arrows will be identical (and of the same color).  </span><br />
<a name="open-arrow-def"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(open-arrow-def w h)</span>
  (defs
    (marker 'id "OpenArrowhead"
            'viewBox "0 0 10 10" 'refX "10" 'refY "5"
            'stroke "black" 'stroke-width "1" 'fill "white"
            'markerUnits "userSpaceOnUse" 
            'markerWidth w 'markerHeight h
            'orient "auto" 'preserveAspectRatio "none"
            (path 'd "M 0 0 L 10 5 L 0 10 z"))))

<a name="filled-arrow-def"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(filled-arrow-def w h)</span>
  (defs
    (marker 'id "FilledArrowhead"
            'viewBox "0 0 10 10" 'refX "10" 'refY "5" 'fill "black"
            'fill "black"
            'markerUnits "userSpaceOnUse" <span class="comment">; "strokeWidth"   </span><br />            'markerWidth w 'markerHeight h
            'orient "auto" 'preserveAspectRatio "none"
            (path 'd "M 0 0 L 10 5 L 0 10 z"))))

<a name="open-diamond-def"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(open-diamond-def w h)</span>
  (defs
    (marker 'id "OpenDiamond"
            'viewBox "0 -5 10 10" 'refX "10" 'refY "0" 
            'stroke "black" 'stroke-width "1" 'fill "white"
            'markerUnits "userSpaceOnUse" <span class="comment">; "strokeWidth"   </span><br />            'markerWidth w 'markerHeight h
            'orient "auto" 'preserveAspectRatio "none"
            (path 'd "M 0 0 L 5 -5 L 10 0 L 5 5 z"))))

<a name="filled-diamond-def"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(filled-diamond-def w h)</span>
  (defs
    (marker 'id "FilledDiamond"
            'viewBox "0 -5 10 10" 'refX "10" 'refY "0" 
            'fill "black"
            'markerUnits "userSpaceOnUse" <span class="comment">; "strokeWidth"   </span><br />            'markerWidth w 'markerHeight h
            'orient "auto" 'preserveAspectRatio "none"
            (path 'd "M 0 0 L 5 -5 L 10 0 L 5 5 z"))))

<span class="comment">; -----------------------------------------------------------------------------------------------------</span><br />
<a name="x-y-of-node"></a><span class="comment">; Extract the x, y, width, and height attributes of a rect AST.
; Useful in relation to definition of edges of SVG graphs.
; Return the cons pair of x and y coordinates of the connection point of node-ast relative to the connector con</span><br /><a name="x-y-of-node"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(x-y-of-node node-ast id con)</span>
 (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX123" title="R5RS Scheme form">letrec</a> ((<span class="local-name-binding">node-interesting?</span> (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">node-ast</span>) 
                               (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> ((<a class="schemedoc-name" href="../../../lib/xml-in-laml/man/xml-in-laml.html#ast-of-type?" title="Manual: xml-in-laml">ast-of-type?</a> 'element-name "rect") node-ast) 
                                    (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX200" title="R5RS Scheme form">equal?</a> (<a class="schemedoc-name" href="../../../lib/xml-in-laml/man/xml-in-laml.html#ast-attribute" title="Manual: xml-in-laml">ast-attribute</a> node-ast 'id #f) id))))) 
  (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">rect-ast-1</span> (<a class="schemedoc-name" href="../../../lib/xml-in-laml/man/xml-in-laml.html#find-first-ast" title="Manual: xml-in-laml">find-first-ast</a> node-ast "rect"))
         (<span class="local-name-binding">rect-ast-2</span> (<a class="schemedoc-name" href="../../../lib/xml-in-laml/man/xml-in-laml.html#traverse-and-collect-first-from-ast" title="Manual: xml-in-laml">traverse-and-collect-first-from-ast</a> node-ast node-interesting? <a class="schemedoc-name" href="../../../lib/man/general.html#id-1" title="Manual: general">id-1</a>))
         (<span class="local-name-binding">rect-ast</span> (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> id rect-ast-2) <span class="comment">; still experimental</span><br />                       rect-ast-2
                       rect-ast-1))
         (<span class="local-name-binding">rect-attr</span> (<a class="schemedoc-name" href="../../../lib/xml-in-laml/man/xml-in-laml.html#ast-attributes" title="Manual: xml-in-laml">ast-attributes</a> rect-ast))

         (<span class="local-name-binding">x</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-number" title="Manual: general">as-number</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#get-prop" title="Manual: general">get-prop</a> 'x rect-attr)))
         (<span class="local-name-binding">y</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-number" title="Manual: general">as-number</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#get-prop" title="Manual: general">get-prop</a> 'y rect-attr)))
         (<span class="local-name-binding">w</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-number" title="Manual: general">as-number</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#get-prop" title="Manual: general">get-prop</a> 'width rect-attr)))
         (<span class="local-name-binding">h</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-number" title="Manual: general">as-number</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#get-prop" title="Manual: general">get-prop</a> 'height rect-attr)))
 
         (<span class="local-name-binding">hl</span> (<a class="applied-name" href="svg-extensions-1.html#horizontal-locator" title="svg-extensions">horizontal-locator</a> con))
         (<span class="local-name-binding">vl</span> (<a class="applied-name" href="svg-extensions-1.html#vertical-locator" title="svg-extensions">vertical-locator</a> con))
        )

       (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a>
        (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> hl 'c) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> x (<a class="applied-name" href="svg-extensions-1.html#divide" title="svg-extensions">divide</a> w 2)))
              ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> hl 'l) x)
              ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> hl 'r) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> x w)))
        (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> vl 'c) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> y (<a class="applied-name" href="svg-extensions-1.html#divide" title="svg-extensions">divide</a> h 2)))
              ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> vl 't) y)
              ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> vl 'b) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> y h)))))))

<a name="basis-x-y-of-node"></a><span class="comment">; A variant of x-y-of-node without use of connectors. 
; Returns a cons pair of (x,y) of node-ast</span><br /><a name="basis-x-y-of-node"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(basis-x-y-of-node node-ast id)</span>
 (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX123" title="R5RS Scheme form">letrec</a> ((<span class="local-name-binding">node-interesting?</span> (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">node-ast</span>) 
                               (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> ((<a class="schemedoc-name" href="../../../lib/xml-in-laml/man/xml-in-laml.html#ast-of-type?" title="Manual: xml-in-laml">ast-of-type?</a> 'element-name "rect") node-ast) 
                                    (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX200" title="R5RS Scheme form">equal?</a> (<a class="schemedoc-name" href="../../../lib/xml-in-laml/man/xml-in-laml.html#ast-attribute" title="Manual: xml-in-laml">ast-attribute</a> node-ast 'id #f) id))))) 
  (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">rect-ast-1</span> (<a class="schemedoc-name" href="../../../lib/xml-in-laml/man/xml-in-laml.html#find-first-ast" title="Manual: xml-in-laml">find-first-ast</a> node-ast "rect"))
         (<span class="local-name-binding">rect-ast-2</span> (<a class="schemedoc-name" href="../../../lib/xml-in-laml/man/xml-in-laml.html#traverse-and-collect-first-from-ast" title="Manual: xml-in-laml">traverse-and-collect-first-from-ast</a> node-ast node-interesting? <a class="schemedoc-name" href="../../../lib/man/general.html#id-1" title="Manual: general">id-1</a>))
         (<span class="local-name-binding">rect-ast</span> (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> id rect-ast-2) <span class="comment">; still experimental</span><br />                       rect-ast-2
                       rect-ast-1))
         (<span class="local-name-binding">rect-attr</span> (<a class="schemedoc-name" href="../../../lib/xml-in-laml/man/xml-in-laml.html#ast-attributes" title="Manual: xml-in-laml">ast-attributes</a> rect-ast))

         (<span class="local-name-binding">x</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-number" title="Manual: general">as-number</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#get-prop" title="Manual: general">get-prop</a> 'x rect-attr)))
         (<span class="local-name-binding">y</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-number" title="Manual: general">as-number</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#get-prop" title="Manual: general">get-prop</a> 'y rect-attr)))
         (<span class="local-name-binding">w</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-number" title="Manual: general">as-number</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#get-prop" title="Manual: general">get-prop</a> 'width rect-attr)))
         (<span class="local-name-binding">h</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-number" title="Manual: general">as-number</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#get-prop" title="Manual: general">get-prop</a> 'height rect-attr)))
        )
     (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> x (<a class="applied-name" href="svg-extensions-1.html#divide" title="svg-extensions">divide</a> w 2)) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> y (<a class="applied-name" href="svg-extensions-1.html#divide" title="svg-extensions">divide</a> h 2))))))

<a name="rectangle-adjustment"></a><span class="comment">; Return delta adjustment to x and y from given-x and given-y relative to the locator.</span><br /><a name="rectangle-adjustment"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(rectangle-adjustment locator-string width height)</span>
  (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">hl</span> (<a class="applied-name" href="svg-extensions-1.html#horizontal-locator" title="svg-extensions">horizontal-locator</a> locator-string))
        (<span class="local-name-binding">vl</span> (<a class="applied-name" href="svg-extensions-1.html#vertical-locator" title="svg-extensions">vertical-locator</a> locator-string))
       )
    (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a>
     (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> hl 'c) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> (<a class="applied-name" href="svg-extensions-1.html#divide" title="svg-extensions">divide</a> width 2)))
           ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> hl 'l) 0)
           ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> hl 'r) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> width)))
     (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> vl 'c) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> (<a class="applied-name" href="svg-extensions-1.html#divide" title="svg-extensions">divide</a> height 2)))
           ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> vl 't) 0)
           ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> vl 'b) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> height))))))

<a name="find-min-max-x-y"></a><span class="comment">; Locate all rectangles in svg-graph and find the minimal bounding box that surrounds it.
; Return a list of four coordinates (top-left-x, top-left-y, bottom-right-x, bottom-right-y).</span><br /><a name="find-min-max-x-y"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(find-min-max-x-y svg-graph-ast)</span>
  (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX123" title="R5RS Scheme form">letrec</a> ((<span class="local-name-binding">reduce-right</span> (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">f</span> <span class="local-name-binding">lst</span>)
                           (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> lst))
                               (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> lst)
                               (f (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> lst) 
                                  (reduce-right f (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> lst)))))) 

           (<span class="local-name-binding">x-y-w-h</span> (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">rect-ast</span>)
                      (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">rect-attr</span> (<a class="schemedoc-name" href="../../../lib/xml-in-laml/man/xml-in-laml.html#ast-attributes" title="Manual: xml-in-laml">ast-attributes</a> rect-ast)))
                        (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-number" title="Manual: general">as-number</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#get-prop" title="Manual: general">get-prop</a> 'x rect-attr)) (<a class="schemedoc-name" href="../../../lib/man/general.html#as-number" title="Manual: general">as-number</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#get-prop" title="Manual: general">get-prop</a> 'y rect-attr)) (<a class="schemedoc-name" href="../../../lib/man/general.html#as-number" title="Manual: general">as-number</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#get-prop" title="Manual: general">get-prop</a> 'width rect-attr)) (<a class="schemedoc-name" href="../../../lib/man/general.html#as-number" title="Manual: general">as-number</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#get-prop" title="Manual: general">get-prop</a> 'height rect-attr))))))

           (<span class="local-name-binding">min-list</span> (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">lst</span>) (reduce-right <a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX248" title="R5RS Scheme form">min</a> lst)))
           (<span class="local-name-binding">max-list</span> (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">lst</span>) (reduce-right <a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX247" title="R5RS Scheme form">max</a> lst)))
           )
    (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">rect-list</span> (<a class="schemedoc-name" href="../../../lib/xml-in-laml/man/xml-in-laml.html#find-asts" title="Manual: xml-in-laml">find-asts</a> svg-graph-ast "rect"))
           (<span class="local-name-binding">x-y-w-h-list</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> x-y-w-h rect-list))
           (<span class="local-name-binding">x1-y1-x2-y2-list</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">x-y-w-y-entry</span>) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#first" title="Manual: general">first</a> x-y-w-y-entry) (<a class="schemedoc-name" href="../../../lib/man/general.html#second" title="Manual: general">second</a> x-y-w-y-entry)
                                                           (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#first" title="Manual: general">first</a> x-y-w-y-entry) (<a class="schemedoc-name" href="../../../lib/man/general.html#third" title="Manual: general">third</a> x-y-w-y-entry)) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#second" title="Manual: general">second</a> x-y-w-y-entry) (<a class="schemedoc-name" href="../../../lib/man/general.html#fourth" title="Manual: general">fourth</a> x-y-w-y-entry))))
                                  x-y-w-h-list))

           )
      (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> 
       (min-list (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> <a class="schemedoc-name" href="../../../lib/man/general.html#first" title="Manual: general">first</a> x1-y1-x2-y2-list)) <span class="comment">; min left top x,y</span><br />       (min-list (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> <a class="schemedoc-name" href="../../../lib/man/general.html#second" title="Manual: general">second</a> x1-y1-x2-y2-list))
       (max-list (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> <a class="schemedoc-name" href="../../../lib/man/general.html#third" title="Manual: general">third</a> x1-y1-x2-y2-list)) <span class="comment">; max right bottom x, y</span><br />       (max-list (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> <a class="schemedoc-name" href="../../../lib/man/general.html#fourth" title="Manual: general">fourth</a> x1-y1-x2-y2-list))))))

<a name="horizontal-locator"></a><span class="comment">; ------------------------------------------------------------------
; Locator functions.</span><br />
<a name="horizontal-locator"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(horizontal-locator locator-string)</span>
  (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">ls</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> locator-string)))
    (<a class="applied-name" href="svg-extensions-1.html#check-locator-string!" title="svg-extensions">check-locator-string!</a> ls)
    (<a class="schemedoc-name" href="../../../lib/man/general.html#as-symbol" title="Manual: general">as-symbol</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX379" title="R5RS Scheme form">string-ref</a> ls 0))))

<a name="vertical-locator"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(vertical-locator locator-string)</span>
  (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">ls</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> locator-string)))
    (<a class="applied-name" href="svg-extensions-1.html#check-locator-string!" title="svg-extensions">check-locator-string!</a> ls)
    (<a class="schemedoc-name" href="../../../lib/man/general.html#as-symbol" title="Manual: general">as-symbol</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX379" title="R5RS Scheme form">string-ref</a> ls 1))))

<a name="locator-string?"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(locator-string? x)</span>
  (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX374" title="R5RS Scheme form">string?</a> x)
       (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX235" title="R5RS Scheme form">=</a> 2 (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX378" title="R5RS Scheme form">string-length</a> x))
       (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">a</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX379" title="R5RS Scheme form">string-ref</a> x 0))
             (<span class="local-name-binding">b</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX379" title="R5RS Scheme form">string-ref</a> x 1)))
         (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX118" title="R5RS Scheme form">or</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX196" title="R5RS Scheme form">eqv?</a> a #\c) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX196" title="R5RS Scheme form">eqv?</a> a #\l) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX196" title="R5RS Scheme form">eqv?</a> a #\r))
              (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX118" title="R5RS Scheme form">or</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX196" title="R5RS Scheme form">eqv?</a> b #\c) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX196" title="R5RS Scheme form">eqv?</a> b #\t) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX196" title="R5RS Scheme form">eqv?</a> b #\b))))))

<a name="check-locator-string!"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(check-locator-string! ls)</span>
  (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="applied-name" href="svg-extensions-1.html#locator-string?" title="svg-extensions">locator-string?</a> ls))
      (<a class="schemedoc-name" href="../../../lib/man/general.html#laml-error" title="Manual: general">laml-error</a> "Invalid locator string:" ls ". " "First char either c, l, or t. Second char either c, t, or b.")))


<a name="animation-includes?"></a><span class="comment">; Does animation, as defined in the global variable current-animation-type, prescribe animation-kind (a symbol)</span><br /><a name="animation-includes?"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(animation-includes? animation-kind)</span>
  (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX346" title="R5RS Scheme form">symbol?</a> <a class="applied-name" href="svg-extensions-1.html#current-animation-type" title="svg-extensions">current-animation-type</a>)
          (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> animation-kind <a class="applied-name" href="svg-extensions-1.html#current-animation-type" title="svg-extensions">current-animation-type</a>))
        ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX331" title="R5RS Scheme form">list?</a> <a class="applied-name" href="svg-extensions-1.html#current-animation-type" title="svg-extensions">current-animation-type</a>)
          (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX338" title="R5RS Scheme form">memq</a> animation-kind <a class="applied-name" href="svg-extensions-1.html#current-animation-type" title="svg-extensions">current-animation-type</a>))
        (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#laml-error" title="Manual: general">laml-error</a> "animation-includes?: animation-kind must be a symbol or a list of symbols:" animation-kind))))


<a name="explanations"></a><a name="explanations"></a><span><a href="../svg-extensions.html#explanations"><img src="../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">explanations</span>
  (<a class="schemedoc-name" href="../../../lib/xml-in-laml/man/xml-in-laml.html#xml-in-laml-abstraction" title="Manual: xml-in-laml">xml-in-laml-abstraction</a>
    (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">cont</span> <span class="local-name-binding">attr</span>)
      (<a class="schemedoc-name" href="../../../lib/xml-in-laml/man/xml-in-laml.html#make-ast" title="Manual: xml-in-laml">make-ast</a> "explanations" cont attr 'double <a class="applied-name" href="svg-extensions-1.html#svg-language" title="svg-extensions">svg-language</a>))
    (<a class="schemedoc-name" href="../../../lib/xml-in-laml/man/xml-in-laml.html#required-implied-attributes" title="Manual: xml-in-laml">required-implied-attributes</a> '() '(x y font-size width height)
                                      "explanations"
    )
    "explanations"
    <a class="applied-name" href="svg-extensions-1.html#svg-language" title="svg-extensions">svg-language</a>))

<a name="explanation"></a><a name="explanation"></a><span><a href="../svg-extensions.html#explanation"><img src="../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">explanation</span>
  (<a class="schemedoc-name" href="../../../lib/xml-in-laml/man/xml-in-laml.html#xml-in-laml-abstraction" title="Manual: xml-in-laml">xml-in-laml-abstraction</a>
    (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">cont</span> <span class="local-name-binding">attr</span>)
      (<a class="schemedoc-name" href="../../../lib/xml-in-laml/man/xml-in-laml.html#make-ast" title="Manual: xml-in-laml">make-ast</a> "explanation" cont attr 'double <a class="applied-name" href="svg-extensions-1.html#svg-language" title="svg-extensions">svg-language</a>))
    (<a class="schemedoc-name" href="../../../lib/xml-in-laml/man/xml-in-laml.html#required-implied-attributes" title="Manual: xml-in-laml">required-implied-attributes</a> '() '(step)
                                      "explanation"
    )
    "explanation"
    <a class="applied-name" href="svg-extensions-1.html#svg-language" title="svg-extensions">svg-language</a>))

<a name="make-explanation-clause"></a><span class="comment">; Make the (overlapping) explanations at x,y. Explanation-list is a list of (step explanation) entries.</span><br /><a name="make-explanation-clause"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(make-explanation-clause explanation-list x y width height font-size from-step to-step)</span>
 (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">explanation-list-completed</span> (<a class="applied-name" href="svg-extensions-1.html#complete-explanation-list" title="svg-extensions">complete-explanation-list</a> explanation-list to-step)))
  (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> 
   (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">step-expl</span>)
    (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">step</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> step-expl))
          (<span class="local-name-binding">expl</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cadr</a> step-expl))
          (<span class="local-name-binding">text-color</span> "black")
         )
     (g 'css:visibility "visible" 'css:opacity (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX235" title="R5RS Scheme form">=</a> step 0) 1 0)
        (<a class="applied-name" href="svg-extensions-1.html#show-explanation-upon" title="svg-extensions">show-explanation-upon</a> step 'forward)
        (<a class="applied-name" href="svg-extensions-1.html#show-explanation-upon" title="svg-extensions">show-explanation-upon</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> 2 step) 'backward)
        (<a class="applied-name" href="svg-extensions-1.html#hide-explanation-upon" title="svg-extensions">hide-explanation-upon</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> step 1) 'forward)
        (<a class="applied-name" href="svg-extensions-1.html#hide-explanation-upon" title="svg-extensions">hide-explanation-upon</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> step 1) 'backward)

<span class="comment">;        (text-box 'x x 'y y 'width ? 'height ?
;                  'font-family "times-roman" 'font-size font-size
;                  'stroke text-color 'color text-color 'fill text-color
;                  expl)</span><br />
        (text  'font-family "times-roman" 'font-size font-size
                 'stroke text-color 'color text-color 'fill text-color
                 'x x 'y y expl))))
   explanation-list-completed)))

<a name="make-explanation-clause-auto"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(make-explanation-clause-auto explanation-list x y width height font-size from-step to-step)</span>
 (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">explanation-list-completed</span> (<a class="applied-name" href="svg-extensions-1.html#complete-explanation-list" title="svg-extensions">complete-explanation-list</a> explanation-list to-step)))
  (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> 
   (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">step-expl</span>)
    (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">step</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> step-expl))
          (<span class="local-name-binding">expl</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cadr</a> step-expl))
          (<span class="local-name-binding">text-color</span> "black")
          (<span class="local-name-binding">start-time</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-number" title="Manual: general">as-number</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#second" title="Manual: general">second</a> <a class="applied-name" href="svg-extensions-1.html#current-animation-type" title="svg-extensions">current-animation-type</a>)))
          (<span class="local-name-binding">seconds-pr-step</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-number" title="Manual: general">as-number</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#third" title="Manual: general">third</a> <a class="applied-name" href="svg-extensions-1.html#current-animation-type" title="svg-extensions">current-animation-type</a>)))
         )
     (g 'css:visibility "visible" 'css:opacity (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX235" title="R5RS Scheme form">=</a> step 0) 1 0)
       (animate 'attributeType "CSS" 'attributeName "opacity" 'from 0 'to 1 'dur <a class="applied-name" href="svg-extensions-1.html#expl-dur" title="svg-extensions">expl-dur</a> 'fill "freeze" 
		'begin (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> start-time (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX250" title="R5RS Scheme form">*</a> step seconds-pr-step)))
       (animate 'attributeType "CSS" 'attributeName "opacity" 'from 1 'to 0 'dur "0.1s" 'fill "freeze" 
                 'begin (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> start-time (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX250" title="R5RS Scheme form">*</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> step 1) seconds-pr-step)))
       (text  'font-family "times-roman" 'font-size font-size
                 'stroke text-color 'color text-color 'fill text-color
                 'x x 'y y expl))))
   explanation-list-completed)))

<a name="complete-explanation-list"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(complete-explanation-list explanation-list to-step)</span>
 (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">sorted-explanation-list</span> (sort-list explanation-list (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">x</span> <span class="local-name-binding">y</span>) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX238" title="R5RS Scheme form">&lt;=</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> x) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> y))))))
   (<a class="applied-name" href="svg-extensions-1.html#complete-explanation-list-1" title="svg-extensions">complete-explanation-list-1</a> sorted-explanation-list 0 to-step)))

<a name="complete-explanation-list-1"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(complete-explanation-list-1 sorted-explanation-list i to-step)</span>
 (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">empty-expl</span> ""))
  (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX237" title="R5RS Scheme form">&gt;</a> i to-step) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> sorted-explanation-list)) '())
        ((<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX238" title="R5RS Scheme form">&lt;=</a> i to-step) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> sorted-explanation-list))
           (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> i empty-expl) (<a class="applied-name" href="svg-extensions-1.html#complete-explanation-list-1" title="svg-extensions">complete-explanation-list-1</a> sorted-explanation-list (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> i 1) to-step)))
        ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX235" title="R5RS Scheme form">=</a> i (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> sorted-explanation-list)))
           (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> sorted-explanation-list) (<a class="applied-name" href="svg-extensions-1.html#complete-explanation-list-1" title="svg-extensions">complete-explanation-list-1</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> sorted-explanation-list) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> i 1) to-step)))
        (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a>
           (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> i empty-expl) (<a class="applied-name" href="svg-extensions-1.html#complete-explanation-list-1" title="svg-extensions">complete-explanation-list-1</a> sorted-explanation-list (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> i 1) to-step))))))

<a name="show-explanation-upon"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a>  <span class="signature">(show-explanation-upon step direction)</span>
  (animate 'attributeType "CSS" 'attributeName "opacity" 'from 0 'to 1 'dur <a class="applied-name" href="svg-extensions-1.html#expl-dur" title="svg-extensions">expl-dur</a> 'fill "freeze" 
                 'begin (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> 
                         (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> direction 'forward) (<a class="applied-name" href="svg-extensions-1.html#animation-forward-button-name" title="svg-extensions">animation-forward-button-name</a> step))
                               ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> direction 'backward) (<a class="applied-name" href="svg-extensions-1.html#animation-backward-button-name" title="svg-extensions">animation-backward-button-name</a> step))
                               (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#laml-error" title="Manual: general">laml-error</a> "show-explanation-upon: direction must be either forward or backward" direction)))
                         "." "click")))

<a name="hide-explanation-upon"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a>  <span class="signature">(hide-explanation-upon step direction)</span>
  (animate 'attributeType "CSS" 'attributeName "opacity" 'from 1 'to 0 'dur "0.1s" 'fill "freeze" 
                 'begin (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a>
                         (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> direction 'forward) (<a class="applied-name" href="svg-extensions-1.html#animation-forward-button-name" title="svg-extensions">animation-forward-button-name</a> step))
                               ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> direction 'backward) (<a class="applied-name" href="svg-extensions-1.html#animation-backward-button-name" title="svg-extensions">animation-backward-button-name</a> step))
                               (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#laml-error" title="Manual: general">laml-error</a> "hide-explanation-upon: direction must be either forward or backward" direction)))
                         "." "click")))


<div class="schemedoc-section-comment">;;; SVG node shape path functions.
;;; The shape path functions are used as the first parameter to the svg-node function.
;;; The svg-node function calls the shape path function, which is passed as the first parameter to svg-node.
;;; A shape path function is supposed to draw a path that serves as the boundary around the svg node.
;;; The first four parameters of an SVG node shape path function receives a bounding box in terms of x, y, w, and h.
;;; (x,y) is the upper left corner of the bounding box. w is the width (pixels), and h the height (pixels).
;;; Internally a shape path function MUST draw a visible or hidden SVG rect, possibly together with another path inside a group element.
;;; .section-id shape-path-functions</div>
<a name="rectangular"></a><a name="rectangular"></a><span><a href="../svg-extensions.html#rectangular"><img src="../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(rectangular x y w h . attributes)</span>
  (rect  'x x 'y y 'width w 'height h
          attributes  <span class="comment">; earlier attributes overwrites later attributes - controlled by SVG mirror</span><br />         'stroke-width "1" 'stroke "black"))

<a name="circular"></a><a name="circular"></a><span><a href="../svg-extensions.html#circular"><img src="../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(circular x y w h . attributes)</span>
  (rect  'x x 'y y 'width w 'height h   'rx (<a class="applied-name" href="svg-extensions-1.html#divide" title="svg-extensions">divide</a> w 2) 'ry (<a class="applied-name" href="svg-extensions-1.html#divide" title="svg-extensions">divide</a> h 2)   attributes  'stroke-width "1" 'stroke "black"))

<a name="diamond"></a><a name="diamond"></a><span><a href="../svg-extensions.html#diamond"><img src="../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(diamond x y w h . attributes)</span>
  (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">hh</span> (<a class="applied-name" href="svg-extensions-1.html#divide" title="svg-extensions">divide</a> h 2)) (<span class="local-name-binding">wh</span> (<a class="applied-name" href="svg-extensions-1.html#divide" title="svg-extensions">divide</a> w 2))          <span class="comment">; half height and width</span><br />         (<span class="local-name-binding">sx</span> x) (<span class="local-name-binding">sy</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> y hh)))       <span class="comment">; diamond start (x,y) coordinates</span><br />    (g
      (rect 'css:visibility "hidden" 'x x 'y y 'width w 'height h  attributes  'stroke-width "1" 'stroke "black")  <span class="comment">; hidden boundary rect</span><br />      (path attributes 'd (<a class="applied-name" href="svg-extensions-1.html#am-p" title="svg-extensions">am-p</a> sx sy (<a class="applied-name" href="svg-extensions-1.html#rl-p" title="svg-extensions">rl-p</a> wh (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> hh) (<a class="applied-name" href="svg-extensions-1.html#rl-p" title="svg-extensions">rl-p</a> wh hh (<a class="applied-name" href="svg-extensions-1.html#rl-p" title="svg-extensions">rl-p</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> wh) hh (<a class="applied-name" href="svg-extensions-1.html#rl-p" title="svg-extensions">rl-p</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> wh) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> hh) (<a class="applied-name" href="svg-extensions-1.html#e-p" title="svg-extensions">e-p</a>))))))))))

<a name="triangular"></a><a name="triangular"></a><span><a href="../svg-extensions.html#triangular"><img src="../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(triangular x y w h . attributes)</span>
  (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">hh</span> (<a class="applied-name" href="svg-extensions-1.html#divide" title="svg-extensions">divide</a> h 2)) (<span class="local-name-binding">wh</span> (<a class="applied-name" href="svg-extensions-1.html#divide" title="svg-extensions">divide</a> w 2))          <span class="comment">; half height and width</span><br />         (<span class="local-name-binding">sx</span> x) (<span class="local-name-binding">sy</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> y h)))       <span class="comment">; diamond start (x,y) coordinates</span><br />    (g
      (rect 'css:visibility "hidden"  'x x 'y y 'width w 'height h  attributes  'stroke-width "1" 'stroke "black")  <span class="comment">; hidden boundary rect</span><br />      (path attributes 'd (<a class="applied-name" href="svg-extensions-1.html#am-p" title="svg-extensions">am-p</a> sx sy (<a class="applied-name" href="svg-extensions-1.html#rl-p" title="svg-extensions">rl-p</a> wh (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> h) (<a class="applied-name" href="svg-extensions-1.html#rl-p" title="svg-extensions">rl-p</a> wh h (<a class="applied-name" href="svg-extensions-1.html#rl-p" title="svg-extensions">rl-p</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> w) 0 (<a class="applied-name" href="svg-extensions-1.html#e-p" title="svg-extensions">e-p</a>)))))))))

<a name="cloud"></a><a name="cloud"></a><span><a href="../svg-extensions.html#cloud"><img src="../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(cloud x y w h . attributes)</span>
  (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">h2</span> (<a class="applied-name" href="svg-extensions-1.html#divide" title="svg-extensions">divide</a> h 2)) (<span class="local-name-binding">w2</span> (<a class="applied-name" href="svg-extensions-1.html#divide" title="svg-extensions">divide</a> w 2))          <span class="comment">; half height and width</span><br />         (<span class="local-name-binding">h4</span> (<a class="applied-name" href="svg-extensions-1.html#divide" title="svg-extensions">divide</a> h2 2)) (<span class="local-name-binding">w4</span> (<a class="applied-name" href="svg-extensions-1.html#divide" title="svg-extensions">divide</a> w2 2))        <span class="comment">; quarts height and width</span><br />         (<span class="local-name-binding">sx</span> x) (<span class="local-name-binding">sy</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> y h2))       <span class="comment">; cloud start (x,y) coordinates</span><br />         (<span class="local-name-binding">c</span> (<a class="applied-name" href="svg-extensions-1.html#divide" title="svg-extensions">divide</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> w h) 8)) (<span class="local-name-binding">c2</span> (<a class="applied-name" href="svg-extensions-1.html#divide" title="svg-extensions">divide</a> c 2)) (<span class="local-name-binding">cm</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> c)) (<span class="local-name-binding">cm2</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> c2))
        )
    (g
      (rect 'css:visibility "hidden" 'x x 'y y 'width w 'height h  attributes  'stroke-width "1" 'stroke "black")  <span class="comment">; hidden boundary rect</span><br />      (path attributes
        'd (<a class="applied-name" href="svg-extensions-1.html#am-p" title="svg-extensions">am-p</a> sx sy 
            (<a class="applied-name" href="svg-extensions-1.html#rq-p" title="svg-extensions">rq-p</a> 0 cm  w4 (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> h4)
             (<a class="applied-name" href="svg-extensions-1.html#rq-p" title="svg-extensions">rq-p</a> 0 cm w4 (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> h4)
              (<a class="applied-name" href="svg-extensions-1.html#rq-p" title="svg-extensions">rq-p</a> c cm2 w4 h4
               (<a class="applied-name" href="svg-extensions-1.html#rq-p" title="svg-extensions">rq-p</a> c cm w4 h4
                (<a class="applied-name" href="svg-extensions-1.html#rq-p" title="svg-extensions">rq-p</a> c c (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> w4) h4
                 (<a class="applied-name" href="svg-extensions-1.html#rq-p" title="svg-extensions">rq-p</a> c c (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> w4) h4
                  (<a class="applied-name" href="svg-extensions-1.html#rq-p" title="svg-extensions">rq-p</a> cm2 c (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> w4) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> h4)
                   (<a class="applied-name" href="svg-extensions-1.html#rq-p" title="svg-extensions">rq-p</a> cm2 c (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> w4) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> h4) 
                    (<a class="applied-name" href="svg-extensions-1.html#e-p" title="svg-extensions">e-p</a>))))))))))))))

<div class="schemedoc-section-comment">;;; Graph Animations.
;;; Svg graphs can be animated in a number of different ways. 
;;; Use the syntactic form with-animation around an svg-graph form to specify the kind of animation to use.
;;; The following kinds are supported:
;;; &lt;ul&gt;
;;;   &lt;li&gt; none. Do not use any animation at all.
;;;   &lt;li&gt; node-emphasize: Emphasize the node with a particular color when it gets focus with the mouse.
;;;   &lt;li&gt; edge-emphasize: Emphasize the edge with a particular color and thickness when it gets focus with the mouse.
;;;   &lt;li&gt; step-buttons-reveal: 
;;;         The nodes and edges are revealed one after the other, controlled by triangular shaped buttons.
;;;         The step attribute tells when to reveal the graph node or edge.
;;;         A given step attribute value should only appear once with this kind of animation.
;;;         As an alternative to the step attribute, you can use the step-from and step-to attributes to given step interval.
;;;         The node or edge is revealed at step step-to and and hidden at step step-from.
;;;         Several nodes or edges can have the same step value. This leads to simultaneous revealing of these nodes and edges.
;;;   &lt;li&gt; step-buttons-walk-through: The nodes and edges are highlighted in a given order, controlled by triangular shaped buttons. 
;;;        By means of the steps attribute (plural) a given node or edge can be highlighted more than once during the walk through.
;;;        Several nodes or edges can have the same step value. 
;;;   &lt;li&gt; step-buttons-walk-through-edge-motion: The nodes are highlighted in a given order. The edges are animated with a moving token.
;;;        The animation is controlled by triangular shaped buttons. 
;;; &lt;/ul&gt;
;;; Within with-animation, you can use node-emphasize and edge-emphasize together. 
;;; You can also use node-emphasize or edge-emphasize (or both) together with step-buttons-reveal and step-buttons-walk-through.
;;; step-buttons-reveal and step-buttons-walk-through cannot be used together.&lt;p&gt;
;;;
;;;
;;; The non-animated part of the graph has implicitly assigned step number 0. 
;;; You can Assign step numbers higher than 0 to selected nodes and edges.
;;; Use the svg-graph attributes to from-step and to-step to control the animated step interval. </div>

<a name="with-animation"></a><a name="with-animation"></a><span><a href="../svg-extensions.html#with-animation"><img src="../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX187" title="R5RS Scheme form">define-syntax</a> <span class="signature">with-animation</span>
 (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX164" title="R5RS Scheme form">syntax-rules</a> ()
   ((with-animation animation-type <a class="schemedoc-name" href="../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#form" title="Manual: xhtml10-transitional-mirror">form</a> ...)
    (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">old-animation-type</span> <a class="applied-name" href="svg-extensions-1.html#current-animation-type" title="svg-extensions">current-animation-type</a>))
      (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> <a class="applied-name" href="svg-extensions-1.html#current-animation-type" title="svg-extensions">current-animation-type</a> animation-type) 
      (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">result</span> (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX125" title="R5RS Scheme form">begin</a> form ...)))
        (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> <a class="applied-name" href="svg-extensions-1.html#current-animation-type" title="svg-extensions">current-animation-type</a> old-animation-type)
        result)))))




<span class="comment">; ---------------------------------------------------------------------------------------------------</span><br /><div class="schemedoc-section-comment">;;; Transform attribute functions.
;;; SVG uses a little language for values of transform attributes. In this section you will find Scheme
;;; counterparts of such expresssions.</div>
<a name="svg-translate"></a><a name="svg-translate"></a><span><a href="../svg-extensions.html#svg-translate"><img src="../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(svg-translate tx ty)</span>
  (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> "translate" "(" (<a class="schemedoc-name" href="../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> tx) "," (<a class="schemedoc-name" href="../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> ty) ")"))

<a name="svg-scale"></a><a name="svg-scale"></a><span><a href="../svg-extensions.html#svg-scale"><img src="../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(svg-scale sx . optional-parameter-list)</span>
 (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">sy</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#optional-parameter" title="Manual: general">optional-parameter</a> 1 optional-parameter-list sx)))
  (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> "scale" "(" (<a class="schemedoc-name" href="../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> sx) "," (<a class="schemedoc-name" href="../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> sy) ")")))

<a name="svg-rotate"></a><a name="svg-rotate"></a><span><a href="../svg-extensions.html#svg-rotate"><img src="../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(svg-rotate angle . optional-parameter-list)</span>
 (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">cx</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#optional-parameter" title="Manual: general">optional-parameter</a> 1 optional-parameter-list #f))
       (<span class="local-name-binding">cy</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#optional-parameter" title="Manual: general">optional-parameter</a> 2 optional-parameter-list #f)))
  (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> cx cy)
      (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> "rotate" "(" (<a class="schemedoc-name" href="../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> angle) "," (<a class="schemedoc-name" href="../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> cx) "," (<a class="schemedoc-name" href="../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> cy) ")")
      (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> "rotate" "(" (<a class="schemedoc-name" href="../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> angle) ")"))))

<a name="svg-skewX"></a><a name="svg-skewX"></a><span><a href="../svg-extensions.html#svg-skewX"><img src="../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(svg-skewX angle)</span>
  (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> "skewX" "(" (<a class="schemedoc-name" href="../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> angle) ")"))

<a name="svg-skewY"></a><a name="svg-skewY"></a><span><a href="../svg-extensions.html#svg-skewY"><img src="../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(svg-skewY angle)</span>
  (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> "skewY" "(" (<a class="schemedoc-name" href="../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> angle) ")"))



<span class="comment">; ---------------------------------------------------------------------------------------------------</span><br /><div class="schemedoc-section-comment">;;; Path functions.
;;; Functions for definition of SVG paths. 
;;; You can think of the functions as constructors of SVG paths.
;;; The functions in this section can be used as the value of d attributes of the SVG path element. 
;;; The functions model a path as a linear recursive structures for instance in the style of lists in Lisp.
;;; All functions return strings.
;;; As a naming convention, the first letter in the prefix tells if we draw in absolute or relative mode ('a' or 'r').
;;; The next letter in the prefix mimics the type of the path ('l' for line, 'm' for move). This letter corresponds to the (lower case) SVG path letter name.
;;; The suffix of the name is always "-p", which is a short name for "-path".
;;; If you dislike the functions you can use native SVG path strings, or you can program your own set of path constructors.</div>
<a name="e-p"></a><a name="e-p"></a><span><a href="../svg-extensions.html#e-p"><img src="../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(e-p)</span> "")

<a name="al-p"></a><a name="al-p"></a><span><a href="../svg-extensions.html#al-p"><img src="../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(al-p x y path)</span> (<a class="applied-name" href="svg-extensions-1.html#p-exp" title="svg-extensions">p-exp</a> "L" path x y))

<a name="rl-p"></a><a name="rl-p"></a><span><a href="../svg-extensions.html#rl-p"><img src="../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(rl-p x y path)</span> (<a class="applied-name" href="svg-extensions-1.html#p-exp" title="svg-extensions">p-exp</a> "l" path x y))

<a name="ah-p"></a><a name="ah-p"></a><span><a href="../svg-extensions.html#ah-p"><img src="../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(ah-p x path)</span> (<a class="applied-name" href="svg-extensions-1.html#p-exp" title="svg-extensions">p-exp</a> "H" path x))

<a name="rh-p"></a><a name="rh-p"></a><span><a href="../svg-extensions.html#rh-p"><img src="../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(rh-p x path)</span> (<a class="applied-name" href="svg-extensions-1.html#p-exp" title="svg-extensions">p-exp</a> "h" path x))

<a name="av-p"></a><a name="av-p"></a><span><a href="../svg-extensions.html#av-p"><img src="../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(av-p y path)</span> (<a class="applied-name" href="svg-extensions-1.html#p-exp" title="svg-extensions">p-exp</a> "V" path y))

<a name="rv-p"></a><a name="rv-p"></a><span><a href="../svg-extensions.html#rv-p"><img src="../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(rv-p y path)</span> (<a class="applied-name" href="svg-extensions-1.html#p-exp" title="svg-extensions">p-exp</a> "v" path y))

<a name="rm-p"></a><a name="rm-p"></a><span><a href="../svg-extensions.html#rm-p"><img src="../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(rm-p x y path)</span> (<a class="applied-name" href="svg-extensions-1.html#p-exp" title="svg-extensions">p-exp</a> "m" path x y))

<a name="am-p"></a><a name="am-p"></a><span><a href="../svg-extensions.html#am-p"><img src="../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(am-p x y path)</span> (<a class="applied-name" href="svg-extensions-1.html#p-exp" title="svg-extensions">p-exp</a> "M" path x y))

<a name="ra-p"></a><a name="ra-p"></a><span><a href="../svg-extensions.html#ra-p"><img src="../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(ra-p rx ry x-axis-rotation large-arc? sweep? x y path)</span>
  (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">large-arc-number</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-01-boolean" title="Manual: general">as-01-boolean</a> large-arc?))
        (<span class="local-name-binding">sweep-number</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-01-boolean" title="Manual: general">as-01-boolean</a> sweep?)))
    (<a class="applied-name" href="svg-extensions-1.html#p-exp" title="svg-extensions">p-exp</a> "a" path rx ry x-axis-rotation large-arc-number sweep-number x y)))

<a name="aa-p"></a><a name="aa-p"></a><span><a href="../svg-extensions.html#aa-p"><img src="../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(aa-p rx ry x-axis-rotation large-arc? sweep? x y path)</span>
  (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">large-arc-number</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-01-boolean" title="Manual: general">as-01-boolean</a> large-arc?))
        (<span class="local-name-binding">sweep-number</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-01-boolean" title="Manual: general">as-01-boolean</a> sweep?)))
    (<a class="applied-name" href="svg-extensions-1.html#p-exp" title="svg-extensions">p-exp</a> "A" path rx ry x-axis-rotation large-arc-number sweep-number x y)))

<a name="rq-p"></a><a name="rq-p"></a><span><a href="../svg-extensions.html#rq-p"><img src="../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(rq-p cx cy x y path)</span>
  (<a class="applied-name" href="svg-extensions-1.html#p-exp" title="svg-extensions">p-exp</a> "q" path cx cy x y))

<a name="aq-p"></a><a name="aq-p"></a><span><a href="../svg-extensions.html#aq-p"><img src="../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(aq-p cx cy x y path)</span>
  (<a class="applied-name" href="svg-extensions-1.html#p-exp" title="svg-extensions">p-exp</a> "Q" path cx cy x y))

<a name="rt-p"></a><a name="rt-p"></a><span><a href="../svg-extensions.html#rt-p"><img src="../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(rt-p x y path)</span>
  (<a class="applied-name" href="svg-extensions-1.html#p-exp" title="svg-extensions">p-exp</a> "t" path x y))

<a name="at-p"></a><a name="at-p"></a><span><a href="../svg-extensions.html#at-p"><img src="../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(at-p x y path)</span>
  (<a class="applied-name" href="svg-extensions-1.html#p-exp" title="svg-extensions">p-exp</a> "T" path x y))

<a name="rc-p"></a><a name="rc-p"></a><span><a href="../svg-extensions.html#rc-p"><img src="../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(rc-p cx1 cy1 cx2 cy2 x y path)</span>
  (<a class="applied-name" href="svg-extensions-1.html#p-exp" title="svg-extensions">p-exp</a> "c" path cx1 cy1 cx2 cy2 x y))

<a name="ac-p"></a><a name="ac-p"></a><span><a href="../svg-extensions.html#ac-p"><img src="../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(ac-p cx1 cy1 cx2 cy2 x y path)</span>
  (<a class="applied-name" href="svg-extensions-1.html#p-exp" title="svg-extensions">p-exp</a> "C" path cx1 cy1 cx2 cy2 x y))

<a name="rs-p"></a><a name="rs-p"></a><span><a href="../svg-extensions.html#rs-p"><img src="../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(rs-p cx2 cy2 x y path)</span>
  (<a class="applied-name" href="svg-extensions-1.html#p-exp" title="svg-extensions">p-exp</a> "s" path cx2 cy2 x y))

<a name="as-p"></a><a name="as-p"></a><span><a href="../svg-extensions.html#as-p"><img src="../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(as-p cx2 cy2 x y path)</span>
  (<a class="applied-name" href="svg-extensions-1.html#p-exp" title="svg-extensions">p-exp</a> "S" path cx2 cy2 x y))

<a name="z-p"></a><a name="z-p"></a><span><a href="../svg-extensions.html#z-p"><img src="../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(z-p)</span> "Z")



<a name="append-path"></a><a name="append-path"></a><span><a href="../svg-extensions.html#append-path"><img src="../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(append-path p1 p2)</span>
  (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> p1 p2))

<a name="p-exp"></a><span class="comment">; SVG render path</span><br /><a name="p-exp"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(p-exp letter path . coordinates)</span>
  (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> 
    letter " " 
    (<a class="schemedoc-name" href="../../../lib/man/general.html#list-to-string" title="Manual: general">list-to-string</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> <a class="schemedoc-name" href="../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> coordinates) " ") 
    " " path))

<a name="svg-path?"></a><span class="comment">; Temporary definition. Strengthen it.</span><br /><a name="svg-path?"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(svg-path? x)</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX374" title="R5RS Scheme form">string?</a> x))


<span class="comment">; ---------------------------------------------------------------------------------------------------</span><br />
<span class="comment">; Misc functions</span><br />
<a name="divide"></a><span class="comment">; Used to prevent rational numbers to appear in SVG, for instance.</span><br /><a name="divide"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(divide x y)</span>
  (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX254" title="R5RS Scheme form">/</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX289" title="R5RS Scheme form">exact-&gt;inexact</a> x) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX289" title="R5RS Scheme form">exact-&gt;inexact</a> y)))


<a name="unique-number"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">unique-number</span> 0)

<a name="unique-symbol"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(unique-symbol prefix)</span>
  (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> <a class="applied-name" href="svg-extensions-1.html#unique-number" title="svg-extensions">unique-number</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> <a class="applied-name" href="svg-extensions-1.html#unique-number" title="svg-extensions">unique-number</a> 1)) 
  (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> prefix "-" (<a class="schemedoc-name" href="../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> <a class="applied-name" href="svg-extensions-1.html#unique-number" title="svg-extensions">unique-number</a>)))


<a name="animation-forward-button-name"></a><span class="comment">; Generate and return an id of the button that activates step in a button controlled animation.</span><br /><a name="animation-forward-button-name"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(animation-forward-button-name step-number)</span>
  (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> "forward-button-id" "-" (<a class="schemedoc-name" href="../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> step-number)))

<a name="animation-backward-button-name"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(animation-backward-button-name step-number)</span>
  (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> "backward-button-id" "-" (<a class="schemedoc-name" href="../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> step-number)))

<a name="animation-button-text-name"></a><span class="comment">; Generate and return an id of the button text that activates step in a button controlled animation. NOT USED.</span><br /><a name="animation-button-text-name"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(animation-button-text-name step-number)</span>
  (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> "button-text-id" "-" (<a class="schemedoc-name" href="../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> step-number)))

<span class="comment">; ---------------------------------------------------------------------------------------------------</span><br />
<div class="schemedoc-section-comment">;;; Aditional basic shapes</div>
<a name="triangle"></a><a name="triangle"></a><span><a href="../svg-extensions.html#triangle"><img src="../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">triangle</span> 
  (<a class="schemedoc-name" href="../../../lib/xml-in-laml/man/xml-in-laml.html#xml-in-laml-positional-abstraction" title="Manual: xml-in-laml">xml-in-laml-positional-abstraction</a> 6 0
    (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">x1</span> <span class="local-name-binding">y1</span> <span class="local-name-binding">x2</span> <span class="local-name-binding">y2</span> <span class="local-name-binding">x3</span> <span class="local-name-binding">y3</span> <span class="local-name-binding">cont</span> <span class="local-name-binding">attr</span>)
     (path 'd (<a class="applied-name" href="svg-extensions-1.html#am-p" title="svg-extensions">am-p</a> x1 y1 (<a class="applied-name" href="svg-extensions-1.html#al-p" title="svg-extensions">al-p</a> x2 y2 (<a class="applied-name" href="svg-extensions-1.html#al-p" title="svg-extensions">al-p</a> x3 y3 (<a class="applied-name" href="svg-extensions-1.html#z-p" title="svg-extensions">z-p</a>)))) cont attr))))


<div class="schemedoc-section-comment">;;; Extended text management.
;;; Not yet completed. Please disregard this function.</div>
<a name="text-box"></a><a name="text-box"></a><span><a href="../svg-extensions.html#text-box"><img src="../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">text-box</span>
  (<a class="schemedoc-name" href="../../../lib/xml-in-laml/man/xml-in-laml.html#xml-in-laml-abstraction" title="Manual: xml-in-laml">xml-in-laml-abstraction</a>
   (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">cont</span> <span class="local-name-binding">attr</span>)
     (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">x</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#get-prop" title="Manual: general">get-prop</a> 'x attr))
            (<span class="local-name-binding">y</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#get-prop" title="Manual: general">get-prop</a> 'y attr))
            (<span class="local-name-binding">width</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#get-prop" title="Manual: general">get-prop</a> 'width attr))
            (<span class="local-name-binding">height</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#get-prop" title="Manual: general">get-prop</a> 'width attr))
            (<span class="local-name-binding">font-family</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#defaulted-get-prop" title="Manual: general">defaulted-get-prop</a> 'font-family attr "times-roman"))
            (<span class="local-name-binding">font-size</span>   (<a class="schemedoc-name" href="../../../lib/man/general.html#as-number" title="Manual: general">as-number</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#defaulted-get-prop" title="Manual: general">defaulted-get-prop</a> 'font-size attr "30")))
           )
        (<a class="applied-name" href="svg-extensions-1.html#do-text-box" title="svg-extensions">do-text-box</a> x y width height font-family font-size cont)
     )
   )
   (<a class="schemedoc-name" href="../../../lib/xml-in-laml/man/xml-in-laml.html#required-implied-attributes" title="Manual: xml-in-laml">required-implied-attributes</a> '(x y width height) '(text-color font-family font-size)
                                 "text-box"
   )
   "text-box"
   <a class="applied-name" href="svg-extensions-1.html#svg-language" title="svg-extensions">svg-language</a>))


<a name="do-text-box"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(do-text-box x y width height font-family font-size text-list)</span>
  (<a class="schemedoc-name" href="../../../lib/man/general.html#laml-error" title="Manual: general">laml-error</a> "STOP")
)

<a name="text-width-factor"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">text-width-factor</span> 1.9)  <span class="comment">; maybe 1.7</span><br />
<a name="measured-text-width"></a><span class="comment">; Determines the width of text-contents, relative to a given font size and familiy.
; Conservative and approximate
; The font-size is given in points.</span><br /><a name="measured-text-width"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(measured-text-width text-contents font-size font-family)</span>
 (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">textual?</span> (<a class="applied-name" href="svg-extensions-1.html#textual-contents?" title="svg-extensions">textual-contents?</a> text-contents))
        (<span class="local-name-binding">txt</span> (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> textual? (<a class="applied-name" href="svg-extensions-1.html#string-of-textual-contents" title="svg-extensions">string-of-textual-contents</a> text-contents) #f))
        (<span class="local-name-binding">basis-width</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-number" title="Manual: general">as-number</a> font-size))  <span class="comment">; A width added as the basis width.
; Without it nodes with short labels become too narrow.</span><br />       )
 
   (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> textual? 
       (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX250" title="R5RS Scheme form">*</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX254" title="R5RS Scheme form">/</a> font-size <a class="applied-name" href="svg-extensions-1.html#text-width-factor" title="svg-extensions">text-width-factor</a>) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX378" title="R5RS Scheme form">string-length</a> txt)) basis-width)    <span class="comment">; earlier (quotient font-size 2)</span><br />       0)  <span class="comment">; rely on min-width in this case</span><br />   ))

<a name="measured-text-height"></a><span class="comment">; Determines the height of text-contents, relative to a given font size and familiy.
; Conservative and approximate
; The font-size is given in points.</span><br /><a name="measured-text-height"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(measured-text-height text-contents font-size font-family)</span>
  (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> font-size 10))

<a name="textual-contents?"></a><span class="comment">; A predicate which determines if x is considered as textual contents. </span><br /><a name="textual-contents?"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(textual-contents? x)</span>
  (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX374" title="R5RS Scheme form">string?</a> x) #t)
        ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX331" title="R5RS Scheme form">list?</a> x)
           (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#find-in-list" title="Manual: general">find-in-list</a> <a class="schemedoc-name" href="../../../lib/xml-in-laml/man/xml-in-laml.html#ast?" title="Manual: xml-in-laml">ast?</a> x)))
        (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#laml-error" title="Manual: general">laml-error</a> "textual-contents?: Unknown type of parameter:" x))))

<a name="string-of-textual-contents"></a><span class="comment">; Return the string from x. x can be a string or the content of an XML-in-LAML AST node.
; Precondition: x satisfies the predicate textual-contents?</span><br /><a name="string-of-textual-contents"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(string-of-textual-contents x)</span>
 (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX374" title="R5RS Scheme form">string?</a> x)
     x
    (aggregated-ast-cdata-contents-1 x "") <span class="comment">; undocumented function from xml-in-laml</span><br /> ))

<a name="ensure-as-seconds"></a><span class="comment">; ---------------------------------------------------------------------------------------------------------------</span><br />
<a name="ensure-as-seconds"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(ensure-as-seconds x)</span>
  (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX224" title="R5RS Scheme form">number?</a> x) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> x) "s"))
        ((<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX374" title="R5RS Scheme form">string?</a> x) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX196" title="R5RS Scheme form">eqv?</a> #\s (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX379" title="R5RS Scheme form">string-ref</a> x (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX378" title="R5RS Scheme form">string-length</a> x) 1)))) x)
        ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX374" title="R5RS Scheme form">string?</a> x) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> x "s"))
        (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#laml-error" title="Manual: general">laml-error</a> "ensure-as-seconds: Cannot ensure x as seconds:" x))))</pre></font><div>&nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p></div></body></html>