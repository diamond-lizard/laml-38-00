<html><head><link href="../../../css-stylesheets/elucidator/program.css" rel="stylesheet" title="program" type="text/css" /> <title>Source file</title></head><body bgcolor="#ffffff" text="#000000" link="#000000" vlink="#000000"><font size="2"><pre><span class="comment">; The LAML library and programs are written by Kurt Normark, Aalborg University, Denmark.
; Copyright (C) 2000,  Kurt Normark, normark@s.auc.dk.
;
; This program is free software; you can redistribute it and/or modify
; it under the terms of the GNU General Public License as published by
; the Free Software Foundation; either version 2 of the License, or
; (at your option) any later version.
;
; This program is distributed in the hope that it will be useful,
; but WITHOUT ANY WARRANTY; without even the implied warranty of
; MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
; GNU General Public License for more details.
;
; You should have received a copy of the GNU General Public License
; along with this program; if not, write to the Free Software
; Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA</span><br />

<div class="schemedoc-abstract-comment">;;;; This is a Lisp pretty printing library, which especially is oriented towards Scheme.&lt;p&gt;
;;;; The pretty printer handles all aspects of Scheme which has special lexical syntax: lists, pairs (dot notation), booleans, chars,
;;;; vectors, and quasi quotation (backquoting). In addition, the pretty printing function handles Scheme special forms
;;;; such as cond, let, define, if, etc. &lt;p&gt;
;;;; A few parameters (global variables) control the pretty printer.&lt;p&gt;
;;;; Conventional comments, read by the this pretty printer, are lost.
;;;; This library assumes that comments are represented as syntactical forms like (comment!!! n "A comment").
;;;; The LAML schemedoc tool contains a procedure lexical-to-syntactical-comments! which converts conventional, semicolon Lisp
;;;; comments to the syntactical comments expected by the pretty printing library.
;;;; The variable syntactical-comment-symbol (and the variable COMMENT-FORM-START in SchemeDoc) allows you to control
;;;; the prefix symbol of syntactical comments.&lt;p&gt;
;;;; The important top level functions of this library are pretty-print-lisp-file and pretty-print-lisp-form. &lt;p&gt;
;;;; Internally, the pretty printer adds pretty-print tokens (strings or chars) to a list, which finally is reversed and linearized
;;;; into a string.&lt;p&gt;
;;;; This library relies on the general library (not loaded by this library).&lt;p&gt;
;;;; In the laml.scm file there are LAML procedures &lt;a href = "../../man/laml.html#scheme-pp"&gt;scheme-pp&lt;/a&gt; 
;;;; and &lt;a href="../../man/laml.html#scheme-pp-simple"&gt;scheme-pp-simple&lt;/a&gt; which pretty print Scheme and Lisp files.
;;;; &lt;kbd&gt;pp-scheme&lt;/kbd&gt; handles comments properly. These are the most top-level Scheme pretty printing procedures in the 
;;;; LAML system.
;;;; .title Reference Manual of the Scheme Pretty Printing Library</div>
<div class="schemedoc-section-comment">;;; Pretty printing parameters.
;;; The variables in this section controls the pretty printing.</div>
<a name="indentation-delta"></a><a name="indentation-delta"></a><span><a href="../scheme-pretty-printing.html#indentation-delta"><img src="../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">indentation-delta</span> 3)

<a name="use-single-lining"></a><a name="use-single-lining"></a><span><a href="../scheme-pretty-printing.html#use-single-lining"><img src="../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">use-single-lining</span> #t)

<a name="prefered-maximum-width"></a><a name="prefered-maximum-width"></a><span><a href="../scheme-pretty-printing.html#prefered-maximum-width"><img src="../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">prefered-maximum-width</span> 90)

<a name="syntactical-comment-symbol"></a><a name="syntactical-comment-symbol"></a><span><a href="../scheme-pretty-printing.html#syntactical-comment-symbol"><img src="../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">syntactical-comment-symbol</span> 'comment!!!)

<div class="schemedoc-section-comment">;;; Top level pretty printing functions.
;;; In this section you will find the important, overall pretty printing functions.</div>
<a name="pretty-print-lisp-file"></a><a name="pretty-print-lisp-file"></a><span><a href="../scheme-pretty-printing.html#pretty-print-lisp-file"><img src="../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(pretty-print-lisp-file in-file-path . optional-parameters)</span>
 (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">out-file-path</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#optional-parameter" title="Manual: general">optional-parameter</a> 1  optional-parameters in-file-path)))
  (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">form-list</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#file-read-all" title="Manual: general">file-read-all</a> in-file-path))
       )
   (<a class="schemedoc-name" href="../../../lib/man/file-read.html#write-text-file" title="Manual: file-read">write-text-file</a> 
    (<a class="applied-name" href="scheme-pretty-printing-1.html#source-aggreated-text-with-interspacing" title="scheme-pretty-printing">source-aggreated-text-with-interspacing</a>
     (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> <a class="applied-name" href="scheme-pretty-printing-1.html#pretty-print-lisp-form" title="scheme-pretty-printing">pretty-print-lisp-form</a> form-list)
     form-list)
    out-file-path))))

<a name="source-aggreated-text-with-interspacing"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(source-aggreated-text-with-interspacing pp-res-list form-list)</span>
  (<a class="applied-name" href="scheme-pretty-printing-1.html#source-aggreated-text-with-interspacing-1" title="scheme-pretty-printing">source-aggreated-text-with-interspacing-1</a> pp-res-list form-list ""))

<a name="source-aggreated-text-with-interspacing-1"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(source-aggreated-text-with-interspacing-1 pp-res-list form-list res)</span>
  (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> pp-res-list)
      res
      (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">this-pp-contr</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> pp-res-list))
            (<span class="local-name-binding">this-form</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> form-list))
            (<span class="local-name-binding">double-cr</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> #\newline) (<a class="schemedoc-name" href="../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> #\newline)))
           )
        (<a class="applied-name" href="scheme-pretty-printing-1.html#source-aggreated-text-with-interspacing-1" title="scheme-pretty-printing">source-aggreated-text-with-interspacing-1</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> pp-res-list) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> form-list)
           (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="applied-name" href="scheme-pretty-printing-1.html#syntactical-comment-form?" title="scheme-pretty-printing">syntactical-comment-form?</a> this-form)
               (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> res this-pp-contr)
               (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> res this-pp-contr double-cr))))))


    
<a name="pretty-print-lisp-form"></a><a name="pretty-print-lisp-form"></a><span><a href="../scheme-pretty-printing.html#pretty-print-lisp-form"><img src="../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(pretty-print-lisp-form form)</span>
 (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> <a class="applied-name" href="scheme-pretty-printing-1.html#res" title="scheme-pretty-printing">res</a> '())
 (<a class="applied-name" href="scheme-pretty-printing-1.html#pretty-print-lisp-form-1" title="scheme-pretty-printing">pretty-print-lisp-form-1</a> form 0 #f)
 (<a class="applied-name" href="scheme-pretty-printing-1.html#linearize-pp-result" title="scheme-pretty-printing">linearize-pp-result</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX335" title="R5RS Scheme form">reverse</a> <a class="applied-name" href="scheme-pretty-printing-1.html#res" title="scheme-pretty-printing">res</a>)))

<a name="pretty-print-lisp-string"></a><a name="pretty-print-lisp-string"></a><span><a href="../scheme-pretty-printing.html#pretty-print-lisp-string"><img src="../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(pretty-print-lisp-string str)</span>
 (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">temp-file-path</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> (<a class="schemedoc-name" href="../../../man/laml.html#laml-temp-file-path" title="Manual: laml">laml-temp-file-path</a>) "lisp-form-string.lsp")))
   (<a class="schemedoc-name" href="../../../lib/man/file-read.html#write-text-file" title="Manual: file-read">write-text-file</a> str temp-file-path)
   (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">form</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#file-read" title="Manual: general">file-read</a> temp-file-path)))
     (<a class="applied-name" href="scheme-pretty-printing-1.html#pretty-print-lisp-form" title="scheme-pretty-printing">pretty-print-lisp-form</a> form))))


<a name="res"></a><span class="comment">; -------------------------------------------------------------------
; The internal result list</span><br />
<a name="res"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">res</span> '())

<a name="add-to-res"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(add-to-res x)</span>
  (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> <a class="applied-name" href="scheme-pretty-printing-1.html#res" title="scheme-pretty-printing">res</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> x <a class="applied-name" href="scheme-pretty-printing-1.html#res" title="scheme-pretty-printing">res</a>)))

<a name="remove-from-res"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(remove-from-res i)</span>
  (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX237" title="R5RS Scheme form">&gt;</a> i 0)
      (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX125" title="R5RS Scheme form">begin</a>
        (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> <a class="applied-name" href="scheme-pretty-printing-1.html#res" title="scheme-pretty-printing">res</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> <a class="applied-name" href="scheme-pretty-printing-1.html#res" title="scheme-pretty-printing">res</a>))
        (<a class="applied-name" href="scheme-pretty-printing-1.html#remove-from-res" title="scheme-pretty-printing">remove-from-res</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> i 1)))))

<a name="linearize-pp-result"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(linearize-pp-result lst)</span>
 (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX411" title="R5RS Scheme form">apply</a> <a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a>
  (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> <a class="schemedoc-name" href="../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> lst)))

<a name="add-white-space"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(add-white-space single-lining?)</span>
  (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> single-lining? 
      (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> #\space)
      (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> #\newline)))

<span class="comment">; ------------------------------------------------------------------
; Internal Lisp pretty-printing stuff</span><br />
<a name="pretty-print-lisp-form-1"></a><span class="comment">; The central, internal lisp pretty printing function.</span><br /><a name="pretty-print-lisp-form-1"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(pretty-print-lisp-form-1 form start-col single-lining?)</span>
  (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX346" title="R5RS Scheme form">symbol?</a> form) (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> form)))
        ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX224" title="R5RS Scheme form">number?</a> form) (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> form)))
        ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX374" title="R5RS Scheme form">string?</a> form) (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#string-it" title="Manual: general">string-it</a> (<a class="applied-name" href="scheme-pretty-printing-1.html#string-quote-protect" title="scheme-pretty-printing">string-quote-protect</a> form))))
        ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX351" title="R5RS Scheme form">char?</a> form) (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> (<a class="applied-name" href="scheme-pretty-printing-1.html#char-it" title="scheme-pretty-printing">char-it</a> form)))       <span class="comment">; scheme specific</span><br />        ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX305" title="R5RS Scheme form">boolean?</a> form) (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> (<a class="applied-name" href="scheme-pretty-printing-1.html#bool-it" title="scheme-pretty-printing">bool-it</a> form)))    <span class="comment">; scheme specific</span><br />        ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX399" title="R5RS Scheme form">vector?</a> form) (<a class="applied-name" href="scheme-pretty-printing-1.html#vector-it" title="scheme-pretty-printing">vector-it</a> form start-col single-lining?))
        ((<a class="applied-name" href="scheme-pretty-printing-1.html#quote-form?" title="scheme-pretty-printing">quote-form?</a> form)  <span class="comment">; (quote x)  </span><br />           (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> "&#39;")
           (<a class="applied-name" href="scheme-pretty-printing-1.html#pretty-print-lisp-form-1" title="scheme-pretty-printing">pretty-print-lisp-form-1</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cadr</a> form) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> 1 start-col) single-lining?))
        ((<a class="applied-name" href="scheme-pretty-printing-1.html#quasiquote-form?" title="scheme-pretty-printing">quasiquote-form?</a> form)  <span class="comment">; (quasiquote x) - backquote</span><br />           (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> "`")
           (<a class="applied-name" href="scheme-pretty-printing-1.html#pretty-print-lisp-form-1" title="scheme-pretty-printing">pretty-print-lisp-form-1</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cadr</a> form) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> 1 start-col) single-lining?))
        ((<a class="applied-name" href="scheme-pretty-printing-1.html#unquote-form?" title="scheme-pretty-printing">unquote-form?</a> form)  <span class="comment">; (unquote x) or ,x</span><br />           (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> ",")
           (<a class="applied-name" href="scheme-pretty-printing-1.html#pretty-print-lisp-form-1" title="scheme-pretty-printing">pretty-print-lisp-form-1</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cadr</a> form) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> 1 start-col) single-lining?))
        ((<a class="applied-name" href="scheme-pretty-printing-1.html#unquote-splicing-form?" title="scheme-pretty-printing">unquote-splicing-form?</a> form)  <span class="comment">; (unquote-splicing x) or ,<span><a name="pretty-print-lisp-form-1-@x"></a> @x</span></span><br />           (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> ",@")
           (<a class="applied-name" href="scheme-pretty-printing-1.html#pretty-print-lisp-form-1" title="scheme-pretty-printing">pretty-print-lisp-form-1</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cadr</a> form) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> 2 start-col) single-lining?))
        ((<a class="applied-name" href="scheme-pretty-printing-1.html#syntactical-comment-form?" title="scheme-pretty-printing">syntactical-comment-form?</a> form) <span class="comment">; (comment x)</span><br />           (<a class="applied-name" href="scheme-pretty-printing-1.html#pretty-print-syntactical-comment" title="scheme-pretty-printing">pretty-print-syntactical-comment</a> form start-col single-lining?))
        ((<a class="applied-name" href="scheme-pretty-printing-1.html#special-form?" title="scheme-pretty-printing">special-form?</a> form)  <span class="comment">; let, cond, define and others that call for special pretty priting</span><br />           (<a class="applied-name" href="scheme-pretty-printing-1.html#pretty-print-special-form" title="scheme-pretty-printing">pretty-print-special-form</a> form start-col)) 
        ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX331" title="R5RS Scheme form">list?</a> form)
           (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> form) (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> "()"))
                 ((<a class="applied-name" href="scheme-pretty-printing-1.html#single-liner-form?" title="scheme-pretty-printing">single-liner-form?</a> form start-col <a class="applied-name" href="scheme-pretty-printing-1.html#prefered-maximum-width" title="scheme-pretty-printing">prefered-maximum-width</a>)
                       (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> "(")
                       (<a class="applied-name" href="scheme-pretty-printing-1.html#add-list-rest-to-res-single-liner" title="scheme-pretty-printing">add-list-rest-to-res-single-liner</a> form)
                       (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> ")"))
                 (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> "(")
                       (<a class="applied-name" href="scheme-pretty-printing-1.html#pretty-print-lisp-form-1" title="scheme-pretty-printing">pretty-print-lisp-form-1</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> form) start-col single-lining?)
                       (<a class="applied-name" href="scheme-pretty-printing-1.html#add-white-space" title="scheme-pretty-printing">add-white-space</a> single-lining?)
                       (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> single-lining?) (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> (<a class="applied-name" href="scheme-pretty-printing-1.html#indentation" title="scheme-pretty-printing">indentation</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> start-col <a class="applied-name" href="scheme-pretty-printing-1.html#indentation-delta" title="scheme-pretty-printing">indentation-delta</a>))))
                       (<a class="applied-name" href="scheme-pretty-printing-1.html#add-list-rest-to-res" title="scheme-pretty-printing">add-list-rest-to-res</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> form) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> start-col <a class="applied-name" href="scheme-pretty-printing-1.html#indentation-delta" title="scheme-pretty-printing">indentation-delta</a>) single-lining?)
                       (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> ")"))))
        ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX319" title="R5RS Scheme form">pair?</a> form)
           (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">prefix-list</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#proper-part" title="Manual: general">proper-part</a> form))
                 (<span class="local-name-binding">last-el</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#first-improper-part" title="Manual: general">first-improper-part</a> form)))
            (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="applied-name" href="scheme-pretty-printing-1.html#single-liner-form?" title="scheme-pretty-printing">single-liner-form?</a> form start-col <a class="applied-name" href="scheme-pretty-printing-1.html#prefered-maximum-width" title="scheme-pretty-printing">prefered-maximum-width</a>)
                       (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> "(")
                       (<a class="applied-name" href="scheme-pretty-printing-1.html#add-list-rest-to-res-single-liner" title="scheme-pretty-printing">add-list-rest-to-res-single-liner</a> prefix-list)
                       (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> " . ")
                       (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">dummy</span> 0))
                         (<a class="applied-name" href="scheme-pretty-printing-1.html#pretty-print-lisp-form-1" title="scheme-pretty-printing">pretty-print-lisp-form-1</a> last-el dummy #t))
                       (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> ")"))
                  (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> 
                      (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> "(")
                      (<a class="applied-name" href="scheme-pretty-printing-1.html#add-list-rest-to-res" title="scheme-pretty-printing">add-list-rest-to-res</a> prefix-list (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> start-col 2) single-lining?)
                      (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> " . ") 
                      (<a class="applied-name" href="scheme-pretty-printing-1.html#add-white-space" title="scheme-pretty-printing">add-white-space</a> single-lining?)
                      (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> single-lining?) (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> (<a class="applied-name" href="scheme-pretty-printing-1.html#indentation" title="scheme-pretty-printing">indentation</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> start-col 2))))
                      (<a class="applied-name" href="scheme-pretty-printing-1.html#pretty-print-lisp-form-1" title="scheme-pretty-printing">pretty-print-lisp-form-1</a> last-el (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> start-col 2) single-lining?)
                      (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> ")")))))
   )
)


<a name="quote-form?"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(quote-form? x)</span>
  (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX331" title="R5RS Scheme form">list?</a> x) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> x)) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> x) 'quote)))

<a name="quasiquote-form?"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(quasiquote-form? x)</span>
  (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX331" title="R5RS Scheme form">list?</a> x) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> x)) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> x) 'quasiquote)))

<a name="unquote-form?"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(unquote-form? x)</span>
  (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX331" title="R5RS Scheme form">list?</a> x) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> x)) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> x) 'unquote)))

<a name="unquote-splicing-form?"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(unquote-splicing-form? x)</span>
  (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX331" title="R5RS Scheme form">list?</a> x) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> x)) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> x) 'unquote-splicing)))

<a name="syntactical-comment-form?"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(syntactical-comment-form? x)</span>
  (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX331" title="R5RS Scheme form">list?</a> x) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX235" title="R5RS Scheme form">=</a> 3 (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX333" title="R5RS Scheme form">length</a> x)) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> x) <a class="applied-name" href="scheme-pretty-printing-1.html#syntactical-comment-symbol" title="scheme-pretty-printing">syntactical-comment-symbol</a>)))

<a name="special-form?"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(special-form? x)</span>
  (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX331" title="R5RS Scheme form">list?</a> x) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> x)) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX338" title="R5RS Scheme form">memq</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> x) '(define if let let* letrec cond))))

<a name="named-let-form?"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(named-let-form? x)</span>
  (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX331" title="R5RS Scheme form">list?</a> x) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX239" title="R5RS Scheme form">&gt;=</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX333" title="R5RS Scheme form">length</a> x) 3) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> x) 'let ) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX346" title="R5RS Scheme form">symbol?</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cadr</a> x))))

<a name="single-liner-form?"></a><span class="comment">; Is form x going to pretty printed on a single line.
; We are in start-col, and the preferred maximum column widht is max-width</span><br /><a name="single-liner-form?"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(single-liner-form? x start-col max-width)</span>
  (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> <a class="applied-name" href="scheme-pretty-printing-1.html#use-single-lining" title="scheme-pretty-printing">use-single-lining</a>
      (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">width</span> (<a class="applied-name" href="scheme-pretty-printing-1.html#meassure-lisp-form" title="scheme-pretty-printing">meassure-lisp-form</a> x)))
        (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX238" title="R5RS Scheme form">&lt;=</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> width start-col) max-width))
      #f))

<a name="string-quote-protect"></a><span class="comment">; Prefix string quotes within str with backslashes</span><br /><a name="string-quote-protect"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(string-quote-protect str)</span>
  (<a class="schemedoc-name" href="../../../lib/man/general.html#replace-string" title="Manual: general">replace-string</a> str (<a class="schemedoc-name" href="../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> #\") (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> #\\) (<a class="schemedoc-name" href="../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> #\"))))


<a name="meassure-lisp-form"></a><span class="comment">; return the size of form assumed that it is pretty print in single-spacing mode.</span><br /><a name="meassure-lisp-form"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(meassure-lisp-form form)</span>
  (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX346" title="R5RS Scheme form">symbol?</a> form) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX378" title="R5RS Scheme form">string-length</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> form)))
        ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX224" title="R5RS Scheme form">number?</a> form) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX378" title="R5RS Scheme form">string-length</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> form)))
        ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX374" title="R5RS Scheme form">string?</a> form) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> 2 (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX378" title="R5RS Scheme form">string-length</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> form))))
        ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX351" title="R5RS Scheme form">char?</a> form) 3)       <span class="comment">; not exact meassure</span><br />        ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX305" title="R5RS Scheme form">boolean?</a> form) 2)    
        ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX399" title="R5RS Scheme form">vector?</a> form) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> 1 (<a class="applied-name" href="scheme-pretty-printing-1.html#meassure-lisp-form" title="scheme-pretty-printing">meassure-lisp-form</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX406" title="R5RS Scheme form">vector-&gt;list</a> form))))
        ((<a class="applied-name" href="scheme-pretty-printing-1.html#quote-form?" title="scheme-pretty-printing">quote-form?</a> form) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> 1 (<a class="applied-name" href="scheme-pretty-printing-1.html#meassure-lisp-form" title="scheme-pretty-printing">meassure-lisp-form</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cadr</a> form))))
        ((<a class="applied-name" href="scheme-pretty-printing-1.html#quasiquote-form?" title="scheme-pretty-printing">quasiquote-form?</a> form)  <span class="comment">; (quasiquote x) - backquote</span><br />           (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> 1 (<a class="applied-name" href="scheme-pretty-printing-1.html#meassure-lisp-form" title="scheme-pretty-printing">meassure-lisp-form</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cadr</a> form))))
        ((<a class="applied-name" href="scheme-pretty-printing-1.html#unquote-form?" title="scheme-pretty-printing">unquote-form?</a> form)  <span class="comment">; (unquote x) or ,x</span><br />           (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> 1 (<a class="applied-name" href="scheme-pretty-printing-1.html#meassure-lisp-form" title="scheme-pretty-printing">meassure-lisp-form</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cadr</a> form))))
        ((<a class="applied-name" href="scheme-pretty-printing-1.html#unquote-splicing-form?" title="scheme-pretty-printing">unquote-splicing-form?</a> form)  <span class="comment">; (unquote-splicing x) or ,<span><a name="meassure-lisp-form-@x"></a> @x</span></span><br />           (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> 2 (<a class="applied-name" href="scheme-pretty-printing-1.html#meassure-lisp-form" title="scheme-pretty-printing">meassure-lisp-form</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cadr</a> form))))
        ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX331" title="R5RS Scheme form">list?</a> form)
           (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">meassure-list</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> <a class="applied-name" href="scheme-pretty-printing-1.html#meassure-lisp-form" title="scheme-pretty-printing">meassure-lisp-form</a> form)))
             (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#accumulate-right" title="Manual: general">accumulate-right</a> <a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> 0 meassure-list) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX333" title="R5RS Scheme form">length</a> form) 1)))
        ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX319" title="R5RS Scheme form">pair?</a> form)
           (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">prefix-list</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#proper-part" title="Manual: general">proper-part</a> form))
                 (<span class="local-name-binding">last-el</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#first-improper-part" title="Manual: general">first-improper-part</a> form)))
             (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> (<a class="applied-name" href="scheme-pretty-printing-1.html#meassure-lisp-form" title="scheme-pretty-printing">meassure-lisp-form</a> prefix-list) 3 (<a class="applied-name" href="scheme-pretty-printing-1.html#meassure-lisp-form" title="scheme-pretty-printing">meassure-lisp-form</a> last-el))))
        (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> 0)
   ))


<a name="char-it"></a><span class="comment">; Emit a Scheme char surface form of ch</span><br /><a name="char-it"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(char-it ch)</span>
  (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX196" title="R5RS Scheme form">eqv?</a> ch #\space) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> #\#) (<a class="schemedoc-name" href="../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> #\\) "space"))
        ((<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX196" title="R5RS Scheme form">eqv?</a> ch #\newline) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> #\#) (<a class="schemedoc-name" href="../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> #\\) "newline"))
        (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> #\#) (<a class="schemedoc-name" href="../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> #\\) (<a class="schemedoc-name" href="../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> ch)))))

<a name="bool-it"></a><span class="comment">; Emit a Scheme boolean surface form of b</span><br /><a name="bool-it"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(bool-it b)</span>
  (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> b "#t" "#f"))

<a name="vector-it"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(vector-it form start-col single-lining?)</span>
  (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> "#")
  (<a class="applied-name" href="scheme-pretty-printing-1.html#pretty-print-lisp-form-1" title="scheme-pretty-printing">pretty-print-lisp-form-1</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX406" title="R5RS Scheme form">vector-&gt;list</a> form) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> 1 start-col) single-lining?)
)
  
<a name="add-list-rest-to-res"></a><span class="comment">; Process the rest of a list</span><br /><a name="add-list-rest-to-res"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(add-list-rest-to-res list-tail start-col single-lining?)</span>
  (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX413" title="R5RS Scheme form">for-each</a>
    (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">el</span>)
      (<a class="applied-name" href="scheme-pretty-printing-1.html#pretty-print-lisp-form-1" title="scheme-pretty-printing">pretty-print-lisp-form-1</a> el start-col single-lining?)
      (<a class="applied-name" href="scheme-pretty-printing-1.html#add-white-space" title="scheme-pretty-printing">add-white-space</a> single-lining?)
      (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> single-lining?) (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> (<a class="applied-name" href="scheme-pretty-printing-1.html#indentation" title="scheme-pretty-printing">indentation</a> start-col))))
    list-tail)
  <span class="comment">; remove lst newline and indentation</span><br />  (<a class="applied-name" href="scheme-pretty-printing-1.html#remove-from-res" title="scheme-pretty-printing">remove-from-res</a> (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> single-lining? 1 2)))

<a name="add-list-rest-to-res-single-liner"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(add-list-rest-to-res-single-liner lst)</span>
 (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">dummy</span> 0))
  (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX413" title="R5RS Scheme form">for-each</a>
    (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">el</span>)
      (<a class="applied-name" href="scheme-pretty-printing-1.html#pretty-print-lisp-form-1" title="scheme-pretty-printing">pretty-print-lisp-form-1</a> el dummy #t)
      (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> #\space))
    lst)
  (<a class="applied-name" href="scheme-pretty-printing-1.html#remove-from-res" title="scheme-pretty-printing">remove-from-res</a> 1) <span class="comment">; last space removed</span><br /> )
)

<a name="indentation"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(indentation n)</span>
  (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX375" title="R5RS Scheme form">make-string</a> n #\space))

<a name="pretty-print-syntactical-comment"></a><span class="comment">; always ends i a newline to make it impossible that trailing lisp stuff ends up in a comment</span><br /><a name="pretty-print-syntactical-comment"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(pretty-print-syntactical-comment form start-col single-lining?)</span>
 (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">level</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-number" title="Manual: general">as-number</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cadr</a> form)))
        (<span class="local-name-binding">comment-prefix</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX375" title="R5RS Scheme form">make-string</a> level #\;) (<a class="schemedoc-name" href="../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> #\space)))
        (<span class="local-name-binding">cr-comment-prefix</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> #\newline) comment-prefix))
        (<span class="local-name-binding">comment-text</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">caddr</a> form))
        (<span class="local-name-binding">comment-text-1</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#replace-string" title="Manual: general">replace-string</a> comment-text (<a class="schemedoc-name" href="../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> #\newline) cr-comment-prefix)) 
       )
    (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> comment-prefix) 
    (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> comment-text-1)
    (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> #\newline)))

<a name="pretty-print-special-form"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(pretty-print-special-form form start-col)</span>
  (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">which-form</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> form)))
    (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> which-form 'define) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX239" title="R5RS Scheme form">&gt;=</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX333" title="R5RS Scheme form">length</a> form) 2))
              (<a class="applied-name" href="scheme-pretty-printing-1.html#pretty-print-define-form" title="scheme-pretty-printing">pretty-print-define-form</a> form start-col))
          ((<a class="applied-name" href="scheme-pretty-printing-1.html#named-let-form?" title="scheme-pretty-printing">named-let-form?</a> form)
              (<a class="applied-name" href="scheme-pretty-printing-1.html#pretty-print-named-let-form" title="scheme-pretty-printing">pretty-print-named-let-form</a> form start-col))
          ((<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX338" title="R5RS Scheme form">memq</a> which-form '(let let* letrec)) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX239" title="R5RS Scheme form">&gt;=</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX333" title="R5RS Scheme form">length</a> form) 2))
              (<a class="applied-name" href="scheme-pretty-printing-1.html#pretty-print-let-form" title="scheme-pretty-printing">pretty-print-let-form</a> form which-form start-col))
          ((<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> which-form 'cond) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX239" title="R5RS Scheme form">&gt;=</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX333" title="R5RS Scheme form">length</a> form) 2))              
              (<a class="applied-name" href="scheme-pretty-printing-1.html#pretty-print-cond-form" title="scheme-pretty-printing">pretty-print-cond-form</a> form start-col))
          ((<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> which-form 'if) (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX239" title="R5RS Scheme form">&gt;=</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX333" title="R5RS Scheme form">length</a> form) 3))              
              (<a class="applied-name" href="scheme-pretty-printing-1.html#pretty-print-if-form" title="scheme-pretty-printing">pretty-print-if-form</a> form start-col))
          (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (error (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> "pretty-print-special-form: Unknown special form: " (<a class="schemedoc-name" href="../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> which-form)))))))

<a name="pretty-print-define-form"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(pretty-print-define-form form start-col)</span>
 (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="applied-name" href="scheme-pretty-printing-1.html#single-liner-form?" title="scheme-pretty-printing">single-liner-form?</a> form start-col <a class="applied-name" href="scheme-pretty-printing-1.html#prefered-maximum-width" title="scheme-pretty-printing">prefered-maximum-width</a>)
     (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">dummy</span> 0)) 
      (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> "(")
      (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> "define")
      (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> #\space)
      (<a class="applied-name" href="scheme-pretty-printing-1.html#add-list-rest-to-res" title="scheme-pretty-printing">add-list-rest-to-res</a> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> form) dummy #t)
      (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> ")")
    )
    (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">name-or-call-form</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cadr</a> form))
         (<span class="local-name-binding">body-rest</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cddr</a> form))
         (<span class="local-name-binding">new-indent</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> start-col <a class="applied-name" href="scheme-pretty-printing-1.html#indentation-delta" title="scheme-pretty-printing">indentation-delta</a>))
         ) 
      (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> "(")
      (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> "define")
      (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> #\space)
  
      (<a class="applied-name" href="scheme-pretty-printing-1.html#pretty-print-lisp-form-1" title="scheme-pretty-printing">pretty-print-lisp-form-1</a> name-or-call-form (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> start-col 8) #f)  <span class="comment">; #t if we insist on calling form on a single line</span><br />      (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> #\newline)
      (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> (<a class="applied-name" href="scheme-pretty-printing-1.html#indentation" title="scheme-pretty-printing">indentation</a> new-indent))
  
      (<a class="applied-name" href="scheme-pretty-printing-1.html#add-list-rest-to-res" title="scheme-pretty-printing">add-list-rest-to-res</a> body-rest new-indent (<a class="applied-name" href="scheme-pretty-printing-1.html#single-liner-form?" title="scheme-pretty-printing">single-liner-form?</a> body-rest new-indent <a class="applied-name" href="scheme-pretty-printing-1.html#prefered-maximum-width" title="scheme-pretty-printing">prefered-maximum-width</a>))
      (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> ")") )))

<a name="pretty-print-let-form"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(pretty-print-let-form form which-let-form start-col)</span>
  (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">name-bindings</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cadr</a> form))
        (<span class="local-name-binding">which-let-form-string</span> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> which-let-form))
        (<span class="local-name-binding">body-rest</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cddr</a> form))
        (<span class="local-name-binding">new-indent</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> start-col <a class="applied-name" href="scheme-pretty-printing-1.html#indentation-delta" title="scheme-pretty-printing">indentation-delta</a>))
       )
    (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> "(")
    (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> which-let-form-string)
    (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> #\space)

    <span class="comment">; #f: name bindings never on same line</span><br />    (<a class="applied-name" href="scheme-pretty-printing-1.html#pretty-print-lisp-form-1" title="scheme-pretty-printing">pretty-print-lisp-form-1</a> name-bindings (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> start-col (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX378" title="R5RS Scheme form">string-length</a> which-let-form-string)) #f)
    (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> #\newline)
    (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> (<a class="applied-name" href="scheme-pretty-printing-1.html#indentation" title="scheme-pretty-printing">indentation</a> new-indent))

    (<a class="applied-name" href="scheme-pretty-printing-1.html#add-list-rest-to-res" title="scheme-pretty-printing">add-list-rest-to-res</a> body-rest new-indent (<a class="applied-name" href="scheme-pretty-printing-1.html#single-liner-form?" title="scheme-pretty-printing">single-liner-form?</a> body-rest new-indent <a class="applied-name" href="scheme-pretty-printing-1.html#prefered-maximum-width" title="scheme-pretty-printing">prefered-maximum-width</a>))
    (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> ")") ))

<a name="pretty-print-named-let-form"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(pretty-print-named-let-form form start-col)</span>
 (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">name</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cadr</a> form))
        (<span class="local-name-binding">name-bindings</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">caddr</a> form))
        (<span class="local-name-binding">body-rest</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cdddr</a> form))
        (<span class="local-name-binding">name-val-indent</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> start-col 6 (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX378" title="R5RS Scheme form">string-length</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> name))))
        (<span class="local-name-binding">body-indent</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> start-col <a class="applied-name" href="scheme-pretty-printing-1.html#indentation-delta" title="scheme-pretty-printing">indentation-delta</a>))
       )
    (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> "(")
    (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> "let")
    (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> #\space)
    (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> (<a class="schemedoc-name" href="../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> name))
    (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> #\space)

    <span class="comment">; #f: name bindings never on same line</span><br />    (<a class="applied-name" href="scheme-pretty-printing-1.html#pretty-print-lisp-form-1" title="scheme-pretty-printing">pretty-print-lisp-form-1</a> name-bindings name-val-indent #f)
    (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> #\newline)
    (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> (<a class="applied-name" href="scheme-pretty-printing-1.html#indentation" title="scheme-pretty-printing">indentation</a> body-indent))

    (<a class="applied-name" href="scheme-pretty-printing-1.html#add-list-rest-to-res" title="scheme-pretty-printing">add-list-rest-to-res</a> body-rest body-indent (<a class="applied-name" href="scheme-pretty-printing-1.html#single-liner-form?" title="scheme-pretty-printing">single-liner-form?</a> body-rest body-indent <a class="applied-name" href="scheme-pretty-printing-1.html#prefered-maximum-width" title="scheme-pretty-printing">prefered-maximum-width</a>))
    (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> ")") ))
  

<a name="pretty-print-cond-form"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(pretty-print-cond-form form start-col)</span>
  (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">condition-consequence-rest</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> form))
       )
    (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> "(")
    (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> "cond")
    (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> #\space)

    (<a class="applied-name" href="scheme-pretty-printing-1.html#add-list-rest-to-res" title="scheme-pretty-printing">add-list-rest-to-res</a> condition-consequence-rest (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> start-col 6) #f)
    (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> ")") ))

<a name="pretty-print-if-form"></a><span></span>(<a class="scheme-syntax-name" href="../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(pretty-print-if-form form start-col)</span>
  (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="applied-name" href="scheme-pretty-printing-1.html#single-liner-form?" title="scheme-pretty-printing">single-liner-form?</a> form start-col <a class="applied-name" href="scheme-pretty-printing-1.html#prefered-maximum-width" title="scheme-pretty-printing">prefered-maximum-width</a>)
      (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">condition</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cadr</a> form))
            (<span class="local-name-binding">body-rest</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> form))
            (<span class="local-name-binding">dummy</span> 0))
        (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> "(")
        (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> "if")
        (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> #\space)
        (<a class="applied-name" href="scheme-pretty-printing-1.html#add-list-rest-to-res" title="scheme-pretty-printing">add-list-rest-to-res</a> body-rest dummy #t)
        (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> ")") )
      (<a class="scheme-syntax-name" href="../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">condition</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cadr</a> form))
            (<span class="local-name-binding">body-rest</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cddr</a> form))
            (<span class="local-name-binding">new-indent</span> (<a class="scheme-procedure-name" href="../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> start-col 4)))
        (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> "(")
        (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> "if")
        (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> #\space)
        
        (<a class="applied-name" href="scheme-pretty-printing-1.html#pretty-print-lisp-form-1" title="scheme-pretty-printing">pretty-print-lisp-form-1</a> condition new-indent (<a class="applied-name" href="scheme-pretty-printing-1.html#single-liner-form?" title="scheme-pretty-printing">single-liner-form?</a> condition new-indent <a class="applied-name" href="scheme-pretty-printing-1.html#prefered-maximum-width" title="scheme-pretty-printing">prefered-maximum-width</a>))
        (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> #\newline)
        (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> (<a class="applied-name" href="scheme-pretty-printing-1.html#indentation" title="scheme-pretty-printing">indentation</a> new-indent))

        (<a class="applied-name" href="scheme-pretty-printing-1.html#add-list-rest-to-res" title="scheme-pretty-printing">add-list-rest-to-res</a> body-rest new-indent #f)
        (<a class="applied-name" href="scheme-pretty-printing-1.html#add-to-res" title="scheme-pretty-printing">add-to-res</a> ")") )))


                      </pre></font><div>&nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p></div></body></html>