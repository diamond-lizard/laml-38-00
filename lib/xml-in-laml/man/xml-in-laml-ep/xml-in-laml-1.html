<html><head><link href="../../../../css-stylesheets/elucidator/program.css" rel="stylesheet" title="program" type="text/css" /> <title>Source file</title></head><body bgcolor="#ffffff" text="#000000" link="#000000" vlink="#000000"><font size="2"><pre><span class="comment">; =&gt;man/xml-in-laml.sdoc</span><br />
<div class="schemedoc-abstract-comment">;;;; The XML-in-LAML common parts, which are shared between all XML-in-LAML languages.
;;;; The library is used together with
;;;; &lt;a href="../mirrors/man/xhtml10-transitional-mirror.html"&gt;XHTML 1.0 transitional&lt;/a&gt;,
;;;; &lt;a href="../mirrors/man/xhtml10-strict-mirror.html"&gt;XHTML 1.0 strict&lt;/a&gt;,
;;;; &lt;a href="../mirrors/man/xhtml10-frameset-mirror.html"&gt;XHTML 1.0 frameset&lt;/a&gt;,
;;;; &lt;a href="../mirrors/man/xhtml11-mirror.html"&gt;XHTML1.1&lt;/a&gt;, 
;;;; &lt;a href="../mirrors/man/svg11-mirror.html"&gt;SVG 1.1&lt;/a&gt;, 
;;;; &lt;a href="../../../styles/xml-in-laml/lecture-notes/man/lecture-notes.html"&gt;LENO&lt;/a&gt;, 
;;;; and other similar mirrors.&lt;p&gt;
;;;;
;;;;
;;;; This library loads &lt;a href="../../man/final-state-automaton.html"&gt;the the LAML finite state automation library&lt;/a&gt;
;;;; for the sake of full document validation at document generation time.&lt;p&gt;
;;;;
;;;;
;;;; &lt;a href="../../../tools/xml-in-laml/man/xml-in-laml.html"&gt;The XML-in-LAML Mirror Generation tool&lt;/a&gt;
;;;; is able to create a set of Scheme mirror functions for a given XML DTD. The generated mirror functions together with
;;;; the shared XML-in-LAML common library (this file) make up the effective mirror of an XML language.&lt;p&gt;
;;;;
;;;;
;;;; This library is also designed to co-exists with non-validating HTML mirrors, such as
;;;; &lt;a href="../../html4.0-loose/man/surface.html"&gt; Html4.0&lt;/a&gt;
;;;; (mainly the sake of LENO).
;;;; However, it &lt;b&gt;cannot&lt;/b&gt; be used together with other validating AST-based HTML mirrors, such as 
;;;; &lt;a href="../../html4.01-transitional-validating/man/surface.html"&gt; Html4.01 transitional validating&lt;/a&gt;.
;;;; You should use a 100% XML-IN-LAML solution instead. By that we mean a solution, where also the
;;;; HTML stuff is based on XML-in-LAML. In practical terms, it means that you should use one of the XHTML mirrors mentioned above.&lt;p&gt;
;;;; .title Reference Manual of the XML-in-LAML library</div>
(<a class="schemedoc-name" href="../../../../man/laml.html#lib-load" title="Manual: laml">lib-load</a> "final-state-automaton.scm")

<div class="schemedoc-section-comment">;;; XML front matters and end matters stuff.
;;; This section contains the XML declaration and other XML front matter stuff. 
;;; In addition it holds the end-laml function.
;;; .section-id front-matters</div>
<a name="standard-prolog"></a><a name="standard-prolog"></a><span><a href="../xml-in-laml.html#standard-prolog"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(standard-prolog . optional-parameter-list)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">language</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#optional-parameter" title="Manual: general">optional-parameter</a> 1 optional-parameter-list #f))
        (<span class="local-name-binding">doc-type-decl</span> (<a class="applied-name" href="xml-in-laml-1.html#xml-document-type-declaration-in" title="xml-in-laml">xml-document-type-declaration-in</a> language))
       )
  (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a>
   (<a class="applied-name" href="xml-in-laml-1.html#xml-declaration" title="xml-in-laml">xml-declaration</a>) (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> #\newline)
   doc-type-decl
   (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#empty-string?" title="Manual: general">empty-string?</a> doc-type-decl)) (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> #\newline) "")
   (<a class="schemedoc-name" href="../../../../man/laml.html#copyright-clause" title="Manual: laml">copyright-clause</a>)
   (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#empty-string?" title="Manual: general">empty-string?</a> (<a class="schemedoc-name" href="../../../../man/laml.html#copyright-clause" title="Manual: laml">copyright-clause</a>))) (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> #\newline) ""))))

<a name="laml-xml-version"></a><a name="laml-xml-version"></a><span><a href="../xml-in-laml.html#laml-xml-version"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">laml-xml-version</span> "1.0")

<a name="laml-character-encoding"></a><a name="laml-character-encoding"></a><span><a href="../xml-in-laml.html#laml-character-encoding"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">laml-character-encoding</span> "iso-8859-1")   <span class="comment">; Alternative: "utf-8"</span><br />
<a name="xml-declaration"></a><a name="xml-declaration"></a><span><a href="../xml-in-laml.html#xml-declaration"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(xml-declaration)</span>
  (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> "&lt;?xml version=" (<a class="schemedoc-name" href="../../../../lib/man/general.html#string-it" title="Manual: general">string-it</a> <a class="applied-name" href="xml-in-laml-1.html#laml-xml-version" title="xml-in-laml">laml-xml-version</a>) 
                 " "
                 "encoding" "=" (<a class="schemedoc-name" href="../../../../lib/man/general.html#string-it" title="Manual: general">string-it</a> <a class="applied-name" href="xml-in-laml-1.html#laml-character-encoding" title="xml-in-laml">laml-character-encoding</a>) 
                 "?&gt;"))

<a name="end-laml"></a><a name="end-laml"></a><span><a href="../xml-in-laml.html#end-laml"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(end-laml)</span>
  <span class="comment">; Check for XML constraints of ID and IDREF(S) attributes</span><br />
  (<a class="applied-name" href="xml-in-laml-1.html#check-id-and-idref-attributes!" title="xml-in-laml">check-id-and-idref-attributes!</a>)

  <span class="comment">; Do the final part of link checking - first relative links</span><br />  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX338" title="R5RS Scheme form">memq</a> <a class="applied-name" href="xml-in-laml-1.html#xml-link-checking" title="xml-in-laml">xml-link-checking</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> 'all 'relative-urls))
      (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX237" title="R5RS Scheme form">&gt;</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX333" title="R5RS Scheme form">length</a> relative-url-list-for-later-checking) 0)
          (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX125" title="R5RS Scheme form">begin</a>
            (<a class="schemedoc-name" href="../../../../lib/man/general.html#display-message" title="Manual: general">display-message</a> "Checking" (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX333" title="R5RS Scheme form">length</a> relative-url-list-for-later-checking) "relative links...")
            (<a class="applied-name" href="xml-in-laml-1.html#check-relative-url-list!" title="xml-in-laml">check-relative-url-list!</a> relative-url-list-for-later-checking)
            (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX235" title="R5RS Scheme form">=</a> 0 relative-url-problem-count) (<a class="schemedoc-name" href="../../../../lib/man/general.html#display-message" title="Manual: general">display-message</a> "All relative links are OK"))
            (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> relative-url-list-for-later-checking '())
            (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> relative-url-problem-count 0)
            )
          (<a class="schemedoc-name" href="../../../../lib/man/general.html#display-message" title="Manual: general">display-message</a> "No relative links to check"))
  )

  <span class="comment">; Next absolute links</span><br />  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX338" title="R5RS Scheme form">memq</a> <a class="applied-name" href="xml-in-laml-1.html#xml-link-checking" title="xml-in-laml">xml-link-checking</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> 'all 'absolute-urls)) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX237" title="R5RS Scheme form">&gt;</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX333" title="R5RS Scheme form">length</a> absolute-url-list-for-later-checking) 0))
      (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX125" title="R5RS Scheme form">begin</a>
         (<a class="schemedoc-name" href="../../../../lib/man/general.html#display-message" title="Manual: general">display-message</a> "Checking" (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX333" title="R5RS Scheme form">length</a> absolute-url-list-for-later-checking) "absolute links...")
         (<a class="applied-name" href="xml-in-laml-1.html#check-absolute-url-list!" title="xml-in-laml">check-absolute-url-list!</a> absolute-url-list-for-later-checking)
         (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX235" title="R5RS Scheme form">=</a> 0 absolute-url-problem-count) (<a class="schemedoc-name" href="../../../../lib/man/general.html#display-message" title="Manual: general">display-message</a> "All absolute links are OK"))
         (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> absolute-url-list-for-later-checking '())
         (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> absolute-url-problem-count 0)
      )
  )
 
  (original-end-laml))
  

<div class="schemedoc-section-comment">;;; XML-in-LAML processing parameters.
;;; The variables and functions in this part control a number of general properties of XML-in-LAML processing. Some of these
;;; are generic for all XML-in-LAML languages; Others are specific to a single language.
;;; A number of the properties are related to the checking, validation, and error reporting of the XML mirror functions.
;;; .section-id processing-par</div>
<a name="laml-internal-representation"></a><a name="laml-internal-representation"></a><span><a href="../xml-in-laml.html#laml-internal-representation"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">laml-internal-representation</span> 'laml) 


<a name="xml-check-attributes?"></a><a name="xml-check-attributes?"></a><span><a href="../xml-in-laml.html#xml-check-attributes?"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">xml-check-attributes?</span> #t)

<a name="xml-validate-contents?"></a><a name="xml-validate-contents?"></a><span><a href="../xml-in-laml.html#xml-validate-contents?"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">xml-validate-contents?</span> #t)

<a name="xml-link-checking"></a><a name="xml-link-checking"></a><span><a href="../xml-in-laml.html#xml-link-checking"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">xml-link-checking</span> 'relative-urls) 

<a name="xml-check-language-overlap?"></a><a name="xml-check-language-overlap?"></a><span><a href="../xml-in-laml.html#xml-check-language-overlap?"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">xml-check-language-overlap?</span> #t)


<a name="xml-transliterate-character-data-in?"></a><a name="xml-transliterate-character-data-in?"></a><span><a href="../xml-in-laml.html#xml-transliterate-character-data-in?"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(xml-transliterate-character-data-in? language)</span>
  (<a class="applied-name" href="xml-in-laml-1.html#assert-known-xml-language" title="xml-in-laml">assert-known-xml-language</a> language "xml-transliterate-character-data-in?")
  (eval-cur-env (<a class="applied-name" href="xml-in-laml-1.html#aggregated-variable" title="xml-in-laml">aggregated-variable</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> language) "xml-transliterate-character-data?")))

<a name="set-xml-transliterate-character-data-in"></a><a name="set-xml-transliterate-character-data-in"></a><span><a href="../xml-in-laml.html#set-xml-transliterate-character-data-in"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(set-xml-transliterate-character-data-in language new-value)</span>
  (<a class="applied-name" href="xml-in-laml-1.html#assert-known-xml-language" title="xml-in-laml">assert-known-xml-language</a> language "set-xml-transliterate-character-data-in")
  (eval-cur-env (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> 'set! (<a class="applied-name" href="xml-in-laml-1.html#aggregated-variable" title="xml-in-laml">aggregated-variable</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> language) "xml-transliterate-character-data?") new-value)))

<a name="xml-char-transformation-table-in"></a><a name="xml-char-transformation-table-in"></a><span><a href="../xml-in-laml.html#xml-char-transformation-table-in"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(xml-char-transformation-table-in language)</span>
  (<a class="applied-name" href="xml-in-laml-1.html#assert-known-xml-language" title="xml-in-laml">assert-known-xml-language</a> language "xml-char-transformation-table-in")
  (eval-cur-env (<a class="applied-name" href="xml-in-laml-1.html#aggregated-variable" title="xml-in-laml">aggregated-variable</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> language) "xml-char-transformation-table")))

<a name="set-xml-char-transformation-table-in"></a><a name="set-xml-char-transformation-table-in"></a><span><a href="../xml-in-laml.html#set-xml-char-transformation-table-in"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(set-xml-char-transformation-table-in language new-value)</span>
  (<a class="applied-name" href="xml-in-laml-1.html#assert-known-xml-language" title="xml-in-laml">assert-known-xml-language</a> language "set-xml-char-transformation-table-in")
  (eval-cur-env (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> 'set! (<a class="applied-name" href="xml-in-laml-1.html#aggregated-variable" title="xml-in-laml">aggregated-variable</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> language) "xml-char-transformation-table") new-value)))



<a name="xml-non-transliteration-elements-in"></a><a name="xml-non-transliteration-elements-in"></a><span><a href="../xml-in-laml.html#xml-non-transliteration-elements-in"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(xml-non-transliteration-elements-in language)</span>
  (<a class="applied-name" href="xml-in-laml-1.html#assert-known-xml-language" title="xml-in-laml">assert-known-xml-language</a> language "xml-non-transliteration-elements-in")
  (eval-cur-env (<a class="applied-name" href="xml-in-laml-1.html#aggregated-variable" title="xml-in-laml">aggregated-variable</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> language) "xml-non-transliteration-elements")))

<a name="xml-preformatted-text-elements-in"></a><a name="xml-preformatted-text-elements-in"></a><span><a href="../xml-in-laml.html#xml-preformatted-text-elements-in"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(xml-preformatted-text-elements-in language)</span>
  (<a class="applied-name" href="xml-in-laml-1.html#assert-known-xml-language" title="xml-in-laml">assert-known-xml-language</a> language "xml-preformatted-text-elements-in")
  (eval-cur-env (<a class="applied-name" href="xml-in-laml-1.html#aggregated-variable" title="xml-in-laml">aggregated-variable</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> language) "xml-preformatted-text-elements")))



<a name="xml-error-truncation-length"></a><a name="xml-error-truncation-length"></a><span><a href="../xml-in-laml.html#xml-error-truncation-length"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">xml-error-truncation-length</span> 130)


<a name="xml-pass-default-dtd-attributes-in?"></a><a name="xml-pass-default-dtd-attributes-in?"></a><span><a href="../xml-in-laml.html#xml-pass-default-dtd-attributes-in?"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(xml-pass-default-dtd-attributes-in? language)</span>
  (<a class="applied-name" href="xml-in-laml-1.html#assert-known-xml-language" title="xml-in-laml">assert-known-xml-language</a> language "xml-pass-default-dtd-attributes-in?")
  (eval-cur-env (<a class="applied-name" href="xml-in-laml-1.html#aggregated-variable" title="xml-in-laml">aggregated-variable</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> language) "xml-pass-default-dtd-attributes?")))


<a name="xml-accept-only-string-valued-attributes-in?"></a><a name="xml-accept-only-string-valued-attributes-in?"></a><span><a href="../xml-in-laml.html#xml-accept-only-string-valued-attributes-in?"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(xml-accept-only-string-valued-attributes-in? language)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> language
      (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX125" title="R5RS Scheme form">begin</a>
        (<a class="applied-name" href="xml-in-laml-1.html#assert-known-xml-language" title="xml-in-laml">assert-known-xml-language</a> language "xml-accept-only-string-valued-attributes-in?")
        (eval-cur-env (<a class="applied-name" href="xml-in-laml-1.html#aggregated-variable" title="xml-in-laml">aggregated-variable</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> language) "xml-accept-only-string-valued-attributes?"))
      )
      #t))

<a name="set-xml-accept-only-string-valued-attributes-in"></a><a name="set-xml-accept-only-string-valued-attributes-in"></a><span><a href="../xml-in-laml.html#set-xml-accept-only-string-valued-attributes-in"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(set-xml-accept-only-string-valued-attributes-in language new-value)</span>
  (<a class="applied-name" href="xml-in-laml-1.html#assert-known-xml-language" title="xml-in-laml">assert-known-xml-language</a> language "set-xml-accept-only-string-valued-attributes-in")
  (eval-cur-env (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> 'set! (<a class="applied-name" href="xml-in-laml-1.html#aggregated-variable" title="xml-in-laml">aggregated-variable</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> language) "xml-accept-only-string-valued-attributes?") new-value)))


<a name="xml-accept-extended-contents-in?"></a><a name="xml-accept-extended-contents-in?"></a><span><a href="../xml-in-laml.html#xml-accept-extended-contents-in?"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(xml-accept-extended-contents-in? language)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> language
      (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX125" title="R5RS Scheme form">begin</a>
        (<a class="applied-name" href="xml-in-laml-1.html#assert-known-xml-language" title="xml-in-laml">assert-known-xml-language</a> language "xml-accept-extended-contents-in?")
        (eval-cur-env (<a class="applied-name" href="xml-in-laml-1.html#aggregated-variable" title="xml-in-laml">aggregated-variable</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> language) "xml-accept-extended-contents?"))
      )
      #f))

<a name="set-xml-accept-extended-contents-in"></a><a name="set-xml-accept-extended-contents-in"></a><span><a href="../xml-in-laml.html#set-xml-accept-extended-contents-in"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(set-xml-accept-extended-contents-in language new-value)</span>
  (<a class="applied-name" href="xml-in-laml-1.html#assert-known-xml-language" title="xml-in-laml">assert-known-xml-language</a> language "set-xml-accept-extended-contents-in")
  (eval-cur-env (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> 'set! (<a class="applied-name" href="xml-in-laml-1.html#aggregated-variable" title="xml-in-laml">aggregated-variable</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> language) "xml-accept-extended-contents?") new-value)))



<a name="xml-document-type-declaration-in"></a><a name="xml-document-type-declaration-in"></a><span><a href="../xml-in-laml.html#xml-document-type-declaration-in"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(xml-document-type-declaration-in language)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> language
      (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX125" title="R5RS Scheme form">begin</a>
        (<a class="applied-name" href="xml-in-laml-1.html#assert-known-xml-language" title="xml-in-laml">assert-known-xml-language</a> language "xml-document-type-declaration-in")
        (eval-cur-env (<a class="applied-name" href="xml-in-laml-1.html#aggregated-variable" title="xml-in-laml">aggregated-variable</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> language) "xml-document-type-declaration")))
      ""))


<a name="xml-represent-white-space-in?"></a><a name="xml-represent-white-space-in?"></a><span><a href="../xml-in-laml.html#xml-represent-white-space-in?"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(xml-represent-white-space-in? language)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> language
      (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX125" title="R5RS Scheme form">begin</a>
        (<a class="applied-name" href="xml-in-laml-1.html#assert-known-xml-language" title="xml-in-laml">assert-known-xml-language</a> language "xml-represent-white-space-in?")
        (eval-cur-env (<a class="applied-name" href="xml-in-laml-1.html#aggregated-variable" title="xml-in-laml">aggregated-variable</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> language) "xml-represent-white-space?"))
      )
      #t))

<a name="xml-duplicated-attribute-handling"></a><a name="xml-duplicated-attribute-handling"></a><span><a href="../xml-in-laml.html#xml-duplicated-attribute-handling"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(xml-duplicated-attribute-handling language)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> language
      (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX125" title="R5RS Scheme form">begin</a>
        (<a class="applied-name" href="xml-in-laml-1.html#assert-known-xml-language" title="xml-in-laml">assert-known-xml-language</a> language "xml-duplicated-attribute-handling")
        (eval-cur-env (<a class="applied-name" href="xml-in-laml-1.html#aggregated-variable" title="xml-in-laml">aggregated-variable</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> language) "xml-duplicated-attribute-handling"))
      )
      'keep-all))


<a name="aggregated-variable"></a><span class="comment">; Form a variable of language-string variable-string and return the symbol.</span><br /><a name="aggregated-variable"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(aggregated-variable language-string variable-string)</span>
  (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-symbol" title="Manual: general">as-symbol</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> language-string "-" variable-string)))

<a name="assert-known-xml-language"></a><span class="comment">; Assert that language is legal relative to the XML-in-LAML languages in use.
; The optional second parameter is intended to hold the operation causing the problems.
; If not, stop the program (fatal error)</span><br /><a name="assert-known-xml-language"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(assert-known-xml-language language . optional-parameter-list)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">context</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#optional-parameter" title="Manual: general">optional-parameter</a> 1 optional-parameter-list #f)))
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX346" title="R5RS Scheme form">symbol?</a> language))
      (<a class="schemedoc-name" href="../../../../lib/man/general.html#laml-error" title="Manual: general">laml-error</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> context (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> context) ":") "") "The XML-in-LAML language must be given as a symbol:" language))
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX338" title="R5RS Scheme form">memq</a> language (<a class="applied-name" href="xml-in-laml-1.html#languages-in-use" title="xml-in-laml">languages-in-use</a>)))
      (<a class="schemedoc-name" href="../../../../lib/man/general.html#laml-error" title="Manual: general">laml-error</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> context (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> context) ":" (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> #\newline)) "")
                  "Fatal error: The language" language 
                  "is not among the currently loaded XML-in-LAML languages:"
                  (<a class="schemedoc-name" href="../../../../lib/man/general.html#list-to-string" title="Manual: general">list-to-string</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> <a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> (<a class="applied-name" href="xml-in-laml-1.html#languages-in-use" title="xml-in-laml">languages-in-use</a>)) ", ")))))


<a name="xml-link-checking-map"></a><span class="comment">; A map from XML language names (symbols) to lists of url-extractor and base-url-extractor functions.</span><br /><a name="xml-link-checking-map"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">xml-link-checking-map</span> '())

<a name="set-xml-link-checking-functions"></a><a name="set-xml-link-checking-functions"></a><span><a href="../xml-in-laml.html#set-xml-link-checking-functions"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(set-xml-link-checking-functions xml-language url-extractor-function base-url-extractor-function)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> <a class="applied-name" href="xml-in-laml-1.html#xml-link-checking-map" title="xml-in-laml">xml-link-checking-map</a> 
        (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> xml-language (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> url-extractor-function base-url-extractor-function))
              <a class="applied-name" href="xml-in-laml-1.html#xml-link-checking-map" title="xml-in-laml">xml-link-checking-map</a>)))

<a name="url-extractor-of-xml-language"></a><a name="url-extractor-of-xml-language"></a><span><a href="../xml-in-laml.html#url-extractor-of-xml-language"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(url-extractor-of-xml-language xml-language)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">res</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX341" title="R5RS Scheme form">assq</a> xml-language <a class="applied-name" href="xml-in-laml-1.html#xml-link-checking-map" title="xml-in-laml">xml-link-checking-map</a>)))
    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> res
        (<a class="schemedoc-name" href="../../../../lib/man/general.html#first" title="Manual: general">first</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> res))
        #f)))

<a name="base-url-extractor-of-xml-language"></a><a name="base-url-extractor-of-xml-language"></a><span><a href="../xml-in-laml.html#base-url-extractor-of-xml-language"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(base-url-extractor-of-xml-language xml-language)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">res</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX341" title="R5RS Scheme form">assq</a> xml-language <a class="applied-name" href="xml-in-laml-1.html#xml-link-checking-map" title="xml-in-laml">xml-link-checking-map</a>)))
    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> res
        (<a class="schemedoc-name" href="../../../../lib/man/general.html#second" title="Manual: general">second</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> res))
        #f)))

<div class="schemedoc-section-comment">;;; Other Constants.
;;; .section-id other-const</div>
<a name="explicit-space"></a><a name="explicit-space"></a><span><a href="../xml-in-laml.html#explicit-space"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">explicit-space</span> #t)

<a name="explicit-space-suppress"></a><a name="explicit-space-suppress"></a><span><a href="../xml-in-laml.html#explicit-space-suppress"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">explicit-space-suppress</span> #f)

<a name="_"></a><a name="_"></a><span><a href="../xml-in-laml.html#_"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">_</span> <a class="applied-name" href="xml-in-laml-1.html#explicit-space-suppress" title="xml-in-laml">explicit-space-suppress</a>)

<a name="preferred-maximum-width"></a><a name="preferred-maximum-width"></a><span><a href="../xml-in-laml.html#preferred-maximum-width"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">preferred-maximum-width</span> 90)

<a name="indentation-delta"></a><a name="indentation-delta"></a><span><a href="../xml-in-laml.html#indentation-delta"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">indentation-delta</span> 3)

<a name="xml-always-render-white-space?"></a><a name="xml-always-render-white-space?"></a><span><a href="../xml-in-laml.html#xml-always-render-white-space?"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">xml-always-render-white-space?</span> #f)


<span class="comment">; ---------------------------------------------------------------------------------------------------</span><br /><div class="schemedoc-section-comment">;;; AST constructors and basic selector selectors.
;;; In this section we document the functions that work on abstract syntax trees (ASTs).
;;; More specifically, we describe the AST constructor function and the most basic functions that
;;; select a constituent of an AST. An AST copy function is also included in this section.
;;; Abstract syntax trees make up the internal representation of XML documents in LAML.
;;; All XML mirror functions return abstract syntax trees, and as such they can be thought as
;;; convenient, high level AST constructors. Notice that the implementation of the functions in this
;;; section depend heavily on the value of the variable laml-internal-representation.
;;; .section-id ast-cons-sel</div>
<a name="laml-make-ast"></a><span class="comment">; ----------------------------------------------------------------------------------------
; The original LAML internal representation.</span><br />
<a name="laml-make-ast"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(laml-make-ast element-name contents attributes kind language . optional-parameter-list)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">internal-attributes</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#optional-parameter" title="Manual: general">optional-parameter</a> 1 optional-parameter-list '()))
       (<span class="local-name-binding">subtrees</span> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> contents) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> contents))
                       ((<a class="applied-name" href="xml-in-laml-1.html#cdata?" title="xml-in-laml">cdata?</a> contents) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> contents))
                       ((<a class="applied-name" href="xml-in-laml-1.html#forced-white-space?" title="xml-in-laml">forced-white-space?</a> contents) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> contents))
                       ((<a class="applied-name" href="xml-in-laml-1.html#delayed-procedural-contents-element?" title="xml-in-laml">delayed-procedural-contents-element?</a> contents) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> contents))
                       ((<a class="applied-name" href="xml-in-laml-1.html#char-ref?" title="xml-in-laml">char-ref?</a> contents) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> contents))
                       ((<a class="applied-name" href="xml-in-laml-1.html#xml-comment?" title="xml-in-laml">xml-comment?</a> contents) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> contents))
                       ((<a class="applied-name" href="xml-in-laml-1.html#cdata-section?" title="xml-in-laml">cdata-section?</a> contents) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> contents))
                       ((<a class="applied-name" href="xml-in-laml-1.html#processing-instruction?" title="xml-in-laml">processing-instruction?</a> contents) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> contents))
                       ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX331" title="R5RS Scheme form">list?</a> contents) contents)
                       (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#laml-error" title="Manual: general">laml-error</a> "make-ast: Contents must be a single content item or a list of these: " 
                                         (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> contents))))))
  (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> 'ast (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> element-name) subtrees attributes (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-symbol" title="Manual: general">as-symbol</a> kind) (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-symbol" title="Manual: general">as-symbol</a> language) internal-attributes)))


<a name="laml-ast-element-name"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">laml-ast-element-name</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#make-selector-function" title="Manual: general">make-selector-function</a> 2 "ast-element-name"))

<a name="laml-ast-subtrees"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">laml-ast-subtrees</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#make-selector-function" title="Manual: general">make-selector-function</a> 3 "ast-subtrees"))

<a name="laml-ast-attributes"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">laml-ast-attributes</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#make-selector-function" title="Manual: general">make-selector-function</a> 4 "ast-attributes"))

<a name="laml-ast-kind"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">laml-ast-kind</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#make-selector-function" title="Manual: general">make-selector-function</a> 5 "ast-kind"))

<a name="laml-ast-language"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">laml-ast-language</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#make-selector-function" title="Manual: general">make-selector-function</a> 6 "ast-language"))

<a name="laml-ast-internal-attributes"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">laml-ast-internal-attributes</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#make-selector-function" title="Manual: general">make-selector-function</a> 7 "ast-internal-attributes"))


<a name="sxml-make-ast"></a><span class="comment">; ----------------------------------------------------------------------------------------
; The SXML internal representation.</span><br />
<a name="sxml-make-ast"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(sxml-make-ast element-name contents attributes-proplist kind language . optional-parameter-list)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">internal-attributes</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#optional-parameter" title="Manual: general">optional-parameter</a> 1 optional-parameter-list '()))
       (<span class="local-name-binding">subtrees</span> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> contents) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> contents))
                       ((<a class="applied-name" href="xml-in-laml-1.html#cdata?" title="xml-in-laml">cdata?</a> contents) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> contents))
                       ((<a class="applied-name" href="xml-in-laml-1.html#forced-white-space?" title="xml-in-laml">forced-white-space?</a> contents) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> contents))
                       ((<a class="applied-name" href="xml-in-laml-1.html#delayed-procedural-contents-element?" title="xml-in-laml">delayed-procedural-contents-element?</a> contents) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> contents))
                       ((<a class="applied-name" href="xml-in-laml-1.html#char-ref?" title="xml-in-laml">char-ref?</a> contents) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> contents))
                       ((<a class="applied-name" href="xml-in-laml-1.html#xml-comment?" title="xml-in-laml">xml-comment?</a> contents) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> contents))
                       ((<a class="applied-name" href="xml-in-laml-1.html#cdata-section?" title="xml-in-laml">cdata-section?</a> contents) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> contents))
                       ((<a class="applied-name" href="xml-in-laml-1.html#processing-instruction?" title="xml-in-laml">processing-instruction?</a> contents) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> contents))
                       ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX331" title="R5RS Scheme form">list?</a> contents) contents)
                       (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#laml-error" title="Manual: general">laml-error</a> "make-ast: Contents must be ast, cdata, forced white space, or a list of these: " 
                                         (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> contents))))))
  (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-symbol" title="Manual: general">as-symbol</a> element-name)
   (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="applied-name" href="xml-in-laml-1.html#sxml-attributes" title="xml-in-laml">sxml-attributes</a> attributes-proplist)
    (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="applied-name" href="xml-in-laml-1.html#sxml-aux-list" title="xml-in-laml">sxml-aux-list</a> kind language)
      subtrees)))))


<a name="sxml-attributes"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(sxml-attributes attributes-proplist)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">attributes-alist</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#propertylist-to-alist" title="Manual: general">propertylist-to-alist</a> attributes-proplist)))
  (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> '@ 
    (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a>
     (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">aname-aval-pair</span>) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-symbol" title="Manual: general">as-symbol</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> aname-aval-pair)) (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> aname-aval-pair))))
     attributes-alist))))

<a name="sxml-aux-list"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(sxml-aux-list kind language)</span>
  (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> '@@
   (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> '*NAMESPACES*)
    (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> 'element-kind kind)
     (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> 'language language) '())))))

<a name="sxml-ast-element-name"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">sxml-ast-element-name</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#compose" title="Manual: general">compose</a> <a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> <a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a>))

<a name="sxml-ast-subtrees"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(sxml-ast-subtrees ast)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> ast))
           '())
       ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="applied-name" href="xml-in-laml-1.html#sxml-attribute-or-aux-related?" title="xml-in-laml">sxml-attribute-or-aux-related?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cadr</a> ast)))   <span class="comment">; at least two elements</span><br />          (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> ast))
       ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cddr</a> ast))                                  
           '())
      ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="applied-name" href="xml-in-laml-1.html#sxml-attribute-or-aux-related?" title="xml-in-laml">sxml-attribute-or-aux-related?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">caddr</a> ast)))   <span class="comment">; at least three elements</span><br />          (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cddr</a> ast))
       (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cdddr</a> ast))))

<a name="sxml-attribute-or-aux-related?"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(sxml-attribute-or-aux-related? x)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX118" title="R5RS Scheme form">or</a> (<a class="applied-name" href="xml-in-laml-1.html#sxml-attribute-related?" title="xml-in-laml">sxml-attribute-related?</a> x) (<a class="applied-name" href="xml-in-laml-1.html#sxml-aux-related?" title="xml-in-laml">sxml-aux-related?</a> x)))

<a name="sxml-attribute-related?"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(sxml-attribute-related? x)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX319" title="R5RS Scheme form">pair?</a> x) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> x) '@)))

<a name="sxml-aux-related?"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(sxml-aux-related? x)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX319" title="R5RS Scheme form">pair?</a> x) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> x) '@@)))


<a name="sxml-ast-attributes"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(sxml-ast-attributes ast)</span>
  <span class="comment">; if there are attributes in x, it will have to be the second element.</span><br />  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> ast))
      '()
      (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="applied-name" href="xml-in-laml-1.html#sxml-attribute-related?" title="xml-in-laml">sxml-attribute-related?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cadr</a> ast))
          (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">attribute-pair-list</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cadr</a> ast))))
            (<a class="schemedoc-name" href="../../../../lib/man/general.html#flatten" title="Manual: general">flatten</a> attribute-pair-list))
          '())))

<a name="sxml-ast-kind"></a><span class="comment">; Return the kind, single or double of ast.
; This function first attempt to extract the information from the aux list of the AST node.
; Second, the function tries to look up the information in the content model of XML element.
; If all this fails, it returns double.</span><br /><a name="sxml-ast-kind"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(sxml-ast-kind ast)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">aux-constituent</span> (<a class="applied-name" href="xml-in-laml-1.html#sxml-aux-constituent-of-ast" title="xml-in-laml">sxml-aux-constituent-of-ast</a> ast))) <span class="comment">; a structure of the form (X (*NAMESPACES*) ...) where X is two at characters</span><br />    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> aux-constituent
        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">candidate</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#defaulted-get" title="Manual: general">defaulted-get</a> 'element-kind (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> aux-constituent) #f)))
          (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> candidate
              (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> candidate)
              (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">aux-language</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#defaulted-get" title="Manual: general">defaulted-get</a> 'language (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> aux-constituent) #f))
                     (<span class="local-name-binding">language</span> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> aux-language aux-language (<a class="applied-name" href="xml-in-laml-1.html#ast-language" title="xml-in-laml">ast-language</a> ast)))
                    )
                (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> language
                    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">content-model</span> (<a class="applied-name" href="xml-in-laml-1.html#content-model-of" title="xml-in-laml">content-model-of</a> (<a class="applied-name" href="xml-in-laml-1.html#ast-element-name" title="xml-in-laml">ast-element-name</a> ast) language)))
                      (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> content-model 'empty) 'single 'double))
                    'double))))
        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">language</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-language" title="xml-in-laml">ast-language</a> ast)))
          (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> language
              (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">content-model</span> (<a class="applied-name" href="xml-in-laml-1.html#content-model-of" title="xml-in-laml">content-model-of</a> (<a class="applied-name" href="xml-in-laml-1.html#ast-element-name" title="xml-in-laml">ast-element-name</a> ast) language)))
                (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> content-model 'empty) 'single 'double))
              'double)))))

<a name="sxml-ast-language"></a><span class="comment">; Return the XML language used by AST.
; If no registration exists in the SXML aux list, return the earliest registered xml language of the
; current LAML document (corresponding the language whose mirror is loaded first).</span><br /><a name="sxml-ast-language"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(sxml-ast-language ast)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">default-language</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#last" title="Manual: general">last</a> (<a class="applied-name" href="xml-in-laml-1.html#languages-in-use" title="xml-in-laml">languages-in-use</a>)))
         (<span class="local-name-binding">aux-constituent</span> (<a class="applied-name" href="xml-in-laml-1.html#sxml-aux-constituent-of-ast" title="xml-in-laml">sxml-aux-constituent-of-ast</a> ast))  <span class="comment">; a structure of the form (X (*NAMESPACES*) ...) where X is two at characters</span><br />        )
    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> aux-constituent
        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">candidate</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#defaulted-get" title="Manual: general">defaulted-get</a> 'language (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> aux-constituent) #f)))
          (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> candidate
              (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> candidate)
              default-language
          ))
        default-language)))

<a name="sxml-ast-internal-attributes"></a><span class="comment">; Return the internal attributes of AST.</span><br /><a name="sxml-ast-internal-attributes"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(sxml-ast-internal-attributes ast)</span>
  (<a class="schemedoc-name" href="../../../../lib/man/general.html#laml-error" title="Manual: general">laml-error</a> "sxml-ast-internal-attributes: Not yet supported"))

<a name="sxml-aux-constituent-of-ast"></a><span class="comment">; Return the aux constituent of ast (either second or third element), 
; or #f if it does not exist.</span><br /><a name="sxml-aux-constituent-of-ast"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(sxml-aux-constituent-of-ast ast)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> ast))
           #f)
        ((<a class="applied-name" href="xml-in-laml-1.html#sxml-aux-related?" title="xml-in-laml">sxml-aux-related?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cadr</a> ast))   <span class="comment">; at least two elements</span><br />           (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cadr</a> ast))
        ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cddr</a> ast))
           #f)
        ((<a class="applied-name" href="xml-in-laml-1.html#sxml-aux-related?" title="xml-in-laml">sxml-aux-related?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">caddr</a> ast))  <span class="comment">; at least three elements</span><br />          (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">caddr</a> ast))
        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> #f)))


<span class="comment">; ----------------------------------------------------------------------------------------</span><br />

<a name="check-ast-constituents?"></a><span class="comment">; A boolean variable that controls whether or not we check the internal soundness of ASTs.
; If the basic mirror is used directly, it makes good sense to set this variable to #t.
; Else we recommend a #f value.</span><br /><a name="check-ast-constituents?"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">check-ast-constituents?</span> #f)

<a name="make-ast"></a><a name="make-ast"></a><span><a href="../xml-in-laml.html#make-ast"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">make-ast</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> <a class="applied-name" href="xml-in-laml-1.html#laml-internal-representation" title="xml-in-laml">laml-internal-representation</a> 'laml) <a class="applied-name" href="xml-in-laml-1.html#laml-make-ast" title="xml-in-laml">laml-make-ast</a>)
        ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> <a class="applied-name" href="xml-in-laml-1.html#laml-internal-representation" title="xml-in-laml">laml-internal-representation</a> 'sxml) <a class="applied-name" href="xml-in-laml-1.html#sxml-make-ast" title="xml-in-laml">sxml-make-ast</a>)
        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#laml-error" title="Manual: general">laml-error</a> "make-ast: Unknown value of laml-internal-representation:" <a class="applied-name" href="xml-in-laml-1.html#laml-internal-representation" title="xml-in-laml">laml-internal-representation</a>))))



<span class="comment">; AST selectors.</span><br />
<a name="ast-element-name"></a><a name="ast-element-name"></a><span><a href="../xml-in-laml.html#ast-element-name"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">ast-element-name</span> 
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> <a class="applied-name" href="xml-in-laml-1.html#laml-internal-representation" title="xml-in-laml">laml-internal-representation</a> 'laml) <a class="applied-name" href="xml-in-laml-1.html#laml-ast-element-name" title="xml-in-laml">laml-ast-element-name</a>)
        ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> <a class="applied-name" href="xml-in-laml-1.html#laml-internal-representation" title="xml-in-laml">laml-internal-representation</a> 'sxml) <a class="applied-name" href="xml-in-laml-1.html#sxml-ast-element-name" title="xml-in-laml">sxml-ast-element-name</a>)
        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#laml-error" title="Manual: general">laml-error</a> "ast-element-name: Unknown value of laml-internal-representation:" <a class="applied-name" href="xml-in-laml-1.html#laml-internal-representation" title="xml-in-laml">laml-internal-representation</a>))))

<a name="ast-subtrees"></a><a name="ast-subtrees"></a><span><a href="../xml-in-laml.html#ast-subtrees"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">ast-subtrees</span> 
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> <a class="applied-name" href="xml-in-laml-1.html#laml-internal-representation" title="xml-in-laml">laml-internal-representation</a> 'laml) <a class="applied-name" href="xml-in-laml-1.html#laml-ast-subtrees" title="xml-in-laml">laml-ast-subtrees</a> )
        ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> <a class="applied-name" href="xml-in-laml-1.html#laml-internal-representation" title="xml-in-laml">laml-internal-representation</a> 'sxml) <a class="applied-name" href="xml-in-laml-1.html#sxml-ast-subtrees" title="xml-in-laml">sxml-ast-subtrees</a> )
        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#laml-error" title="Manual: general">laml-error</a> "ast-subtrees : Unknown value of laml-internal-representation:" <a class="applied-name" href="xml-in-laml-1.html#laml-internal-representation" title="xml-in-laml">laml-internal-representation</a>))))


<a name="ast-attributes"></a><a name="ast-attributes"></a><span><a href="../xml-in-laml.html#ast-attributes"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">ast-attributes</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> <a class="applied-name" href="xml-in-laml-1.html#laml-internal-representation" title="xml-in-laml">laml-internal-representation</a> 'laml) <a class="applied-name" href="xml-in-laml-1.html#laml-ast-attributes" title="xml-in-laml">laml-ast-attributes</a>)
        ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> <a class="applied-name" href="xml-in-laml-1.html#laml-internal-representation" title="xml-in-laml">laml-internal-representation</a> 'sxml) <a class="applied-name" href="xml-in-laml-1.html#sxml-ast-attributes" title="xml-in-laml">sxml-ast-attributes</a>)
        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#laml-error" title="Manual: general">laml-error</a> "ast-attributes : Unknown value of laml-internal-representation:" <a class="applied-name" href="xml-in-laml-1.html#laml-internal-representation" title="xml-in-laml">laml-internal-representation</a>))))


<a name="ast-kind"></a><a name="ast-kind"></a><span><a href="../xml-in-laml.html#ast-kind"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">ast-kind</span> 
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> <a class="applied-name" href="xml-in-laml-1.html#laml-internal-representation" title="xml-in-laml">laml-internal-representation</a> 'laml) <a class="applied-name" href="xml-in-laml-1.html#laml-ast-kind" title="xml-in-laml">laml-ast-kind</a>)
        ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> <a class="applied-name" href="xml-in-laml-1.html#laml-internal-representation" title="xml-in-laml">laml-internal-representation</a> 'sxml) <a class="applied-name" href="xml-in-laml-1.html#sxml-ast-kind" title="xml-in-laml">sxml-ast-kind</a>)
        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#laml-error" title="Manual: general">laml-error</a> "ast-kind : Unknown value of laml-internal-representation:" <a class="applied-name" href="xml-in-laml-1.html#laml-internal-representation" title="xml-in-laml">laml-internal-representation</a>))))


<a name="ast-language"></a><a name="ast-language"></a><span><a href="../xml-in-laml.html#ast-language"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">ast-language</span> 
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> <a class="applied-name" href="xml-in-laml-1.html#laml-internal-representation" title="xml-in-laml">laml-internal-representation</a> 'laml) <a class="applied-name" href="xml-in-laml-1.html#laml-ast-language" title="xml-in-laml">laml-ast-language</a>)
        ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> <a class="applied-name" href="xml-in-laml-1.html#laml-internal-representation" title="xml-in-laml">laml-internal-representation</a> 'sxml) <a class="applied-name" href="xml-in-laml-1.html#sxml-ast-language" title="xml-in-laml">sxml-ast-language</a>)
        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#laml-error" title="Manual: general">laml-error</a> "ast-language  : Unknown value of laml-internal-representation:" <a class="applied-name" href="xml-in-laml-1.html#laml-internal-representation" title="xml-in-laml">laml-internal-representation</a>))))

<a name="ast-internal-attributes"></a><a name="ast-internal-attributes"></a><span><a href="../xml-in-laml.html#ast-internal-attributes"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">ast-internal-attributes</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> <a class="applied-name" href="xml-in-laml-1.html#laml-internal-representation" title="xml-in-laml">laml-internal-representation</a> 'laml) <a class="applied-name" href="xml-in-laml-1.html#laml-ast-internal-attributes" title="xml-in-laml">laml-ast-internal-attributes</a>)
        ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> <a class="applied-name" href="xml-in-laml-1.html#laml-internal-representation" title="xml-in-laml">laml-internal-representation</a> 'sxml) <a class="applied-name" href="xml-in-laml-1.html#sxml-ast-internal-attributes" title="xml-in-laml">sxml-ast-internal-attributes</a>)
        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#laml-error" title="Manual: general">laml-error</a> "ast-internal-attributes : Unknown value of laml-internal-representation:" <a class="applied-name" href="xml-in-laml-1.html#laml-internal-representation" title="xml-in-laml">laml-internal-representation</a>))))


<a name="ast-copy"></a><a name="ast-copy"></a><span><a href="../xml-in-laml.html#ast-copy"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(ast-copy ast)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> ast)
      (<a class="applied-name" href="xml-in-laml-1.html#make-ast" title="xml-in-laml">make-ast</a> (<a class="applied-name" href="xml-in-laml-1.html#ast-element-name" title="xml-in-laml">ast-element-name</a> ast) 
                (<a class="applied-name" href="xml-in-laml-1.html#ast-subtrees" title="xml-in-laml">ast-subtrees</a> ast) 
                (<a class="schemedoc-name" href="../../../../lib/man/general.html#shallow-copy-list" title="Manual: general">shallow-copy-list</a> (<a class="applied-name" href="xml-in-laml-1.html#ast-attributes" title="xml-in-laml">ast-attributes</a> ast))
                (<a class="applied-name" href="xml-in-laml-1.html#ast-kind" title="xml-in-laml">ast-kind</a> ast)
                (<a class="applied-name" href="xml-in-laml-1.html#ast-language" title="xml-in-laml">ast-language</a> ast)
                (<a class="schemedoc-name" href="../../../../lib/man/general.html#shallow-copy-list" title="Manual: general">shallow-copy-list</a> (<a class="applied-name" href="xml-in-laml-1.html#ast-internal-attributes" title="xml-in-laml">ast-internal-attributes</a> ast)))
      ast))

<a name="free-single-element"></a><a name="free-single-element"></a><span><a href="../xml-in-laml.html#free-single-element"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(free-single-element element-name)</span>
  (<a class="applied-name" href="xml-in-laml-1.html#xml-in-laml-positional-abstraction" title="xml-in-laml">xml-in-laml-positional-abstraction</a> 1 0
    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">xml-language</span> <span class="local-name-binding">cont</span> <span class="local-name-binding">attr</span>)
       (<a class="applied-name" href="xml-in-laml-1.html#make-ast" title="xml-in-laml">make-ast</a> element-name '() attr 'single xml-language))))

<a name="free-double-element"></a><a name="free-double-element"></a><span><a href="../xml-in-laml.html#free-double-element"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(free-double-element element-name)</span>
  (<a class="applied-name" href="xml-in-laml-1.html#xml-in-laml-positional-abstraction" title="xml-in-laml">xml-in-laml-positional-abstraction</a> 1 0
    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">xml-language</span> <span class="local-name-binding">cont</span> <span class="local-name-binding">attr</span>)
       (<a class="applied-name" href="xml-in-laml-1.html#make-ast" title="xml-in-laml">make-ast</a> element-name cont attr 'double xml-language))))


<div class="schemedoc-section-comment">;;; High-level AST selector functions.
;;; In this section we describe a set of more elaborate functions that access the constituents of an AST.
;;; In many contexts, the functions in this section are more convenient than the basic selector functions
;;; from the previous section.
;;; .section-id highlevel-ast-sel</div>
<a name="ast-subtree"></a><a name="ast-subtree"></a><span><a href="../xml-in-laml.html#ast-subtree"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(ast-subtree ast el-name . optional-parameter-list)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">n</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#optional-parameter" title="Manual: general">optional-parameter</a> 1 optional-parameter-list 1))
       (<span class="local-name-binding">subtrees</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-subtrees" title="xml-in-laml">ast-subtrees</a> ast)))
  (<a class="applied-name" href="xml-in-laml-1.html#sub-ast-1" title="xml-in-laml">sub-ast-1</a> subtrees (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> el-name) n)))

<a name="sub-ast-1"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(sub-ast-1 subtree-list el-name n)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> subtree-list) #f)
       ((<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> subtree-list)) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX200" title="R5RS Scheme form">equal?</a> el-name (<a class="applied-name" href="xml-in-laml-1.html#ast-element-name" title="xml-in-laml">ast-element-name</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> subtree-list)))) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX235" title="R5RS Scheme form">=</a> n 1))
         (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> subtree-list))
       ((<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> subtree-list)) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX200" title="R5RS Scheme form">equal?</a> el-name (<a class="applied-name" href="xml-in-laml-1.html#ast-element-name" title="xml-in-laml">ast-element-name</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> subtree-list)))) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX237" title="R5RS Scheme form">&gt;</a> n 1))
         (<a class="applied-name" href="xml-in-laml-1.html#sub-ast-1" title="xml-in-laml">sub-ast-1</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> subtree-list) el-name (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> n 1)))
       (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="applied-name" href="xml-in-laml-1.html#sub-ast-1" title="xml-in-laml">sub-ast-1</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> subtree-list) el-name n))))

        

<a name="ast-attribute"></a><a name="ast-attribute"></a><span><a href="../xml-in-laml.html#ast-attribute"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(ast-attribute ast name . optional-parameter-list)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">default-attribute-value</span> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> optional-parameter-list) #f (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> optional-parameter-list)))
        (<span class="local-name-binding">attr-list</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-attributes" title="xml-in-laml">ast-attributes</a> ast)))
    (<a class="schemedoc-name" href="../../../../lib/man/general.html#defaulted-get-prop" title="Manual: general">defaulted-get-prop</a> name attr-list default-attribute-value)))

<a name="has-ast-attribute?"></a><a name="has-ast-attribute?"></a><span><a href="../xml-in-laml.html#has-ast-attribute?"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(has-ast-attribute? ast name)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">attr-list</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-attributes" title="xml-in-laml">ast-attributes</a> ast)))
    (<a class="schemedoc-name" href="../../../../lib/man/general.html#turn-into-boolean" title="Manual: general">turn-into-boolean</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#find-in-property-list" title="Manual: general">find-in-property-list</a> name attr-list))))

<a name="attribute-getter"></a><a name="attribute-getter"></a><span><a href="../xml-in-laml.html#attribute-getter"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(attribute-getter attribute-name . optional-parameter-list)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">default-value</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#optional-parameter" title="Manual: general">optional-parameter</a> 1 optional-parameter-list #f)))
   (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> default-value
    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">ast</span>)
      (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">attribute-plist</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-attributes" title="xml-in-laml">ast-attributes</a> ast)))
        (<a class="schemedoc-name" href="../../../../lib/man/general.html#defaulted-get-prop" title="Manual: general">defaulted-get-prop</a> attribute-name attribute-plist default-value)))
    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">ast</span>)
      (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">attribute-plist</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-attributes" title="xml-in-laml">ast-attributes</a> ast)))
        (<a class="schemedoc-name" href="../../../../lib/man/general.html#get-prop" title="Manual: general">get-prop</a> attribute-name attribute-plist))))))



<a name="aggregated-ast-cdata-contents"></a><span class="comment">; Return a string of the aggregated CDATA contents of ast.
; White space markers are taken into account, but ast subtrees of ast are ignored in this aggregation.
; All other AST constituents are ignored.
; .internal-references "alias" "ast-text"</span><br /><a name="aggregated-ast-cdata-contents"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(aggregated-ast-cdata-contents ast)</span>
  (<a class="applied-name" href="xml-in-laml-1.html#aggregated-ast-cdata-contents-1" title="xml-in-laml">aggregated-ast-cdata-contents-1</a> (<a class="applied-name" href="xml-in-laml-1.html#ast-subtrees" title="xml-in-laml">ast-subtrees</a> ast) ""))

<a name="aggregated-ast-cdata-contents-1"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(aggregated-ast-cdata-contents-1 contents-list res)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> contents-list) res)
        ((<a class="applied-name" href="xml-in-laml-1.html#cdata?" title="xml-in-laml">cdata?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> contents-list)) 
           (<a class="applied-name" href="xml-in-laml-1.html#aggregated-ast-cdata-contents-1" title="xml-in-laml">aggregated-ast-cdata-contents-1</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> contents-list) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> res (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> contents-list))))
        ((<a class="applied-name" href="xml-in-laml-1.html#forced-white-space?" title="xml-in-laml">forced-white-space?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> contents-list)) (<a class="applied-name" href="xml-in-laml-1.html#aggregated-ast-cdata-contents-1" title="xml-in-laml">aggregated-ast-cdata-contents-1</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> contents-list) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> res " ")))
        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="applied-name" href="xml-in-laml-1.html#aggregated-ast-cdata-contents-1" title="xml-in-laml">aggregated-ast-cdata-contents-1</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> contents-list) res))))

<a name="aggregated-ast-cdata-contents-deep"></a><span class="comment">; Return a string of the aggregated CDATA contents of ast.
; White space markers are taken into account, and text from ast subtrees does also contribute recursively. 
; All other AST constituents are ignored.
; .internal-references "alias" "ast-text-deep"</span><br /><a name="aggregated-ast-cdata-contents-deep"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(aggregated-ast-cdata-contents-deep ast)</span>
  (<a class="applied-name" href="xml-in-laml-1.html#aggregated-ast-cdata-contents-deep-1" title="xml-in-laml">aggregated-ast-cdata-contents-deep-1</a> (<a class="applied-name" href="xml-in-laml-1.html#ast-subtrees" title="xml-in-laml">ast-subtrees</a> ast) ""))

<a name="aggregated-ast-cdata-contents-deep-1"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(aggregated-ast-cdata-contents-deep-1 contents-list res)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> contents-list) res)
        ((<a class="applied-name" href="xml-in-laml-1.html#cdata?" title="xml-in-laml">cdata?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> contents-list)) 
           (<a class="applied-name" href="xml-in-laml-1.html#aggregated-ast-cdata-contents-deep-1" title="xml-in-laml">aggregated-ast-cdata-contents-deep-1</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> contents-list) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> res (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> contents-list))))
        ((<a class="applied-name" href="xml-in-laml-1.html#forced-white-space?" title="xml-in-laml">forced-white-space?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> contents-list)) (<a class="applied-name" href="xml-in-laml-1.html#aggregated-ast-cdata-contents-deep-1" title="xml-in-laml">aggregated-ast-cdata-contents-deep-1</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> contents-list) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> res " ")))
        ((<a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> contents-list)) 
           (<a class="applied-name" href="xml-in-laml-1.html#aggregated-ast-cdata-contents-deep-1" title="xml-in-laml">aggregated-ast-cdata-contents-deep-1</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> contents-list) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> res (<a class="applied-name" href="xml-in-laml-1.html#aggregated-ast-cdata-contents-deep" title="xml-in-laml">aggregated-ast-cdata-contents-deep</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> contents-list)))))
        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="applied-name" href="xml-in-laml-1.html#aggregated-ast-cdata-contents-deep-1" title="xml-in-laml">aggregated-ast-cdata-contents-deep-1</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> contents-list) res))))

<a name="ast-text"></a><a name="ast-text"></a><span><a href="../xml-in-laml.html#ast-text"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">ast-text</span> <a class="applied-name" href="xml-in-laml-1.html#aggregated-ast-cdata-contents" title="xml-in-laml">aggregated-ast-cdata-contents</a>)

<a name="ast-text-deep"></a><a name="ast-text-deep"></a><span><a href="../xml-in-laml.html#ast-text-deep"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">ast-text-deep</span> <a class="applied-name" href="xml-in-laml-1.html#aggregated-ast-cdata-contents-deep" title="xml-in-laml">aggregated-ast-cdata-contents-deep</a>)

<a name="ast-internal-attribute"></a><a name="ast-internal-attribute"></a><span><a href="../xml-in-laml.html#ast-internal-attribute"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(ast-internal-attribute ast name . optional-parameter-list)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">default-attribute-value</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#optional-parameter" title="Manual: general">optional-parameter</a> 1 optional-parameter-list #f)))
   (<a class="schemedoc-name" href="../../../../lib/man/general.html#defaulted-get-prop" title="Manual: general">defaulted-get-prop</a> name (<a class="applied-name" href="xml-in-laml-1.html#ast-internal-attributes" title="xml-in-laml">ast-internal-attributes</a> ast) default-attribute-value)))

<a name="has-internal-ast-attribute?"></a><a name="has-internal-ast-attribute?"></a><span><a href="../xml-in-laml.html#has-internal-ast-attribute?"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(has-internal-ast-attribute? ast name)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">internal-attr-list</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-internal-attributes" title="xml-in-laml">ast-internal-attributes</a> ast)))
    (<a class="schemedoc-name" href="../../../../lib/man/general.html#turn-into-boolean" title="Manual: general">turn-into-boolean</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#find-in-property-list" title="Manual: general">find-in-property-list</a> name internal-attr-list))))

<a name="selected-internal-attributes"></a><a name="selected-internal-attributes"></a><span><a href="../xml-in-laml.html#selected-internal-attributes"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(selected-internal-attributes ast prefix)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">all-attributes</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-internal-attributes" title="xml-in-laml">ast-internal-attributes</a> ast)))
    (<a class="applied-name" href="xml-in-laml-1.html#selected-attributes-in" title="xml-in-laml">selected-attributes-in</a> all-attributes prefix)))

<a name="selected-attributes-in"></a><span class="comment">; Helping function of selected-internal-attributes. 
; As a precondition, assume that attribute-prop-list is in fact a property list (has an even number of elements).</span><br /><a name="selected-attributes-in"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(selected-attributes-in attribute-prop-list prefix)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> attribute-prop-list) '())
        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a>
           (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">key</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#first" title="Manual: general">first</a> attribute-prop-list)))
                 (<span class="local-name-binding">val</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#second" title="Manual: general">second</a> attribute-prop-list)))
             (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#looking-at-substring?" title="Manual: general">looking-at-substring?</a> key 0 prefix)
                 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">new-key</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-symbol" title="Manual: general">as-symbol</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX391" title="R5RS Scheme form">substring</a> key (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX378" title="R5RS Scheme form">string-length</a> prefix) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX378" title="R5RS Scheme form">string-length</a> key) ))))
                    (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> new-key (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> val (<a class="applied-name" href="xml-in-laml-1.html#selected-attributes-in" title="xml-in-laml">selected-attributes-in</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cddr</a> attribute-prop-list) prefix))))
                 (<a class="applied-name" href="xml-in-laml-1.html#selected-attributes-in" title="xml-in-laml">selected-attributes-in</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cddr</a> attribute-prop-list) prefix))))))

<div class="schemedoc-section-comment">;;; AST Mutators.
;;; Both the attributes and the internal attributes of an AST can be mutated imperatively.
;;; In this section you will find procedures for attribute mutation.
;;; The name of the procedures include an exclamation mark to emphasize their imperative nature.
;;; Don't use them if you do not really need them!
;;; In addition we provide a functional attribute mutator called copy-ast-mutate-attributes.
;;; .section-id ast-mutators</div>
<a name="copy-ast-mutate-attributes"></a><a name="copy-ast-mutate-attributes"></a><span><a href="../xml-in-laml.html#copy-ast-mutate-attributes"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(copy-ast-mutate-attributes ast . new-attributes)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">new-attributes-1</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#alist-to-propertylist" title="Manual: general">alist-to-propertylist</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">pair</span>) 
                                                       (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> pair) (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> pair))))
                                                     (<a class="schemedoc-name" href="../../../../lib/man/general.html#propertylist-to-alist" title="Manual: general">propertylist-to-alist</a> new-attributes)))))
  (<a class="applied-name" href="xml-in-laml-1.html#make-ast" title="xml-in-laml">make-ast</a> (<a class="applied-name" href="xml-in-laml-1.html#ast-element-name" title="xml-in-laml">ast-element-name</a> ast) 
            (<a class="applied-name" href="xml-in-laml-1.html#ast-subtrees" title="xml-in-laml">ast-subtrees</a> ast) 
            (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX334" title="R5RS Scheme form">append</a> new-attributes-1 (<a class="schemedoc-name" href="../../../../lib/man/general.html#but-props" title="Manual: general">but-props</a> (<a class="applied-name" href="xml-in-laml-1.html#ast-attributes" title="xml-in-laml">ast-attributes</a> ast) (<a class="schemedoc-name" href="../../../../lib/man/general.html#every-second-element" title="Manual: general">every-second-element</a> new-attributes)))
            (<a class="applied-name" href="xml-in-laml-1.html#ast-kind" title="xml-in-laml">ast-kind</a> ast)
            (<a class="applied-name" href="xml-in-laml-1.html#ast-language" title="xml-in-laml">ast-language</a> ast)
            (<a class="applied-name" href="xml-in-laml-1.html#ast-internal-attributes" title="xml-in-laml">ast-internal-attributes</a> ast))))

<a name="set-internal-ast-attributes!"></a><a name="set-internal-ast-attributes!"></a><span><a href="../xml-in-laml.html#set-internal-ast-attributes!"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(set-internal-ast-attributes! ast prop-list)</span>
  (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX323" title="R5RS Scheme form">set-car!</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX336" title="R5RS Scheme form">list-tail</a> ast 6) prop-list))

<a name="set-ast-attributes!"></a><a name="set-ast-attributes!"></a><span><a href="../xml-in-laml.html#set-ast-attributes!"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(set-ast-attributes! ast prop-list)</span>
  (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX323" title="R5RS Scheme form">set-car!</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX336" title="R5RS Scheme form">list-tail</a> ast 3) prop-list))

<a name="set-ast-attribute!"></a><a name="set-ast-attribute!"></a><span><a href="../xml-in-laml.html#set-ast-attribute!"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(set-ast-attribute! ast name value)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">attr-list</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-attributes" title="xml-in-laml">ast-attributes</a> ast))
         (<span class="local-name-binding">p-list-section</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#find-in-property-list" title="Manual: general">find-in-property-list</a> name attr-list))
        )
    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> p-list-section
        (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX323" title="R5RS Scheme form">set-car!</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> p-list-section) value)
        (<a class="applied-name" href="xml-in-laml-1.html#set-ast-attributes!" title="xml-in-laml">set-ast-attributes!</a> ast (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> name (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> value attr-list))))))

<a name="set-internal-ast-attribute!"></a><a name="set-internal-ast-attribute!"></a><span><a href="../xml-in-laml.html#set-internal-ast-attribute!"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(set-internal-ast-attribute! ast name value)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">internal-attr-list</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-internal-attributes" title="xml-in-laml">ast-internal-attributes</a> ast))
         (<span class="local-name-binding">p-list-section</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#find-in-property-list" title="Manual: general">find-in-property-list</a> name internal-attr-list))
        )
    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> p-list-section
        (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX323" title="R5RS Scheme form">set-car!</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> p-list-section) value)
        (<a class="applied-name" href="xml-in-laml-1.html#set-internal-ast-attributes!" title="xml-in-laml">set-internal-ast-attributes!</a> ast (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> name (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> value internal-attr-list))))))



<a name="remove-internal-ast-attribute!"></a><a name="remove-internal-ast-attribute!"></a><span><a href="../xml-in-laml.html#remove-internal-ast-attribute!"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(remove-internal-ast-attribute! ast name)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">internal-attr-list</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-internal-attributes" title="xml-in-laml">ast-internal-attributes</a> ast)))
  (<a class="applied-name" href="xml-in-laml-1.html#set-internal-ast-attributes!" title="xml-in-laml">set-internal-ast-attributes!</a> ast 
    (<a class="schemedoc-name" href="../../../../lib/man/general.html#remove-prop!" title="Manual: general">remove-prop!</a> name internal-attr-list))))



<a name="remove-ast-attribute!"></a><a name="remove-ast-attribute!"></a><span><a href="../xml-in-laml.html#remove-ast-attribute!"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(remove-ast-attribute! ast name)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">attr-list</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-attributes" title="xml-in-laml">ast-attributes</a> ast)))
  (<a class="applied-name" href="xml-in-laml-1.html#set-ast-attributes!" title="xml-in-laml">set-ast-attributes!</a> ast 
    (<a class="schemedoc-name" href="../../../../lib/man/general.html#remove-prop!" title="Manual: general">remove-prop!</a> name attr-list))))

<a name="remove-ast-attributes!"></a><a name="remove-ast-attributes!"></a><span><a href="../xml-in-laml.html#remove-ast-attributes!"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(remove-ast-attributes! ast name-list)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">attr-list</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-attributes" title="xml-in-laml">ast-attributes</a> ast)))
  (<a class="applied-name" href="xml-in-laml-1.html#set-ast-attributes!" title="xml-in-laml">set-ast-attributes!</a> ast 
    (<a class="schemedoc-name" href="../../../../lib/man/general.html#remove-props!" title="Manual: general">remove-props!</a> name-list attr-list))))


<div class="schemedoc-section-comment">;;; XML-in-LAML Predicates.
;;; The functions in this section are predicates that work on ASTs and their constituents.
;;; .section-id ast-pred</div>
<a name="laml-ast-safe?"></a><span class="comment">; (define (laml-ast? x)
;   (and (pair? x) (eq? (car x) 'ast)
;        (list? x) (= 7 (length x))))</span><br />

<a name="laml-ast-safe?"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(laml-ast-safe? x)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX319" title="R5RS Scheme form">pair?</a> x) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> x) 'ast)

              (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX128" title="R5RS Scheme form">do</a> ((y x (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> y))
            (<a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a> 1 (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> <a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a> 1)))
           ((<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX118" title="R5RS Scheme form">or</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> y) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX235" title="R5RS Scheme form">=</a> <a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a> 7)) (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX235" title="R5RS Scheme form">=</a> <a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a> 7) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> y)) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> y))))) 

  )
)

<a name="laml-ast-fast?"></a><span class="comment">; Simplified, much faster, but weaker version.</span><br /><a name="laml-ast-fast?"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(laml-ast-fast? x)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX319" title="R5RS Scheme form">pair?</a> x) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> x) 'ast)))


<a name="sxml-ast?"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(sxml-ast? x)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX319" title="R5RS Scheme form">pair?</a> x) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX346" title="R5RS Scheme form">symbol?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> x))))

<a name="sxml-ast-strong?"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(sxml-ast-strong? x)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX331" title="R5RS Scheme form">list?</a> x) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX239" title="R5RS Scheme form">&gt;=</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX333" title="R5RS Scheme form">length</a> x) 3) 
       (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX346" title="R5RS Scheme form">symbol?</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#first" title="Manual: general">first</a> x))
       (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX331" title="R5RS Scheme form">list?</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#second" title="Manual: general">second</a> x)) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#second" title="Manual: general">second</a> x)) '@)
       (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX331" title="R5RS Scheme form">list?</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#third" title="Manual: general">third</a> x)) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#third" title="Manual: general">third</a> x)) '@@)))


<a name="ast?"></a><a name="ast?"></a><span><a href="../xml-in-laml.html#ast?"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">ast?</span> 
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> <a class="schemedoc-name" href="../../../../man/laml.html#laml-execution-mode" title="Manual: laml">laml-execution-mode</a> 'safe) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> <a class="applied-name" href="xml-in-laml-1.html#laml-internal-representation" title="xml-in-laml">laml-internal-representation</a> 'laml)) <a class="applied-name" href="xml-in-laml-1.html#laml-ast-safe?" title="xml-in-laml">laml-ast-safe?</a>)
        ((<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> <a class="schemedoc-name" href="../../../../man/laml.html#laml-execution-mode" title="Manual: laml">laml-execution-mode</a> 'fast) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> <a class="applied-name" href="xml-in-laml-1.html#laml-internal-representation" title="xml-in-laml">laml-internal-representation</a> 'laml)) <a class="applied-name" href="xml-in-laml-1.html#laml-ast-fast?" title="xml-in-laml">laml-ast-fast?</a>)
        ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> <a class="applied-name" href="xml-in-laml-1.html#laml-internal-representation" title="xml-in-laml">laml-internal-representation</a> 'sxml) <a class="applied-name" href="xml-in-laml-1.html#sxml-ast?" title="xml-in-laml">sxml-ast?</a>)
        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#laml-error" title="Manual: general">laml-error</a> "ast?: Unknown value of laml-internal-representation:" <a class="applied-name" href="xml-in-laml-1.html#laml-internal-representation" title="xml-in-laml">laml-internal-representation</a>))))

<a name="ast-strong?"></a><a name="ast-strong?"></a><span><a href="../xml-in-laml.html#ast-strong?"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">ast-strong?</span> 
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> <a class="schemedoc-name" href="../../../../man/laml.html#laml-execution-mode" title="Manual: laml">laml-execution-mode</a> 'safe) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> <a class="applied-name" href="xml-in-laml-1.html#laml-internal-representation" title="xml-in-laml">laml-internal-representation</a> 'laml)) <a class="applied-name" href="xml-in-laml-1.html#laml-ast-safe?" title="xml-in-laml">laml-ast-safe?</a>)
        ((<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> <a class="schemedoc-name" href="../../../../man/laml.html#laml-execution-mode" title="Manual: laml">laml-execution-mode</a> 'fast) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> <a class="applied-name" href="xml-in-laml-1.html#laml-internal-representation" title="xml-in-laml">laml-internal-representation</a> 'laml)) <a class="applied-name" href="xml-in-laml-1.html#laml-ast-fast?" title="xml-in-laml">laml-ast-fast?</a>)
        ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> <a class="applied-name" href="xml-in-laml-1.html#laml-internal-representation" title="xml-in-laml">laml-internal-representation</a> 'sxml) <a class="applied-name" href="xml-in-laml-1.html#sxml-ast-strong?" title="xml-in-laml">sxml-ast-strong?</a>)
        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#laml-error" title="Manual: general">laml-error</a> "ast-strong?: Unknown value of laml-internal-representation:" <a class="applied-name" href="xml-in-laml-1.html#laml-internal-representation" title="xml-in-laml">laml-internal-representation</a>))))

<a name="cdata?"></a><a name="cdata?"></a><span><a href="../xml-in-laml.html#cdata?"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">cdata?</span> <a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX374" title="R5RS Scheme form">string?</a>)

<a name="contents-data?"></a><a name="contents-data?"></a><span><a href="../xml-in-laml.html#contents-data?"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(contents-data? x . optional-parameter-list)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">language</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#optional-parameter" title="Manual: general">optional-parameter</a> 1  optional-parameter-list #f)))
   (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> language
       (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="applied-name" href="xml-in-laml-1.html#xml-accept-extended-contents-in?" title="xml-in-laml">xml-accept-extended-contents-in?</a> language)
           (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX118" title="R5RS Scheme form">or</a> (<a class="applied-name" href="xml-in-laml-1.html#cdata?" title="xml-in-laml">cdata?</a> x) (<a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> x) (<a class="applied-name" href="xml-in-laml-1.html#char-ref?" title="xml-in-laml">char-ref?</a> x) (<a class="applied-name" href="xml-in-laml-1.html#cdata-section?" title="xml-in-laml">cdata-section?</a> x) (<a class="applied-name" href="xml-in-laml-1.html#extended-contents-data?" title="xml-in-laml">extended-contents-data?</a> x))
           (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX118" title="R5RS Scheme form">or</a> (<a class="applied-name" href="xml-in-laml-1.html#cdata?" title="xml-in-laml">cdata?</a> x) (<a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> x) (<a class="applied-name" href="xml-in-laml-1.html#char-ref?" title="xml-in-laml">char-ref?</a> x) (<a class="applied-name" href="xml-in-laml-1.html#cdata-section?" title="xml-in-laml">cdata-section?</a> x)))
       (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX118" title="R5RS Scheme form">or</a> (<a class="applied-name" href="xml-in-laml-1.html#cdata?" title="xml-in-laml">cdata?</a> x) (<a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> x) (<a class="applied-name" href="xml-in-laml-1.html#char-ref?" title="xml-in-laml">char-ref?</a> x) (<a class="applied-name" href="xml-in-laml-1.html#cdata-section?" title="xml-in-laml">cdata-section?</a> x)))))

<span class="comment">; Is the parameter x a contents element item, with ASTs recognized in the strong form (using ast-strong?)
; .form (contents-data-strong? x [language])
; .internal-references "strong ASTs" "ast-strong?"
; (define (contents-data-strong? x . optional-parameter-list)
; (let ((language (optional-parameter 1  optional-parameter-list #f)))
;   (if language
;       (if (xml-accept-extended-contents-in? language)
;           (or (cdata? x) (ast-strong? x) (char-ref? x) (cdata-section? x) (extended-contents-data? x))
;           (or (cdata? x) (ast-strong? x) (char-ref? x) (cdata-section? x)))
;       (or (cdata? x) (ast-strong? x) (char-ref? x) (cdata-section? x)))))</span><br />

<span class="comment">; More efficient version. The function contents-data-strong? is a bottleneck in xml-sort-tag-parameters</span><br />
<a name="contents-data-strong?"></a><a name="contents-data-strong?"></a><span><a href="../xml-in-laml.html#contents-data-strong?"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(contents-data-strong? x . optional-parameter-list)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX118" title="R5RS Scheme form">or</a> (<a class="applied-name" href="xml-in-laml-1.html#cdata?" title="xml-in-laml">cdata?</a> x) (<a class="applied-name" href="xml-in-laml-1.html#ast-strong?" title="xml-in-laml">ast-strong?</a> x) (<a class="applied-name" href="xml-in-laml-1.html#char-ref?" title="xml-in-laml">char-ref?</a> x) (<a class="applied-name" href="xml-in-laml-1.html#cdata-section?" title="xml-in-laml">cdata-section?</a> x))
     #t
     (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">language</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#optional-parameter" title="Manual: general">optional-parameter</a> 1  optional-parameter-list #f)))
       (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> language
           (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="applied-name" href="xml-in-laml-1.html#xml-accept-extended-contents-in?" title="xml-in-laml">xml-accept-extended-contents-in?</a> language)
               (<a class="applied-name" href="xml-in-laml-1.html#extended-contents-data?" title="xml-in-laml">extended-contents-data?</a> x)
               #f
           )
           #f))))

<a name="extended-contents-data?"></a><span class="comment">; Is x considered as extended contents data. </span><br /><a name="extended-contents-data?"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(extended-contents-data? x)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX118" title="R5RS Scheme form">or</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX224" title="R5RS Scheme form">number?</a> x) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX351" title="R5RS Scheme form">char?</a> x)))

<a name="delayed-procedural-contents-element?"></a><a name="delayed-procedural-contents-element?"></a><span><a href="../xml-in-laml.html#delayed-procedural-contents-element?"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(delayed-procedural-contents-element? x)</span>
  (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX410" title="R5RS Scheme form">procedure?</a> x))

<a name="char-ref?"></a><a name="char-ref?"></a><span><a href="../xml-in-laml.html#char-ref?"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(char-ref? x)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX331" title="R5RS Scheme form">list?</a> x) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX239" title="R5RS Scheme form">&gt;=</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX333" title="R5RS Scheme form">length</a> x) 2) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> x) 'char-ref) (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX118" title="R5RS Scheme form">or</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX224" title="R5RS Scheme form">number?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cadr</a> x)) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX346" title="R5RS Scheme form">symbol?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cadr</a> x)))))

<a name="forced-white-space?"></a><a name="forced-white-space?"></a><span><a href="../xml-in-laml.html#forced-white-space?"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(forced-white-space? x)</span>
 (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> x <a class="applied-name" href="xml-in-laml-1.html#explicit-space" title="xml-in-laml">explicit-space</a>))

<a name="white-space-suppress?"></a><a name="white-space-suppress?"></a><span><a href="../xml-in-laml.html#white-space-suppress?"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(white-space-suppress? x)</span>
 (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> x <a class="applied-name" href="xml-in-laml-1.html#explicit-space-suppress" title="xml-in-laml">explicit-space-suppress</a>))

<a name="white-space-related?"></a><a name="white-space-related?"></a><span><a href="../xml-in-laml.html#white-space-related?"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(white-space-related? x)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX118" title="R5RS Scheme form">or</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> x <a class="applied-name" href="xml-in-laml-1.html#explicit-space" title="xml-in-laml">explicit-space</a>) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> x <a class="applied-name" href="xml-in-laml-1.html#explicit-space-suppress" title="xml-in-laml">explicit-space-suppress</a>)))

<a name="terminal-ast-node?"></a><a name="terminal-ast-node?"></a><span><a href="../xml-in-laml.html#terminal-ast-node?"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(terminal-ast-node? x)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> x)
      (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> (<a class="applied-name" href="xml-in-laml-1.html#ast-subtrees" title="xml-in-laml">ast-subtrees</a> x))))

<a name="xml-comment?"></a><a name="xml-comment?"></a><span><a href="../xml-in-laml.html#xml-comment?"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(xml-comment? x)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX331" title="R5RS Scheme form">list?</a> x) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX239" title="R5RS Scheme form">&gt;=</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX333" title="R5RS Scheme form">length</a> x) 1) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> x) 'xml-comment)))

<a name="cdata-section?"></a><a name="cdata-section?"></a><span><a href="../xml-in-laml.html#cdata-section?"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(cdata-section? x)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX331" title="R5RS Scheme form">list?</a> x) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX239" title="R5RS Scheme form">&gt;=</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX333" title="R5RS Scheme form">length</a> x) 1) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> x) 'cdata-section)))

<a name="processing-instruction?"></a><a name="processing-instruction?"></a><span><a href="../xml-in-laml.html#processing-instruction?"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(processing-instruction? x)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX331" title="R5RS Scheme form">list?</a> x) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX239" title="R5RS Scheme form">&gt;=</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX333" title="R5RS Scheme form">length</a> x) 1) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> x) 'processing-instruction)))


<a name="ast-of-type?"></a><a name="ast-of-type?"></a><span><a href="../xml-in-laml.html#ast-of-type?"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(ast-of-type? type name)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> type 'element-name)
           (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">ast</span>) 
             (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> ast) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX200" title="R5RS Scheme form">equal?</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> (<a class="applied-name" href="xml-in-laml-1.html#ast-element-name" title="xml-in-laml">ast-element-name</a> ast)) (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> name)))))
        ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> type 'kind)
           (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">ast</span>) 
             (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> ast) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX200" title="R5RS Scheme form">equal?</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> (<a class="applied-name" href="xml-in-laml-1.html#ast-kind" title="xml-in-laml">ast-kind</a> ast)) (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> name)))))
        ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> type 'language)
           (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">ast</span>) 
             (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> ast) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX200" title="R5RS Scheme form">equal?</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> (<a class="applied-name" href="xml-in-laml-1.html#ast-language" title="xml-in-laml">ast-language</a> ast)) (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> name)))))
        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> 
            (<a class="schemedoc-name" href="../../../../lib/man/general.html#laml-error" title="Manual: general">laml-error</a> "ast-of-type?: Unknown first parameter (type): " type))))



<div class="schemedoc-section-comment">;;; Character Entities.
;;; The function char-ref returns a character-reference. In XML, character references are used to
;;; denote characters which are not directly accessible from normal input devices. Notice that
;;; the predicated char-ref? is located in the AST predicate section.
;;; .section-id char-ent</div>
<a name="char-ref"></a><a name="char-ref"></a><span><a href="../xml-in-laml.html#char-ref"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(char-ref x)</span>
 (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> 'char-ref
    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX224" title="R5RS Scheme form">number?</a> x) x)
          ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX374" title="R5RS Scheme form">string?</a> x) (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-symbol" title="Manual: general">as-symbol</a> x))
          ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX346" title="R5RS Scheme form">symbol?</a> x) x)
          (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#laml-error" title="Manual: general">laml-error</a> "char-ref: Invalid parameter:" x)))))


<a name="char-ref-value"></a><a name="char-ref-value"></a><span><a href="../xml-in-laml.html#char-ref-value"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(char-ref-value char-ref-structure)</span>
  (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cadr</a> char-ref-structure))

<a name="xml-render-char-ref"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(xml-render-char-ref char-ref)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="applied-name" href="xml-in-laml-1.html#char-ref?" title="xml-in-laml">char-ref?</a> char-ref)) (<a class="schemedoc-name" href="../../../../lib/man/general.html#laml-error" title="Manual: general">laml-error</a> "xml-render-char-ref: XML rendering non char-ref:" char-ref))
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX123" title="R5RS Scheme form">letrec</a> ((<span class="local-name-binding">char-ref-render</span> 
           (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">x</span>)
             (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX224" title="R5RS Scheme form">number?</a> x) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> "&amp;#" (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> x) ";")) <span class="comment">; we do not enforce a three-digit representation</span><br />                   ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX346" title="R5RS Scheme form">symbol?</a> x) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> "&amp;" (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> x) ";"))
                   (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#laml-error" title="Manual: general">laml-error</a> "xml-render-char-ref: the parameter must be numeric, a symbol, or a string" x)))))
          (<span class="local-name-binding">three-digit-string</span> 
            (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">n</span>)
             (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX239" title="R5RS Scheme form">&gt;=</a> n 0) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX236" title="R5RS Scheme form">&lt;</a> n 10)) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> "00" (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> n)))
                   ((<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX239" title="R5RS Scheme form">&gt;=</a> n 10) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX236" title="R5RS Scheme form">&lt;</a> n 100)) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> "0" (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> n)))
                   ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX236" title="R5RS Scheme form">&lt;</a> n 1000) (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> n))
                   (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (error "three-digit-string: parameter must be between 0 and 999")))))
         )
   (char-ref-render (<a class="applied-name" href="xml-in-laml-1.html#char-ref-value" title="xml-in-laml">char-ref-value</a> char-ref))))

<span class="comment">; ---------------------------------------------------------------------------------------------------------------</span><br /><div class="schemedoc-section-comment">;;; XML Comments.
;;; The xml-comment form documented below allows for native XML comments in an XML-in-LAML document.
;;; Use the xml-comment form if it is important for you that LAML outputs native XML comments.
;;; In other cases, you may use Scheme comments in your LAML document.
;;; XML comments are not rendered if they occur in empty elements.
;;; .section-id xml-comments</div>
<a name="xml-comment"></a><a name="xml-comment"></a><span><a href="../xml-in-laml.html#xml-comment"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(xml-comment . comment-text-list)</span>
  (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> 'xml-comment (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> <a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> comment-text-list)))

<a name="xml-comment-contents"></a><a name="xml-comment-contents"></a><span><a href="../xml-in-laml.html#xml-comment-contents"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(xml-comment-contents xml-comment)</span>
   (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cadr</a> xml-comment))

<a name="xml-render-xml-comment"></a><a name="xml-render-xml-comment"></a><span><a href="../xml-in-laml.html#xml-render-xml-comment"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(xml-render-xml-comment xml-comment)</span>
  (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> "&lt;!--"  (<a class="schemedoc-name" href="../../../../lib/man/general.html#list-to-string" title="Manual: general">list-to-string</a> (<a class="applied-name" href="xml-in-laml-1.html#xml-comment-contents" title="xml-in-laml">xml-comment-contents</a> xml-comment) " ") "--&gt;")) 

<span class="comment">; ---------------------------------------------------------------------------------------------------------------</span><br /><div class="schemedoc-section-comment">;;; XML CDATA Sections.
;;; CDATA sections are typically used in script and style elements, to protect the characters '&lt;', '&gt;', and others.
;;; Most browsers do not render CDATA sections, if they appear within the textual contents.
;;; .section-id cdata-sections</div>
<a name="cdata-section"></a><a name="cdata-section"></a><span><a href="../xml-in-laml.html#cdata-section"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(cdata-section . cdata-text-list)</span>
  (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> 'cdata-section (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> <a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> cdata-text-list)))

<a name="cdata-section-contents"></a><a name="cdata-section-contents"></a><span><a href="../xml-in-laml.html#cdata-section-contents"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(cdata-section-contents cdata-section)</span>
  (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cadr</a> cdata-section))

<a name="xml-render-cdata-section"></a><a name="xml-render-cdata-section"></a><span><a href="../xml-in-laml.html#xml-render-cdata-section"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(xml-render-cdata-section cdata-section)</span>
  (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> "&lt;![CDATA[" (<a class="schemedoc-name" href="../../../../lib/man/general.html#list-to-string" title="Manual: general">list-to-string</a> (<a class="applied-name" href="xml-in-laml-1.html#cdata-section-contents" title="xml-in-laml">cdata-section-contents</a> cdata-section) " ") "]]&gt;"))

<span class="comment">; ---------------------------------------------------------------------------------------------------------------</span><br /><div class="schemedoc-section-comment">;;; XML Processing Instructions.
;;; A processing instruction is an XML technicality for telling something to an application, which 
;;; processes the document. Processing instructions are only rendered if they occur in non-empty elements.
;;; .section-id processing-instructions</div>
<a name="processing-instruction"></a><a name="processing-instruction"></a><span><a href="../xml-in-laml.html#processing-instruction"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(processing-instruction pi-target . text-list)</span>
  (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> 'processing-instruction (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> pi-target) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> <a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> text-list)))

<a name="processing-instruction-target"></a><a name="processing-instruction-target"></a><span><a href="../xml-in-laml.html#processing-instruction-target"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(processing-instruction-target pi)</span>
  (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cadr</a> pi))

<a name="processing-instruction-contents"></a><a name="processing-instruction-contents"></a><span><a href="../xml-in-laml.html#processing-instruction-contents"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(processing-instruction-contents pi)</span>
  (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">caddr</a> pi))

<a name="xml-render-processing-instruction"></a><a name="xml-render-processing-instruction"></a><span><a href="../xml-in-laml.html#xml-render-processing-instruction"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(xml-render-processing-instruction pi)</span>
  (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> "&lt;?" (<a class="applied-name" href="xml-in-laml-1.html#processing-instruction-target" title="xml-in-laml">processing-instruction-target</a> pi) " " (<a class="schemedoc-name" href="../../../../lib/man/general.html#list-to-string" title="Manual: general">list-to-string</a> (<a class="applied-name" href="xml-in-laml-1.html#processing-instruction-contents" title="xml-in-laml">processing-instruction-contents</a> pi) " ") "?&gt;"))

<span class="comment">; ---------------------------------------------------------------------------------------------------</span><br /><div class="schemedoc-section-comment">;;; XML Language Bookkeeping.
;;; XML-in-LAML keeps track of the XML-in-LAML languages in use, and it will warn you if an ambiguously named mirror function is used.
;;; The boolean variable xml-check-language-overlap? can be used to control the reporting of language overlaps (use of ambiguous mirror functions.)&lt;p&gt;
;;; Each XML language has a name when used in LAML. The names of all loaded mirrors is returned by the parameter-less function languages-in-use.
;;; If N is the name of an XML-in-LAML language, (N 'el-name) returns the mirror function named el-name in N.&lt;p&gt;
;;; A language map is an association list that maps mirror function names to the mirror functions. 
;;; Via use of a language map, it is always possible to acces a mirror function independt of name clashes with 
;;; other XML language mirrors.
;;; .section-id language-bookkeeping</div>
<a name="xml-in-laml-name-clashes"></a><a name="xml-in-laml-name-clashes"></a><span><a href="../xml-in-laml.html#xml-in-laml-name-clashes"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">xml-in-laml-name-clashes</span> '())

<a name="register-xml-in-laml-language"></a><a name="register-xml-in-laml-language"></a><span><a href="../xml-in-laml.html#register-xml-in-laml-language"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(register-xml-in-laml-language language language-map)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> <a class="applied-name" href="xml-in-laml-1.html#xml-in-laml-name-clashes" title="xml-in-laml">xml-in-laml-name-clashes</a> (<a class="applied-name" href="xml-in-laml-1.html#precompute-name-clashes" title="xml-in-laml">precompute-name-clashes</a> language-map <a class="applied-name" href="xml-in-laml-1.html#xml-in-laml-name-clashes" title="xml-in-laml">xml-in-laml-name-clashes</a>)) 
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX338" title="R5RS Scheme form">memq</a> language (<a class="applied-name" href="xml-in-laml-1.html#languages-in-use" title="xml-in-laml">languages-in-use</a>)))
     (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> xml-in-laml-languages-in-use (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> language language-map) xml-in-laml-languages-in-use)))
)

<a name="precompute-name-clashes"></a><span class="comment">; Return the new name clashes given that new-language-map is about to be registered.
; The existing name clashes is passed as the parameter existing-name-clashes.</span><br /><a name="precompute-name-clashes"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(precompute-name-clashes new-language-map existing-name-clashes)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">all-existing-names</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#flatten" title="Manual: general">flatten</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> <a class="applied-name" href="xml-in-laml-1.html#element-names-of-language" title="xml-in-laml">element-names-of-language</a> (<a class="applied-name" href="xml-in-laml-1.html#languages-in-use" title="xml-in-laml">languages-in-use</a>))))
         (<span class="local-name-binding">new-names</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> <a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> new-language-map))
         (<span class="local-name-binding">intersection</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#list-intersection-by-predicate" title="Manual: general">list-intersection-by-predicate</a> new-names all-existing-names <a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a>))
        )
    (<a class="schemedoc-name" href="../../../../lib/man/general.html#remove-duplicates-by-predicate" title="Manual: general">remove-duplicates-by-predicate</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX334" title="R5RS Scheme form">append</a> existing-name-clashes intersection) <a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a>)))


<a name="language-map-of"></a><a name="language-map-of"></a><span><a href="../xml-in-laml.html#language-map-of"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(language-map-of language)</span>
  (<a class="schemedoc-name" href="../../../../lib/man/general.html#defaulted-get" title="Manual: general">defaulted-get</a> language xml-in-laml-languages-in-use #f))

<a name="language-in-use?"></a><a name="language-in-use?"></a><span><a href="../xml-in-laml.html#language-in-use?"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(language-in-use? language)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">lg-map</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#defaulted-get" title="Manual: general">defaulted-get</a> language xml-in-laml-languages-in-use #f)))
    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> lg-map #t #f)))

<a name="languages-in-use"></a><a name="languages-in-use"></a><span><a href="../xml-in-laml.html#languages-in-use"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(languages-in-use)</span> 
  (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> <a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> xml-in-laml-languages-in-use))

<a name="element-names-of-language"></a><a name="element-names-of-language"></a><span><a href="../xml-in-laml.html#element-names-of-language"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(element-names-of-language language)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">lg-map</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#defaulted-get" title="Manual: general">defaulted-get</a> language xml-in-laml-languages-in-use '())))
    (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> <a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> lg-map))) 

<a name="causes-xml-in-laml-name-clash?"></a><a name="causes-xml-in-laml-name-clash?"></a><span><a href="../xml-in-laml.html#causes-xml-in-laml-name-clash?"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(causes-xml-in-laml-name-clash? name)</span>
  (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX338" title="R5RS Scheme form">memq</a> name <a class="applied-name" href="xml-in-laml-1.html#xml-in-laml-name-clashes" title="xml-in-laml">xml-in-laml-name-clashes</a>))

<a name="activator-via-language-map"></a><a name="activator-via-language-map"></a><span><a href="../xml-in-laml.html#activator-via-language-map"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(activator-via-language-map language)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">element-name</span>)
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">lg-map</span> (<a class="applied-name" href="xml-in-laml-1.html#language-map-of" title="xml-in-laml">language-map-of</a> language)))
    (<a class="applied-name" href="xml-in-laml-1.html#get-mirror-function" title="xml-in-laml">get-mirror-function</a> lg-map element-name))))

<a name="the-name-binding-stack"></a><span class="comment">; A global variable which holds bindings of a set of variables. </span><br /><a name="the-name-binding-stack"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">the-name-binding-stack</span> '())

<a name="push-name-bindings"></a><span class="comment">; Push an entry with namebindings for name-list on the name binding list.</span><br /><a name="push-name-bindings"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(push-name-bindings name-list)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">name-fu-map</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">n</span>) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> n (eval-cur-env n))) name-list)))
    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> <a class="applied-name" href="xml-in-laml-1.html#the-name-binding-stack" title="xml-in-laml">the-name-binding-stack</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> name-fu-map <a class="applied-name" href="xml-in-laml-1.html#the-name-binding-stack" title="xml-in-laml">the-name-binding-stack</a>))))

<a name="pop-and-restore-name-bindings"></a><span class="comment">; Pop the name binding list, and reestablish the bindings in the top entry.
; As a precondition it is assumed that the name binding stack is not empty.</span><br /><a name="pop-and-restore-name-bindings"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(pop-and-restore-name-bindings)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">name-fu-map</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> <a class="applied-name" href="xml-in-laml-1.html#the-name-binding-stack" title="xml-in-laml">the-name-binding-stack</a>)))
    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> <a class="applied-name" href="xml-in-laml-1.html#the-name-binding-stack" title="xml-in-laml">the-name-binding-stack</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> <a class="applied-name" href="xml-in-laml-1.html#the-name-binding-stack" title="xml-in-laml">the-name-binding-stack</a>))
    (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX413" title="R5RS Scheme form">for-each</a>
      (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">name-fu-pair</span>)
         (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX410" title="R5RS Scheme form">procedure?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> name-fu-pair))
             (eval-cur-env `(set! ,(<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> name-fu-pair) ,(<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> name-fu-pair)))
             (eval-cur-env `(set! ,(<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> name-fu-pair) (quote ,(<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> name-fu-pair)))))
             
      )
      name-fu-map)))

<a name="establish-xml-in-laml-name-bindings"></a><span class="comment">; Assign the variables in xml-element-variable-list to the corresponding mirror functions in xml-language. 
; xml-element-variable-list is a list of symbols. 
; xml-language is the name of an xml language in use (a symbol).</span><br /><a name="establish-xml-in-laml-name-bindings"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(establish-xml-in-laml-name-bindings xml-element-variable-list xml-language)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">lang-map</span> (<a class="applied-name" href="xml-in-laml-1.html#language-map-of" title="xml-in-laml">language-map-of</a> xml-language)))
   (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX413" title="R5RS Scheme form">for-each</a> 
     (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">xml-element-name</span>)
        (eval-cur-env `(set! ,xml-element-name ,(<a class="applied-name" href="xml-in-laml-1.html#get-mirror-function" title="xml-in-laml">get-mirror-function</a> lang-map xml-element-name)))
     )
     xml-element-variable-list)))


<a name="with-xml-language"></a><a name="with-xml-language"></a><span><a href="../xml-in-laml.html#with-xml-language"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX187" title="R5RS Scheme form">define-syntax</a> <span class="signature">with-xml-language</span> 
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX164" title="R5RS Scheme form">syntax-rules</a> ()
   ((with-xml-language xml-language-name <a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#form" title="Manual: xhtml10-transitional-mirror">form</a> ...)
    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">name-clashes</span> <a class="applied-name" href="xml-in-laml-1.html#xml-in-laml-name-clashes" title="xml-in-laml">xml-in-laml-name-clashes</a>))   
      (<a class="applied-name" href="xml-in-laml-1.html#push-name-bindings" title="xml-in-laml">push-name-bindings</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX334" title="R5RS Scheme form">append</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> 'xml-id-attribute-list 'xml-idref-attribute-list) name-clashes))
      (<a class="applied-name" href="xml-in-laml-1.html#establish-xml-in-laml-name-bindings" title="xml-in-laml">establish-xml-in-laml-name-bindings</a> name-clashes xml-language-name)
      (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> <a class="applied-name" href="xml-in-laml-1.html#xml-id-attribute-list" title="xml-in-laml">xml-id-attribute-list</a> '()) (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> <a class="applied-name" href="xml-in-laml-1.html#xml-idref-attribute-list" title="xml-in-laml">xml-idref-attribute-list</a> '())
      (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">result</span> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX125" title="R5RS Scheme form">begin</a> form ...)))
        (<a class="applied-name" href="xml-in-laml-1.html#check-id-and-idref-attributes!" title="xml-in-laml">check-id-and-idref-attributes!</a>)
        (<a class="applied-name" href="xml-in-laml-1.html#pop-and-restore-name-bindings" title="xml-in-laml">pop-and-restore-name-bindings</a>)
        result)))))

<a name="with-xml-language!"></a><a name="with-xml-language!"></a><span><a href="../xml-in-laml.html#with-xml-language!"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX187" title="R5RS Scheme form">define-syntax</a> <span class="signature">with-xml-language!</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX164" title="R5RS Scheme form">syntax-rules</a> ()
   ((with-xml-language! xml-language-name minus-elements <a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#form" title="Manual: xhtml10-transitional-mirror">form</a> ...)
    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">name-clashes</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#list-difference" title="Manual: general">list-difference</a> (<a class="applied-name" href="xml-in-laml-1.html#element-names-of-language" title="xml-in-laml">element-names-of-language</a> xml-language-name) minus-elements)))  
      (<a class="applied-name" href="xml-in-laml-1.html#push-name-bindings" title="xml-in-laml">push-name-bindings</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX334" title="R5RS Scheme form">append</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> 'xml-id-attribute-list 'xml-idref-attribute-list) name-clashes))
      (<a class="applied-name" href="xml-in-laml-1.html#establish-xml-in-laml-name-bindings" title="xml-in-laml">establish-xml-in-laml-name-bindings</a> name-clashes xml-language-name)
      (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> <a class="applied-name" href="xml-in-laml-1.html#xml-id-attribute-list" title="xml-in-laml">xml-id-attribute-list</a> '()) (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> <a class="applied-name" href="xml-in-laml-1.html#xml-idref-attribute-list" title="xml-in-laml">xml-idref-attribute-list</a> '())
      (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">result</span> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX125" title="R5RS Scheme form">begin</a> form ...)))
        (<a class="applied-name" href="xml-in-laml-1.html#check-id-and-idref-attributes!" title="xml-in-laml">check-id-and-idref-attributes!</a>)
        (<a class="applied-name" href="xml-in-laml-1.html#pop-and-restore-name-bindings" title="xml-in-laml">pop-and-restore-name-bindings</a>)
        result)))))


<span class="comment">; ---------------------------------------------------------------------------------------------------</span><br /><div class="schemedoc-section-comment">;;; The Language Map.
;;; The language map is a mapping that allows us to access the element mirror functions independent of
;;; any name clash. 
;;; In this version of LAML the language map is an association that maps element names (symbols) to function objects.
;;; In the longer run, it should be a more efficient search structure.
;;; .section-id language-map</div>
<a name="temp-language-map"></a><span class="comment">; An auxilary variable used by the XML-in-LAML mirror libraries.</span><br /><a name="temp-language-map"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">temp-language-map</span> '())

<a name="temp-mirror-function"></a><span class="comment">; An auxilary variable used by the XML-in-LAML mirror libraries.</span><br /><a name="temp-mirror-function"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">temp-mirror-function</span> #f)


<a name="get-mirror-function"></a><a name="get-mirror-function"></a><span><a href="../xml-in-laml.html#get-mirror-function"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(get-mirror-function language-map element-name)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">element-name-symbol</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-symbol" title="Manual: general">as-symbol</a> element-name)))
   (<a class="schemedoc-name" href="../../../../lib/man/general.html#defaulted-get" title="Manual: general">defaulted-get</a> element-name-symbol language-map #f)))

<a name="put-mirror-function"></a><a name="put-mirror-function"></a><span><a href="../xml-in-laml.html#put-mirror-function"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(put-mirror-function language-map element-name mirror-function)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">element-name-symbol</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-symbol" title="Manual: general">as-symbol</a> element-name)))
   (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="applied-name" href="xml-in-laml-1.html#get-mirror-function" title="xml-in-laml">get-mirror-function</a> language-map element-name-symbol)
       (<a class="schemedoc-name" href="../../../../lib/man/general.html#laml-error" title="Manual: general">laml-error</a> "put-mirror-function: The name" element-name "is defined twice.")
       (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> element-name-symbol mirror-function) language-map))))



<span class="comment">; ---------------------------------------------------------------------------------------------------</span><br />
<div class="schemedoc-section-comment">;;; XML Navigation Information.
;;; XML navigation information provides for "smart searching" of XML ASTs. The smartness
;;; is based on the following knowledge: (1) The possible direct and indirect sub-elements
;;; of a given element. (2) The possible attributes of an element and its direct and indirect 
;;; sub-elements. This information is pre-computed in the XML-in-LAML mirror generation tool.
;;; The functions in this section provides access to this pre-computed information.
;;; Notice that the functions in this section return static information, as derived from the DTD.
;;; .section-id xml-navigation</div>
<a name="register-xml-in-laml-navigator"></a><a name="register-xml-in-laml-navigator"></a><span><a href="../xml-in-laml.html#register-xml-in-laml-navigator"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(register-xml-in-laml-navigator language navigator-structure)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> xml-in-laml-navigator-structures (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> language navigator-structure) xml-in-laml-navigator-structures))
)

<a name="xml-navigator-of"></a><a name="xml-navigator-of"></a><span><a href="../xml-in-laml.html#xml-navigator-of"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(xml-navigator-of language)</span>
  (<a class="schemedoc-name" href="../../../../lib/man/general.html#defaulted-get" title="Manual: general">defaulted-get</a> language xml-in-laml-navigator-structures #f))

<a name="xml-navigator?"></a><span class="comment">; Is x an xml-navigator?</span><br /><a name="xml-navigator?"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(xml-navigator? x)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX331" title="R5RS Scheme form">list?</a> x) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX235" title="R5RS Scheme form">=</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX333" title="R5RS Scheme form">length</a> x) 2) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> x) 'xml-navigator)))

<a name="xml-navigator-vector"></a><span class="comment">; Return the navigator vector of xml-navigator.
; As a precondition, it is assumed that the parameter satisfy the predicate xml-navigator?</span><br /><a name="xml-navigator-vector"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(xml-navigator-vector xml-navigator)</span>
 (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cadr</a> xml-navigator))

<a name="navigator-triple-element-name"></a><span class="comment">; Navigator triple selectors</span><br /><a name="navigator-triple-element-name"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">navigator-triple-element-name</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#make-selector-function" title="Manual: general">make-selector-function</a> 1 "navigator-triple-element-name"))
<a name="navigator-triple-possible-element-vector"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">navigator-triple-possible-element-vector</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#make-selector-function" title="Manual: general">make-selector-function</a> 2 "navigator-triple-possible-element-vector"))
<a name="navigator-triple-possible-attribute-vector"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">navigator-triple-possible-attribute-vector</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#make-selector-function" title="Manual: general">make-selector-function</a> 3 "navigator-triple-possible-attribute-vector"))


<a name="possible-elements-rooted-by-element"></a><a name="possible-elements-rooted-by-element"></a><span><a href="../xml-in-laml.html#possible-elements-rooted-by-element"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(possible-elements-rooted-by-element element-name language)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">nav-vector</span> (<a class="applied-name" href="xml-in-laml-1.html#xml-navigator-vector" title="xml-in-laml">xml-navigator-vector</a> (<a class="applied-name" href="xml-in-laml-1.html#xml-navigator-of" title="xml-in-laml">xml-navigator-of</a> language)))
        (<span class="local-name-binding">relevant-tripple</span> 
          (<a class="schemedoc-name" href="../../../../lib/man/general.html#binary-search-in-vector" title="Manual: general">binary-search-in-vector</a> nav-vector (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-symbol" title="Manual: general">as-symbol</a> element-name) <a class="applied-name" href="xml-in-laml-1.html#navigator-triple-element-name" title="xml-in-laml">navigator-triple-element-name</a> <a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> <a class="applied-name" href="xml-in-laml-1.html#symbol-leq?" title="xml-in-laml">symbol-leq?</a>))
       )
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> relevant-tripple 
      (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">element-vector</span> (<a class="applied-name" href="xml-in-laml-1.html#navigator-triple-possible-element-vector" title="xml-in-laml">navigator-triple-possible-element-vector</a> relevant-tripple)))
        (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX406" title="R5RS Scheme form">vector-&gt;list</a> element-vector))
      (<a class="schemedoc-name" href="../../../../lib/man/general.html#laml-error" title="Manual: general">laml-error</a> "possible-elements-rooted-by-element: Cannot locate" element-name "in" language))))


<a name="possible-attributes-rooted-by-element"></a><a name="possible-attributes-rooted-by-element"></a><span><a href="../xml-in-laml.html#possible-attributes-rooted-by-element"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(possible-attributes-rooted-by-element element-name language)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">nav-vector</span> (<a class="applied-name" href="xml-in-laml-1.html#xml-navigator-vector" title="xml-in-laml">xml-navigator-vector</a> (<a class="applied-name" href="xml-in-laml-1.html#xml-navigator-of" title="xml-in-laml">xml-navigator-of</a> language)))
        (<span class="local-name-binding">relevant-tripple</span> 
          (<a class="schemedoc-name" href="../../../../lib/man/general.html#binary-search-in-vector" title="Manual: general">binary-search-in-vector</a> nav-vector (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-symbol" title="Manual: general">as-symbol</a> element-name) <a class="applied-name" href="xml-in-laml-1.html#navigator-triple-element-name" title="xml-in-laml">navigator-triple-element-name</a> <a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> <a class="applied-name" href="xml-in-laml-1.html#symbol-leq?" title="xml-in-laml">symbol-leq?</a>))
       )
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> relevant-tripple 
      (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">attribute-vector</span> (<a class="applied-name" href="xml-in-laml-1.html#navigator-triple-possible-attribute-vector" title="xml-in-laml">navigator-triple-possible-attribute-vector</a> relevant-tripple)))
        (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX406" title="R5RS Scheme form">vector-&gt;list</a> attribute-vector))
      (<a class="schemedoc-name" href="../../../../lib/man/general.html#laml-error" title="Manual: general">laml-error</a> "possible-attributes-rooted-by-element: Cannot locate" element-name "in" language))))

<a name="can-have-element-constituent?"></a><a name="can-have-element-constituent?"></a><span><a href="../xml-in-laml.html#can-have-element-constituent?"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(can-have-element-constituent? ast el-name)</span>
 (<a class="applied-name" href="xml-in-laml-1.html#can-have-element-constituent-help" title="xml-in-laml">can-have-element-constituent-help</a> (<a class="applied-name" href="xml-in-laml-1.html#ast-element-name" title="xml-in-laml">ast-element-name</a> ast) el-name (<a class="applied-name" href="xml-in-laml-1.html#xml-navigator-of" title="xml-in-laml">xml-navigator-of</a> (<a class="applied-name" href="xml-in-laml-1.html#ast-language" title="xml-in-laml">ast-language</a> ast))))

<a name="can-have-element-constituent-help"></a><span class="comment">; Can el-name be a constituent of an AST rooted by in-element-name, using xml-navigator.
; The function doing the real work of can-have-element-constituent?</span><br /><a name="can-have-element-constituent-help"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(can-have-element-constituent-help in-element-name el-name xml-navigator)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">nav-vector</span> (<a class="applied-name" href="xml-in-laml-1.html#xml-navigator-vector" title="xml-in-laml">xml-navigator-vector</a> xml-navigator))
        (<span class="local-name-binding">relevant-tripple</span> 
          (<a class="schemedoc-name" href="../../../../lib/man/general.html#binary-search-in-vector" title="Manual: general">binary-search-in-vector</a> nav-vector (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-symbol" title="Manual: general">as-symbol</a> in-element-name) <a class="applied-name" href="xml-in-laml-1.html#navigator-triple-element-name" title="xml-in-laml">navigator-triple-element-name</a> <a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> <a class="applied-name" href="xml-in-laml-1.html#symbol-leq?" title="xml-in-laml">symbol-leq?</a>))
       )
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> relevant-tripple 
      (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">element-vector</span> (<a class="applied-name" href="xml-in-laml-1.html#navigator-triple-possible-element-vector" title="xml-in-laml">navigator-triple-possible-element-vector</a> relevant-tripple)))
        (<a class="schemedoc-name" href="../../../../lib/man/general.html#turn-into-boolean" title="Manual: general">turn-into-boolean</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#binary-search-in-vector" title="Manual: general">binary-search-in-vector</a> element-vector (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-symbol" title="Manual: general">as-symbol</a> el-name) <a class="schemedoc-name" href="../../../../lib/man/general.html#id-1" title="Manual: general">id-1</a> <a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> <a class="applied-name" href="xml-in-laml-1.html#symbol-leq?" title="xml-in-laml">symbol-leq?</a>)))
      #f)))

<a name="symbol-leq?"></a><span class="comment">; Is symbol sym1 considered less than or equal to symbol sym2</span><br /><a name="symbol-leq?"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(symbol-leq? sym1 sym2)</span>
  (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX385" title="R5RS Scheme form">string&lt;=?</a> (symbol->string sym1) (symbol->string sym2)))


<div class="schemedoc-section-comment">;;; Mirror Generation Functions.
;;; The function generate-xml-mirror-function is the (higher-order) function that generates the mirror of XML elements in Scheme.
;;; In addition, this section contains the function that implement the LAML parameter passing rules of the mirror functions,
;;; namely, xml-sort-tag-parameters.
;;; .section-id mirror-gen</div>

<a name="xml-sort-tag-parameters"></a><a name="xml-sort-tag-parameters"></a><span><a href="../xml-in-laml.html#xml-sort-tag-parameters"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(xml-sort-tag-parameters parameters tag-name . optional-parameter-list)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">language</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#optional-parameter" title="Manual: general">optional-parameter</a> 1 optional-parameter-list #f)))
  (<a class="applied-name" href="xml-in-laml-1.html#xml-sort-tag-parameters-1" title="xml-in-laml">xml-sort-tag-parameters-1</a> parameters tag-name language #f)))

<a name="xml-sort-superficially-tag-parameters"></a><a name="xml-sort-superficially-tag-parameters"></a><span><a href="../xml-in-laml.html#xml-sort-superficially-tag-parameters"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(xml-sort-superficially-tag-parameters parameters tag-name . optional-parameter-list)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">language</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#optional-parameter" title="Manual: general">optional-parameter</a> 1  optional-parameter-list #f)))
  (<a class="applied-name" href="xml-in-laml-1.html#xml-sort-tag-parameters-1" title="xml-in-laml">xml-sort-tag-parameters-1</a> parameters tag-name language #t)))


<a name="strip-initial-explicit-spaces-stp"></a><span class="comment">; --------------------------------------------------------------------------------------------------------------------------
; Start of xml-sort-tag-parameters-1 and its helping functions</span><br /> 
<a name="strip-initial-explicit-spaces-stp"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">strip-initial-explicit-spaces-stp</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">cl</span>) (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX319" title="R5RS Scheme form">pair?</a> cl) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> cl) <a class="applied-name" href="xml-in-laml-1.html#explicit-space" title="xml-in-laml">explicit-space</a>)) (<a class="applied-name" href="xml-in-laml-1.html#strip-initial-explicit-spaces-stp" title="xml-in-laml">strip-initial-explicit-spaces-stp</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> cl)) cl)))

<a name="list-not-laml-special-stp?"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">list-not-laml-special-stp?</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">x</span>) (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX331" title="R5RS Scheme form">list?</a> x) 
		   (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX118" title="R5RS Scheme form">or</a> (<a class="applied-name" href="xml-in-laml-1.html#ast-strong?" title="xml-in-laml">ast-strong?</a> x) (<a class="applied-name" href="xml-in-laml-1.html#char-ref?" title="xml-in-laml">char-ref?</a> x) (<a class="applied-name" href="xml-in-laml-1.html#xml-comment?" title="xml-in-laml">xml-comment?</a> x) (<a class="applied-name" href="xml-in-laml-1.html#cdata-section?" title="xml-in-laml">cdata-section?</a> x)
			    (<a class="applied-name" href="xml-in-laml-1.html#processing-instruction?" title="xml-in-laml">processing-instruction?</a> x))))))


<a name="maybe-string-stp"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">maybe-string-stp</span> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">x</span>) (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="applied-name" href="xml-in-laml-1.html#extended-contents-data?" title="xml-in-laml">extended-contents-data?</a> x) (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> x) x)))

<a name="as-string-attr-val-stp"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">as-string-attr-val-stp</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">x</span>)
    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="applied-name" href="xml-in-laml-1.html#char-ref?" title="xml-in-laml">char-ref?</a> x) (<a class="applied-name" href="xml-in-laml-1.html#xml-render-char-ref" title="xml-in-laml">xml-render-char-ref</a> x))
	  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> x)))))

<a name="xml-flatten-parameters-stp"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">xml-flatten-parameters-stp</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">parameters</span>)
    (<a class="applied-name" href="xml-in-laml-1.html#xml-flatten-parameters-1" title="xml-in-laml">xml-flatten-parameters-1</a> parameters '())))

<a name="xml-flatten-parameters-1"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">xml-flatten-parameters-1</span> 
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">parameters</span> <span class="local-name-binding">res</span>)
    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> parameters) res)
	  ((<a class="applied-name" href="xml-in-laml-1.html#list-not-laml-special-stp?" title="xml-in-laml">list-not-laml-special-stp?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> parameters))
	   (<a class="applied-name" href="xml-in-laml-1.html#xml-flatten-parameters-1" title="xml-in-laml">xml-flatten-parameters-1</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> parameters) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX334" title="R5RS Scheme form">append</a> (<a class="applied-name" href="xml-in-laml-1.html#xml-flatten-parameters-1" title="xml-in-laml">xml-flatten-parameters-1</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> parameters) '()) res)))
	  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="applied-name" href="xml-in-laml-1.html#xml-flatten-parameters-1" title="xml-in-laml">xml-flatten-parameters-1</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> parameters) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> parameters) res))))))

<a name="xml-split-parameters-stp"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">xml-split-parameters-stp</span> <span class="comment">; Do a basic split of parameters in contents and attributes. 
; Parameters is reversed in the starting point.
; Do not perform any error checking.
; Return a cons pair of contents and attributes. </span><br />  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">parameters</span>)
    (<a class="applied-name" href="xml-in-laml-1.html#xml-split-parameters-1" title="xml-in-laml">xml-split-parameters-1</a> parameters '() '())))

<a name="xml-split-parameters-1"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">xml-split-parameters-1</span> 
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">parameters</span> <span class="local-name-binding">content-list</span> <span class="local-name-binding">attribute-list</span>) <span class="comment">; parameter is reversed</span><br />    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> parameters) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> content-list attribute-list))
	  ((<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> parameters))) <span class="comment">; thus parameters has at least two elements</span><br />		(<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX346" title="R5RS Scheme form">symbol?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cadr</a> parameters))) <span class="comment">; input is reversed</span><br />	   (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">attr-name</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cadr</a> parameters))
		 (<span class="local-name-binding">attr-val</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> parameters)))
	     (<a class="applied-name" href="xml-in-laml-1.html#xml-split-parameters-1" title="xml-in-laml">xml-split-parameters-1</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cddr</a> parameters) content-list (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> attr-name (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> attr-val attribute-list)))))
	  ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX346" title="R5RS Scheme form">symbol?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> parameters)) 
	   (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">attr-name</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> parameters)))
	     (<a class="applied-name" href="xml-in-laml-1.html#xml-split-parameters-1" title="xml-in-laml">xml-split-parameters-1</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> parameters) content-list (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> attr-name attribute-list))))
	  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="applied-name" href="xml-in-laml-1.html#xml-split-parameters-1" title="xml-in-laml">xml-split-parameters-1</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> parameters) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> parameters) content-list) attribute-list)))))

<a name="xml-process-contents-stp"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">xml-process-contents-stp</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">contents-list</span> <span class="local-name-binding">tag-name</span> <span class="local-name-binding">language</span> <span class="local-name-binding">superficial?</span> <span class="local-name-binding">white-space?</span>)
    (<a class="applied-name" href="xml-in-laml-1.html#xml-process-contents-1" title="xml-in-laml">xml-process-contents-1</a> contents-list '() tag-name language superficial? white-space?)))

<a name="xml-process-contents-1"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">xml-process-contents-1</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">content-parameters</span> <span class="local-name-binding">res</span> <span class="local-name-binding">tag-name</span> <span class="local-name-binding">language</span> <span class="local-name-binding">superficial?</span> <span class="local-name-binding">white-space?</span>)
    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> content-parameters) res)

					<span class="comment">; CONTENTS DATA - CDATA, CHAR-REF, XML-comment, PI, DELAYED-PROCEDURAL-CONTENT or AST - 
; and then a space suppress value - no space after</span><br />	  ((<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="applied-name" href="xml-in-laml-1.html#x-contents-data-strong?" title="xml-in-laml">x-contents-data-strong?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> content-parameters) language) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> content-parameters)))
		(<a class="applied-name" href="xml-in-laml-1.html#white-space-related?" title="xml-in-laml">white-space-related?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cadr</a> content-parameters)) (<a class="applied-name" href="xml-in-laml-1.html#white-space-suppress?" title="xml-in-laml">white-space-suppress?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cadr</a> content-parameters)))              
	   (<a class="applied-name" href="xml-in-laml-1.html#xml-process-contents-1" title="xml-in-laml">xml-process-contents-1</a>
	    (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cddr</a> content-parameters) 
	    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> white-space? 
		(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> superficial? 
		    (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> <a class="applied-name" href="xml-in-laml-1.html#explicit-space-suppress" title="xml-in-laml">explicit-space-suppress</a>
			  (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="applied-name" href="xml-in-laml-1.html#maybe-string-stp" title="xml-in-laml">maybe-string-stp</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> content-parameters)) res)) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="applied-name" href="xml-in-laml-1.html#maybe-string-stp" title="xml-in-laml">maybe-string-stp</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> content-parameters)) res))
		(<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="applied-name" href="xml-in-laml-1.html#maybe-string-stp" title="xml-in-laml">maybe-string-stp</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> content-parameters)) res)) tag-name language superficial? white-space?))
                      

					<span class="comment">; CONTENTS DATA - CDATA, CHAR-REF, XML-comment, PI, DELAYED-PROCEDURAL-CONTENT, or AST - 
; and then a space value -  space after (not typical)</span><br />	  ((<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="applied-name" href="xml-in-laml-1.html#x-contents-data-strong?" title="xml-in-laml">x-contents-data-strong?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> content-parameters) language) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> content-parameters)))
		(<a class="applied-name" href="xml-in-laml-1.html#white-space-related?" title="xml-in-laml">white-space-related?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cadr</a> content-parameters)) (<a class="applied-name" href="xml-in-laml-1.html#forced-white-space?" title="xml-in-laml">forced-white-space?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cadr</a> content-parameters))) <span class="comment">; space after</span><br />	   (<a class="applied-name" href="xml-in-laml-1.html#xml-process-contents-1" title="xml-in-laml">xml-process-contents-1</a>
	    (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cddr</a> content-parameters)
	    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> white-space? 
		(<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> <a class="applied-name" href="xml-in-laml-1.html#explicit-space" title="xml-in-laml">explicit-space</a>
		      (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="applied-name" href="xml-in-laml-1.html#maybe-string-stp" title="xml-in-laml">maybe-string-stp</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> content-parameters)) res))
		(<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="applied-name" href="xml-in-laml-1.html#maybe-string-stp" title="xml-in-laml">maybe-string-stp</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> content-parameters)) res)) tag-name language superficial? white-space?))

					<span class="comment">; CONTENTS DATA - CDATA, CHAR-REF, XML-comment, PI, DELAYED-PROCEDURAL-CONTENT or AST - </span><br />	  ((<a class="applied-name" href="xml-in-laml-1.html#x-contents-data-strong?" title="xml-in-laml">x-contents-data-strong?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> content-parameters) language) <span class="comment">; space after</span><br />	   (<a class="applied-name" href="xml-in-laml-1.html#xml-process-contents-1" title="xml-in-laml">xml-process-contents-1</a>  
	    (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> content-parameters)
	    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> white-space? 
		(<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> <a class="applied-name" href="xml-in-laml-1.html#explicit-space" title="xml-in-laml">explicit-space</a>
		      (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="applied-name" href="xml-in-laml-1.html#maybe-string-stp" title="xml-in-laml">maybe-string-stp</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> content-parameters)) res))
		(<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="applied-name" href="xml-in-laml-1.html#maybe-string-stp" title="xml-in-laml">maybe-string-stp</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> content-parameters)) res)) tag-name language superficial? white-space?))

					<span class="comment">; White space in other situations - just ignore it</span><br />	  ((<a class="applied-name" href="xml-in-laml-1.html#white-space-related?" title="xml-in-laml">white-space-related?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> content-parameters))  
	   (<a class="applied-name" href="xml-in-laml-1.html#xml-process-contents-1" title="xml-in-laml">xml-process-contents-1</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> content-parameters) res tag-name language superficial? white-space?))

	  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> 
	   (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">extended-contents</span> (<a class="applied-name" href="xml-in-laml-1.html#xml-accept-extended-contents-in?" title="xml-in-laml">xml-accept-extended-contents-in?</a> language))
		  (<span class="local-name-binding">hint</span> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> extended-contents) 
			    (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> #\newline) 
					   "You may consider use of extended contents: (set-xml-accept-extended-contents-in "
					   "&#39;" (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> language) " #t" ")")
			    ""))
		  ) 
	     (<a class="applied-name" href="xml-in-laml-1.html#xml-sort-error" title="xml-in-laml">xml-sort-error</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> "Fatal error in an XML-in-LAML  " tag-name "  element." 
					    hint)
			     (<a class="applied-name" href="xml-in-laml-1.html#xml-render-error-message" title="xml-in-laml">xml-render-error-message</a> content-parameters)))
	   ))))

<a name="xml-process-attributes-stp"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">xml-process-attributes-stp</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">attributes</span> <span class="local-name-binding">tag-name</span> <span class="local-name-binding">language</span>)
    (<a class="applied-name" href="xml-in-laml-1.html#xml-process-attributes-1" title="xml-in-laml">xml-process-attributes-1</a> attributes '() tag-name language)))

<a name="xml-process-attributes-1"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">xml-process-attributes-1</span> 
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">attribute-prop-list</span> <span class="local-name-binding">res</span> <span class="local-name-binding">tag-name</span> <span class="local-name-binding">language</span>)
    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> attribute-prop-list) res)
	  ((<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX346" title="R5RS Scheme form">symbol?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> attribute-prop-list)) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> attribute-prop-list))))
	   (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">attr-name</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> attribute-prop-list))
		  (<span class="local-name-binding">attr-val</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cadr</a> attribute-prop-list))
		  (<span class="local-name-binding">problematic-attr-value-type?</span> 
		   (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX118" title="R5RS Scheme form">or</a> (<a class="applied-name" href="xml-in-laml-1.html#ast-strong?" title="xml-in-laml">ast-strong?</a> attr-val) (<a class="applied-name" href="xml-in-laml-1.html#char-ref?" title="xml-in-laml">char-ref?</a> attr-val) (<a class="applied-name" href="xml-in-laml-1.html#xml-comment?" title="xml-in-laml">xml-comment?</a> attr-val) (<a class="applied-name" href="xml-in-laml-1.html#processing-instruction?" title="xml-in-laml">processing-instruction?</a> attr-val)
		       (<a class="applied-name" href="xml-in-laml-1.html#delayed-procedural-contents-element?" title="xml-in-laml">delayed-procedural-contents-element?</a> attr-val))
                   )
		  )
	     (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX374" title="R5RS Scheme form">string?</a> attr-val)) (<a class="applied-name" href="xml-in-laml-1.html#xml-accept-only-string-valued-attributes-in?" title="xml-in-laml">xml-accept-only-string-valued-attributes-in?</a> language))
                 
		 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> (problematic-attr-value-type?
			(<a class="applied-name" href="xml-in-laml-1.html#xml-check-error" title="xml-in-laml">xml-check-error</a> "An unpsupported attribute value type is passed as the value of the attribute"
					 (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> #\newline) " "  (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> attr-name) "  in an instance of the "
					 tag-name " element. " (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> #\newline)
					 " "  "The attribute is ignored."))
		       (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a>
			(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">extended-attributes?</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="applied-name" href="xml-in-laml-1.html#xml-accept-only-string-valued-attributes-in?" title="xml-in-laml">xml-accept-only-string-valued-attributes-in?</a> language)))
			       (<span class="local-name-binding">hint</span> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> extended-attributes?) 
					 (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> #\newline) 
							"   You may consider use of relaxed attributes:" (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> #\newline) 
							"   " "(set-xml-accept-only-string-valued-attributes-in "
							"&#39;" (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> language) " #f" ")")
					 ""))
			       )
			  (<a class="applied-name" href="xml-in-laml-1.html#xml-check-error" title="xml-in-laml">xml-check-error</a> "A non-string value " (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> attr-val)
					   " is passed as the value of the attribute" (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> #\newline)
					   " " (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> attr-name) "  in an instance of the " tag-name " element."
					   (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> #\newline) 
					   " " "The attribute value is converted to a string." hint))))

		 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> (problematic-attr-value-type?
			(<a class="applied-name" href="xml-in-laml-1.html#xml-check-error" title="xml-in-laml">xml-check-error</a> "An unsupported attribute value type is passed as the value of the attribute"
					 (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> #\newline) " "  (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> attr-name) "  in an instance of the "
					 tag-name " element. " (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> #\newline)
					 " "  "The attribute is ignored."))
		       (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a>
			#f))
		 )
	     (<a class="applied-name" href="xml-in-laml-1.html#xml-process-attributes-1" title="xml-in-laml">xml-process-attributes-1</a> 
	      (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cddr</a> attribute-prop-list)
	      (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> problematic-attr-value-type?) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="applied-name" href="xml-in-laml-1.html#as-string-attr-val-stp" title="xml-in-laml">as-string-attr-val-stp</a> attr-val) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> attr-name res)) res) tag-name language)
	     ))
	  ((<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX346" title="R5RS Scheme form">symbol?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> attribute-prop-list)) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> attribute-prop-list)) )
	   (<a class="applied-name" href="xml-in-laml-1.html#xml-sort-error" title="xml-in-laml">xml-sort-error</a> 
	    (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> "Fatal error in an XML-in-LAML element: " "Attributes of the  " tag-name
			   "  element must be of the form  &#39;symbol \"value\" "  (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> #\newline) "   "
			   "Only the symbol  " (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> attribute-prop-list))
			   "  appears in last encountered attribute." )))
	  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#laml-error" title="Manual: general">laml-error</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> "Fatal error in XML-in-LAML element: Malformed attribute list") ))


	  ))
  )


<a name="xml-sort-tag-parameters-1"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(xml-sort-tag-parameters-1 parameters tag-name language superficial?)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">white-space?</span> (<a class="applied-name" href="xml-in-laml-1.html#xml-represent-white-space-in?" title="xml-in-laml">xml-represent-white-space-in?</a> language)))
    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">flat-parameters</span> (<a class="applied-name" href="xml-in-laml-1.html#xml-flatten-parameters-stp" title="xml-in-laml">xml-flatten-parameters-stp</a> parameters))
           (<span class="local-name-binding">splited-flat-parameters</span> (<a class="applied-name" href="xml-in-laml-1.html#xml-split-parameters-stp" title="xml-in-laml">xml-split-parameters-stp</a> flat-parameters))
           (<span class="local-name-binding">raw-contents</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> splited-flat-parameters))
           (<span class="local-name-binding">raw-attributes</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> splited-flat-parameters))
           (<span class="local-name-binding">contents</span> (<a class="applied-name" href="xml-in-laml-1.html#xml-process-contents-stp" title="xml-in-laml">xml-process-contents-stp</a> raw-contents tag-name language superficial? white-space?))
           (<span class="local-name-binding">attributes</span> (<a class="applied-name" href="xml-in-laml-1.html#xml-process-attributes-stp" title="xml-in-laml">xml-process-attributes-stp</a> raw-attributes tag-name language))
           )
      (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a>
       (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX335" title="R5RS Scheme form">reverse</a> (<a class="applied-name" href="xml-in-laml-1.html#strip-initial-explicit-spaces-stp" title="xml-in-laml">strip-initial-explicit-spaces-stp</a> contents))
       (<a class="applied-name" href="xml-in-laml-1.html#xml-modify-attribute-list" title="xml-in-laml">xml-modify-attribute-list</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX335" title="R5RS Scheme form">reverse</a> attributes) (<a class="applied-name" href="xml-in-laml-1.html#xml-duplicated-attribute-handling" title="xml-in-laml">xml-duplicated-attribute-handling</a> language))))))


<span class="comment">; End of xml-sort-tag-parameters-1 and its helping functions
; --------------------------------------------------------------------------------------------------------------------------</span><br />
<span class="comment">; (define (x-contents-data-strong? x . optional-parameter-list)
;  (let ((language (optional-parameter 1  optional-parameter-list #f)))
;    (if language
;        (or (contents-data-strong? x language)
;            (xml-comment? x)
;            (processing-instruction? x)
;            (delayed-procedural-contents-element? x)
;        )
;        (or (contents-data-strong? x)
;            (xml-comment? x)
;            (processing-instruction? x)
;            (delayed-procedural-contents-element? x)
;        ))))</span><br />
<a name="x-contents-data-strong?"></a><span class="comment">; A extended variant of contents-data-strong?, which also takes XML comments and XML processing instructions into account.
; Used in xml-sort-tag-parameters.</span><br /><a name="x-contents-data-strong?"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(x-contents-data-strong? x . optional-parameter-list)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX118" title="R5RS Scheme form">or</a> (<a class="applied-name" href="xml-in-laml-1.html#cdata?" title="xml-in-laml">cdata?</a> x) (<a class="applied-name" href="xml-in-laml-1.html#ast-strong?" title="xml-in-laml">ast-strong?</a> x) (<a class="applied-name" href="xml-in-laml-1.html#char-ref?" title="xml-in-laml">char-ref?</a> x) (<a class="applied-name" href="xml-in-laml-1.html#cdata-section?" title="xml-in-laml">cdata-section?</a> x))  <span class="comment">; test easy cases first - for efficiency reasons</span><br />     #t
     (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">language</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#optional-parameter" title="Manual: general">optional-parameter</a> 1  optional-parameter-list #f)))   <span class="comment">; do full and original test in case the easy cases fail</span><br />       (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> language
	   (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX118" title="R5RS Scheme form">or</a> (<a class="applied-name" href="xml-in-laml-1.html#contents-data-strong?" title="xml-in-laml">contents-data-strong?</a> x language)
	       (<a class="applied-name" href="xml-in-laml-1.html#xml-comment?" title="xml-in-laml">xml-comment?</a> x)
	       (<a class="applied-name" href="xml-in-laml-1.html#processing-instruction?" title="xml-in-laml">processing-instruction?</a> x)
	       (<a class="applied-name" href="xml-in-laml-1.html#delayed-procedural-contents-element?" title="xml-in-laml">delayed-procedural-contents-element?</a> x)
	       )
	   (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX118" title="R5RS Scheme form">or</a> (<a class="applied-name" href="xml-in-laml-1.html#contents-data-strong?" title="xml-in-laml">contents-data-strong?</a> x)
	       (<a class="applied-name" href="xml-in-laml-1.html#xml-comment?" title="xml-in-laml">xml-comment?</a> x)
	       (<a class="applied-name" href="xml-in-laml-1.html#processing-instruction?" title="xml-in-laml">processing-instruction?</a> x)
	       (<a class="applied-name" href="xml-in-laml-1.html#delayed-procedural-contents-element?" title="xml-in-laml">delayed-procedural-contents-element?</a> x)
	       )))))
 

<a name="xml-modify-attribute-list"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(xml-modify-attribute-list attribute-prop-list kind)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> kind 'keep-all) attribute-prop-list)
       ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> kind 'keep-first) (<a class="applied-name" href="xml-in-laml-1.html#remove-duplicate-properties-keep-first" title="xml-in-laml">remove-duplicate-properties-keep-first</a> attribute-prop-list))
       ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> kind 'keep-last) (<a class="applied-name" href="xml-in-laml-1.html#remove-duplicate-properties-keep-last" title="xml-in-laml">remove-duplicate-properties-keep-last</a> attribute-prop-list))
       (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#laml-error" title="Manual: general">laml-error</a> "xml-modify-attribute-list: Unknown kind of attribute modification" kind))))

<a name="remove-duplicate-properties-keep-first"></a><span class="comment">; Remove duplicate properties non-destructively. Keep first duplicate. Comparison done by eq?</span><br /><a name="remove-duplicate-properties-keep-first"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(remove-duplicate-properties-keep-first proplist)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX123" title="R5RS Scheme form">letrec</a> ((<span class="local-name-binding">remove-duplicate-properties-keep-first-help</span>
             (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">proplist</span> <span class="local-name-binding">seen-keys</span>)
               (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> proplist) '())
                     ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX338" title="R5RS Scheme form">memq</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> proplist) seen-keys) (remove-duplicate-properties-keep-first-help (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cddr</a> proplist) seen-keys))
                     (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> proplist) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cadr</a> proplist) 
                              (remove-duplicate-properties-keep-first-help (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cddr</a> proplist) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> proplist) seen-keys)))))))))
  (remove-duplicate-properties-keep-first-help proplist '())))

<a name="remove-duplicate-properties-keep-last"></a><span class="comment">; Remove duplicate properties non-destructively. Keep last duplicated. Comparison done by eq?</span><br /><a name="remove-duplicate-properties-keep-last"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(remove-duplicate-properties-keep-last proplist)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX123" title="R5RS Scheme form">letrec</a> ((<span class="local-name-binding">memq-prop-list</span> 
            (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">prop</span> <span class="local-name-binding">proplist</span>)
              (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> proplist)
                  #f
                  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX118" title="R5RS Scheme form">or</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> proplist) prop) (memq-prop-list prop (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> proplist))))))
                  
          (<span class="local-name-binding">remove-duplicate-properties-keep-last-help</span>
             (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">proplist</span>)
               (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> proplist) '())
                     ((memq-prop-list (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> proplist) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cddr</a> proplist)) 
                         (remove-duplicate-properties-keep-last-help (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cddr</a> proplist)))
                     (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> proplist) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cadr</a> proplist) 
                              (remove-duplicate-properties-keep-last-help (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cddr</a> proplist))))))))
         )
  (remove-duplicate-properties-keep-last-help proplist)))


  




<a name="xml-sort-error"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(xml-sort-error message parameters)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">max-str-lgt</span> <a class="applied-name" href="xml-in-laml-1.html#xml-error-truncation-length" title="xml-in-laml">xml-error-truncation-length</a>)  
        (<span class="local-name-binding">parameters-2</span> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX237" title="R5RS Scheme form">&gt;</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX378" title="R5RS Scheme form">string-length</a> parameters) max-str-lgt) 
                        (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX391" title="R5RS Scheme form">substring</a> parameters 0 (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> max-str-lgt 1)) "...")
                        parameters)))
  (<a class="schemedoc-name" href="../../../../lib/man/general.html#laml-error" title="Manual: general">laml-error</a>
      "***" message (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> #\newline)
      "  The list of parameters: " parameters-2 (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> #\newline))))

<a name="laml-source-prepare"></a><a name="laml-source-prepare"></a><span><a href="../xml-in-laml.html#laml-source-prepare"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(laml-source-prepare laml-lst)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> laml-lst) laml-lst)
        ((<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="applied-name" href="xml-in-laml-1.html#white-space-related?" title="xml-in-laml">white-space-related?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> laml-lst)) (<a class="applied-name" href="xml-in-laml-1.html#forced-white-space?" title="xml-in-laml">forced-white-space?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> laml-lst)))  <span class="comment">; always remove forced-white-space marker</span><br />           (<a class="applied-name" href="xml-in-laml-1.html#laml-source-prepare" title="xml-in-laml">laml-source-prepare</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> laml-lst)))
        ((<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> laml-lst))) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="applied-name" href="xml-in-laml-1.html#white-space-related?" title="xml-in-laml">white-space-related?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> laml-lst))) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="applied-name" href="xml-in-laml-1.html#white-space-related?" title="xml-in-laml">white-space-related?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cadr</a> laml-lst))))  <span class="comment">; insert white space suppress </span><br />           (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> laml-lst) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> <a class="applied-name" href="xml-in-laml-1.html#explicit-space-suppress" title="xml-in-laml">explicit-space-suppress</a> (<a class="applied-name" href="xml-in-laml-1.html#laml-source-prepare" title="xml-in-laml">laml-source-prepare</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cadr</a> laml-lst) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cddr</a> laml-lst))))))
        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> laml-lst) (<a class="applied-name" href="xml-in-laml-1.html#laml-source-prepare" title="xml-in-laml">laml-source-prepare</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> laml-lst))))))

<span class="comment">; -----------------------------------------------------------------------------------------------------------------------</span><br />
<a name="generate-xml-mirror-function"></a><a name="generate-xml-mirror-function"></a><span><a href="../xml-in-laml.html#generate-xml-mirror-function"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(generate-xml-mirror-function validation-procedure tag-name default-dtd-attributes single-double-kind language overlap-check? action-procedure)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> single-double-kind 'double)
        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> <span class="local-name-binding">parameters</span>
          (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">contents-attributes</span> (<a class="applied-name" href="xml-in-laml-1.html#xml-sort-tag-parameters" title="xml-in-laml">xml-sort-tag-parameters</a> parameters tag-name language))
                 (<span class="local-name-binding">contents</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> contents-attributes))
                 (<span class="local-name-binding">attributes</span> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="applied-name" href="xml-in-laml-1.html#xml-pass-default-dtd-attributes-in?" title="xml-in-laml">xml-pass-default-dtd-attributes-in?</a> language)
                                 (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX334" title="R5RS Scheme form">append</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> contents-attributes) default-dtd-attributes)
                                 (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> contents-attributes)))
                 (<span class="local-name-binding">split-attributes</span> (<a class="applied-name" href="xml-in-laml-1.html#split-xml-and-internal-attributes" title="xml-in-laml">split-xml-and-internal-attributes</a> attributes))
                 (<span class="local-name-binding">xml-attributes</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> split-attributes))
                 (<span class="local-name-binding">internal-attributes</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> split-attributes))
                 (<span class="local-name-binding">run-action-procedure?</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-boolean" title="Manual: general">as-boolean</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#defaulted-get-prop" title="Manual: general">defaulted-get-prop</a> 'run-action-procedure internal-attributes #t)))  
                )
            (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="applied-name" href="xml-in-laml-1.html#has-procedural-content-items?" title="xml-in-laml">has-procedural-content-items?</a> contents)) 
                (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX118" title="R5RS Scheme form">or</a> <a class="applied-name" href="xml-in-laml-1.html#xml-check-attributes?" title="xml-in-laml">xml-check-attributes?</a> <a class="applied-name" href="xml-in-laml-1.html#xml-validate-contents?" title="xml-in-laml">xml-validate-contents?</a> overlap-check?)  <span class="comment">; checked here for improved efficiency</span><br />                    (validation-procedure tag-name xml-attributes contents overlap-check?))
            )  <span class="comment">; postpone validation in case of procedural contents!</span><br />            (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> action-procedure
                (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">real-action-procedure</span> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX305" title="R5RS Scheme form">boolean?</a> action-procedure) 
                                                     (<a class="applied-name" href="xml-in-laml-1.html#action-procedure-of-language" title="xml-in-laml">action-procedure-of-language</a> tag-name language))
                                                    ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX410" title="R5RS Scheme form">procedure?</a> action-procedure)
                                                      action-procedure)
                                                    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#laml-error" title="Manual: general">laml-error</a> "generate-xml-mirror-function: Invalid action procedure"))))
                      (<span class="local-name-binding">the-ast</span> (<a class="applied-name" href="xml-in-laml-1.html#make-ast" title="xml-in-laml">make-ast</a> tag-name contents xml-attributes 'double language internal-attributes)))
                  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> run-action-procedure? (real-action-procedure the-ast))
                  the-ast)
                 (<a class="applied-name" href="xml-in-laml-1.html#make-ast" title="xml-in-laml">make-ast</a> tag-name contents xml-attributes 'double language internal-attributes)
            ))))
           

       ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> single-double-kind 'single)   
          (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> <span class="local-name-binding">parameters</span>
            (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">contents-attributes</span> (<a class="applied-name" href="xml-in-laml-1.html#xml-sort-tag-parameters" title="xml-in-laml">xml-sort-tag-parameters</a> parameters tag-name language))
                   (<span class="local-name-binding">contents</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> contents-attributes))
                   (<span class="local-name-binding">attributes</span> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="applied-name" href="xml-in-laml-1.html#xml-pass-default-dtd-attributes-in?" title="xml-in-laml">xml-pass-default-dtd-attributes-in?</a> language)
                                   (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX334" title="R5RS Scheme form">append</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> contents-attributes) default-dtd-attributes)
                                   (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> contents-attributes)))
                   (<span class="local-name-binding">split-attributes</span> (<a class="applied-name" href="xml-in-laml-1.html#split-xml-and-internal-attributes" title="xml-in-laml">split-xml-and-internal-attributes</a> attributes))
                   (<span class="local-name-binding">xml-attributes</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> split-attributes))
                   (<span class="local-name-binding">internal-attributes</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> split-attributes))
                   (<span class="local-name-binding">run-action-procedure?</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-boolean" title="Manual: general">as-boolean</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#defaulted-get-prop" title="Manual: general">defaulted-get-prop</a> 'run-action-procedure internal-attributes #t)))  
                  )
              (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="applied-name" href="xml-in-laml-1.html#has-procedural-content-items?" title="xml-in-laml">has-procedural-content-items?</a> contents))
                  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX118" title="R5RS Scheme form">or</a> <a class="applied-name" href="xml-in-laml-1.html#xml-check-attributes?" title="xml-in-laml">xml-check-attributes?</a> <a class="applied-name" href="xml-in-laml-1.html#xml-validate-contents?" title="xml-in-laml">xml-validate-contents?</a> overlap-check?)  <span class="comment">; checked here for improved efficiency</span><br />                      (validation-procedure tag-name xml-attributes contents overlap-check?))  <span class="comment">; postpone validation in case of procedural contents!</span><br />              )
              (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> action-procedure
                  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">real-action-procedure</span> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX305" title="R5RS Scheme form">boolean?</a> action-procedure) 
                                                     (<a class="applied-name" href="xml-in-laml-1.html#action-procedure-of-language" title="xml-in-laml">action-procedure-of-language</a> tag-name language))
                                                    ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX410" title="R5RS Scheme form">procedure?</a> action-procedure)
                                                      action-procedure)
                                                    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#laml-error" title="Manual: general">laml-error</a> "generate-xml-mirror-function: Invalid action procedure"))))
                        (<span class="local-name-binding">the-ast</span> (<a class="applied-name" href="xml-in-laml-1.html#make-ast" title="xml-in-laml">make-ast</a> tag-name contents xml-attributes 'single language internal-attributes)))  <span class="comment">; Before June 4, 2008: Empty contents. </span><br />                    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> run-action-procedure? (real-action-procedure the-ast))                                       <span class="comment">; Pass contents because it may hold delayed procedure content items.</span><br />                    the-ast)
                  (<a class="applied-name" href="xml-in-laml-1.html#make-ast" title="xml-in-laml">make-ast</a> tag-name contents xml-attributes 'single language internal-attributes)  <span class="comment">; Before June 4, 2008: Empty contents. </span><br />              )                                                                                     
            )
          )
       )

       (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (error (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> "generate-xml-mirror-function: unknown single-double-kind: " (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> single-double-kind))))
 )
)

<a name="split-xml-and-internal-attributes"></a><span class="comment">; Return a cons pair of ordinary XML attributes and the internal attributes.
; Strips the 'internal:' part of the name of internal attributes. </span><br /><a name="split-xml-and-internal-attributes"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(split-xml-and-internal-attributes prop-list)</span>
  (<a class="applied-name" href="xml-in-laml-1.html#split-xml-and-internal-attributes-1" title="xml-in-laml">split-xml-and-internal-attributes-1</a> prop-list '() '())) 

<a name="split-xml-and-internal-attributes-1"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(split-xml-and-internal-attributes-1 prop-list prop-list-xml prop-list-internal)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> prop-list) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX335" title="R5RS Scheme form">reverse</a> prop-list-xml) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX335" title="R5RS Scheme form">reverse</a> prop-list-internal)))
        ((<a class="applied-name" href="xml-in-laml-1.html#internal-attribute-name?" title="xml-in-laml">internal-attribute-name?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> prop-list))
               (<a class="applied-name" href="xml-in-laml-1.html#split-xml-and-internal-attributes-1" title="xml-in-laml">split-xml-and-internal-attributes-1</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cddr</a> prop-list) prop-list-xml (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cadr</a> prop-list) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="applied-name" href="xml-in-laml-1.html#drop-internal-prefix" title="xml-in-laml">drop-internal-prefix</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> prop-list)) prop-list-internal))))
        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a>  (<a class="applied-name" href="xml-in-laml-1.html#split-xml-and-internal-attributes-1" title="xml-in-laml">split-xml-and-internal-attributes-1</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cddr</a> prop-list) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cadr</a> prop-list) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> prop-list) prop-list-xml)) prop-list-internal))))
  
<a name="internal-attribute-name?"></a><span class="comment">; Is attr-name (a symbol) an internal attribute name.
; True if it has the prefix 'internal:'</span><br /><a name="internal-attribute-name?"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(internal-attribute-name? attr-name)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">attr-name-string</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> attr-name)))
    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX239" title="R5RS Scheme form">&gt;=</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX378" title="R5RS Scheme form">string-length</a> attr-name-string) 9)
         (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX200" title="R5RS Scheme form">equal?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX391" title="R5RS Scheme form">substring</a> attr-name-string 0 9) "internal:"))))

<a name="drop-internal-prefix"></a><span class="comment">; Precondition: internal-attr-name is a name (symbol) with prefix 'internal:'
; Return the attribute name (a symbol) without the 'internal:' prefix.</span><br /><a name="drop-internal-prefix"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(drop-internal-prefix internal-attr-name)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">internal-attr-name-string</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> internal-attr-name)) 
        (<span class="local-name-binding">str-lgt</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX378" title="R5RS Scheme form">string-length</a> internal-attr-name-string)))
  (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-symbol" title="Manual: general">as-symbol</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX391" title="R5RS Scheme form">substring</a> internal-attr-name-string 9 str-lgt))))
  



<span class="comment">; ---------------------------------------------------------------------------------------------------------------</span><br />
<div class="schemedoc-section-comment">;;; Contents Validation. 
;;; The definitions in this section carry out the content validation. 
;;; Throughout the procedures in this section it is assumed that delayed procedural content items have been expaneded
;;; before content validation is attempted. 
;;; .section-id validation</div>
<span class="comment">; XML document validation.
; The non-trivial validation cases are based on the automata generated by tools/xml-in-laml/xml-in-laml.scm.</span><br />

<a name="terminator-symbol"></a><span class="comment">; The symbol which is assumed to end all input to the dfa. 
; The value of this variable must comply with the similar constant in tools/xml-in-laml/xml-in-laml.scm.</span><br /><a name="terminator-symbol"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">terminator-symbol</span> 'terminator$$)

<a name="textual-content-symbol"></a><span class="comment">; The symbol that represents textual contents (pcdata) during validation.</span><br /><a name="textual-content-symbol"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">textual-content-symbol</span> 'textual-contents$$)

<a name="non-textual-content-symbol"></a><span class="comment">; The symbol that represents "non textual contents",  such as XML comments.</span><br /><a name="non-textual-content-symbol"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">non-textual-content-symbol</span> 'non-textual-contents$$)


<a name="validate-contents-by-dfa!"></a><a name="validate-contents-by-dfa!"></a><span><a href="../xml-in-laml.html#validate-contents-by-dfa!"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(validate-contents-by-dfa! contents dfa tag-name)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX331" title="R5RS Scheme form">list?</a> contents)) (<a class="schemedoc-name" href="../../../../lib/man/general.html#laml-error" title="Manual: general">laml-error</a> "Contents passed to validate-contents-by-dfa! is assumed to be a list"))
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">augmented-contents</span> (<a class="applied-name" href="xml-in-laml-1.html#xml-prepare-contents-for-validation" title="xml-in-laml">xml-prepare-contents-for-validation</a> contents))
        (<span class="local-name-binding">accepted</span> (<a class="schemedoc-name" href="../../../../lib/man/final-state-automaton.html#automaton-accepts?" title="Manual: final-state-automaton">automaton-accepts?</a> dfa augmented-contents)))
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> accepted)
      (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> last-automaton-input-symbol)
               (<a class="applied-name" href="xml-in-laml-1.html#xml-check-error" title="xml-in-laml">xml-check-error</a> "Empty and insufficient input to" (<a class="applied-name" href="xml-in-laml-1.html#a-or-an" title="xml-in-laml">a-or-an</a> tag-name) (<a class="applied-name" href="xml-in-laml-1.html#as-string-spacy" title="xml-in-laml">as-string-spacy</a> tag-name) "element." (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> #\newline)
                        "  " (<a class="applied-name" href="xml-in-laml-1.html#truncate-string" title="xml-in-laml">truncate-string</a> (<a class="applied-name" href="xml-in-laml-1.html#xml-render-error-message" title="xml-in-laml">xml-render-error-message</a> contents))))
            ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> last-automaton-input-symbol <a class="applied-name" href="xml-in-laml-1.html#terminator-symbol" title="xml-in-laml">terminator-symbol</a>)
               (<a class="applied-name" href="xml-in-laml-1.html#xml-check-error" title="xml-in-laml">xml-check-error</a> "Abrupt termination of" (<a class="applied-name" href="xml-in-laml-1.html#a-or-an" title="xml-in-laml">a-or-an</a> tag-name) (<a class="applied-name" href="xml-in-laml-1.html#as-string-spacy" title="xml-in-laml">as-string-spacy</a> tag-name) "element:" (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> #\newline)
                        "  " (<a class="applied-name" href="xml-in-laml-1.html#truncate-string" title="xml-in-laml">truncate-string</a> (<a class="applied-name" href="xml-in-laml-1.html#xml-render-error-message" title="xml-in-laml">xml-render-error-message</a> contents))))
            ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> last-automaton-input-symbol <a class="applied-name" href="xml-in-laml-1.html#textual-content-symbol" title="xml-in-laml">textual-content-symbol</a>)
               (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">the-textual-contents</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX337" title="R5RS Scheme form">list-ref</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#filter" title="Manual: general">filter</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#negate" title="Manual: general">negate</a> <a class="applied-name" href="xml-in-laml-1.html#white-space-related?" title="xml-in-laml">white-space-related?</a>) contents) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX247" title="R5RS Scheme form">max</a> 0 (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> automaton-input-number 1)))))
                (<a class="applied-name" href="xml-in-laml-1.html#xml-check-error" title="xml-in-laml">xml-check-error</a> "Textual contents" (<a class="applied-name" href="xml-in-laml-1.html#xml-render-error-message" title="xml-in-laml">xml-render-error-message</a> the-textual-contents) "is illegal in" (<a class="applied-name" href="xml-in-laml-1.html#a-or-an" title="xml-in-laml">a-or-an</a> tag-name) 
                                  (<a class="applied-name" href="xml-in-laml-1.html#as-string-spacy" title="xml-in-laml">as-string-spacy</a> tag-name) "element:" (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> #\newline)
                        "  " (<a class="applied-name" href="xml-in-laml-1.html#truncate-string" title="xml-in-laml">truncate-string</a> (<a class="applied-name" href="xml-in-laml-1.html#xml-render-error-message" title="xml-in-laml">xml-render-error-message</a> contents)))))
            (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> 
               (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="applied-name" href="xml-in-laml-1.html#extraordinary-allow-element?" title="xml-in-laml">extraordinary-allow-element?</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-symbol" title="Manual: general">as-symbol</a> last-automaton-input-symbol) (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-symbol" title="Manual: general">as-symbol</a> tag-name)))
                   (<a class="applied-name" href="xml-in-laml-1.html#xml-check-error" title="xml-in-laml">xml-check-error</a> "Encountered a misplaced" (<a class="applied-name" href="xml-in-laml-1.html#as-string-spacy" title="xml-in-laml">as-string-spacy</a> last-automaton-input-symbol) "element within"
                                     (<a class="applied-name" href="xml-in-laml-1.html#a-or-an" title="xml-in-laml">a-or-an</a> tag-name) (<a class="applied-name" href="xml-in-laml-1.html#as-string-spacy" title="xml-in-laml">as-string-spacy</a> tag-name) "element:" (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> #\newline)
                                     "  " (<a class="applied-name" href="xml-in-laml-1.html#truncate-string" title="xml-in-laml">truncate-string</a> (<a class="applied-name" href="xml-in-laml-1.html#xml-render-error-message" title="xml-in-laml">xml-render-error-message</a> contents)))))))))


<a name="validate-as-pcdata!"></a><a name="validate-as-pcdata!"></a><span><a href="../xml-in-laml.html#validate-as-pcdata!"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(validate-as-pcdata! contents tag-name)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX331" title="R5RS Scheme form">list?</a> contents)) (<a class="schemedoc-name" href="../../../../lib/man/general.html#laml-error" title="Manual: general">laml-error</a> "Contents passed to validate-as-pcdata! is assumed to be a list"))
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">res</span> (<a class="applied-name" href="xml-in-laml-1.html#do-validate-pcdata-contents" title="xml-in-laml">do-validate-pcdata-contents</a> contents)))
    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX118" title="R5RS Scheme form">or</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX346" title="R5RS Scheme form">symbol?</a> res) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX374" title="R5RS Scheme form">string?</a> res))
             (<a class="applied-name" href="xml-in-laml-1.html#xml-check-error" title="xml-in-laml">xml-check-error</a> "Encountered a misplaced" (<a class="applied-name" href="xml-in-laml-1.html#as-string-spacy" title="xml-in-laml">as-string-spacy</a> res) "element in" (<a class="applied-name" href="xml-in-laml-1.html#a-or-an" title="xml-in-laml">a-or-an</a> tag-name)
                              (<a class="applied-name" href="xml-in-laml-1.html#as-string-spacy" title="xml-in-laml">as-string-spacy</a> tag-name) "element, where only textual contents is allowed." (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> #\newline)
                "  "  (<a class="applied-name" href="xml-in-laml-1.html#truncate-string" title="xml-in-laml">truncate-string</a> (<a class="applied-name" href="xml-in-laml-1.html#xml-render-error-message" title="xml-in-laml">xml-render-error-message</a> contents))))
          ((<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX305" title="R5RS Scheme form">boolean?</a> res) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> res))
             (<a class="applied-name" href="xml-in-laml-1.html#xml-check-error" title="xml-in-laml">xml-check-error</a> "Unindentified problem in" (<a class="applied-name" href="xml-in-laml-1.html#a-or-an" title="xml-in-laml">a-or-an</a> tag-name) (<a class="applied-name" href="xml-in-laml-1.html#as-string-spacy" title="xml-in-laml">as-string-spacy</a> tag-name) "element." (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> #\newline)
                "  "  (<a class="applied-name" href="xml-in-laml-1.html#truncate-string" title="xml-in-laml">truncate-string</a> (<a class="applied-name" href="xml-in-laml-1.html#xml-render-error-message" title="xml-in-laml">xml-render-error-message</a> contents)))))))

<a name="do-validate-pcdata-contents"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(do-validate-pcdata-contents contents)</span>
  (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX417" title="R5RS Scheme form">call-with-current-continuation</a> 
    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">exit</span>)
     (<a class="applied-name" href="xml-in-laml-1.html#do-validate-pcdata-contents-1" title="xml-in-laml">do-validate-pcdata-contents-1</a> contents exit))))

<a name="do-validate-pcdata-contents-1"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(do-validate-pcdata-contents-1 contents return)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> contents) #t) 
        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">content-item</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> contents)))
                 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> content-item)  (return (<a class="applied-name" href="xml-in-laml-1.html#ast-element-name" title="xml-in-laml">ast-element-name</a> content-item)))
                       ((<a class="applied-name" href="xml-in-laml-1.html#cdata?" title="xml-in-laml">cdata?</a> content-item) #t)
                       ((<a class="applied-name" href="xml-in-laml-1.html#char-ref?" title="xml-in-laml">char-ref?</a> content-item) #t)
                       ((<a class="applied-name" href="xml-in-laml-1.html#cdata-section?" title="xml-in-laml">cdata-section?</a> content-item) #t)
                       ((<a class="applied-name" href="xml-in-laml-1.html#white-space-related?" title="xml-in-laml">white-space-related?</a> content-item) #t)
                       (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (return #f)))
                 (<a class="applied-name" href="xml-in-laml-1.html#do-validate-pcdata-contents-1" title="xml-in-laml">do-validate-pcdata-contents-1</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> contents) return)))))

<a name="validate-mixed-contents-by-simple-means!"></a><a name="validate-mixed-contents-by-simple-means!"></a><span><a href="../xml-in-laml.html#validate-mixed-contents-by-simple-means!"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(validate-mixed-contents-by-simple-means! contents symbol-choice-list tag-name)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX331" title="R5RS Scheme form">list?</a> contents)) (<a class="schemedoc-name" href="../../../../lib/man/general.html#laml-error" title="Manual: general">laml-error</a> "Contents passed to validate-mixed-contents-by-simple-means! is assumed to be a list"))
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">res</span> (<a class="applied-name" href="xml-in-laml-1.html#do-validate-mixed-contents" title="xml-in-laml">do-validate-mixed-contents</a> contents symbol-choice-list tag-name)))
    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX118" title="R5RS Scheme form">or</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX346" title="R5RS Scheme form">symbol?</a> res) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX374" title="R5RS Scheme form">string?</a> res))
             (<a class="applied-name" href="xml-in-laml-1.html#xml-check-error" title="xml-in-laml">xml-check-error</a> "Encountered a misplaced" (<a class="applied-name" href="xml-in-laml-1.html#as-string-spacy" title="xml-in-laml">as-string-spacy</a> res) "in" (<a class="applied-name" href="xml-in-laml-1.html#a-or-an" title="xml-in-laml">a-or-an</a> tag-name) (<a class="applied-name" href="xml-in-laml-1.html#as-string-spacy" title="xml-in-laml">as-string-spacy</a> tag-name) "element." (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> #\newline) 
                "  "  (<a class="applied-name" href="xml-in-laml-1.html#truncate-string" title="xml-in-laml">truncate-string</a> (<a class="applied-name" href="xml-in-laml-1.html#xml-render-error-message" title="xml-in-laml">xml-render-error-message</a> contents))))
          ((<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX305" title="R5RS Scheme form">boolean?</a> res) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> res))
             (<a class="applied-name" href="xml-in-laml-1.html#xml-check-error" title="xml-in-laml">xml-check-error</a> "Unidentified problem in" (<a class="applied-name" href="xml-in-laml-1.html#a-or-an" title="xml-in-laml">a-or-an</a> tag-name) (<a class="applied-name" href="xml-in-laml-1.html#as-string-spacy" title="xml-in-laml">as-string-spacy</a> tag-name) "element." (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> #\newline)
                "  "  (<a class="applied-name" href="xml-in-laml-1.html#truncate-string" title="xml-in-laml">truncate-string</a> (<a class="applied-name" href="xml-in-laml-1.html#xml-render-error-message" title="xml-in-laml">xml-render-error-message</a> contents)))))))
   

<a name="do-validate-mixed-contents"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(do-validate-mixed-contents contents symbol-choice-list element-name)</span>
  (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX417" title="R5RS Scheme form">call-with-current-continuation</a> 
    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">exit</span>)
     (<a class="applied-name" href="xml-in-laml-1.html#do-validate-mixed-contents-1" title="xml-in-laml">do-validate-mixed-contents-1</a> contents symbol-choice-list exit element-name))))

<a name="do-validate-mixed-contents-1"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(do-validate-mixed-contents-1 contents symbol-choice-list return element-name)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> contents) #t) 
        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">content-item</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> contents)))
                 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> content-item) (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX118" title="R5RS Scheme form">or</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX338" title="R5RS Scheme form">memq</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-symbol" title="Manual: general">as-symbol</a> (<a class="applied-name" href="xml-in-laml-1.html#ast-element-name" title="xml-in-laml">ast-element-name</a> content-item)) symbol-choice-list)
                                                    (<a class="applied-name" href="xml-in-laml-1.html#extraordinary-allow-element?" title="xml-in-laml">extraordinary-allow-element?</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-symbol" title="Manual: general">as-symbol</a> (<a class="applied-name" href="xml-in-laml-1.html#ast-element-name" title="xml-in-laml">ast-element-name</a> content-item)) (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-symbol" title="Manual: general">as-symbol</a> element-name)))
                                                #t
                                                (return (<a class="applied-name" href="xml-in-laml-1.html#ast-element-name" title="xml-in-laml">ast-element-name</a> content-item))))
                       ((<a class="applied-name" href="xml-in-laml-1.html#cdata?" title="xml-in-laml">cdata?</a> content-item) #t)
                       ((<a class="applied-name" href="xml-in-laml-1.html#char-ref?" title="xml-in-laml">char-ref?</a> content-item) #t)
                       ((<a class="applied-name" href="xml-in-laml-1.html#xml-comment?" title="xml-in-laml">xml-comment?</a> content-item) #t)
                       ((<a class="applied-name" href="xml-in-laml-1.html#processing-instruction?" title="xml-in-laml">processing-instruction?</a> content-item) #t)
                       ((<a class="applied-name" href="xml-in-laml-1.html#cdata-section?" title="xml-in-laml">cdata-section?</a> content-item) #t)
                       ((<a class="applied-name" href="xml-in-laml-1.html#white-space-related?" title="xml-in-laml">white-space-related?</a> content-item) #t)
                       (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (return #f)))
                 (<a class="applied-name" href="xml-in-laml-1.html#do-validate-mixed-contents-1" title="xml-in-laml">do-validate-mixed-contents-1</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> contents) symbol-choice-list return element-name)))))

<a name="extraordinary-allow-element?"></a><a name="extraordinary-allow-element?"></a><span><a href="../xml-in-laml.html#extraordinary-allow-element?"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(extraordinary-allow-element? element-name context-element-name)</span>
  #f)


<a name="xml-prepare-contents-for-validation"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(xml-prepare-contents-for-validation contents)</span>
  (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX334" title="R5RS Scheme form">append</a>
    (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">content-item</span>)
           (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> content-item) (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-symbol" title="Manual: general">as-symbol</a> (<a class="applied-name" href="xml-in-laml-1.html#ast-element-name" title="xml-in-laml">ast-element-name</a> content-item)))
                 ((<a class="applied-name" href="xml-in-laml-1.html#cdata?" title="xml-in-laml">cdata?</a> content-item) <a class="applied-name" href="xml-in-laml-1.html#textual-content-symbol" title="xml-in-laml">textual-content-symbol</a>)
                 ((<a class="applied-name" href="xml-in-laml-1.html#char-ref?" title="xml-in-laml">char-ref?</a> content-item) <a class="applied-name" href="xml-in-laml-1.html#textual-content-symbol" title="xml-in-laml">textual-content-symbol</a>)
                 ((<a class="applied-name" href="xml-in-laml-1.html#cdata-section?" title="xml-in-laml">cdata-section?</a> content-item) <a class="applied-name" href="xml-in-laml-1.html#textual-content-symbol" title="xml-in-laml">textual-content-symbol</a>)
                 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#laml-error" title="Manual: general">laml-error</a> "xml-prepare-contents-for-validation: Unknown element content item:" content-item))))
         (<a class="schemedoc-name" href="../../../../lib/man/general.html#filter" title="Manual: general">filter</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#negate" title="Manual: general">negate</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#disjunction" title="Manual: general">disjunction</a> <a class="applied-name" href="xml-in-laml-1.html#processing-instruction?" title="xml-in-laml">processing-instruction?</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#disjunction" title="Manual: general">disjunction</a> <a class="applied-name" href="xml-in-laml-1.html#white-space-related?" title="xml-in-laml">white-space-related?</a> <a class="applied-name" href="xml-in-laml-1.html#xml-comment?" title="xml-in-laml">xml-comment?</a>))) contents))
    (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> <a class="applied-name" href="xml-in-laml-1.html#terminator-symbol" title="xml-in-laml">terminator-symbol</a>)))

<a name="xml-check-for-empty-contents!"></a><span class="comment">; Empty contents checking of empty elements. Allow XML comments and processing instructions.</span><br /><a name="xml-check-for-empty-contents!"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(xml-check-for-empty-contents! contents tag-name)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">filtered-contents</span>   <span class="comment">; filtering away PIs and XML comments. Notice that these are (p.t.) not rendered anyway in empty elements.</span><br />         (<a class="schemedoc-name" href="../../../../lib/man/general.html#filter" title="Manual: general">filter</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#negate" title="Manual: general">negate</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#disjunction" title="Manual: general">disjunction</a> <a class="applied-name" href="xml-in-laml-1.html#white-space-related?" title="xml-in-laml">white-space-related?</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#disjunction" title="Manual: general">disjunction</a> <a class="applied-name" href="xml-in-laml-1.html#processing-instruction?" title="xml-in-laml">processing-instruction?</a>  <a class="applied-name" href="xml-in-laml-1.html#xml-comment?" title="xml-in-laml">xml-comment?</a>))) contents)))
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> filtered-contents))
      (<a class="applied-name" href="xml-in-laml-1.html#xml-check-error" title="xml-in-laml">xml-check-error</a> 
        (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> "The empty element" (<a class="applied-name" href="xml-in-laml-1.html#as-string-spacy" title="xml-in-laml">as-string-spacy</a> tag-name) "is not supposed to have any content:" (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> #\newline)
                       "  " (<a class="applied-name" href="xml-in-laml-1.html#xml-render-error-message" title="xml-in-laml">xml-render-error-message</a> filtered-contents) (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> #\newline) "  " "The element content is ignored.")))))

<a name="a-or-an"></a><span class="comment">; Return "a" or "an" depending on following-word.
; following-word is string-converted by this function.</span><br /><a name="a-or-an"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(a-or-an following-word)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">following-word-1</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> following-word)))
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="schemedoc-name" href="../../../../lib/man/general.html#blank-string?" title="Manual: general">blank-string?</a> following-word-1) "a")
        ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX237" title="R5RS Scheme form">&gt;</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX378" title="R5RS Scheme form">string-length</a> following-word-1) 0)
         (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">first-char</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX379" title="R5RS Scheme form">string-ref</a> following-word-1 0)))
           (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX339" title="R5RS Scheme form">memv</a> first-char (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> #\a #\e #\i #\o #\u #\y ))
               "an"
               "a")))
        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> "a"))))

<a name="as-string-spacy"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(as-string-spacy x)</span>
 (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> " " (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> x) " "))


<a name="indented-terminal-lines"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(indented-terminal-lines line-list)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">sep</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> #\newline) "  ")))
  (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> sep (<a class="schemedoc-name" href="../../../../lib/man/general.html#list-to-string" title="Manual: general">list-to-string</a> line-list sep))))


<span class="comment">; ; A predicate which always gives positive validation.
; ; Used if the xml-in-laml tool constant use-manually-programmed-validation-predicates is #f.
; (define (faked-generice-content-checker x)
;   #t)</span><br />

<a name="and-fn"></a><span class="comment">; and as a function - as opposed to a macro.</span><br /><a name="and-fn"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(and-fn x y)</span> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> x y))
<a name="or-fn"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(or-fn x y)</span> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX118" title="R5RS Scheme form">or</a> x y))



<span class="comment">; --------------------------------------------------------------------------------------------------------------------------------</span><br /><div class="schemedoc-section-comment">;;; Attribute Checking. 
;;; The definitions in this section is used by the validation procedures, which are specific
;;; for each supported XML language.
;;; &lt;em&gt; Current status of attribute checking&lt;/em&gt;: 
;;; From LAML version 27: The constrains regarding ID, IDREF, and IDREFS are now handled. See the function check-id-and-idref-attributes!.
;;; NotationTypes are not dealt with - mostly because I have never encountered them, so the motivation to
;;; program check for this special enumeration type is not high. The #FIXED default keyword is present in the parsed DTD
;;; information, but we do not carry out any check against it (which is: If the attribute is given it must have the fixed default value).
;;; The attribute value normalization called for in section 3.3.3 of the XML specificaiton is not done either. Attribute duplication
;;; is checked for, as well as presence of angle characters in attribute values.
;;; .section-id attribute-check</div>
<a name="xml-id-attribute-list"></a><span class="comment">; A list of attribute values for ID attributes.
; Such attribute values are required to be unique within the document. 
; This is checked by the procedure check-id-and-idref-attributes! .</span><br /><a name="xml-id-attribute-list"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">xml-id-attribute-list</span> '())

<a name="xml-idref-attribute-list"></a><span class="comment">; A list of attribute values for IDREF attributes.
; Such attribute values are required to refer to one of the ID attributes, collected in xml-id-attribute-list.
; This is checked by the procedure check-id-and-idref-attributes! .</span><br /><a name="xml-idref-attribute-list"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">xml-idref-attribute-list</span> '())

<a name="att-name"></a><span class="comment">; Attribute tripple selectors</span><br /><a name="att-name"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">att-name</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#make-selector-function" title="Manual: general">make-selector-function</a> 1))
<a name="att-type"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">att-type</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#make-selector-function" title="Manual: general">make-selector-function</a> 2))
<a name="att-status"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">att-status</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#make-selector-function" title="Manual: general">make-selector-function</a> 3))

<a name="xml-check-attributes!"></a><a name="xml-check-attributes!"></a><span><a href="../xml-in-laml.html#xml-check-attributes!"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(xml-check-attributes! attributes dtd-attribute-definition number-of-req-attributes tag-name)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX246" title="R5RS Scheme form">even?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX333" title="R5RS Scheme form">length</a> attributes))  <span class="comment">; if not, we report the error elsewhere</span><br />  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">required-attribute-names</span> 
           (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#compose" title="Manual: general">compose</a> <a class="schemedoc-name" href="../../../../lib/man/general.html#as-symbol" title="Manual: general">as-symbol</a> <a class="applied-name" href="xml-in-laml-1.html#att-name" title="xml-in-laml">att-name</a>) (<a class="schemedoc-name" href="../../../../lib/man/general.html#front-sublist" title="Manual: general">front-sublist</a> dtd-attribute-definition number-of-req-attributes)))
        (<span class="local-name-binding">dtd-attribute-names</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#compose" title="Manual: general">compose</a> <a class="schemedoc-name" href="../../../../lib/man/general.html#as-symbol" title="Manual: general">as-symbol</a> <a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a>) dtd-attribute-definition))
        (<span class="local-name-binding">attribute-names</span> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> attributes) '() (<a class="schemedoc-name" href="../../../../lib/man/general.html#every-second-element" title="Manual: general">every-second-element</a> attributes)))
        (<span class="local-name-binding">attribute-values</span> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> attributes) '() (<a class="schemedoc-name" href="../../../../lib/man/general.html#every-second-element" title="Manual: general">every-second-element</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> attributes))))
       )
    (<a class="applied-name" href="xml-in-laml-1.html#xml-check-required-attributes!" title="xml-in-laml">xml-check-required-attributes!</a> attribute-names required-attribute-names tag-name)
    (<a class="applied-name" href="xml-in-laml-1.html#xml-check-for-attribute-existence!" title="xml-in-laml">xml-check-for-attribute-existence!</a> attribute-names dtd-attribute-names tag-name)
    (<a class="applied-name" href="xml-in-laml-1.html#xml-check-for-attribute-types!" title="xml-in-laml">xml-check-for-attribute-types!</a> attribute-names attribute-values dtd-attribute-definition tag-name)
    (<a class="applied-name" href="xml-in-laml-1.html#xml-check-for-attribute-duplicates!" title="xml-in-laml">xml-check-for-attribute-duplicates!</a> attribute-names tag-name)
)))

<a name="check-id-and-idref-attributes!"></a><a name="check-id-and-idref-attributes!"></a><span><a href="../xml-in-laml.html#check-id-and-idref-attributes!"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(check-id-and-idref-attributes!)</span>
  <span class="comment">; See section 3.3.1 of the XML 1.0 Specificatioin.</span><br />
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">id-duplicates</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#duplicates-by-predicate" title="Manual: general">duplicates-by-predicate</a> <a class="applied-name" href="xml-in-laml-1.html#xml-id-attribute-list" title="xml-in-laml">xml-id-attribute-list</a> <a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX200" title="R5RS Scheme form">equal?</a>)))

    <span class="comment">; Check that all ID attribute values are unique</span><br />    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> id-duplicates))
        (<a class="applied-name" href="xml-in-laml-1.html#xml-check-error" title="xml-in-laml">xml-check-error</a> "The following ID attribute values are duplicated:" (<a class="schemedoc-name" href="../../../../lib/man/general.html#list-to-string" title="Manual: general">list-to-string</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> <a class="schemedoc-name" href="../../../../lib/man/general.html#string-it" title="Manual: general">string-it</a> id-duplicates) ",")))

    <span class="comment">; Check that all IDREF (and IDREFS) attribute values refer to an ID attribute in the current document.</span><br />    (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX413" title="R5RS Scheme form">for-each</a>
      (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">idref-attr-val</span>)
        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX340" title="R5RS Scheme form">member</a> idref-attr-val <a class="applied-name" href="xml-in-laml-1.html#xml-id-attribute-list" title="xml-in-laml">xml-id-attribute-list</a>))
            (<a class="applied-name" href="xml-in-laml-1.html#xml-check-error" title="xml-in-laml">xml-check-error</a> "The IDREF attribute value" (<a class="schemedoc-name" href="../../../../lib/man/general.html#string-it" title="Manual: general">string-it</a> idref-attr-val) "does not refer to an ID attribute."))
      )
      (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX335" title="R5RS Scheme form">reverse</a> <a class="applied-name" href="xml-in-laml-1.html#xml-idref-attribute-list" title="xml-in-laml">xml-idref-attribute-list</a>))

    <span class="comment">; Make sure that we do not make double reporting</span><br />    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> <a class="applied-name" href="xml-in-laml-1.html#xml-id-attribute-list" title="xml-in-laml">xml-id-attribute-list</a> '())
    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> <a class="applied-name" href="xml-in-laml-1.html#xml-idref-attribute-list" title="xml-in-laml">xml-idref-attribute-list</a> '())
   ))
      

<a name="xml-check-required-attributes!"></a><span class="comment">; Check that all elements in required-attribute-names are in fact present in attribute-names.
; The last parameter, tag-name is the name of the enclosing tag - used for error message purposes.</span><br /><a name="xml-check-required-attributes!"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(xml-check-required-attributes! attribute-names required-attribute-names tag-name)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> required-attribute-names))
      (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX125" title="R5RS Scheme form">begin</a>
         (<a class="applied-name" href="xml-in-laml-1.html#xml-check-one-required-attribute!" title="xml-in-laml">xml-check-one-required-attribute!</a> attribute-names (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> required-attribute-names) tag-name)
         (<a class="applied-name" href="xml-in-laml-1.html#xml-check-required-attributes!" title="xml-in-laml">xml-check-required-attributes!</a> attribute-names (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> required-attribute-names) tag-name))))

<a name="xml-check-one-required-attribute!"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(xml-check-one-required-attribute! attribute-names required-attribute tag-name)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX338" title="R5RS Scheme form">memq</a> required-attribute attribute-names))
      (<a class="applied-name" href="xml-in-laml-1.html#xml-check-error" title="xml-in-laml">xml-check-error</a> 
        "The required attribute" (<a class="applied-name" href="xml-in-laml-1.html#as-string-spacy" title="xml-in-laml">as-string-spacy</a> required-attribute) "is not present in the" (<a class="applied-name" href="xml-in-laml-1.html#as-string-spacy" title="xml-in-laml">as-string-spacy</a> tag-name) "element.")))


<div class="schemedoc-section-comment">;;; Link Checking.
;;; Web documents are able to link to other web documents. As an example, in XHTML the href attribute of the a element represents such a link.
;;; The procedures in this section are used to check that links actually address existing resources.</div>
<span class="comment">; A number of global variables related to link checking are located in laml.scm
; Reason: Avoids resetting (re-initialization) of this variables in case xml-in-laml.scm (this source file) is reloaded.</span><br />
<a name="collect-links-for-later-checking-in-ast!"></a><a name="collect-links-for-later-checking-in-ast!"></a><span><a href="../xml-in-laml.html#collect-links-for-later-checking-in-ast!"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(collect-links-for-later-checking-in-ast! xml-ast absolute-target-html-file)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX123" title="R5RS Scheme form">letrec</a> ((<span class="local-name-binding">url-not-deal-with?</span>
            (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">url-string</span>)
              (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX118" title="R5RS Scheme form">or</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#looking-at-substring?" title="Manual: general">looking-at-substring?</a> url-string 0 "mailto:")
                  (<a class="schemedoc-name" href="../../../../lib/man/general.html#looking-at-substring?" title="Manual: general">looking-at-substring?</a> url-string 0 "file://")  <span class="comment">; LAML should deal with it!</span><br />                  (<a class="schemedoc-name" href="../../../../lib/man/general.html#looking-at-substring?" title="Manual: general">looking-at-substring?</a> url-string 0 "ftp://")   <span class="comment">; LAML should deal with it!</span><br />                  (<a class="schemedoc-name" href="../../../../lib/man/general.html#looking-at-substring?" title="Manual: general">looking-at-substring?</a> url-string 0 "prospero://")
                  (<a class="schemedoc-name" href="../../../../lib/man/general.html#looking-at-substring?" title="Manual: general">looking-at-substring?</a> url-string 0 "wais://")
                  (<a class="schemedoc-name" href="../../../../lib/man/general.html#looking-at-substring?" title="Manual: general">looking-at-substring?</a> url-string 0 "telnet://")
                  (<a class="schemedoc-name" href="../../../../lib/man/general.html#looking-at-substring?" title="Manual: general">looking-at-substring?</a> url-string 0 "gopher://")
                  (<a class="schemedoc-name" href="../../../../lib/man/general.html#looking-at-substring?" title="Manual: general">looking-at-substring?</a> url-string 0 "news:")))))
    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">xml-language</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-language" title="xml-in-laml">ast-language</a> xml-ast))
           (<span class="local-name-binding">url-extractor-fn</span> (<a class="applied-name" href="xml-in-laml-1.html#url-extractor-of-xml-language" title="xml-in-laml">url-extractor-of-xml-language</a> xml-language))
           (<span class="local-name-binding">base-url-extractor-fn</span> (<a class="applied-name" href="xml-in-laml-1.html#base-url-extractor-of-xml-language" title="xml-in-laml">base-url-extractor-of-xml-language</a> xml-language))
           (<span class="local-name-binding">base-url</span> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> base-url-extractor-fn (base-url-extractor-fn xml-ast) #f)) 
           (<span class="local-name-binding">absolute-target-html-file-path</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#file-name-initial-path" title="Manual: general">file-name-initial-path</a> absolute-target-html-file))
           (<span class="local-name-binding">url-list-1</span> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> url-extractor-fn (url-extractor-fn xml-ast) '()))
           (<span class="local-name-binding">url-list-2</span> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> base-url
                           (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> 
                            (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">url</span>)
                              (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#relative-url?" title="Manual: general">relative-url?</a> url) 
                                  (<a class="applied-name" href="xml-in-laml-1.html#url-relative-to-base-url" title="xml-in-laml">url-relative-to-base-url</a> base-url url)  <span class="comment">; now ABSOLUTE url, to be further checked as such...</span><br />                                  url))
                            url-list-1)
                           url-list-1))
           )
      (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX413" title="R5RS Scheme form">for-each</a>
       (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">url</span>)
         (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX305" title="R5RS Scheme form">boolean?</a> url) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> url))   <span class="comment">; URL extractor returned #f</span><br />                 'do-nothing)
               ((url-not-deal-with? url)         <span class="comment">; Some URLs, as recognized by the local function url-not-dealt-with?, are not supported (yet).</span><br />                'do-nothing)
               ((<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#absolute-url?" title="Manual: general">absolute-url?</a> url) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX338" title="R5RS Scheme form">memq</a> <a class="applied-name" href="xml-in-laml-1.html#xml-link-checking" title="xml-in-laml">xml-link-checking</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> 'all 'absolute-urls)))
                (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> absolute-url-list-for-later-checking (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> url absolute-url-list-for-later-checking)))
               ((<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#relative-url?" title="Manual: general">relative-url?</a> url) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX338" title="R5RS Scheme form">memq</a> <a class="applied-name" href="xml-in-laml-1.html#xml-link-checking" title="xml-in-laml">xml-link-checking</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> 'all 'relative-urls)))
                (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> relative-url-list-for-later-checking 
                      (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> url absolute-target-html-file-path) relative-url-list-for-later-checking)))
               (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> 'do-nothing)))
       url-list-2))))

<a name="url-relative-to-base-url"></a><span class="comment">; Resolve relative-url relative to absolute-base-url, as (for instance) provided in a an XHTML base element.</span><br /><a name="url-relative-to-base-url"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(url-relative-to-base-url absolute-base-url relative-url)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="applied-name" href="xml-in-laml-1.html#anchor-part-alone?" title="xml-in-laml">anchor-part-alone?</a> relative-url) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> absolute-base-url relative-url))
        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#file-name-initial-path" title="Manual: general">file-name-initial-path</a> absolute-base-url) relative-url))))

<a name="anchor-part-alone?"></a><span class="comment">; Is url just an anchor part alone, such as "#foo"</span><br /><a name="anchor-part-alone?"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(anchor-part-alone? url)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX374" title="R5RS Scheme form">string?</a> url) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX237" title="R5RS Scheme form">&gt;</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX378" title="R5RS Scheme form">string-length</a> url) 0) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX196" title="R5RS Scheme form">eqv?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX379" title="R5RS Scheme form">string-ref</a> url 0) #\#)))

<a name="check-relative-url-list!"></a><a name="check-relative-url-list!"></a><span><a href="../xml-in-laml.html#check-relative-url-list!"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(check-relative-url-list! relative-urls)</span>
  (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX413" title="R5RS Scheme form">for-each</a>
    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">rel-url-entry</span>)
     (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">rel-url</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#first" title="Manual: general">first</a> rel-url-entry))
            (<span class="local-name-binding">rel-url-without-anchor</span> (<a class="applied-name" href="xml-in-laml-1.html#eliminate-anchor-part-of-url" title="xml-in-laml">eliminate-anchor-part-of-url</a> rel-url))

            (<span class="local-name-binding">rel-url-initial-path</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#file-name-initial-path" title="Manual: general">file-name-initial-path</a> rel-url-without-anchor))
            (<span class="local-name-binding">rel-url-file-name-proper</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#file-name-proper" title="Manual: general">file-name-proper</a> rel-url-without-anchor))
            (<span class="local-name-binding">rel-url-extension</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#file-name-extension" title="Manual: general">file-name-extension</a> rel-url-without-anchor))

            (<span class="local-name-binding">initial-absolute-file-path</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#second" title="Manual: general">second</a> rel-url-entry))
            (<span class="local-name-binding">normalized-absolute-file-path</span>
             (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a>
              (<a class="schemedoc-name" href="../../../../lib/man/general.html#normalize-file-path" title="Manual: general">normalize-file-path</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> initial-absolute-file-path rel-url-initial-path))
              rel-url-file-name-proper
              (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#empty-string?" title="Manual: general">empty-string?</a> rel-url-extension) "" (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> "." rel-url-extension)))) 
           )
      (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> rel-url (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#empty-string?" title="Manual: general">empty-string?</a> rel-url-without-anchor))   <span class="comment">; do not check relative urs of the form "#some-anchor" - they are relative to the current XML file.</span><br />               (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (file-exists? normalized-absolute-file-path))          <span class="comment">; check both file and directory existence - some urls address a directory!</span><br />                    (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (directory-exists? normalized-absolute-file-path)))
          )
          (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX125" title="R5RS Scheme form">begin</a> 
             (<a class="applied-name" href="xml-in-laml-1.html#xml-check-error" title="xml-in-laml">xml-check-error</a> "LINKING PROBLEM: URL  " rel-url "  RELATIVE TO  " initial-absolute-file-path)
             (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> relative-url-problem-count (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> relative-url-problem-count 1)) 
          )
      )
     ))
    relative-urls))

<a name="eliminate-anchor-part-of-url"></a><span class="comment">; Eliminate the anchor part of URL - the part starting with '#'</span><br /><a name="eliminate-anchor-part-of-url"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(eliminate-anchor-part-of-url url)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">hash-pos</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#find-in-string-from-end" title="Manual: general">find-in-string-from-end</a> url #\#)))
    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> hash-pos
        (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX391" title="R5RS Scheme form">substring</a> url 0 hash-pos)
        url)))

<a name="check-absolute-url-list!"></a><a name="check-absolute-url-list!"></a><span><a href="../xml-in-laml.html#check-absolute-url-list!"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(check-absolute-url-list! absolute-urls)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">unique-absolute-urls</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#remove-duplicates" title="Manual: general">remove-duplicates</a> absolute-urls))) 
  (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX413" title="R5RS Scheme form">for-each</a>
    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">abs-url</span>)
      (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (url-target-exists? abs-url))
          (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX125" title="R5RS Scheme form">begin</a>
             (<a class="applied-name" href="xml-in-laml-1.html#xml-check-error" title="xml-in-laml">xml-check-error</a> "LINKING PROBLEM TO  " abs-url)
             (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> absolute-url-problem-count (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> absolute-url-problem-count 1)))))
          
    unique-absolute-urls)))


<div class="schemedoc-section-comment">;;; XML validation procedures.
;;; The functions in this section provide access to the XML-in-LAML validation procedures.
;;; The validation functions are part of the mirrors of a given XML language in Scheme.
;;; In normal and native use of XML-in-LAML, the validation procedures are called by the
;;; mirror functions. If the internal AST structure is created by other means (for instance
;;; authored directly, or made via a parser) it is relevant to get access to the validation procedures.
;;; This is the rationale behind the functions in this section. Thus, the procedures in this section
;;; use the functions from the sections Contents Validation and Attribute Checking.
;;; .section-id validation-functions</div>
<a name="validation-procedure-map-of"></a><a name="validation-procedure-map-of"></a><span><a href="../xml-in-laml.html#validation-procedure-map-of"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(validation-procedure-map-of language)</span>
  (<a class="schemedoc-name" href="../../../../lib/man/general.html#defaulted-get" title="Manual: general">defaulted-get</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-symbol" title="Manual: general">as-symbol</a> language) xml-in-laml-validator-structures #f))

<a name="validation-element-name-of-validator-entry"></a><span class="comment">; Selector functions of an entry in a validation procedure map</span><br /><a name="validation-element-name-of-validator-entry"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">validation-element-name-of-validator-entry</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#make-selector-function" title="Manual: general">make-selector-function</a> 1 "validation-element-name-of-validator-entry"))
<a name="validation-procedure-of-validator-entry"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">validation-procedure-of-validator-entry</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#make-selector-function" title="Manual: general">make-selector-function</a> 2 "validation-procedure-of-validator-entry"))

<a name="validation-procedure-of"></a><a name="validation-procedure-of"></a><span><a href="../xml-in-laml.html#validation-procedure-of"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(validation-procedure-of element-name language)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">validator-map</span> (<a class="applied-name" href="xml-in-laml-1.html#validation-procedure-map-of" title="xml-in-laml">validation-procedure-map-of</a> language)))
    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> validator-map
        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">validator-proc</span> 
                (<a class="schemedoc-name" href="../../../../lib/man/general.html#binary-search-in-vector" title="Manual: general">binary-search-in-vector</a> 
                  validator-map (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> element-name) <a class="applied-name" href="xml-in-laml-1.html#validation-element-name-of-validator-entry" title="xml-in-laml">validation-element-name-of-validator-entry</a> <a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX381" title="R5RS Scheme form">string=?</a> <a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX385" title="R5RS Scheme form">string&lt;=?</a>)))
          (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> validator-proc
              (<a class="applied-name" href="xml-in-laml-1.html#validation-procedure-of-validator-entry" title="xml-in-laml">validation-procedure-of-validator-entry</a> validator-proc)
              #f)
        )
        #f)))

<a name="register-xml-in-laml-validators"></a><a name="register-xml-in-laml-validators"></a><span><a href="../xml-in-laml.html#register-xml-in-laml-validators"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(register-xml-in-laml-validators language validator-structure)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> xml-in-laml-validator-structures (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> language validator-structure) xml-in-laml-validator-structures))
)

<a name="validate-ast!"></a><a name="validate-ast!"></a><span><a href="../xml-in-laml.html#validate-ast!"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(validate-ast! ast . optional-parameter-list)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">given-language</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#optional-parameter" title="Manual: general">optional-parameter</a> 1 optional-parameter-list (<a class="applied-name" href="xml-in-laml-1.html#ast-language" title="xml-in-laml">ast-language</a> ast)))
       (<span class="local-name-binding">overlap-check?</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#optional-parameter" title="Manual: general">optional-parameter</a> 2 optional-parameter-list #t))
      )
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">el-name</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-element-name" title="xml-in-laml">ast-element-name</a> ast))
         (<span class="local-name-binding">attr-prop-list</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-attributes" title="xml-in-laml">ast-attributes</a> ast))
         (<span class="local-name-binding">element-content-items</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-subtrees" title="xml-in-laml">ast-subtrees</a> ast))
         (<span class="local-name-binding">val-proc!</span> (<a class="applied-name" href="xml-in-laml-1.html#validation-procedure-of" title="xml-in-laml">validation-procedure-of</a> el-name given-language))
        )
    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> val-proc! 
        (val-proc! el-name attr-prop-list element-content-items overlap-check?)
        (<a class="applied-name" href="xml-in-laml-1.html#xml-check-error" title="xml-in-laml">xml-check-error</a> "Using unknown XML element name: " el-name)) 
 
    (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX413" title="R5RS Scheme form">for-each</a> 
      (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">ast</span>) (<a class="applied-name" href="xml-in-laml-1.html#validate-ast!" title="xml-in-laml">validate-ast!</a> ast given-language overlap-check?))  <span class="comment">; maybe problem with the passing of given-language</span><br />      (<a class="schemedoc-name" href="../../../../lib/man/general.html#filter" title="Manual: general">filter</a> <a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> element-content-items)))))

<div class="schemedoc-section-comment">;;; XML warning procedures.
;;; .section-id warning-proc</div>
<a name="display-xml-warning"></a><a name="display-xml-warning"></a><span><a href="../xml-in-laml.html#display-xml-warning"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(display-xml-warning . messages)</span>
 (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX461" title="R5RS Scheme form">display</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> "XML Warning: " (laml-aggregate-messages messages))) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX463" title="R5RS Scheme form">newline</a>))


<a name="xml-check-error"></a><a name="xml-check-error"></a><span><a href="../xml-in-laml.html#xml-check-error"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">xml-check-error</span> <a class="applied-name" href="xml-in-laml-1.html#display-xml-warning" title="xml-in-laml">display-xml-warning</a>)


<a name="xml-check-for-attribute-existence!"></a><span class="comment">; Check that all names in attribute-names found in the list of names dtd-attribute-names
; tag-name is the name of the enclosing tag
; CSS attributes should not be checked for existence. </span><br /><a name="xml-check-for-attribute-existence!"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(xml-check-for-attribute-existence! attribute-names dtd-attribute-names tag-name)</span>
   (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> attribute-names))
       (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX125" title="R5RS Scheme form">begin</a>
         (<a class="applied-name" href="xml-in-laml-1.html#xml-check-one-attribute-existence!" title="xml-in-laml">xml-check-one-attribute-existence!</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> attribute-names) dtd-attribute-names tag-name)
         (<a class="applied-name" href="xml-in-laml-1.html#xml-check-for-attribute-existence!" title="xml-in-laml">xml-check-for-attribute-existence!</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> attribute-names) dtd-attribute-names tag-name))))

<a name="xml-check-one-attribute-existence!"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(xml-check-one-attribute-existence! name dtd-attribute-names tag-name)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="applied-name" href="xml-in-laml-1.html#xml-css-key?" title="xml-in-laml">xml-css-key?</a> name)) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX338" title="R5RS Scheme form">memq</a> name dtd-attribute-names)))
      (<a class="applied-name" href="xml-in-laml-1.html#xml-check-error" title="xml-in-laml">xml-check-error</a> "The XML attribute" (<a class="applied-name" href="xml-in-laml-1.html#as-string-spacy" title="xml-in-laml">as-string-spacy</a> name) "is not valid in the"  (<a class="applied-name" href="xml-in-laml-1.html#as-string-spacy" title="xml-in-laml">as-string-spacy</a> tag-name) "element.")))

<a name="xml-check-for-attribute-types!"></a><span class="comment">; Check that the attributes (as splitted into attribute-names and attribute-values - lists of equal lengths)
; have correct types according the dtd-attribute-names.</span><br /><a name="xml-check-for-attribute-types!"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(xml-check-for-attribute-types! attribute-names attribute-values dtd-attributes tag-name)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> attribute-names))
      (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX125" title="R5RS Scheme form">begin</a>
         (<a class="applied-name" href="xml-in-laml-1.html#xml-check-one-attribute-type!" title="xml-in-laml">xml-check-one-attribute-type!</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> attribute-names) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> attribute-values) dtd-attributes tag-name)
         (<a class="applied-name" href="xml-in-laml-1.html#xml-check-for-attribute-types!" title="xml-in-laml">xml-check-for-attribute-types!</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> attribute-names) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> attribute-values) dtd-attributes tag-name))))

<a name="xml-check-one-attribute-type!"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(xml-check-one-attribute-type! name value dtd-attributes tag-name)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">attribute-descriptor</span> 
          (<a class="schemedoc-name" href="../../../../lib/man/general.html#find-in-list" title="Manual: general">find-in-list</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">tripple</span>) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-symbol" title="Manual: general">as-symbol</a> (<a class="applied-name" href="xml-in-laml-1.html#att-name" title="xml-in-laml">att-name</a> tripple)) name)) dtd-attributes)))
    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> attribute-descriptor
        (<a class="applied-name" href="xml-in-laml-1.html#xml-check-attribute-value!" title="xml-in-laml">xml-check-attribute-value!</a> name value (<a class="applied-name" href="xml-in-laml-1.html#att-type" title="xml-in-laml">att-type</a> attribute-descriptor) tag-name))))

<a name="xml-check-attribute-value!"></a><span class="comment">; Is value a 'member of' attribute-type. value is a string.
; '&lt;' characters are allowed, because they are transformed to &lt; by means of the character transformation table.</span><br /><a name="xml-check-attribute-value!"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(xml-check-attribute-value! name value attribute-type tag-name)</span>

  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX331" title="R5RS Scheme form">list?</a> attribute-type) 
            (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX340" title="R5RS Scheme form">member</a> value attribute-type))  
                (<a class="applied-name" href="xml-in-laml-1.html#xml-check-error" title="xml-in-laml">xml-check-error</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> "The value  " (<a class="schemedoc-name" href="../../../../lib/man/general.html#string-it" title="Manual: general">string-it</a> value) "  of the XML attribute  "
                                            (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> name) "  is not valid in the "  tag-name " element."))))

        ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX200" title="R5RS Scheme form">equal?</a> "CDATA" attribute-type)
            #t)

        ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX340" title="R5RS Scheme form">member</a> attribute-type (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> "ID" ))
            (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">legal-name?</span> (<a class="applied-name" href="xml-in-laml-1.html#is-legal-xml-name?" title="xml-in-laml">is-legal-xml-name?</a> value)))
              (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> <a class="applied-name" href="xml-in-laml-1.html#xml-id-attribute-list" title="xml-in-laml">xml-id-attribute-list</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> value <a class="applied-name" href="xml-in-laml-1.html#xml-id-attribute-list" title="xml-in-laml">xml-id-attribute-list</a>)) <span class="comment">; side effect: register ID attribute value</span><br />              (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> legal-name?)
                  (<a class="applied-name" href="xml-in-laml-1.html#xml-check-error" title="xml-in-laml">xml-check-error</a> "The ID attribute value" (<a class="schemedoc-name" href="../../../../lib/man/general.html#string-it" title="Manual: general">string-it</a> value) "is illegal according to the XML 1.0 Name production."))))

        ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX340" title="R5RS Scheme form">member</a> attribute-type (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> "IDREF"))
            (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">legal-name?</span> (<a class="applied-name" href="xml-in-laml-1.html#is-legal-xml-name?" title="xml-in-laml">is-legal-xml-name?</a> value)))
              (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> <a class="applied-name" href="xml-in-laml-1.html#xml-idref-attribute-list" title="xml-in-laml">xml-idref-attribute-list</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> value <a class="applied-name" href="xml-in-laml-1.html#xml-idref-attribute-list" title="xml-in-laml">xml-idref-attribute-list</a>)) <span class="comment">; side effect: register IDREF attribute value</span><br />              (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> legal-name?)
                  (<a class="applied-name" href="xml-in-laml-1.html#xml-check-error" title="xml-in-laml">xml-check-error</a> "The IDREF attribute value" (<a class="schemedoc-name" href="../../../../lib/man/general.html#string-it" title="Manual: general">string-it</a> value) "is illegal according to the XML 1.0-spec Name production."))))

        ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX340" title="R5RS Scheme form">member</a> attribute-type (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> "IDREFS"))
            (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">name-list</span> (<a class="applied-name" href="xml-in-laml-1.html#extract-name-list-from-names-attribute" title="xml-in-laml">extract-name-list-from-names-attribute</a> value)))
              (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX413" title="R5RS Scheme form">for-each</a>
                (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">value</span>)
                  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">legal-name?</span> (<a class="applied-name" href="xml-in-laml-1.html#is-legal-xml-name?" title="xml-in-laml">is-legal-xml-name?</a> value)))
                    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> <a class="applied-name" href="xml-in-laml-1.html#xml-idref-attribute-list" title="xml-in-laml">xml-idref-attribute-list</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> value <a class="applied-name" href="xml-in-laml-1.html#xml-idref-attribute-list" title="xml-in-laml">xml-idref-attribute-list</a>))
                    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> legal-name?)
                        (<a class="applied-name" href="xml-in-laml-1.html#xml-check-error" title="xml-in-laml">xml-check-error</a> "The IDREFS attribute value" (<a class="schemedoc-name" href="../../../../lib/man/general.html#string-it" title="Manual: general">string-it</a> value) "is illegal according to the XML 1.0-spec Name production.")))
                )
                name-list)
            ))

        ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX340" title="R5RS Scheme form">member</a> attribute-type (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> "ENTITY" "ENTITIES" "NMTOKEN" "NMTOKENS"))
            #t)

        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="applied-name" href="xml-in-laml-1.html#xml-check-error" title="xml-in-laml">xml-check-error</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> "DTD error!!! The type  " (<a class="schemedoc-name" href="../../../../lib/man/general.html#string-it" title="Manual: general">string-it</a> attribute-type) "  of the XML attribute  "
                                            (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> name) "  is not valid in the "  tag-name " element.")))
  ))


<a name="extract-name-list-from-names-attribute"></a><span class="comment">; The parameter names is a white space separated list of names (a string).
; Return the list of individual names (a list of strings).</span><br /><a name="extract-name-list-from-names-attribute"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(extract-name-list-from-names-attribute names)</span>
  (<a class="schemedoc-name" href="../../../../lib/man/general.html#split-string-by-predicate" title="Manual: general">split-string-by-predicate</a> names (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">ch</span>) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX339" title="R5RS Scheme form">memv</a> ch <a class="schemedoc-name" href="../../../../lib/man/general.html#white-space-char-list" title="Manual: general">white-space-char-list</a>))))


<a name="is-legal-xml-name?"></a><span class="comment">; Is x a legal XML name, as defined by Name production of the XML 1.0 spec.
; A conservative predicates that only allows english ASCII characters.
; Assume as a precondition that x is a string. </span><br /><a name="is-legal-xml-name?"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(is-legal-xml-name? x)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#empty-string?" title="Manual: general">empty-string?</a> x)
      #f
      (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">first-char</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX379" title="R5RS Scheme form">string-ref</a> x 0))
            (<span class="local-name-binding">suffix-str</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX391" title="R5RS Scheme form">substring</a> x 1 (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX378" title="R5RS Scheme form">string-length</a> x)))
            (<span class="local-name-binding">digits</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> #\0 #\1 #\2 #\3 #\4 #\5 #\6 #\7 #\8 #\9 ))
            (<span class="local-name-binding">letters</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> #\a #\b #\c #\d #\e #\f #\g #\h #\i #\j #\k #\l #\m #\n #\o #\p #\q #\r #\s #\t #\u #\v #\w #\x #\y #\z
                           #\A #\B #\C #\D #\E #\F #\G #\H #\I #\J #\K #\L #\M #\N #\O #\P #\Q #\R #\S #\T #\U #\V #\W #\X #\Y #\Z))
           )
        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> 
          (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX118" title="R5RS Scheme form">or</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX339" title="R5RS Scheme form">memv</a> first-char letters) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX196" title="R5RS Scheme form">eqv?</a> first-char #\_) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX196" title="R5RS Scheme form">eqv?</a> first-char #\:))
          (<a class="schemedoc-name" href="../../../../lib/man/general.html#string-of-char-list?" title="Manual: general">string-of-char-list?</a> suffix-str (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX334" title="R5RS Scheme form">append</a> letters digits (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> #\. #\- #\_ #\:)))))))

<a name="xml-check-for-attribute-duplicates!"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(xml-check-for-attribute-duplicates! attribute-names tag-name)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">duplicated-attribute-names</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#duplicates-by-predicate" title="Manual: general">duplicates-by-predicate</a> attribute-names <a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a>)))
   (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> duplicated-attribute-names)) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> duplicated-attribute-names))) <span class="comment">; only one duplicated attribute</span><br />           (<a class="applied-name" href="xml-in-laml-1.html#xml-check-error" title="xml-in-laml">xml-check-error</a> 
            "The attribute" (<a class="applied-name" href="xml-in-laml-1.html#as-string-spacy" title="xml-in-laml">as-string-spacy</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> duplicated-attribute-names))
                           "is not allowed to appear more than once in" (<a class="applied-name" href="xml-in-laml-1.html#a-or-an" title="xml-in-laml">a-or-an</a> tag-name) (<a class="applied-name" href="xml-in-laml-1.html#as-string-spacy" title="xml-in-laml">as-string-spacy</a> tag-name) "element."))
         ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> duplicated-attribute-names))  <span class="comment">; two or more duplicated attribut names</span><br />           (<a class="applied-name" href="xml-in-laml-1.html#xml-check-error" title="xml-in-laml">xml-check-error</a> 
            "The attributes" " " (<a class="schemedoc-name" href="../../../../lib/man/general.html#list-to-string" title="Manual: general">list-to-string</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> <a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> duplicated-attribute-names) ", ") " "
                           "are not allowed to appear more than once in" (<a class="applied-name" href="xml-in-laml-1.html#a-or-an" title="xml-in-laml">a-or-an</a> tag-name) (<a class="applied-name" href="xml-in-laml-1.html#as-string-spacy" title="xml-in-laml">as-string-spacy</a> tag-name) "element."))
         (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> #t) <span class="comment">; do nothing</span><br />   )))




<a name="check-language-overlap!"></a><span class="comment">; ---------------------------------------------------------------------------------------------------------------
; Check of language overlap</span><br />
<a name="check-language-overlap!"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(check-language-overlap! name)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="applied-name" href="xml-in-laml-1.html#causes-xml-in-laml-name-clash?" title="xml-in-laml">causes-xml-in-laml-name-clash?</a> name)
      (<a class="applied-name" href="xml-in-laml-1.html#xml-check-error" title="xml-in-laml">xml-check-error</a> 
       "The mirror function named" (<a class="applied-name" href="xml-in-laml-1.html#as-string-spacy" title="xml-in-laml">as-string-spacy</a> name) "is ambiguous. Please use it via an appropriate language map.")))


<span class="comment">; ---------------------------------------------------------------------------------------------------------------
; Html character transformation table mutations.
; Mutations that cause literal presentation of the characters #\&lt; , #\&gt;, #", #\' and #\&</span><br />
(<a class="schemedoc-name" href="../../../../man/laml.html#set-html-char-transformation-entry!" title="Manual: laml">set-html-char-transformation-entry!</a> <a class="schemedoc-name" href="../../../../man/laml.html#html-char-transformation-table" title="Manual: laml">html-char-transformation-table</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX367" title="R5RS Scheme form">char-&gt;integer</a> #\<) "&amp;lt;")
(<a class="schemedoc-name" href="../../../../man/laml.html#set-html-char-transformation-entry!" title="Manual: laml">set-html-char-transformation-entry!</a> <a class="schemedoc-name" href="../../../../man/laml.html#html-char-transformation-table" title="Manual: laml">html-char-transformation-table</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX367" title="R5RS Scheme form">char-&gt;integer</a> #\>) "&amp;gt;")
(<a class="schemedoc-name" href="../../../../man/laml.html#set-html-char-transformation-entry!" title="Manual: laml">set-html-char-transformation-entry!</a> <a class="schemedoc-name" href="../../../../man/laml.html#html-char-transformation-table" title="Manual: laml">html-char-transformation-table</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX367" title="R5RS Scheme form">char-&gt;integer</a> #\") "&amp;quot;")
(<a class="schemedoc-name" href="../../../../man/laml.html#set-html-char-transformation-entry!" title="Manual: laml">set-html-char-transformation-entry!</a> <a class="schemedoc-name" href="../../../../man/laml.html#html-char-transformation-table" title="Manual: laml">html-char-transformation-table</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX367" title="R5RS Scheme form">char-&gt;integer</a> #\') "&amp;#39;")
(<a class="schemedoc-name" href="../../../../man/laml.html#set-html-char-transformation-entry!" title="Manual: laml">set-html-char-transformation-entry!</a> <a class="schemedoc-name" href="../../../../man/laml.html#html-char-transformation-table" title="Manual: laml">html-char-transformation-table</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX367" title="R5RS Scheme form">char-&gt;integer</a> #\&) "&amp;amp;")

<span class="comment">; ---------------------------------------------------------------------------------------------------------------</span><br />

<div class="schemedoc-section-comment">;;; Rendering functions and procedures.
;;; The functions and procedures in this section transform the internal document representation
;;; (abstract syntax trees) to a textual form (text strings) which can be delivered in various ways (as strings or in streams).
;;; Both pretty printed and non pretty printed renderings are supported.
;;; In the start of the section we document a couple of variable that controls aspects of the 
;;; .section-id rendering</div>
<a name="compact-end-tag-rendering?"></a><a name="compact-end-tag-rendering?"></a><span><a href="../xml-in-laml.html#compact-end-tag-rendering?"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">compact-end-tag-rendering?</span> #t)

<a name="use-empty-tags-for-elements-without-contents"></a><a name="use-empty-tags-for-elements-without-contents"></a><span><a href="../xml-in-laml.html#use-empty-tags-for-elements-without-contents"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">use-empty-tags-for-elements-without-contents</span> #f)

<span class="comment">; ---------------------------------------------------------------------------------------------------
; Fast AST rendering.</span><br />
<a name="render-to-output-port"></a><a name="render-to-output-port"></a><span><a href="../xml-in-laml.html#render-to-output-port"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(render-to-output-port xml-clause output-port . optional-parameter-list)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">prolog</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#optional-parameter" title="Manual: general">optional-parameter</a> 1 optional-parameter-list #f))
        (<span class="local-name-binding">epilog</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#optional-parameter" title="Manual: general">optional-parameter</a> 2 optional-parameter-list #f))
        (<span class="local-name-binding">language</span> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> xml-clause) (<a class="applied-name" href="xml-in-laml-1.html#ast-language" title="xml-in-laml">ast-language</a> xml-clause) #f))  <span class="comment">; if - just to be conservative.</span><br />        (<span class="local-name-binding">prolog-text</span> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX346" title="R5RS Scheme form">symbol?</a> prolog) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> prolog 'prolog)) (<a class="applied-name" href="xml-in-laml-1.html#standard-prolog" title="xml-in-laml">standard-prolog</a> language))
                           ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX374" title="R5RS Scheme form">string?</a> prolog) prolog)
                           (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> "")))
        (<span class="local-name-binding">epilog-text</span> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX346" title="R5RS Scheme form">symbol?</a> epilog) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> epilog 'epilog)) (<a class="schemedoc-name" href="../../../../man/laml.html#standard-epilog" title="Manual: laml">standard-epilog</a>))
                           ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX374" title="R5RS Scheme form">string?</a> epilog) epilog)
                           (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> "")))
        (<span class="local-name-binding">put-fn</span> (<a class="applied-name" href="xml-in-laml-1.html#put-in-sink-stream-generator" title="xml-in-laml">put-in-sink-stream-generator</a> output-port))
       )
  (put-fn prolog-text)
  (<a class="applied-name" href="xml-in-laml-1.html#render-fast" title="xml-in-laml">render-fast</a> xml-clause put-fn <a class="applied-name" href="xml-in-laml-1.html#xml-always-render-white-space?" title="xml-in-laml">xml-always-render-white-space?</a>)
  (put-fn epilog-text)))

<a name="pretty-render-to-output-port"></a><a name="pretty-render-to-output-port"></a><span><a href="../xml-in-laml.html#pretty-render-to-output-port"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(pretty-render-to-output-port xml-clause output-port . optional-parameter-list)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">prolog</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#optional-parameter" title="Manual: general">optional-parameter</a> 1 optional-parameter-list #f))
        (<span class="local-name-binding">epilog</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#optional-parameter" title="Manual: general">optional-parameter</a> 2 optional-parameter-list #f))
        (<span class="local-name-binding">language</span> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> xml-clause) (<a class="applied-name" href="xml-in-laml-1.html#ast-language" title="xml-in-laml">ast-language</a> xml-clause) #f))  <span class="comment">; if - just to be conservative.</span><br />        (<span class="local-name-binding">prolog-text</span> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX346" title="R5RS Scheme form">symbol?</a> prolog) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> prolog 'prolog)) (<a class="applied-name" href="xml-in-laml-1.html#standard-prolog" title="xml-in-laml">standard-prolog</a> language))
                           ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX374" title="R5RS Scheme form">string?</a> prolog) prolog)
                           (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> "")))
        (<span class="local-name-binding">epilog-text</span> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX346" title="R5RS Scheme form">symbol?</a> epilog) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> epilog 'epilog)) (<a class="schemedoc-name" href="../../../../man/laml.html#standard-epilog" title="Manual: laml">standard-epilog</a>))
                           ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX374" title="R5RS Scheme form">string?</a> epilog) epilog)
                           (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> "")))
        (<span class="local-name-binding">put-fn</span> (<a class="applied-name" href="xml-in-laml-1.html#put-in-sink-stream-generator" title="xml-in-laml">put-in-sink-stream-generator</a> output-port))
       )
  (put-fn prolog-text)
  (<a class="applied-name" href="xml-in-laml-1.html#pp-render-fast" title="xml-in-laml">pp-render-fast</a> xml-clause put-fn <a class="applied-name" href="xml-in-laml-1.html#xml-always-render-white-space?" title="xml-in-laml">xml-always-render-white-space?</a> 0 #f)
  (put-fn epilog-text)))

<a name="render-start-tag-to-output-port"></a><a name="render-start-tag-to-output-port"></a><span><a href="../xml-in-laml.html#render-start-tag-to-output-port"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(render-start-tag-to-output-port xml-clause output-port)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">put-fn</span> (<a class="applied-name" href="xml-in-laml-1.html#put-in-sink-stream-generator" title="xml-in-laml">put-in-sink-stream-generator</a> output-port)))
  (<a class="applied-name" href="xml-in-laml-1.html#render-fast" title="xml-in-laml">render-fast</a> xml-clause put-fn <a class="applied-name" href="xml-in-laml-1.html#xml-always-render-white-space?" title="xml-in-laml">xml-always-render-white-space?</a> 'start-tag)))


<a name="render-end-tag-to-output-port"></a><a name="render-end-tag-to-output-port"></a><span><a href="../xml-in-laml.html#render-end-tag-to-output-port"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(render-end-tag-to-output-port xml-clause output-port)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">put-fn</span> (<a class="applied-name" href="xml-in-laml-1.html#put-in-sink-stream-generator" title="xml-in-laml">put-in-sink-stream-generator</a> output-port)))
  (<a class="applied-name" href="xml-in-laml-1.html#render-fast" title="xml-in-laml">render-fast</a> xml-clause put-fn <a class="applied-name" href="xml-in-laml-1.html#xml-always-render-white-space?" title="xml-in-laml">xml-always-render-white-space?</a> 'end-tag)))

<a name="xml-render"></a><a name="xml-render"></a><span><a href="../xml-in-laml.html#xml-render"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(xml-render xml-clause . optional-parameter-list)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">prolog</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#optional-parameter" title="Manual: general">optional-parameter</a> 1 optional-parameter-list #f))
        (<span class="local-name-binding">epilog</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#optional-parameter" title="Manual: general">optional-parameter</a> 2 optional-parameter-list #f))
        (<span class="local-name-binding">prolog-text</span> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX346" title="R5RS Scheme form">symbol?</a> prolog) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> prolog 'prolog)) (<a class="applied-name" href="xml-in-laml-1.html#standard-prolog" title="xml-in-laml">standard-prolog</a>))
                           ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX374" title="R5RS Scheme form">string?</a> prolog) prolog)
                           (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> "")))
        (<span class="local-name-binding">epilog-text</span> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX346" title="R5RS Scheme form">symbol?</a> epilog) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> epilog 'epilog)) (<a class="schemedoc-name" href="../../../../man/laml.html#standard-epilog" title="Manual: laml">standard-epilog</a>))
                           ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX374" title="R5RS Scheme form">string?</a> epilog) epilog)
                           (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> "")))
       )
   (<a class="applied-name" href="xml-in-laml-1.html#reset-sink-string" title="xml-in-laml">reset-sink-string</a>)
   (<a class="applied-name" href="xml-in-laml-1.html#render-fast" title="xml-in-laml">render-fast</a> xml-clause <a class="applied-name" href="xml-in-laml-1.html#put-in-sink-text-string" title="xml-in-laml">put-in-sink-text-string</a> <a class="applied-name" href="xml-in-laml-1.html#xml-always-render-white-space?" title="xml-in-laml">xml-always-render-white-space?</a>)
   (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a>
     prolog-text
     (<a class="applied-name" href="xml-in-laml-1.html#sink-string" title="xml-in-laml">sink-string</a>)  
     epilog-text)))


<a name="pretty-xml-render"></a><a name="pretty-xml-render"></a><span><a href="../xml-in-laml.html#pretty-xml-render"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(pretty-xml-render xml-clause . optional-parameter-list)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">prolog</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#optional-parameter" title="Manual: general">optional-parameter</a> 1 optional-parameter-list #f))
        (<span class="local-name-binding">epilog</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#optional-parameter" title="Manual: general">optional-parameter</a> 2 optional-parameter-list #f))
        (<span class="local-name-binding">prolog-text</span> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX346" title="R5RS Scheme form">symbol?</a> prolog) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> prolog 'prolog)) (<a class="applied-name" href="xml-in-laml-1.html#standard-prolog" title="xml-in-laml">standard-prolog</a>))
                           ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX374" title="R5RS Scheme form">string?</a> prolog) prolog)
                           (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> "")))
        (<span class="local-name-binding">epilog-text</span> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX346" title="R5RS Scheme form">symbol?</a> epilog) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> epilog 'epilog)) (<a class="schemedoc-name" href="../../../../man/laml.html#standard-epilog" title="Manual: laml">standard-epilog</a>))
                           ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX374" title="R5RS Scheme form">string?</a> epilog) epilog)
                           (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> "")))
       )
   (<a class="applied-name" href="xml-in-laml-1.html#reset-sink-string" title="xml-in-laml">reset-sink-string</a>)
   (<a class="applied-name" href="xml-in-laml-1.html#pp-render-fast" title="xml-in-laml">pp-render-fast</a> xml-clause <a class="applied-name" href="xml-in-laml-1.html#put-in-sink-text-string" title="xml-in-laml">put-in-sink-text-string</a> <a class="applied-name" href="xml-in-laml-1.html#xml-always-render-white-space?" title="xml-in-laml">xml-always-render-white-space?</a> 0 #f)
   (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a>
     prolog-text
     (<a class="applied-name" href="xml-in-laml-1.html#sink-string" title="xml-in-laml">sink-string</a>)  
     epilog-text)))





<a name="start-tag-of"></a><a name="start-tag-of"></a><span><a href="../xml-in-laml.html#start-tag-of"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(start-tag-of xml-clause)</span>
  (<a class="applied-name" href="xml-in-laml-1.html#reset-sink-string" title="xml-in-laml">reset-sink-string</a>)
  (<a class="applied-name" href="xml-in-laml-1.html#render-fast" title="xml-in-laml">render-fast</a> xml-clause <a class="applied-name" href="xml-in-laml-1.html#put-in-sink-text-string" title="xml-in-laml">put-in-sink-text-string</a> <a class="applied-name" href="xml-in-laml-1.html#xml-always-render-white-space?" title="xml-in-laml">xml-always-render-white-space?</a> 'start-tag)
  (<a class="applied-name" href="xml-in-laml-1.html#sink-string" title="xml-in-laml">sink-string</a>))

<a name="end-tag-of"></a><a name="end-tag-of"></a><span><a href="../xml-in-laml.html#end-tag-of"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(end-tag-of xml-clause)</span>
  (<a class="applied-name" href="xml-in-laml-1.html#reset-sink-string" title="xml-in-laml">reset-sink-string</a>)
  (<a class="applied-name" href="xml-in-laml-1.html#render-fast" title="xml-in-laml">render-fast</a> xml-clause <a class="applied-name" href="xml-in-laml-1.html#put-in-sink-text-string" title="xml-in-laml">put-in-sink-text-string</a> <a class="applied-name" href="xml-in-laml-1.html#xml-always-render-white-space?" title="xml-in-laml">xml-always-render-white-space?</a> 'end-tag)
  (<a class="applied-name" href="xml-in-laml-1.html#sink-string" title="xml-in-laml">sink-string</a>))


<span class="comment">; ---------------------------------------------------------------------------------------------------
; Contents rendering, for instance for error message purposes</span><br />
<a name="xml-in-laml-error-message-style"></a><span class="comment">; A variable which controls the style of xml-in-laml related error messages. Either the symbol laml or xml</span><br /><a name="xml-in-laml-error-message-style"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">xml-in-laml-error-message-style</span> 'laml) 

<a name="xml-render-error-message"></a><span class="comment">; Render contents for error message purposes, xml style.</span><br /><a name="xml-render-error-message"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(xml-render-error-message contents)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> <a class="applied-name" href="xml-in-laml-1.html#xml-in-laml-error-message-style" title="xml-in-laml">xml-in-laml-error-message-style</a> 'laml) (<a class="applied-name" href="xml-in-laml-1.html#xml-render-as-laml" title="xml-in-laml">xml-render-as-laml</a> contents))
       ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> <a class="applied-name" href="xml-in-laml-1.html#xml-in-laml-error-message-style" title="xml-in-laml">xml-in-laml-error-message-style</a> 'xml) (<a class="applied-name" href="xml-in-laml-1.html#xml-render-as-xml" title="xml-in-laml">xml-render-as-xml</a> contents))
       (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#laml-error" title="Manual: general">laml-error</a> "xml-render-error-message" "Problem to render contents of error message"))))

<a name="xml-render-as-xml"></a><span class="comment">; A slight generalization of xml-render - for error message purposes only.</span><br /><a name="xml-render-as-xml"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(xml-render-as-xml contents)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> contents) (<a class="applied-name" href="xml-in-laml-1.html#xml-render" title="xml-in-laml">xml-render</a> contents))
        ((<a class="applied-name" href="xml-in-laml-1.html#cdata?" title="xml-in-laml">cdata?</a> contents) contents)
        ((<a class="applied-name" href="xml-in-laml-1.html#char-ref?" title="xml-in-laml">char-ref?</a> contents) (<a class="applied-name" href="xml-in-laml-1.html#xml-render-char-ref" title="xml-in-laml">xml-render-char-ref</a> contents))
        ((<a class="applied-name" href="xml-in-laml-1.html#cdata-section?" title="xml-in-laml">cdata-section?</a> contents) (<a class="applied-name" href="xml-in-laml-1.html#xml-render-cdata-section" title="xml-in-laml">xml-render-cdata-section</a> contents))
        ((<a class="applied-name" href="xml-in-laml-1.html#forced-white-space?" title="xml-in-laml">forced-white-space?</a> contents) "")
        ((<a class="applied-name" href="xml-in-laml-1.html#delayed-procedural-contents-element?" title="xml-in-laml">delayed-procedural-contents-element?</a> contents) "#&lt;delayed-procedural-contents-element&gt;")
        ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX331" title="R5RS Scheme form">list?</a> contents) (<a class="schemedoc-name" href="../../../../lib/man/general.html#list-to-string" title="Manual: general">list-to-string</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> <a class="applied-name" href="xml-in-laml-1.html#xml-render-as-xml" title="xml-in-laml">xml-render-as-xml</a> contents) " "))
        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> "??")))

<a name="truncate-string"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(truncate-string str)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX237" title="R5RS Scheme form">&gt;</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX378" title="R5RS Scheme form">string-length</a> str) <a class="applied-name" href="xml-in-laml-1.html#xml-error-truncation-length" title="xml-in-laml">xml-error-truncation-length</a>)
     (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX391" title="R5RS Scheme form">substring</a> str 0 <a class="applied-name" href="xml-in-laml-1.html#xml-error-truncation-length" title="xml-in-laml">xml-error-truncation-length</a>) "...")
     str))



<a name="xml-render-as-laml"></a><a name="xml-render-as-laml"></a><span><a href="../xml-in-laml.html#xml-render-as-laml"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(xml-render-as-laml contents . optional-parameter-list)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">contents-after</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#optional-parameter" title="Manual: general">optional-parameter</a> 1 optional-parameter-list 'none)))
  (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a>
   (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> contents) (<a class="applied-name" href="xml-in-laml-1.html#xml-render-ast-as-laml" title="xml-in-laml">xml-render-ast-as-laml</a> contents))
         ((<a class="applied-name" href="xml-in-laml-1.html#char-ref?" title="xml-in-laml">char-ref?</a> contents) (<a class="applied-name" href="xml-in-laml-1.html#xml-render-char-ref-as-laml" title="xml-in-laml">xml-render-char-ref-as-laml</a> contents))
         ((<a class="applied-name" href="xml-in-laml-1.html#cdata-section?" title="xml-in-laml">cdata-section?</a> contents) (<a class="applied-name" href="xml-in-laml-1.html#xml-render-cdata-section-as-laml" title="xml-in-laml">xml-render-cdata-section-as-laml</a> contents))
         ((<a class="applied-name" href="xml-in-laml-1.html#white-space-related?" title="xml-in-laml">white-space-related?</a> contents) "")              <span class="comment">; ignore - already handled</span><br />         ((<a class="applied-name" href="xml-in-laml-1.html#delayed-procedural-contents-element?" title="xml-in-laml">delayed-procedural-contents-element?</a> contents) "#&lt;delayed-procedural-contents-element&gt;")
         ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX331" title="R5RS Scheme form">list?</a> contents) (<a class="schemedoc-name" href="../../../../lib/man/general.html#list-to-string" title="Manual: general">list-to-string</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> <a class="applied-name" href="xml-in-laml-1.html#xml-render-as-laml" title="xml-in-laml">xml-render-as-laml</a> contents) " "))
         (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="applied-name" href="xml-in-laml-1.html#as-source-string" title="xml-in-laml">as-source-string</a> contents)))
   (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="applied-name" href="xml-in-laml-1.html#white-space-related?" title="xml-in-laml">white-space-related?</a> contents))
    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> contents-after 'none))
        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> contents-after <a class="applied-name" href="xml-in-laml-1.html#explicit-space" title="xml-in-laml">explicit-space</a>) "")
              (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> " _"))
        "")
    ""))))
 

<a name="xml-render-ast-as-laml"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(xml-render-ast-as-laml ast)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">attributes</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-attributes" title="xml-in-laml">ast-attributes</a> ast))
       (<span class="local-name-binding">the-subtrees</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-subtrees" title="xml-in-laml">ast-subtrees</a> ast))
      )
  (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> 
   "(" (<a class="applied-name" href="xml-in-laml-1.html#ast-element-name" title="xml-in-laml">ast-element-name</a> ast) (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> attributes)) " " "")
       (<a class="applied-name" href="xml-in-laml-1.html#xml-render-attribute-list-as-laml" title="xml-in-laml">xml-render-attribute-list-as-laml</a> attributes) (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> the-subtrees)) " " "")
       (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">subtrees</span> the-subtrees))
         (<a class="schemedoc-name" href="../../../../lib/man/general.html#string-merge" title="Manual: general">string-merge</a> (<a class="applied-name" href="xml-in-laml-1.html#map-contextual" title="xml-in-laml">map-contextual</a> <a class="applied-name" href="xml-in-laml-1.html#xml-render-as-laml" title="xml-in-laml">xml-render-as-laml</a> subtrees) (<a class="schemedoc-name" href="../../../../lib/man/general.html#make-list" title="Manual: general">make-list</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX333" title="R5RS Scheme form">length</a> subtrees) 1) " ")))
   ")")))

<a name="map-contextual"></a><span class="comment">; A variant of map that passes both the current and the following element (if available) to the function.
; Consequently, f should be prepared (by an optional parameter) to accept two elements.</span><br /><a name="map-contextual"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(map-contextual f lst)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> lst) '())
        ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> lst)) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> (f (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> lst))))
        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (f (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> lst) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cadr</a> lst)) (<a class="applied-name" href="xml-in-laml-1.html#map-contextual" title="xml-in-laml">map-contextual</a> f (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> lst))))))


<a name="xml-render-attribute-list-as-laml"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(xml-render-attribute-list-as-laml attr-property-list)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">lgt</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX333" title="R5RS Scheme form">length</a> attr-property-list)))
   (<a class="schemedoc-name" href="../../../../lib/man/general.html#string-merge" title="Manual: general">string-merge</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> <a class="applied-name" href="xml-in-laml-1.html#as-source-string" title="xml-in-laml">as-source-string</a> attr-property-list) (<a class="schemedoc-name" href="../../../../lib/man/general.html#make-list" title="Manual: general">make-list</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> lgt 1) " "))))

<a name="xml-render-char-ref-as-laml"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(xml-render-char-ref-as-laml char-ref)</span>
 (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> 
  "(" "char-ref" " "
      (<a class="applied-name" href="xml-in-laml-1.html#as-source-string" title="xml-in-laml">as-source-string</a> (<a class="applied-name" href="xml-in-laml-1.html#char-ref-value" title="xml-in-laml">char-ref-value</a> char-ref))
  ")"))

<a name="xml-render-cdata-section-as-laml"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(xml-render-cdata-section-as-laml cdata-section)</span>
 (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> 
  "(" "cdata-section" " "
      (<a class="schemedoc-name" href="../../../../lib/man/general.html#list-to-string" title="Manual: general">list-to-string</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> <a class="applied-name" href="xml-in-laml-1.html#as-source-string" title="xml-in-laml">as-source-string</a> (<a class="applied-name" href="xml-in-laml-1.html#cdata-section-contents" title="xml-in-laml">cdata-section-contents</a> cdata-section)) " ")
  ")"))

<a name="as-source-string"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(as-source-string x)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX224" title="R5RS Scheme form">number?</a> x) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX292" title="R5RS Scheme form">number-&gt;string</a> x))
        ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX346" title="R5RS Scheme form">symbol?</a> x) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> "&#39;" (symbol->string x)))
        ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX374" title="R5RS Scheme form">string?</a> x) (<a class="schemedoc-name" href="../../../../lib/man/general.html#string-it" title="Manual: general">string-it</a> x))
        ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX305" title="R5RS Scheme form">boolean?</a> x) 
            (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> x "#t" "#f"))  
        ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX351" title="R5RS Scheme form">char?</a> x) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-char" title="Manual: general">as-char</a> 35)) (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-char" title="Manual: general">as-char</a> 92)) (<a class="schemedoc-name" href="../../../../lib/man/general.html#char-&gt;string" title="Manual: general">char-&gt;string</a> x)))
        ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX331" title="R5RS Scheme form">list?</a> x)
            (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> "(" 
               (<a class="schemedoc-name" href="../../../../lib/man/general.html#string-merge" title="Manual: general">string-merge</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> <a class="applied-name" href="xml-in-laml-1.html#as-source-string" title="xml-in-laml">as-source-string</a> x) (<a class="schemedoc-name" href="../../../../lib/man/general.html#make-list" title="Manual: general">make-list</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX333" title="R5RS Scheme form">length</a> x) 1) " "))
               ")"))
        ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX399" title="R5RS Scheme form">vector?</a> x)
          (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">lst</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX406" title="R5RS Scheme form">vector-&gt;list</a> x)))
            (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> "#(" 
               (<a class="schemedoc-name" href="../../../../lib/man/general.html#string-merge" title="Manual: general">string-merge</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> <a class="applied-name" href="xml-in-laml-1.html#as-source-string" title="xml-in-laml">as-source-string</a> lst) (<a class="schemedoc-name" href="../../../../lib/man/general.html#make-list" title="Manual: general">make-list</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX333" title="R5RS Scheme form">length</a> lst) 1) " "))
               ")")))
        ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX319" title="R5RS Scheme form">pair?</a> x)
            (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> "(" 
               (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX411" title="R5RS Scheme form">apply</a> <a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a>
                  (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">y</span>) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> (<a class="applied-name" href="xml-in-laml-1.html#as-source-string" title="xml-in-laml">as-source-string</a> y) " ")) (<a class="schemedoc-name" href="../../../../lib/man/general.html#proper-part" title="Manual: general">proper-part</a> x))
               )
               " . " (<a class="applied-name" href="xml-in-laml-1.html#as-source-string" title="xml-in-laml">as-source-string</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#first-improper-part" title="Manual: general">first-improper-part</a> x))
               ")"))
        ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX410" title="R5RS Scheme form">procedure?</a> x)
            "&lt;PROCEDURE&gt;")
        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> "??")))


<span class="comment">; ---------------------------------------------------------------------------------------------------------------
; Begin June 3, 2007</span><br />
<a name="render-as-laml-to-output-port"></a><a name="render-as-laml-to-output-port"></a><span><a href="../xml-in-laml.html#render-as-laml-to-output-port"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(render-as-laml-to-output-port xml-clause output-port . optional-parameter-list)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">prolog</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#optional-parameter" title="Manual: general">optional-parameter</a> 1 optional-parameter-list #f))
        (<span class="local-name-binding">epilog</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#optional-parameter" title="Manual: general">optional-parameter</a> 2 optional-parameter-list #f))
        (<span class="local-name-binding">language</span> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> xml-clause) (<a class="applied-name" href="xml-in-laml-1.html#ast-language" title="xml-in-laml">ast-language</a> xml-clause) #f))  <span class="comment">; if - just to be conservative.</span><br />        (<span class="local-name-binding">prolog-text</span> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX374" title="R5RS Scheme form">string?</a> prolog) prolog)
                           (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> "")))
        (<span class="local-name-binding">epilog-text</span> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX374" title="R5RS Scheme form">string?</a> epilog) epilog)
                           (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> "")))
        (<span class="local-name-binding">put-fn</span> (<a class="applied-name" href="xml-in-laml-1.html#put-in-sink-stream-generator" title="xml-in-laml">put-in-sink-stream-generator</a> output-port))
       )
  (put-fn prolog-text)
  (<a class="applied-name" href="xml-in-laml-1.html#render-fast-as-laml" title="xml-in-laml">render-fast-as-laml</a> xml-clause put-fn)
  (put-fn epilog-text)))

<a name="render-as-laml-string"></a><a name="render-as-laml-string"></a><span><a href="../xml-in-laml.html#render-as-laml-string"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(render-as-laml-string xml-clause . optional-parameter-list)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">prolog</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#optional-parameter" title="Manual: general">optional-parameter</a> 1 optional-parameter-list #f))
        (<span class="local-name-binding">epilog</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#optional-parameter" title="Manual: general">optional-parameter</a> 2 optional-parameter-list #f))
        (<span class="local-name-binding">prolog-text</span> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX374" title="R5RS Scheme form">string?</a> prolog) prolog)
                           (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> "")))
        (<span class="local-name-binding">epilog-text</span> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX374" title="R5RS Scheme form">string?</a> epilog) epilog)
                           (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> "")))
       )
   (<a class="applied-name" href="xml-in-laml-1.html#reset-sink-string" title="xml-in-laml">reset-sink-string</a>)
   (<a class="applied-name" href="xml-in-laml-1.html#render-fast-as-laml" title="xml-in-laml">render-fast-as-laml</a> xml-clause <a class="applied-name" href="xml-in-laml-1.html#put-in-sink-text-string" title="xml-in-laml">put-in-sink-text-string</a>)
   (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a>
     prolog-text
     (<a class="applied-name" href="xml-in-laml-1.html#sink-string" title="xml-in-laml">sink-string</a>)  
     epilog-text)))


<a name="render-fast-as-laml"></a><span class="comment">; Render ast via the put function. 
; render-what is fixed and constant: all.</span><br /><a name="render-fast-as-laml"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(render-fast-as-laml ast put)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">render-what</span> 'all)
        (<span class="local-name-binding">tag-name</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-element-name" title="xml-in-laml">ast-element-name</a> ast)) 
        (<span class="local-name-binding">contents-list</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-subtrees" title="xml-in-laml">ast-subtrees</a> ast))
        (<span class="local-name-binding">attribute-properlist</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-attributes" title="xml-in-laml">ast-attributes</a> ast))  <span class="comment">; split in normal and css here</span><br />        (<span class="local-name-binding">attribute-alist</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#propertylist-to-alist" title="Manual: general">propertylist-to-alist</a> attribute-properlist))
        (<span class="local-name-binding">kind</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-kind" title="xml-in-laml">ast-kind</a> ast))
        (<span class="local-name-binding">extraordinary-preserve-white-space</span> #f) <span class="comment">; fixed and constant</span><br />        (<span class="local-name-binding">language</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-language" title="xml-in-laml">ast-language</a> ast))
       )

  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> kind 'single)  <span class="comment">; empty element</span><br />          (put #\() 
          (put tag-name) (put #\space) 

          <span class="comment">; Linearize HTML attributes - duplicate code inlined for double elements!</span><br />          (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX413" title="R5RS Scheme form">for-each</a> 
            (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">attr-pair</span>) 
             (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">key</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> attr-pair))
                   (<span class="local-name-binding">val</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> attr-pair)))
               (put #\space)
               (put #\') (put (symbol->string key)) (put #\space)
               (put <a class="applied-name" href="xml-in-laml-1.html#quote-char" title="xml-in-laml">quote-char</a>)
               (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX128" title="R5RS Scheme form">do</a> ((lgt (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX378" title="R5RS Scheme form">string-length</a> val))
                    (<a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a> 0 (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> <a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a> 1))
                   )
                   ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX235" title="R5RS Scheme form">=</a> <a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a> lgt) 'done)
                 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">ch</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX379" title="R5RS Scheme form">string-ref</a> val <a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a>)))
                   (put ch))
                 )
               (put <a class="applied-name" href="xml-in-laml-1.html#quote-char" title="xml-in-laml">quote-char</a>) (put #\space))
            )
          attribute-alist)

        (put ")"))

        ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> kind 'double)  <span class="comment">; non-empty element</span><br />          (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX118" title="R5RS Scheme form">or</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> render-what 'all) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> render-what 'start-tag))
            (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX125" title="R5RS Scheme form">begin</a>
              (put #\() 
              (put tag-name) (put #\space)

                                        <span class="comment">; Linearize HTML attributes</span><br />              (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX413" title="R5RS Scheme form">for-each</a> 
               (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">attr-pair</span>) 
                 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">key</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> attr-pair))
                       (<span class="local-name-binding">val</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> attr-pair)))
                   (put #\space)
                   (put #\') (put (symbol->string key)) (put #\space)
                   (put <a class="applied-name" href="xml-in-laml-1.html#quote-char" title="xml-in-laml">quote-char</a>)
                   (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX128" title="R5RS Scheme form">do</a> ((lgt (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX378" title="R5RS Scheme form">string-length</a> val))
                        (<a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a> 0 (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> <a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a> 1))
                        )
                       ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX235" title="R5RS Scheme form">=</a> <a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a> lgt) 'done)
                     (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">ch</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX379" title="R5RS Scheme form">string-ref</a> val <a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a>)))
                       (put ch)))
                   (put <a class="applied-name" href="xml-in-laml-1.html#quote-char" title="xml-in-laml">quote-char</a>) (put #\space))
                 )
               attribute-alist)

            ))

          (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX118" title="R5RS Scheme form">or</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> render-what 'all) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> render-what 'contents))
              (<a class="applied-name" href="xml-in-laml-1.html#linearize-contents-list-fast-as-laml" title="xml-in-laml">linearize-contents-list-fast-as-laml</a> contents-list put tag-name ))

          (put ")")
       )

       (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (error "render-fast-as-laml: Either a single or double kind of ast expected.")))))

<a name="linearize-contents-list-fast-as-laml"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(linearize-contents-list-fast-as-laml contents-list put tag-name)</span>
  (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX413" title="R5RS Scheme form">for-each</a> 
    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">contents</span>) (<a class="applied-name" href="xml-in-laml-1.html#linearize-contents-fast-as-laml" title="xml-in-laml">linearize-contents-fast-as-laml</a> contents put tag-name))
    contents-list))


<a name="linearize-contents-fast-as-laml"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(linearize-contents-fast-as-laml contents put tag-name)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="applied-name" href="xml-in-laml-1.html#char-ref?" title="xml-in-laml">char-ref?</a> contents) (put (<a class="applied-name" href="xml-in-laml-1.html#xml-render-char-ref-as-laml" title="xml-in-laml">xml-render-char-ref-as-laml</a> contents)))
        ((<a class="applied-name" href="xml-in-laml-1.html#cdata-section?" title="xml-in-laml">cdata-section?</a> contents) (put (<a class="applied-name" href="xml-in-laml-1.html#xml-render-cdata-section-as-laml" title="xml-in-laml">xml-render-cdata-section-as-laml</a> contents)))
        ((<a class="applied-name" href="xml-in-laml-1.html#cdata?" title="xml-in-laml">cdata?</a> contents) 
          (put (<a class="applied-name" href="xml-in-laml-1.html#as-source-string" title="xml-in-laml">as-source-string</a> contents)) (put #\space)
        )
        ((<a class="applied-name" href="xml-in-laml-1.html#forced-white-space?" title="xml-in-laml">forced-white-space?</a> contents) (put " "))    <span class="comment">; not correct rendering. I cannot easily insert "_" due to possitive white space repr. in the AST</span><br />        ((<a class="applied-name" href="xml-in-laml-1.html#white-space-related?" title="xml-in-laml">white-space-related?</a> contents) (put ""))
        ((<a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> contents) (<a class="applied-name" href="xml-in-laml-1.html#render-fast-as-laml" title="xml-in-laml">render-fast-as-laml</a> contents put))
        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> 'do-nothing)
   )
)

<span class="comment">; End June 3, 2007
; ---------------------------------------------------------------------------------------------------------------</span><br />


<span class="comment">; A very simple pure textual rendering of content (an AST, a list of ASTs, char-ref, etc). Strips all markup.
; No formatting is provided at all.
; .returns a text string without markup and without any formatting.
; Old and primitive version.
; (define (xml-render-as-simple-text contents)
;  (cond ((ast? contents) (xml-render-as-simple-text (ast-subtrees contents)))
;        ((char-ref? contents) (as-string (char-ref-value contents)))
;        ((cdata-section? contents) (xml-render-cdata-section cdata-section))
;        ((and (white-space-related? contents) (eq? contents explicit-space)) " ")
;        ((white-space-related? contents) "")
;        ((delayed-procedural-contents-element? contents) "")  ; ignore
;        ((list? contents) (list-to-string (map xml-render-as-simple-text  contents) ""))
;        (else (as-string contents))))</span><br />

<span class="comment">; ----------------------------------------------------------------------------------------
; Rendering of ASTs (lists of ASTs, etc) as pure and simple text.
; Modelled after the function render-fast.</span><br />

<a name="xml-render-as-simple-text"></a><a name="xml-render-as-simple-text"></a><span><a href="../xml-in-laml.html#xml-render-as-simple-text"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(xml-render-as-simple-text contents)</span>
   (<a class="applied-name" href="xml-in-laml-1.html#reset-sink-string" title="xml-in-laml">reset-sink-string</a>)
   (<a class="applied-name" href="xml-in-laml-1.html#xml-render-as-simple-text-1" title="xml-in-laml">xml-render-as-simple-text-1</a> contents)
   (<a class="applied-name" href="xml-in-laml-1.html#sink-string" title="xml-in-laml">sink-string</a>))

<a name="xml-render-as-simple-text-1"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(xml-render-as-simple-text-1 contents)</span>
   (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> contents) (<a class="applied-name" href="xml-in-laml-1.html#render-fast-simple-text" title="xml-in-laml">render-fast-simple-text</a> contents <a class="applied-name" href="xml-in-laml-1.html#put-in-sink-text-string" title="xml-in-laml">put-in-sink-text-string</a> #f))  <span class="comment">; xml-always-render-white-space?</span><br />         ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX331" title="R5RS Scheme form">list?</a> contents) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX413" title="R5RS Scheme form">for-each</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">c</span>) (<a class="applied-name" href="xml-in-laml-1.html#xml-render-as-simple-text-1" title="xml-in-laml">xml-render-as-simple-text-1</a> c)) contents))
	 ((<a class="applied-name" href="xml-in-laml-1.html#char-ref?" title="xml-in-laml">char-ref?</a> contents) (<a class="applied-name" href="xml-in-laml-1.html#put-in-sink-text-string" title="xml-in-laml">put-in-sink-text-string</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> (<a class="applied-name" href="xml-in-laml-1.html#char-ref-value" title="xml-in-laml">char-ref-value</a> contents))))
	 ((<a class="applied-name" href="xml-in-laml-1.html#cdata-section?" title="xml-in-laml">cdata-section?</a> contents) (<a class="applied-name" href="xml-in-laml-1.html#put-in-sink-text-string" title="xml-in-laml">put-in-sink-text-string</a> (<a class="applied-name" href="xml-in-laml-1.html#xml-render-cdata-section" title="xml-in-laml">xml-render-cdata-section</a> <a class="applied-name" href="xml-in-laml-1.html#cdata-section" title="xml-in-laml">cdata-section</a>)))
	 ((<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="applied-name" href="xml-in-laml-1.html#white-space-related?" title="xml-in-laml">white-space-related?</a> contents) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> contents <a class="applied-name" href="xml-in-laml-1.html#explicit-space" title="xml-in-laml">explicit-space</a>)) (<a class="applied-name" href="xml-in-laml-1.html#put-in-sink-text-string" title="xml-in-laml">put-in-sink-text-string</a> #\space)) 
	 ((<a class="applied-name" href="xml-in-laml-1.html#white-space-related?" title="xml-in-laml">white-space-related?</a> contents) 'do-nothing)
	 ((<a class="applied-name" href="xml-in-laml-1.html#delayed-procedural-contents-element?" title="xml-in-laml">delayed-procedural-contents-element?</a> contents) 'do-nothing)
         ((<a class="applied-name" href="xml-in-laml-1.html#cdata?" title="xml-in-laml">cdata?</a> contents) (<a class="applied-name" href="xml-in-laml-1.html#linearize-contents-fast-simple-text" title="xml-in-laml">linearize-contents-fast-simple-text</a> contents <a class="applied-name" href="xml-in-laml-1.html#put-in-sink-text-string" title="xml-in-laml">put-in-sink-text-string</a> #f '() 'no-char-trans-table-needed #f))  <span class="comment">; in order to eliminate extra white space in pure text</span><br />         (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="applied-name" href="xml-in-laml-1.html#put-in-sink-text-string" title="xml-in-laml">put-in-sink-text-string</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> contents)))))

<a name="render-fast-simple-text"></a><span class="comment">; Adapted from render-fast</span><br /><a name="render-fast-simple-text"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(render-fast-simple-text ast put always-render-white-space?)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">render-what</span> 'all)
        (<span class="local-name-binding">tag-name</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-element-name" title="xml-in-laml">ast-element-name</a> ast)) 
        (<span class="local-name-binding">contents-list</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-subtrees" title="xml-in-laml">ast-subtrees</a> ast))
        (<span class="local-name-binding">attribute-properlist</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-attributes" title="xml-in-laml">ast-attributes</a> ast))  <span class="comment">; split in normal and css here</span><br />        (<span class="local-name-binding">attribute-alist</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#propertylist-to-alist" title="Manual: general">propertylist-to-alist</a> attribute-properlist))
        (<span class="local-name-binding">reorganized-attribute-alist</span> (<a class="applied-name" href="xml-in-laml-1.html#html-css-split" title="xml-in-laml">html-css-split</a> attribute-alist '() '()))
        (<span class="local-name-binding">html-attribute-alist</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> reorganized-attribute-alist))
        (<span class="local-name-binding">css-attribute-alist</span>  (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> reorganized-attribute-alist))
        (<span class="local-name-binding">kind</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-kind" title="xml-in-laml">ast-kind</a> ast))

        (<span class="local-name-binding">language</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-language" title="xml-in-laml">ast-language</a> ast))
        (<span class="local-name-binding">xml-transliterate-character-data?</span> #f)
        (<span class="local-name-binding">xml-non-transliteration-elements</span> (<a class="applied-name" href="xml-in-laml-1.html#xml-non-transliteration-elements-in" title="xml-in-laml">xml-non-transliteration-elements-in</a> language))
        (<span class="local-name-binding">xml-preformatted-text-elements</span> (<a class="applied-name" href="xml-in-laml-1.html#xml-preformatted-text-elements-in" title="xml-in-laml">xml-preformatted-text-elements-in</a> language))  <span class="comment">; (list "pre")</span><br />        (<span class="local-name-binding">xml-char-transformation-table</span> (<a class="applied-name" href="xml-in-laml-1.html#xml-char-transformation-table-in" title="xml-in-laml">xml-char-transformation-table-in</a> language))

       )

  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> kind 'single)  <span class="comment">; empty element</span><br />          'do-nothing
        )

        ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> kind 'double)  <span class="comment">; non-empty element</span><br />          
          (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX118" title="R5RS Scheme form">or</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> render-what 'all) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> render-what 'contents))
              (<a class="applied-name" href="xml-in-laml-1.html#linearize-contents-list-fast-simple-text" title="xml-in-laml">linearize-contents-list-fast-simple-text</a> contents-list put xml-transliterate-character-data? xml-non-transliteration-elements
                                            xml-char-transformation-table 
                                            (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX118" title="R5RS Scheme form">or</a> always-render-white-space? (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX340" title="R5RS Scheme form">member</a> tag-name xml-preformatted-text-elements))))
        )

        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (error "render-fast-simple-text: Either a single or double kind of ast expected.")))))


<a name="linearize-contents-list-fast-simple-text"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(linearize-contents-list-fast-simple-text contents-list put xml-transliterate-character-data? xml-non-transliteration-elements xml-char-transformation-table always-render-white-space?)</span>
  (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX413" title="R5RS Scheme form">for-each</a> 
    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">contents</span>) 
      (<a class="applied-name" href="xml-in-laml-1.html#linearize-contents-fast-simple-text" title="xml-in-laml">linearize-contents-fast-simple-text</a> contents put 
                                                xml-transliterate-character-data? xml-non-transliteration-elements xml-char-transformation-table always-render-white-space?))
    contents-list))


<a name="linearize-contents-fast-simple-text"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(linearize-contents-fast-simple-text contents put xml-transliterate-character-data? xml-non-transliteration-elements xml-char-transformation-table 
                                 always-render-white-space?)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="applied-name" href="xml-in-laml-1.html#char-ref?" title="xml-in-laml">char-ref?</a> contents) (put (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> (<a class="applied-name" href="xml-in-laml-1.html#char-ref-value" title="xml-in-laml">char-ref-value</a> contents))))  <span class="comment">; ??</span><br />        ((<a class="applied-name" href="xml-in-laml-1.html#xml-comment?" title="xml-in-laml">xml-comment?</a> contents) 'do-nothing)
        ((<a class="applied-name" href="xml-in-laml-1.html#processing-instruction?" title="xml-in-laml">processing-instruction?</a> contents) 'do-nothing)
        ((<a class="applied-name" href="xml-in-laml-1.html#cdata-section?" title="xml-in-laml">cdata-section?</a> contents) (put (<a class="applied-name" href="xml-in-laml-1.html#xml-render-cdata-section" title="xml-in-laml">xml-render-cdata-section</a> contents)))
        ((<a class="applied-name" href="xml-in-laml-1.html#cdata?" title="xml-in-laml">cdata?</a> contents) 
          (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">white-space-printed?</span> #f)) <span class="comment">; true if last printed char is white space</span><br />            (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX128" title="R5RS Scheme form">do</a> ((lgt (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX378" title="R5RS Scheme form">string-length</a> contents))
		 (<a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a> 0 (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> <a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a> 1))
		 )
		((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX235" title="R5RS Scheme form">=</a> <a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a> lgt) 'done)
	      (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">ch</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX379" title="R5RS Scheme form">string-ref</a> contents <a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a>)))
		(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> always-render-white-space?
		    (put ch)
		    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX125" title="R5RS Scheme form">begin</a>
		      (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> white-space-printed? (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX339" title="R5RS Scheme form">memv</a> ch <a class="schemedoc-name" href="../../../../lib/man/general.html#white-space-char-list" title="Manual: general">white-space-char-list</a>)))
			  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX339" title="R5RS Scheme form">memv</a> ch <a class="schemedoc-name" href="../../../../lib/man/general.html#white-space-char-list" title="Manual: general">white-space-char-list</a>) (put #\space) (put ch)))
		      (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX339" title="R5RS Scheme form">memv</a> ch <a class="schemedoc-name" href="../../../../lib/man/general.html#white-space-char-list" title="Manual: general">white-space-char-list</a>) (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> white-space-printed? #t) (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> white-space-printed? #f))
                      )
		    )
		)
	      )
           )
        )
        ((<a class="applied-name" href="xml-in-laml-1.html#forced-white-space?" title="xml-in-laml">forced-white-space?</a> contents) (put #\space))
        ((<a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> contents) (<a class="applied-name" href="xml-in-laml-1.html#render-fast-simple-text" title="xml-in-laml">render-fast-simple-text</a> contents put always-render-white-space?))
        ((<a class="applied-name" href="xml-in-laml-1.html#delayed-procedural-contents-element?" title="xml-in-laml">delayed-procedural-contents-element?</a> contents) 'do-nothing)
        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> 'do-nothing)
   )
)

<span class="comment">; End of simple text rendering.
; ----------------------------------------------------------------------------------------</span><br />




<a name="sink-string-segment-size"></a><span class="comment">; --------------------------------------------------------------------
; String sink in terms of segments (a list) of strings.</span><br />
<a name="sink-string-segment-size"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">sink-string-segment-size</span> 20000)
<a name="sink-string-segment-limit"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">sink-string-segment-limit</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> <a class="applied-name" href="xml-in-laml-1.html#sink-string-segment-size" title="xml-in-laml">sink-string-segment-size</a> 1))
<a name="output-sink-segments"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">output-sink-segments</span> '())
<a name="output-sink-string"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">output-sink-string</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX375" title="R5RS Scheme form">make-string</a> <a class="applied-name" href="xml-in-laml-1.html#sink-string-segment-size" title="xml-in-laml">sink-string-segment-size</a>))
<a name="next-sink-ptr"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">next-sink-ptr</span> 0)

<a name="put-in-sink-text-string"></a><span class="comment">; Put x (string or char) into output sink.</span><br /><a name="put-in-sink-text-string"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(put-in-sink-text-string x)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX351" title="R5RS Scheme form">char?</a> x) 
          (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX125" title="R5RS Scheme form">begin</a>
           (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX380" title="R5RS Scheme form">string-set!</a> <a class="applied-name" href="xml-in-laml-1.html#output-sink-string" title="xml-in-laml">output-sink-string</a> <a class="applied-name" href="xml-in-laml-1.html#next-sink-ptr" title="xml-in-laml">next-sink-ptr</a> x)
           (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> <a class="applied-name" href="xml-in-laml-1.html#next-sink-ptr" title="xml-in-laml">next-sink-ptr</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> 1 <a class="applied-name" href="xml-in-laml-1.html#next-sink-ptr" title="xml-in-laml">next-sink-ptr</a>))
           (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX235" title="R5RS Scheme form">=</a> <a class="applied-name" href="xml-in-laml-1.html#next-sink-ptr" title="xml-in-laml">next-sink-ptr</a> <a class="applied-name" href="xml-in-laml-1.html#sink-string-segment-size" title="xml-in-laml">sink-string-segment-size</a>) (<a class="applied-name" href="xml-in-laml-1.html#prepare-next-sink-segment" title="xml-in-laml">prepare-next-sink-segment</a>))))

        ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX374" title="R5RS Scheme form">string?</a> x)
          (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX128" title="R5RS Scheme form">do</a> ((lgt (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX378" title="R5RS Scheme form">string-length</a> x))
               (<a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a> 0 (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> <a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a> 1))
               (j <a class="applied-name" href="xml-in-laml-1.html#next-sink-ptr" title="xml-in-laml">next-sink-ptr</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX236" title="R5RS Scheme form">&lt;</a> j <a class="applied-name" href="xml-in-laml-1.html#sink-string-segment-limit" title="xml-in-laml">sink-string-segment-limit</a>) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> j 1) 0))
              )
              ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX235" title="R5RS Scheme form">=</a> <a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a> lgt) (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> <a class="applied-name" href="xml-in-laml-1.html#next-sink-ptr" title="xml-in-laml">next-sink-ptr</a> j))
               (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX380" title="R5RS Scheme form">string-set!</a> <a class="applied-name" href="xml-in-laml-1.html#output-sink-string" title="xml-in-laml">output-sink-string</a> j (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX379" title="R5RS Scheme form">string-ref</a> x <a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a>))
               (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX235" title="R5RS Scheme form">=</a> j <a class="applied-name" href="xml-in-laml-1.html#sink-string-segment-limit" title="xml-in-laml">sink-string-segment-limit</a>) (<a class="applied-name" href="xml-in-laml-1.html#prepare-next-sink-segment" title="xml-in-laml">prepare-next-sink-segment</a>))
              ))

        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> "put-in-sink-string: Can only output chars or strings")))

<a name="prepare-next-sink-segment"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(prepare-next-sink-segment)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> <a class="applied-name" href="xml-in-laml-1.html#output-sink-segments" title="xml-in-laml">output-sink-segments</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX395" title="R5RS Scheme form">string-copy</a> <a class="applied-name" href="xml-in-laml-1.html#output-sink-string" title="xml-in-laml">output-sink-string</a>) <a class="applied-name" href="xml-in-laml-1.html#output-sink-segments" title="xml-in-laml">output-sink-segments</a>))
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> <a class="applied-name" href="xml-in-laml-1.html#next-sink-ptr" title="xml-in-laml">next-sink-ptr</a> 0)
)

<a name="sink-string"></a><span class="comment">; Return the resulting sink string</span><br /><a name="sink-string"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(sink-string)</span>
 (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> 
   (<a class="schemedoc-name" href="../../../../lib/man/general.html#list-to-string" title="Manual: general">list-to-string</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX335" title="R5RS Scheme form">reverse</a> <a class="applied-name" href="xml-in-laml-1.html#output-sink-segments" title="xml-in-laml">output-sink-segments</a>) "")
   (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX391" title="R5RS Scheme form">substring</a> <a class="applied-name" href="xml-in-laml-1.html#output-sink-string" title="xml-in-laml">output-sink-string</a> 0 <a class="applied-name" href="xml-in-laml-1.html#next-sink-ptr" title="xml-in-laml">next-sink-ptr</a>)))

<a name="reset-sink-string"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(reset-sink-string)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> <a class="applied-name" href="xml-in-laml-1.html#output-sink-segments" title="xml-in-laml">output-sink-segments</a> '())
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> <a class="applied-name" href="xml-in-laml-1.html#next-sink-ptr" title="xml-in-laml">next-sink-ptr</a> 0))

<span class="comment">; --------------------------------------------------------------------
; Stream sink.</span><br />
<a name="put-in-sink-stream-generator"></a><span class="comment">; Generate an output port put procedure</span><br /><a name="put-in-sink-stream-generator"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(put-in-sink-stream-generator port)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">x</span>)
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX351" title="R5RS Scheme form">char?</a> x) 
          (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX466" title="R5RS Scheme form">write-char</a> x port))
        ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX374" title="R5RS Scheme form">string?</a> x)
          (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX128" title="R5RS Scheme form">do</a> ((lgt (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX378" title="R5RS Scheme form">string-length</a> x))
               (<a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a> 0 (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> <a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a> 1))
              )
              ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX235" title="R5RS Scheme form">=</a> <a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a> lgt) 'done)
               (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX466" title="R5RS Scheme form">write-char</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX379" title="R5RS Scheme form">string-ref</a> x <a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a>) port)))
        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> "put-in-sink-stream: Can only output chars or strings"))))


<a name="quote-char"></a><span class="comment">; --------------------------------------------------------------------
; Sink independet raw rendering. 
; The function render-fast, as shown below, has a 'pretty printing counterpart' called pp-render-fast.</span><br />
<a name="quote-char"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">quote-char</span> #\")

<a name="render-fast"></a><span class="comment">; Render ast via the put function. 
; The optional parameter, render-what is either all, start-tag, contents, end-tag.
; It only applies for double elements (elements with contents).
; The default valus is all. If render-what is start-tag, only the start-tag is rendered.
; If render-what is contents, only the contents in between the start and end tag is rendered.
; If render-what is end-tag, only the end tag is rendered.</span><br /><a name="render-fast"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(render-fast ast put always-render-white-space? . optional-parameter-list)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">render-what</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#optional-parameter" title="Manual: general">optional-parameter</a> 1 optional-parameter-list 'all))
        (<span class="local-name-binding">tag-name</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-element-name" title="xml-in-laml">ast-element-name</a> ast)) 
        (<span class="local-name-binding">contents-list</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-subtrees" title="xml-in-laml">ast-subtrees</a> ast))
        (<span class="local-name-binding">attribute-properlist</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-attributes" title="xml-in-laml">ast-attributes</a> ast))  <span class="comment">; split in normal and css here</span><br />        (<span class="local-name-binding">attribute-alist</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#propertylist-to-alist" title="Manual: general">propertylist-to-alist</a> attribute-properlist))
        (<span class="local-name-binding">reorganized-attribute-alist</span> (<a class="applied-name" href="xml-in-laml-1.html#html-css-split" title="xml-in-laml">html-css-split</a> attribute-alist '() '()))
        (<span class="local-name-binding">html-attribute-alist</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> reorganized-attribute-alist))
        (<span class="local-name-binding">css-attribute-alist</span>  (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> reorganized-attribute-alist))
        (<span class="local-name-binding">kind</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-kind" title="xml-in-laml">ast-kind</a> ast))

        (<span class="local-name-binding">extraordinary-preserve-white-space</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-boolean" title="Manual: general">as-boolean</a> (<a class="applied-name" href="xml-in-laml-1.html#ast-internal-attribute" title="xml-in-laml">ast-internal-attribute</a> ast 'white-space-preserve #f)))
        (<span class="local-name-binding">alternate-xml-char-transformation-table</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-internal-attribute" title="xml-in-laml">ast-internal-attribute</a> ast 'xml-char-transformation-table #f))

        (<span class="local-name-binding">language</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-language" title="xml-in-laml">ast-language</a> ast))
        (<span class="local-name-binding">xml-transliterate-character-data?</span> (<a class="applied-name" href="xml-in-laml-1.html#xml-transliterate-character-data-in?" title="xml-in-laml">xml-transliterate-character-data-in?</a> language))
        (<span class="local-name-binding">xml-non-transliteration-elements</span> (<a class="applied-name" href="xml-in-laml-1.html#xml-non-transliteration-elements-in" title="xml-in-laml">xml-non-transliteration-elements-in</a> language))
        (<span class="local-name-binding">xml-preformatted-text-elements</span> (<a class="applied-name" href="xml-in-laml-1.html#xml-preformatted-text-elements-in" title="xml-in-laml">xml-preformatted-text-elements-in</a> language))  <span class="comment">; like:  (list "pre")</span><br />        (<span class="local-name-binding">xml-char-transformation-table</span> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> alternate-xml-char-transformation-table
                                           (eval-cur-env (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-symbol" title="Manual: general">as-symbol</a> alternate-xml-char-transformation-table))
                                           (<a class="applied-name" href="xml-in-laml-1.html#xml-char-transformation-table-in" title="xml-in-laml">xml-char-transformation-table-in</a> language)))

       )

  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> kind 'single)  <span class="comment">; empty element</span><br />          (put #\<) 
          (put tag-name) 

          <span class="comment">; Linearize HTML attributes - duplicate code inlined for double elements!</span><br />          (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX413" title="R5RS Scheme form">for-each</a> 
            (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">attr-pair</span>) 
             (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">key</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> attr-pair))
                   (<span class="local-name-binding">val</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> attr-pair)))
               (put #\space)
               (put (symbol->string key))
               (put #\=) (put <a class="applied-name" href="xml-in-laml-1.html#quote-char" title="xml-in-laml">quote-char</a>)
               (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX128" title="R5RS Scheme form">do</a> ((lgt (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX378" title="R5RS Scheme form">string-length</a> val))
                    (<a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a> 0 (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> <a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a> 1))
                   )
                   ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX235" title="R5RS Scheme form">=</a> <a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a> lgt) 'done)
                 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">ch</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX379" title="R5RS Scheme form">string-ref</a> val <a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a>)))
                   (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX196" title="R5RS Scheme form">eqv?</a> ch #\&) (put ch) (put (<a class="schemedoc-name" href="../../../../man/laml.html#html-char-transform" title="Manual: laml">html-char-transform</a> ch xml-char-transformation-table))))
                 )
               (put <a class="applied-name" href="xml-in-laml-1.html#quote-char" title="xml-in-laml">quote-char</a>))
            )
          html-attribute-alist)

          <span class="comment">; Linearize CSS attributes - duplicate code inlined for double elements!</span><br />          (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> css-attribute-alist))
              (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX125" title="R5RS Scheme form">begin</a>
                (put #\space) 
                (put "style=") (put <a class="applied-name" href="xml-in-laml-1.html#quote-char" title="xml-in-laml">quote-char</a>)
                (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX413" title="R5RS Scheme form">for-each</a>
                 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">attr-pair</span>) 
                   (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">key</span> (symbol->string (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> attr-pair)))
                          (<span class="local-name-binding">non-cssed-key</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX391" title="R5RS Scheme form">substring</a> key 4 (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX378" title="R5RS Scheme form">string-length</a> key)))
                          (<span class="local-name-binding">val</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> attr-pair)))
                     (put non-cssed-key)
                     (put #\:)
                     (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX128" title="R5RS Scheme form">do</a> ((lgt (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX378" title="R5RS Scheme form">string-length</a> val))
                          (<a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a> 0 (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> <a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a> 1))
                         )
                         ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX235" title="R5RS Scheme form">=</a> <a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a> lgt) 'done)
                       (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">ch</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX379" title="R5RS Scheme form">string-ref</a> val <a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a>)))
                         (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX196" title="R5RS Scheme form">eqv?</a> ch #\&) (put ch) (put (<a class="schemedoc-name" href="../../../../man/laml.html#html-char-transform" title="Manual: laml">html-char-transform</a> ch xml-char-transformation-table)))))
                     (put #\;))) 
                css-attribute-alist)
                (put <a class="applied-name" href="xml-in-laml-1.html#quote-char" title="xml-in-laml">quote-char</a>)))

          (put " /&gt;"))

        ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> kind 'double)  <span class="comment">; non-empty element</span><br />          (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX118" title="R5RS Scheme form">or</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> render-what 'all) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> render-what 'start-tag))
            (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX125" title="R5RS Scheme form">begin</a>
              (put #\<) 
              (put tag-name) 

                                        <span class="comment">; Linearize HTML attributes</span><br />              (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX413" title="R5RS Scheme form">for-each</a> 
               (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">attr-pair</span>) 
                 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">key</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> attr-pair))
                       (<span class="local-name-binding">val</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> attr-pair)))
                   (put #\space)
                   (put (symbol->string key))
                   (put #\=) (put <a class="applied-name" href="xml-in-laml-1.html#quote-char" title="xml-in-laml">quote-char</a>)
                   (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX128" title="R5RS Scheme form">do</a> ((lgt (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX378" title="R5RS Scheme form">string-length</a> val))
                        (<a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a> 0 (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> <a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a> 1))
                        )
                       ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX235" title="R5RS Scheme form">=</a> <a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a> lgt) 'done)
                     (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">ch</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX379" title="R5RS Scheme form">string-ref</a> val <a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a>)))
                       (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX196" title="R5RS Scheme form">eqv?</a> ch #\&) (put ch) (put (<a class="schemedoc-name" href="../../../../man/laml.html#html-char-transform" title="Manual: laml">html-char-transform</a> ch xml-char-transformation-table)))))
                   (put <a class="applied-name" href="xml-in-laml-1.html#quote-char" title="xml-in-laml">quote-char</a>))
                 )
               html-attribute-alist)

                                        <span class="comment">; Linearize CSS attributes</span><br />              (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> css-attribute-alist))
                  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX125" title="R5RS Scheme form">begin</a>
                    (put #\space) 
                    (put "style=") (put <a class="applied-name" href="xml-in-laml-1.html#quote-char" title="xml-in-laml">quote-char</a>)
                    (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX413" title="R5RS Scheme form">for-each</a>
                     (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">attr-pair</span>) 
                       (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">key</span> (symbol->string (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> attr-pair)))
                              (<span class="local-name-binding">non-cssed-key</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX391" title="R5RS Scheme form">substring</a> key 4 (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX378" title="R5RS Scheme form">string-length</a> key)))
                              (<span class="local-name-binding">val</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> attr-pair)))
                         (put non-cssed-key)
                         (put #\:)
                         (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX128" title="R5RS Scheme form">do</a> ((lgt (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX378" title="R5RS Scheme form">string-length</a> val))
                              (<a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a> 0 (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> <a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a> 1))
                              )
                             ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX235" title="R5RS Scheme form">=</a> <a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a> lgt) 'done)
                           (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">ch</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX379" title="R5RS Scheme form">string-ref</a> val <a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a>)))
                             (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX196" title="R5RS Scheme form">eqv?</a> ch #\&) (put ch) (put (<a class="schemedoc-name" href="../../../../man/laml.html#html-char-transform" title="Manual: laml">html-char-transform</a> ch xml-char-transformation-table)))))
                         (put #\;))) 
                     css-attribute-alist)
                    (put <a class="applied-name" href="xml-in-laml-1.html#quote-char" title="xml-in-laml">quote-char</a>)))

              (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> <a class="applied-name" href="xml-in-laml-1.html#use-empty-tags-for-elements-without-contents" title="xml-in-laml">use-empty-tags-for-elements-without-contents</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> contents-list)) (put " /&gt;") (put #\>)) ))

          (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX118" title="R5RS Scheme form">or</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> render-what 'all) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> render-what 'contents))
              (<a class="applied-name" href="xml-in-laml-1.html#linearize-contents-list-fast" title="xml-in-laml">linearize-contents-list-fast</a> contents-list put tag-name xml-transliterate-character-data? xml-non-transliteration-elements
                                            xml-char-transformation-table 
                                            (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX118" title="R5RS Scheme form">or</a> always-render-white-space? (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX340" title="R5RS Scheme form">member</a> tag-name xml-preformatted-text-elements) extraordinary-preserve-white-space)))

          (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> <a class="applied-name" href="xml-in-laml-1.html#use-empty-tags-for-elements-without-contents" title="xml-in-laml">use-empty-tags-for-elements-without-contents</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> contents-list)))
              (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX118" title="R5RS Scheme form">or</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> render-what 'all) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> render-what 'end-tag))
		  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX125" title="R5RS Scheme form">begin</a> (put "&lt;/")  (put tag-name) (put #\>)))))

       (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (error "render-fast: Either a single or double kind of ast expected.")))))

<a name="linearize-contents-list-fast"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(linearize-contents-list-fast contents-list put tag-name xml-transliterate-character-data? xml-non-transliteration-elements xml-char-transformation-table always-render-white-space?)</span>
  (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX413" title="R5RS Scheme form">for-each</a> 
    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">contents</span>) (<a class="applied-name" href="xml-in-laml-1.html#linearize-contents-fast" title="xml-in-laml">linearize-contents-fast</a> contents put tag-name xml-transliterate-character-data? xml-non-transliteration-elements xml-char-transformation-table always-render-white-space?))
    contents-list))


<a name="linearize-contents-fast"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(linearize-contents-fast contents put tag-name xml-transliterate-character-data? xml-non-transliteration-elements xml-char-transformation-table 
                                 always-render-white-space?)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="applied-name" href="xml-in-laml-1.html#char-ref?" title="xml-in-laml">char-ref?</a> contents) (put (<a class="applied-name" href="xml-in-laml-1.html#xml-render-char-ref" title="xml-in-laml">xml-render-char-ref</a> contents)))
        ((<a class="applied-name" href="xml-in-laml-1.html#xml-comment?" title="xml-in-laml">xml-comment?</a> contents) (put (<a class="applied-name" href="xml-in-laml-1.html#xml-render-xml-comment" title="xml-in-laml">xml-render-xml-comment</a> contents)))
        ((<a class="applied-name" href="xml-in-laml-1.html#processing-instruction?" title="xml-in-laml">processing-instruction?</a> contents) (put (<a class="applied-name" href="xml-in-laml-1.html#xml-render-processing-instruction" title="xml-in-laml">xml-render-processing-instruction</a> contents)))
        ((<a class="applied-name" href="xml-in-laml-1.html#cdata-section?" title="xml-in-laml">cdata-section?</a> contents) (put (<a class="applied-name" href="xml-in-laml-1.html#xml-render-cdata-section" title="xml-in-laml">xml-render-cdata-section</a> contents)))
        ((<a class="applied-name" href="xml-in-laml-1.html#cdata?" title="xml-in-laml">cdata?</a> contents) 
          (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">white-space-printed?</span> #f)) <span class="comment">; true if last printed char is white space</span><br />           (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> xml-transliterate-character-data? (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX340" title="R5RS Scheme form">member</a> tag-name xml-non-transliteration-elements)))

               (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX128" title="R5RS Scheme form">do</a> ((lgt (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX378" title="R5RS Scheme form">string-length</a> contents))
                    (<a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a> 0 (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> <a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a> 1))
                    )
                   ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX235" title="R5RS Scheme form">=</a> <a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a> lgt) 'done)
                 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">ch</span> (<a class="schemedoc-name" href="../../../../man/laml.html#html-char-transform" title="Manual: laml">html-char-transform</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX379" title="R5RS Scheme form">string-ref</a> contents <a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a>) xml-char-transformation-table)) <span class="comment">; a string!</span><br />                        (<span class="local-name-binding">ch-white-space?</span> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#empty-string?" title="Manual: general">empty-string?</a> ch)) (<a class="schemedoc-name" href="../../../../lib/man/general.html#string-of-char-list?" title="Manual: general">string-of-char-list?</a> ch <a class="schemedoc-name" href="../../../../lib/man/general.html#white-space-char-list" title="Manual: general">white-space-char-list</a>)))
                       )
                  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> always-render-white-space?
                      (put ch)
                      (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX125" title="R5RS Scheme form">begin</a>
                        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> white-space-printed? ch-white-space?))
                            (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> ch-white-space? (put #\space) (put ch)))
                        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> ch-white-space? (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> white-space-printed? #t) (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> white-space-printed? #f))
                      )
                  )
                 )
               )

               (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX128" title="R5RS Scheme form">do</a> ((lgt (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX378" title="R5RS Scheme form">string-length</a> contents))
                    (<a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a> 0 (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> <a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a> 1))
                    )
                   ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX235" title="R5RS Scheme form">=</a> <a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a> lgt) 'done)
                 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">ch</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX379" title="R5RS Scheme form">string-ref</a> contents <a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a>)))
                  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> always-render-white-space?
                      (put ch)
                      (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX125" title="R5RS Scheme form">begin</a>
                       (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> white-space-printed? (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX339" title="R5RS Scheme form">memv</a> ch <a class="schemedoc-name" href="../../../../lib/man/general.html#white-space-char-list" title="Manual: general">white-space-char-list</a>)))
                           (put ch))
                       (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX339" title="R5RS Scheme form">memv</a> ch <a class="schemedoc-name" href="../../../../lib/man/general.html#white-space-char-list" title="Manual: general">white-space-char-list</a>) (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> white-space-printed? #t) (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> white-space-printed? #f))
                      )
                  )
                 )
               )
            )
           )
        )
        ((<a class="applied-name" href="xml-in-laml-1.html#forced-white-space?" title="xml-in-laml">forced-white-space?</a> contents) (put #\space))
        ((<a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> contents) (<a class="applied-name" href="xml-in-laml-1.html#render-fast" title="xml-in-laml">render-fast</a> contents put always-render-white-space?))
        ((<a class="applied-name" href="xml-in-laml-1.html#delayed-procedural-contents-element?" title="xml-in-laml">delayed-procedural-contents-element?</a> contents)
           (<a class="schemedoc-name" href="../../../../lib/man/general.html#display-warning" title="Manual: general">display-warning</a> "Attempting to render delayed procedural content element - ignored"))
        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> 'do-nothing)
   )
)


<a name="xml-css-key?"></a><span class="comment">; Return whether key is a css-key, for instance a key like css:k or CSS:k
; A true value is the key proper, such as k (as a string).</span><br /><a name="xml-css-key?"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(xml-css-key? key)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">key-str</span> (symbol->string key))
         (<span class="local-name-binding">lgt</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX378" title="R5RS Scheme form">string-length</a> key-str)))
   (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a>
    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX239" title="R5RS Scheme form">&gt;=</a> lgt 4) 
         (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX118" title="R5RS Scheme form">or</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX196" title="R5RS Scheme form">eqv?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX379" title="R5RS Scheme form">string-ref</a> key-str 0) #\c) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX196" title="R5RS Scheme form">eqv?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX379" title="R5RS Scheme form">string-ref</a> key-str 0) #\C))
         (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX118" title="R5RS Scheme form">or</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX196" title="R5RS Scheme form">eqv?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX379" title="R5RS Scheme form">string-ref</a> key-str 1) #\s) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX196" title="R5RS Scheme form">eqv?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX379" title="R5RS Scheme form">string-ref</a> key-str 1) #\S))
         (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX118" title="R5RS Scheme form">or</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX196" title="R5RS Scheme form">eqv?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX379" title="R5RS Scheme form">string-ref</a> key-str 2) #\s) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX196" title="R5RS Scheme form">eqv?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX379" title="R5RS Scheme form">string-ref</a> key-str 2) #\S))
         (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX196" title="R5RS Scheme form">eqv?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX379" title="R5RS Scheme form">string-ref</a> key-str 3) #\:))
    (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX391" title="R5RS Scheme form">substring</a> key-str 4 lgt)
    #f)))

<a name="html-css-split"></a><span class="comment">; Split attribute-alist in two parts: the HTML attributes and the CSS attributes.
; Return (cons html-alist css-alist) where html-alist is the association lists of HTML attributes
; and css-alist is the association list of CSS attributes.</span><br /><a name="html-css-split"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(html-css-split attribute-alist html-alist css-alist)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> attribute-alist) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX335" title="R5RS Scheme form">reverse</a> html-alist) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX335" title="R5RS Scheme form">reverse</a> css-alist)))
        ((<a class="applied-name" href="xml-in-laml-1.html#xml-css-key?" title="xml-in-laml">xml-css-key?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">caar</a> attribute-alist)) 
            (<a class="applied-name" href="xml-in-laml-1.html#html-css-split" title="xml-in-laml">html-css-split</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> attribute-alist) html-alist (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> attribute-alist) css-alist)))
        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> 
            (<a class="applied-name" href="xml-in-laml-1.html#html-css-split" title="xml-in-laml">html-css-split</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> attribute-alist) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> attribute-alist) html-alist) css-alist))))


<a name="pp-render-fast"></a><span class="comment">; ----------------------------------------------------------------------------------------------------------------------------------------------------------
; Pretty printed, fast AST rendering.
; The procedures pp-render-fast, pp-linearize-contents-list-fast, and pp-linearize-contents-fast
; are very similar to render-fast, linearize-contents-list-fast, and linearize-contents-fast. 
; This is an important notice for maintenance purposes. 
; In case of single line rendering of an XML fragment, pp-render-fast calls render-fast.</span><br />

<a name="pp-render-fast"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(pp-render-fast ast put always-render-white-space? start-col single-lining?)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="applied-name" href="xml-in-laml-1.html#single-liner-form?" title="xml-in-laml">single-liner-form?</a> ast start-col <a class="applied-name" href="xml-in-laml-1.html#preferred-maximum-width" title="xml-in-laml">preferred-maximum-width</a>)
     (<a class="applied-name" href="xml-in-laml-1.html#render-fast" title="xml-in-laml">render-fast</a> ast put #f)
     (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">tag-name</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-element-name" title="xml-in-laml">ast-element-name</a> ast)) 
            (<span class="local-name-binding">contents-list</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-subtrees" title="xml-in-laml">ast-subtrees</a> ast))
            (<span class="local-name-binding">attribute-properlist</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-attributes" title="xml-in-laml">ast-attributes</a> ast)) <span class="comment">; split in normal and css here</span><br />            (<span class="local-name-binding">attribute-alist</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#propertylist-to-alist" title="Manual: general">propertylist-to-alist</a> attribute-properlist))
            (<span class="local-name-binding">reorganized-attribute-alist</span> (<a class="applied-name" href="xml-in-laml-1.html#html-css-split" title="xml-in-laml">html-css-split</a> attribute-alist '() '()))
            (<span class="local-name-binding">html-attribute-alist</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> reorganized-attribute-alist))
            (<span class="local-name-binding">css-attribute-alist</span>  (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> reorganized-attribute-alist))
            (<span class="local-name-binding">kind</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-kind" title="xml-in-laml">ast-kind</a> ast))

            (<span class="local-name-binding">language</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-language" title="xml-in-laml">ast-language</a> ast))
            (<span class="local-name-binding">xml-transliterate-character-data?</span> (<a class="applied-name" href="xml-in-laml-1.html#xml-transliterate-character-data-in?" title="xml-in-laml">xml-transliterate-character-data-in?</a> language))
            (<span class="local-name-binding">xml-non-transliteration-elements</span> (<a class="applied-name" href="xml-in-laml-1.html#xml-non-transliteration-elements-in" title="xml-in-laml">xml-non-transliteration-elements-in</a> language))
            (<span class="local-name-binding">xml-preformatted-text-elements</span> (<a class="applied-name" href="xml-in-laml-1.html#xml-preformatted-text-elements-in" title="xml-in-laml">xml-preformatted-text-elements-in</a> language)) <span class="comment">; (list "pre")</span><br />            (<span class="local-name-binding">xml-char-transformation-table</span> (<a class="applied-name" href="xml-in-laml-1.html#xml-char-transformation-table-in" title="xml-in-laml">xml-char-transformation-table-in</a> language))

            (<span class="local-name-binding">attr-width</span> 0)  <span class="comment">; approximative printed attribute width</span><br />            (<span class="local-name-binding">attr-cnt</span> 0)
            (<span class="local-name-binding">attr-lgt</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX333" title="R5RS Scheme form">length</a> attribute-alist))

           )

       (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> kind 'single)        <span class="comment">; empty element</span><br />              (put #\<) 
              (put tag-name) 

                                        <span class="comment">; Linearize HTML attributes - duplicate code inlined for double elements!</span><br />              (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX413" title="R5RS Scheme form">for-each</a> 
               (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">attr-pair</span>) 
                 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">key</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> attr-pair))
                       (<span class="local-name-binding">val</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> attr-pair)))
                   (put #\space)
                   (put (symbol->string key))
                   (put #\=) (put <a class="applied-name" href="xml-in-laml-1.html#quote-char" title="xml-in-laml">quote-char</a>)
                   (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX128" title="R5RS Scheme form">do</a> ((lgt (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX378" title="R5RS Scheme form">string-length</a> val))
                        (<a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a> 0 (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> <a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a> 1))
                        )
                       ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX235" title="R5RS Scheme form">=</a> <a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a> lgt) 'done)
                     (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">ch</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX379" title="R5RS Scheme form">string-ref</a> val <a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a>)))
                       (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX196" title="R5RS Scheme form">eqv?</a> ch #\&) (put ch) (put (<a class="schemedoc-name" href="../../../../man/laml.html#html-char-transform" title="Manual: laml">html-char-transform</a> ch xml-char-transformation-table)))))
                   (put <a class="applied-name" href="xml-in-laml-1.html#quote-char" title="xml-in-laml">quote-char</a>)
                   (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> attr-width (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> attr-width (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX378" title="R5RS Scheme form">string-length</a> (symbol->string key)) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX378" title="R5RS Scheme form">string-length</a> val) 3))
                   (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> attr-cnt (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> 1 attr-cnt)) 
                   (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX237" title="R5RS Scheme form">&gt;</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> attr-width start-col) <a class="applied-name" href="xml-in-laml-1.html#preferred-maximum-width" title="xml-in-laml">preferred-maximum-width</a>) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX236" title="R5RS Scheme form">&lt;</a> attr-cnt attr-lgt))
                       (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX125" title="R5RS Scheme form">begin</a> (put #\newline) (<a class="applied-name" href="xml-in-laml-1.html#put-indentation" title="xml-in-laml">put-indentation</a> put (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX378" title="R5RS Scheme form">string-length</a> tag-name) start-col 1)) (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> attr-width 0))) <span class="comment">; PP!!</span><br />                  )
                 )
               html-attribute-alist)

                                        <span class="comment">; Linearize CSS attributes - duplicate code inlined for double elements!</span><br />              (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> css-attribute-alist))
                  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX125" title="R5RS Scheme form">begin</a>
                    (put #\space) 
                    (put "style=") (put <a class="applied-name" href="xml-in-laml-1.html#quote-char" title="xml-in-laml">quote-char</a>)
                    (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX413" title="R5RS Scheme form">for-each</a>
                     (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">attr-pair</span>) 
                       (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">key</span> (symbol->string (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> attr-pair)))
                              (<span class="local-name-binding">non-cssed-key</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX391" title="R5RS Scheme form">substring</a> key 4 (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX378" title="R5RS Scheme form">string-length</a> key)))
                              (<span class="local-name-binding">val</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> attr-pair)))
                         (put non-cssed-key)
                         (put #\:)
                         (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX128" title="R5RS Scheme form">do</a> ((lgt (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX378" title="R5RS Scheme form">string-length</a> val))
                              (<a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a> 0 (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> <a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a> 1))
                              )
                             ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX235" title="R5RS Scheme form">=</a> <a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a> lgt) 'done)
                           (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">ch</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX379" title="R5RS Scheme form">string-ref</a> val <a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a>)))
                             (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX196" title="R5RS Scheme form">eqv?</a> ch #\&) (put ch) (put (<a class="schemedoc-name" href="../../../../man/laml.html#html-char-transform" title="Manual: laml">html-char-transform</a> ch xml-char-transformation-table)))))
                         (put #\;))) 
                     css-attribute-alist)
                    (put <a class="applied-name" href="xml-in-laml-1.html#quote-char" title="xml-in-laml">quote-char</a>)))

              (put " /&gt;"))

             ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> kind 'double)        <span class="comment">; non-empty element</span><br />              (put #\<) 
              (put tag-name) 

                                        <span class="comment">; Linearize HTML attributes</span><br />              (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX413" title="R5RS Scheme form">for-each</a> 
               (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">attr-pair</span>) 
                 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">key</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> attr-pair))
                       (<span class="local-name-binding">val</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> attr-pair)))
                   (put #\space)
                   (put (symbol->string key))
                   (put #\=) (put <a class="applied-name" href="xml-in-laml-1.html#quote-char" title="xml-in-laml">quote-char</a>)
                   (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX128" title="R5RS Scheme form">do</a> ((lgt (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX378" title="R5RS Scheme form">string-length</a> val))
                        (<a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a> 0 (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> <a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a> 1))
                        )
                       ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX235" title="R5RS Scheme form">=</a> <a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a> lgt) 'done)
                     (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">ch</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX379" title="R5RS Scheme form">string-ref</a> val <a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a>)))
                       (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX196" title="R5RS Scheme form">eqv?</a> ch #\&) (put ch) (put (<a class="schemedoc-name" href="../../../../man/laml.html#html-char-transform" title="Manual: laml">html-char-transform</a> ch xml-char-transformation-table)))))
                   (put <a class="applied-name" href="xml-in-laml-1.html#quote-char" title="xml-in-laml">quote-char</a>)
                   (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> attr-width (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> attr-width (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX378" title="R5RS Scheme form">string-length</a> (symbol->string key)) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX378" title="R5RS Scheme form">string-length</a> val) 3)) 
                   (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> attr-cnt (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> 1 attr-cnt)) 
                   (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX237" title="R5RS Scheme form">&gt;</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> attr-width start-col) <a class="applied-name" href="xml-in-laml-1.html#preferred-maximum-width" title="xml-in-laml">preferred-maximum-width</a>) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX236" title="R5RS Scheme form">&lt;</a> attr-cnt attr-lgt))
                       (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX125" title="R5RS Scheme form">begin</a> (put #\newline) (<a class="applied-name" href="xml-in-laml-1.html#put-indentation" title="xml-in-laml">put-indentation</a> put (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX378" title="R5RS Scheme form">string-length</a> tag-name) start-col 1)) (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> attr-width 0)))
                  )
                 )
               html-attribute-alist)

                                        <span class="comment">; Linearize CSS attributes</span><br />              (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> css-attribute-alist))
                  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX125" title="R5RS Scheme form">begin</a>
                    (put #\space) 
                    (put "style=") (put <a class="applied-name" href="xml-in-laml-1.html#quote-char" title="xml-in-laml">quote-char</a>)
                    (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX413" title="R5RS Scheme form">for-each</a>
                     (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">attr-pair</span>) 
                       (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">key</span> (symbol->string (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> attr-pair)))
                              (<span class="local-name-binding">non-cssed-key</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX391" title="R5RS Scheme form">substring</a> key 4 (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX378" title="R5RS Scheme form">string-length</a> key)))
                              (<span class="local-name-binding">val</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> attr-pair)))
                         (put non-cssed-key)
                         (put #\:)
                         (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX128" title="R5RS Scheme form">do</a> ((lgt (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX378" title="R5RS Scheme form">string-length</a> val))
                              (<a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a> 0 (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> <a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a> 1))
                              )
                             ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX235" title="R5RS Scheme form">=</a> <a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a> lgt) 'done)
                           (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">ch</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX379" title="R5RS Scheme form">string-ref</a> val <a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a>)))
                             (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX196" title="R5RS Scheme form">eqv?</a> ch #\&) (put ch) (put (<a class="schemedoc-name" href="../../../../man/laml.html#html-char-transform" title="Manual: laml">html-char-transform</a> ch xml-char-transformation-table)))))
                         (put #\;))) 
                     css-attribute-alist)
                    (put <a class="applied-name" href="xml-in-laml-1.html#quote-char" title="xml-in-laml">quote-char</a>)))

              (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> <a class="applied-name" href="xml-in-laml-1.html#use-empty-tags-for-elements-without-contents" title="xml-in-laml">use-empty-tags-for-elements-without-contents</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> contents-list))
                  (put " /&gt;")
                  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX125" title="R5RS Scheme form">begin</a>
		    (put #\>)

                                        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX340" title="R5RS Scheme form">member</a> tag-name xml-preformatted-text-elements)) (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX125" title="R5RS Scheme form">begin</a> (put #\newline) (<a class="applied-name" href="xml-in-laml-1.html#put-indentation" title="xml-in-laml">put-indentation</a> put (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> start-col <a class="applied-name" href="xml-in-laml-1.html#indentation-delta" title="xml-in-laml">indentation-delta</a>))))   <span class="comment">; PP!!</span><br />
		    (<a class="applied-name" href="xml-in-laml-1.html#pp-linearize-contents-list-fast" title="xml-in-laml">pp-linearize-contents-list-fast</a> 
		     contents-list put tag-name 
		     xml-transliterate-character-data? xml-non-transliteration-elements xml-char-transformation-table
		     (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX118" title="R5RS Scheme form">or</a> always-render-white-space? (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX340" title="R5RS Scheme form">member</a> tag-name xml-preformatted-text-elements))
		     (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> start-col <a class="applied-name" href="xml-in-laml-1.html#indentation-delta" title="xml-in-laml">indentation-delta</a>) single-lining?)

		    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> <a class="applied-name" href="xml-in-laml-1.html#compact-end-tag-rendering?" title="xml-in-laml">compact-end-tag-rendering?</a>) <span class="comment">; Jan 17, 2006. Experimentally removed to avoid white space problems.</span><br />			(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX125" title="R5RS Scheme form">begin</a> (put #\newline) (<a class="applied-name" href="xml-in-laml-1.html#put-indentation" title="xml-in-laml">put-indentation</a> put start-col)))

					<span class="comment">; !!!!!</span><br />		    (put "&lt;/")  (put tag-name) (put #\>))))

             (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (error "pp-render-fast: Either a single or double kind of ast expected."))))))

<a name="pp-linearize-contents-list-fast"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(pp-linearize-contents-list-fast contents-list put tag-name xml-transliterate-character-data? xml-non-transliteration-elements xml-char-transformation-table 
                                        always-render-white-space? start-col single-lining?)</span>
  (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX413" title="R5RS Scheme form">for-each</a> 
    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">contents</span>) (<a class="applied-name" href="xml-in-laml-1.html#pp-linearize-contents-fast" title="xml-in-laml">pp-linearize-contents-fast</a> contents put tag-name xml-transliterate-character-data? xml-non-transliteration-elements xml-char-transformation-table
                                                   always-render-white-space? start-col single-lining?))
    contents-list))


<a name="pp-linearize-contents-fast"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(pp-linearize-contents-fast contents put tag-name xml-transliterate-character-data? xml-non-transliteration-elements xml-char-transformation-table 
                                    always-render-white-space? start-col single-lining?)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="applied-name" href="xml-in-laml-1.html#char-ref?" title="xml-in-laml">char-ref?</a> contents) (put (<a class="applied-name" href="xml-in-laml-1.html#xml-render-char-ref" title="xml-in-laml">xml-render-char-ref</a> contents)))
        ((<a class="applied-name" href="xml-in-laml-1.html#xml-comment?" title="xml-in-laml">xml-comment?</a> contents) (put (<a class="applied-name" href="xml-in-laml-1.html#xml-render-xml-comment" title="xml-in-laml">xml-render-xml-comment</a> contents)))
        ((<a class="applied-name" href="xml-in-laml-1.html#processing-instruction?" title="xml-in-laml">processing-instruction?</a> contents) (put (<a class="applied-name" href="xml-in-laml-1.html#xml-render-processing-instruction" title="xml-in-laml">xml-render-processing-instruction</a> contents)))
        ((<a class="applied-name" href="xml-in-laml-1.html#cdata-section?" title="xml-in-laml">cdata-section?</a> contents) (put (<a class="applied-name" href="xml-in-laml-1.html#xml-render-cdata-section" title="xml-in-laml">xml-render-cdata-section</a> contents)))
        ((<a class="applied-name" href="xml-in-laml-1.html#cdata?" title="xml-in-laml">cdata?</a> contents) 
          (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">white-space-printed?</span> #f)) <span class="comment">; true if last printed char is white space</span><br />           (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> xml-transliterate-character-data? (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX340" title="R5RS Scheme form">member</a> tag-name xml-non-transliteration-elements)))

               (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX128" title="R5RS Scheme form">do</a> ((lgt (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX378" title="R5RS Scheme form">string-length</a> contents))   <span class="comment">; With HTML transformations</span><br />                    (<a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a> 0 (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> <a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a> 1))
                    (j 0 (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> j 1))
                    )
                   ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX235" title="R5RS Scheme form">=</a> <a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a> lgt) 'done)
                 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">ch</span> (<a class="schemedoc-name" href="../../../../man/laml.html#html-char-transform" title="Manual: laml">html-char-transform</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX379" title="R5RS Scheme form">string-ref</a> contents <a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a>) xml-char-transformation-table)) <span class="comment">; a string!</span><br />                        (<span class="local-name-binding">ch-white-space?</span> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#empty-string?" title="Manual: general">empty-string?</a> ch)) (<a class="schemedoc-name" href="../../../../lib/man/general.html#string-of-char-list?" title="Manual: general">string-of-char-list?</a> ch <a class="schemedoc-name" href="../../../../lib/man/general.html#white-space-char-list" title="Manual: general">white-space-char-list</a>)))
                       )
                  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> always-render-white-space?     
                      (put ch)
                      (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX125" title="R5RS Scheme form">begin</a>
                        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> white-space-printed? ch-white-space?))
                            (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> ch-white-space? 
                               (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX237" title="R5RS Scheme form">&gt;</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> j start-col) <a class="applied-name" href="xml-in-laml-1.html#preferred-maximum-width" title="xml-in-laml">preferred-maximum-width</a>)
                                   (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX125" title="R5RS Scheme form">begin</a> (put #\newline) (<a class="applied-name" href="xml-in-laml-1.html#put-indentation" title="xml-in-laml">put-indentation</a> put start-col) (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> j 0)) <span class="comment">; PP!!</span><br />                                   (put #\space)
                               )
                               (put ch))
                        )
                        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> ch-white-space? (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> white-space-printed? #t) (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> white-space-printed? #f))
                      )
                  )
                 )  
               )

               (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX128" title="R5RS Scheme form">do</a> ((lgt (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX378" title="R5RS Scheme form">string-length</a> contents))   <span class="comment">; Without HTML transformations - must be tested carefully.</span><br />                    (<a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a> 0 (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> <a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a> 1))
                    (j 0 (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> j 1))
                   )
                   ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX235" title="R5RS Scheme form">=</a> <a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a> lgt) 'done)
                 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">ch</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX379" title="R5RS Scheme form">string-ref</a> contents <a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a>))
                        (<span class="local-name-binding">ch-white-space?</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX339" title="R5RS Scheme form">memv</a> ch <a class="schemedoc-name" href="../../../../lib/man/general.html#white-space-char-list" title="Manual: general">white-space-char-list</a>))
                       )
                  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> always-render-white-space?
                      (put ch)
                      (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX125" title="R5RS Scheme form">begin</a>
                       (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> white-space-printed? ch-white-space?))
                           (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> ch-white-space?
                               (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX237" title="R5RS Scheme form">&gt;</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> j start-col) <a class="applied-name" href="xml-in-laml-1.html#preferred-maximum-width" title="xml-in-laml">preferred-maximum-width</a>)
                                   (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX125" title="R5RS Scheme form">begin</a> (put #\newline) (<a class="applied-name" href="xml-in-laml-1.html#put-indentation" title="xml-in-laml">put-indentation</a> put start-col) (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> j 0)) <span class="comment">; PP!!</span><br />                                   (put #\space)
                               )                               
                               (put ch))
                       )
                       (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX339" title="R5RS Scheme form">memv</a> ch <a class="schemedoc-name" href="../../../../lib/man/general.html#white-space-char-list" title="Manual: general">white-space-char-list</a>) (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> white-space-printed? #t) (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> white-space-printed? #f))
                      )
                  )
                 )
               )
            )
           )
        )
        ((<a class="applied-name" href="xml-in-laml-1.html#forced-white-space?" title="xml-in-laml">forced-white-space?</a> contents)
           (put #\newline) (<a class="applied-name" href="xml-in-laml-1.html#put-indentation" title="xml-in-laml">put-indentation</a> put start-col)  <span class="comment">; PP!!</span><br />        )
        ((<a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> contents)
           (<a class="applied-name" href="xml-in-laml-1.html#pp-render-fast" title="xml-in-laml">pp-render-fast</a> contents put always-render-white-space? start-col single-lining?)
        )
        ((<a class="applied-name" href="xml-in-laml-1.html#delayed-procedural-contents-element?" title="xml-in-laml">delayed-procedural-contents-element?</a> contents)
           (<a class="schemedoc-name" href="../../../../lib/man/general.html#display-warning" title="Manual: general">display-warning</a> "Attempting to render delayed procedural content element - ignored"))
        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> 'do-nothing)
   )
)

<a name="put-indentation"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(put-indentation put n)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX128" title="R5RS Scheme form">do</a> ((<a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a> 1 (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> <a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a> 1)))
    ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX237" title="R5RS Scheme form">&gt;</a> <a class="schemedoc-name" href="../../../../lib/xml-in-laml/mirrors/man/xhtml10-transitional-mirror.html#i" title="Manual: xhtml10-transitional-mirror">i</a> n) 'done) 
  (put #\space)))

<a name="single-liner-form?"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(single-liner-form? ast start-col max-width)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">width</span> (<a class="applied-name" href="xml-in-laml-1.html#measure-xml-in-laml-form" title="xml-in-laml">measure-xml-in-laml-form</a> ast)))
   (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX238" title="R5RS Scheme form">&lt;=</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> width start-col) max-width)))


<a name="measure-xml-in-laml-form"></a><span class="comment">; Approximative measurement of an AST, string, character reference or white space marker.</span><br /><a name="measure-xml-in-laml-form"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(measure-xml-in-laml-form x)</span>  
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX374" title="R5RS Scheme form">string?</a> x) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX378" title="R5RS Scheme form">string-length</a> x))  <span class="comment">; not accurate due to use of the HTML transformation table.</span><br />       ((<a class="applied-name" href="xml-in-laml-1.html#forced-white-space?" title="xml-in-laml">forced-white-space?</a> x) 1)
       ((<a class="applied-name" href="xml-in-laml-1.html#char-ref?" title="xml-in-laml">char-ref?</a> x) 
        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">value</span> (<a class="applied-name" href="xml-in-laml-1.html#char-ref-value" title="xml-in-laml">char-ref-value</a> x)))
          (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX346" title="R5RS Scheme form">symbol?</a> value) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> 2 (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX378" title="R5RS Scheme form">string-length</a> (symbol->string value))))
                ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX224" title="R5RS Scheme form">number?</a> value) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> 3 (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX378" title="R5RS Scheme form">string-length</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX292" title="R5RS Scheme form">number-&gt;string</a> value))))
                (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#laml-error" title="Manual: general">laml-error</a> "measure-xml-in-laml-form: Error in character reference" x))))
       )
       ((<a class="applied-name" href="xml-in-laml-1.html#xml-comment?" title="xml-in-laml">xml-comment?</a> x) 
        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">comment-contents</span> (<a class="applied-name" href="xml-in-laml-1.html#xml-comment-contents" title="xml-in-laml">xml-comment-contents</a> x))  <span class="comment">; a list of strings</span><br />               (<span class="local-name-binding">contents-sum</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#sum-list" title="Manual: general">sum-list</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> <a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX378" title="R5RS Scheme form">string-length</a> comment-contents)))
               (<span class="local-name-binding">comment-count</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX333" title="R5RS Scheme form">length</a> comment-contents)))
          (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a>  contents-sum comment-count 6)
        )
       )
       ((<a class="applied-name" href="xml-in-laml-1.html#processing-instruction?" title="xml-in-laml">processing-instruction?</a> x) 
        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">target</span> (<a class="applied-name" href="xml-in-laml-1.html#processing-instruction-target" title="xml-in-laml">processing-instruction-target</a> x))
               (<span class="local-name-binding">contents</span> (<a class="applied-name" href="xml-in-laml-1.html#processing-instruction-contents" title="xml-in-laml">processing-instruction-contents</a> x))  <span class="comment">; a list of strings</span><br />               (<span class="local-name-binding">contents-sum</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#sum-list" title="Manual: general">sum-list</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> <a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX378" title="R5RS Scheme form">string-length</a> contents)))
               (<span class="local-name-binding">count</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX333" title="R5RS Scheme form">length</a> contents)))
          (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a>  (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX378" title="R5RS Scheme form">string-length</a> target) contents-sum count 4)
        )
       )
       ((<a class="applied-name" href="xml-in-laml-1.html#cdata-section?" title="xml-in-laml">cdata-section?</a> x)
        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">cdata-contents</span> (<a class="applied-name" href="xml-in-laml-1.html#cdata-section-contents" title="xml-in-laml">cdata-section-contents</a> x))  <span class="comment">; a list of strings         </span><br />               (<span class="local-name-binding">contents-sum</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#sum-list" title="Manual: general">sum-list</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> <a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX378" title="R5RS Scheme form">string-length</a> cdata-contents)))
               (<span class="local-name-binding">count</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX333" title="R5RS Scheme form">length</a> cdata-contents)))
          (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> contents-sum count 10))
       )

       ((<a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> x)
         (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">tag-name</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-element-name" title="xml-in-laml">ast-element-name</a> x))
               (<span class="local-name-binding">attributes</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#propertylist-to-alist" title="Manual: general">propertylist-to-alist</a> (<a class="applied-name" href="xml-in-laml-1.html#ast-attributes" title="xml-in-laml">ast-attributes</a> x)))
               (<span class="local-name-binding">content-list</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-subtrees" title="xml-in-laml">ast-subtrees</a> x))
              )
           (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX250" title="R5RS Scheme form">*</a> 2 (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX378" title="R5RS Scheme form">string-length</a> tag-name))                       <span class="comment">; tag-names, start and end</span><br />              5                                                    <span class="comment">; angle brackets in start and end tag, '/' in end tag.</span><br />              (<a class="applied-name" href="xml-in-laml-1.html#measure-attribute-list" title="xml-in-laml">measure-attribute-list</a> attributes)                  <span class="comment">; attributes</span><br />              (<a class="schemedoc-name" href="../../../../lib/man/general.html#sum-list" title="Manual: general">sum-list</a>
                (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> <a class="applied-name" href="xml-in-laml-1.html#measure-xml-in-laml-form" title="xml-in-laml">measure-xml-in-laml-form</a> content-list))       <span class="comment">; contents</span><br />           )
         )
       )
       ((<a class="applied-name" href="xml-in-laml-1.html#delayed-procedural-contents-element?" title="xml-in-laml">delayed-procedural-contents-element?</a> x) 0)   <span class="comment">; very bad estimate indeed. We actually assume that we never measure ASTs with delayed procedural content elements...</span><br />       (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#laml-error" title="Manual: general">laml-error</a> "measure-xml-in-laml-form: Unknown constituent" x))
  )
)

<a name="measure-attribute-list"></a><span class="comment">; Measure attribute-list, which is represented on a-list form.
; Approximative measure - does not take css style attributes into special account</span><br /><a name="measure-attribute-list"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(measure-attribute-list attribute-alist)</span>
  (<a class="schemedoc-name" href="../../../../lib/man/general.html#sum-list" title="Manual: general">sum-list</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> <a class="applied-name" href="xml-in-laml-1.html#measure-attribute" title="xml-in-laml">measure-attribute</a> attribute-alist)))

<a name="measure-attribute"></a><span class="comment">; Measure a single attribute, non CSS. Approximative.</span><br /><a name="measure-attribute"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(measure-attribute key-val)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">key</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> key-val))
       (<span class="local-name-binding">val</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> key-val)))
  (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX378" title="R5RS Scheme form">string-length</a> (symbol->string key))
     (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX378" title="R5RS Scheme form">string-length</a> val)
     4  <span class="comment">; string quotes, '=', and space after.</span><br />  )))


<span class="comment">; -------------------------------------------------------------------------------------------------------------------------------------------------
; Attribute linearization functions.  Linearizes to a string.
; These functions are NOT used in render-fast (which uses an imperative, 
; more efficient, html-char-table transformed approach).
; The functions are used in other corners of LAML, such as in relation to AST tree transformation, error messaging,
; and pretty printed rendering.</span><br />
<a name="xml-linearize-attributes"></a><span class="comment">; Return a pair of strings: The head is the string represeting XML attributes.
; The tail is the string representing the CSS attributes (to go into an HTML style attribute).</span><br /><a name="xml-linearize-attributes"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(xml-linearize-attributes attr-list)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">lgt</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX333" title="R5RS Scheme form">length</a> attr-list)))
  <span class="comment">; catch a typical error here: non-symbol key, probably old-fashioned calling convention from html-v1.</span><br />  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX239" title="R5RS Scheme form">&gt;=</a> lgt 1) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX346" title="R5RS Scheme form">symbol?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> attr-list))))
      (error (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> "xml-linearize-attributes: Non-symbol key encountered: " (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> attr-list)) " in attribute list " (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> attr-list) ". Maybe conversion problem from html-v1.")))
  (<a class="applied-name" href="xml-in-laml-1.html#xml-linearize-attributes-1" title="xml-in-laml">xml-linearize-attributes-1</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX335" title="R5RS Scheme form">reverse</a> attr-list) "" "" lgt attr-list)))

<a name="xml-linearize-attributes-1"></a><span class="comment">; Internal helping operation to xml-linearize-attributes. The parameter whole-attr-list is for error messaging purposes</span><br /><a name="xml-linearize-attributes-1"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(xml-linearize-attributes-1 attr-list html-attr-string css-attr-string lgt whole-attr-list)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX235" title="R5RS Scheme form">=</a> lgt  0 ) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#strip-trailing-characters" title="Manual: general">strip-trailing-characters</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> #\space) html-attr-string) css-attr-string))
        ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX239" title="R5RS Scheme form">&gt;=</a> lgt 2) (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">val</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> attr-list))   <span class="comment">; val and key are reversed at this time</span><br />                           (<span class="local-name-binding">key</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cadr</a> attr-list))
                           (<span class="local-name-binding">css-key</span> (<a class="applied-name" href="xml-in-laml-1.html#xml-css-key?" title="xml-in-laml">xml-css-key?</a> key))
                         )
                     (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> (css-key                  <span class="comment">; CSS attribute</span><br />                              (<a class="applied-name" href="xml-in-laml-1.html#xml-linearize-attributes-1" title="xml-in-laml">xml-linearize-attributes-1</a> 
                                (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cddr</a> attr-list)
                                html-attr-string 
                                (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> (<a class="applied-name" href="xml-in-laml-1.html#xml-linearize-attribute-pair-css" title="xml-in-laml">xml-linearize-attribute-pair-css</a> val css-key) ";" css-attr-string)
                                (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> lgt 2)
                                whole-attr-list))
                           (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a>                            <span class="comment">; HTML attribute</span><br />                             (<a class="applied-name" href="xml-in-laml-1.html#xml-linearize-attributes-1" title="xml-in-laml">xml-linearize-attributes-1</a> 
                               (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cddr</a> attr-list)
                               (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> (<a class="applied-name" href="xml-in-laml-1.html#xml-linearize-attribute-pair-html" title="xml-in-laml">xml-linearize-attribute-pair-html</a> val key) " " html-attr-string)
                               css-attr-string
                               (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> lgt 2)
                               whole-attr-list)))))
        ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX236" title="R5RS Scheme form">&lt;</a> lgt 2) (error (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> "Xml-Linearize-attributes-1: Called with an odd length attribute list. Not a Lisp property list: " (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> whole-attr-list))))))


<a name="xml-linearize-attribute-pair-html"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(xml-linearize-attribute-pair-html val key)</span>
  (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> key) " = " (<a class="schemedoc-name" href="../../../../lib/man/general.html#string-it" title="Manual: general">string-it</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> val))))

<a name="xml-linearize-attribute-pair-css"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(xml-linearize-attribute-pair-css val key)</span>
  (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> key ": " (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> val)))

<span class="comment">; ---------------------------------------------------------------------------------------------------------------</span><br />

<div class="schemedoc-section-comment">;;; Element related functions.
;;; This section contains (mostly) higher-order functions that are related to 
;;; the mirrors of the XML elements.  
;;; .section-id element-mod</div>
<a name="xml-modify-element"></a><a name="xml-modify-element"></a><span><a href="../xml-in-laml.html#xml-modify-element"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(xml-modify-element element . attributes-and-contents)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> <span class="local-name-binding">parameters</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX411" title="R5RS Scheme form">apply</a> element (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX334" title="R5RS Scheme form">append</a> parameters attributes-and-contents))))

<a name="xml-modify-element-prepend"></a><a name="xml-modify-element-prepend"></a><span><a href="../xml-in-laml.html#xml-modify-element-prepend"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(xml-modify-element-prepend element . attributes-and-contents)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> <span class="local-name-binding">parameters</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX411" title="R5RS Scheme form">apply</a> element (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX334" title="R5RS Scheme form">append</a> attributes-and-contents parameters))))


<div class="schemedoc-section-comment">;;; XML in LAML abstraction functions.
;;; The functions in this category are higher-order functions which generate functions that obey XML-in-LAML parameter passing rules.
;;; In other words, the function that are generated use the same parameter conventions as the mirror functions of the HTML and XML elements.
;;; The most useful function is xml-in-laml-abstraction.  xml-in-laml-positional-abstraction is a generalized version of  xml-in-laml-abstraction.
;;; The function xml-in-laml-parametrization is only useful if you want to interface between XML-in-LAML parameter passing rules
;;; and a function with simple, conventional, positional parameter passing.
;;; .section-id abstraction-fu</div>

<a name="xml-in-laml-abstraction"></a><a name="xml-in-laml-abstraction"></a><span><a href="../xml-in-laml.html#xml-in-laml-abstraction"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(xml-in-laml-abstraction f  . optional-parameter-list)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">parameter-validator!</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#optional-parameter" title="Manual: general">optional-parameter</a> 1 optional-parameter-list (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">co</span> <span class="local-name-binding">at</span>) #t)))
       (<span class="local-name-binding">f-name</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#optional-parameter" title="Manual: general">optional-parameter</a> 2 optional-parameter-list "ad hoc abstraction"))
       (<span class="local-name-binding">language</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#optional-parameter" title="Manual: general">optional-parameter</a> 3 optional-parameter-list (<a class="applied-name" href="xml-in-laml-1.html#guess-xml-language-if-possible" title="xml-in-laml">guess-xml-language-if-possible</a>)))
      )
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> <span class="local-name-binding">parameters</span> 
    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">ordered-parameters</span> (<a class="applied-name" href="xml-in-laml-1.html#xml-sort-superficially-tag-parameters" title="xml-in-laml">xml-sort-superficially-tag-parameters</a> parameters f-name language))
           (<span class="local-name-binding">content-parameters</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> ordered-parameters))
           (<span class="local-name-binding">attribute-prop-list</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> ordered-parameters))
          )
      (parameter-validator! content-parameters attribute-prop-list)
      (f content-parameters attribute-prop-list)))))


<a name="xml-in-laml-positional-abstraction"></a><a name="xml-in-laml-positional-abstraction"></a><span><a href="../xml-in-laml.html#xml-in-laml-positional-abstraction"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(xml-in-laml-positional-abstraction n m f  . optional-parameter-list)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">parameter-validator!</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#optional-parameter" title="Manual: general">optional-parameter</a> 1 optional-parameter-list (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">co</span> <span class="local-name-binding">at</span>) #t)))
       (<span class="local-name-binding">f-name</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#optional-parameter" title="Manual: general">optional-parameter</a> 2 optional-parameter-list "ad hoc abstraction"))
       (<span class="local-name-binding">language</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#optional-parameter" title="Manual: general">optional-parameter</a> 3 optional-parameter-list (<a class="applied-name" href="xml-in-laml-1.html#guess-xml-language-if-possible" title="xml-in-laml">guess-xml-language-if-possible</a>)))
      )
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> <span class="local-name-binding">parameters</span> 
   (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">lgt-parameters</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX333" title="R5RS Scheme form">length</a> parameters)))
    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX237" title="R5RS Scheme form">&gt;</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> n m) lgt-parameters)
        (<a class="schemedoc-name" href="../../../../lib/man/general.html#laml-error" title="Manual: general">laml-error</a> "Two few parameters passed to" f-name ":" parameters))
    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">prefix-parameters</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#front-sublist" title="Manual: general">front-sublist</a> parameters n))
           (<span class="local-name-binding">rest-parameters</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX336" title="R5RS Scheme form">list-tail</a> parameters n))
           (<span class="local-name-binding">rest-length</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> lgt-parameters n))
           (<span class="local-name-binding">xml-in-laml-parameters</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#front-sublist" title="Manual: general">front-sublist</a> rest-parameters (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a>  rest-length m)))
           (<span class="local-name-binding">suffix-parameters</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#rear-sublist" title="Manual: general">rear-sublist</a> parameters m))
           (<span class="local-name-binding">ordered-parameters</span> (<a class="applied-name" href="xml-in-laml-1.html#xml-sort-superficially-tag-parameters" title="xml-in-laml">xml-sort-superficially-tag-parameters</a> xml-in-laml-parameters f-name language))
           (<span class="local-name-binding">content-parameters</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> ordered-parameters))
           (<span class="local-name-binding">attribute-prop-list</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> ordered-parameters))
          )
      (parameter-validator! content-parameters attribute-prop-list)
      (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX411" title="R5RS Scheme form">apply</a> f (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX334" title="R5RS Scheme form">append</a> prefix-parameters (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> content-parameters attribute-prop-list) suffix-parameters)))))))

<a name="xml-in-laml-parametrization"></a><a name="xml-in-laml-parametrization"></a><span><a href="../xml-in-laml.html#xml-in-laml-parametrization"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(xml-in-laml-parametrization f  parameter-mediator . optional-parameter-list)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">parameter-validator!</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#optional-parameter" title="Manual: general">optional-parameter</a> 1 optional-parameter-list (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">co</span> <span class="local-name-binding">at</span>) #t)))
       (<span class="local-name-binding">f-name</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#optional-parameter" title="Manual: general">optional-parameter</a> 2 optional-parameter-list "some xml-in-laml parametrization"))
       (<span class="local-name-binding">language</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#optional-parameter" title="Manual: general">optional-parameter</a> 3 optional-parameter-list #f))
      )
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> <span class="local-name-binding">parameters</span> 
    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">ordered-parameters</span> (<a class="applied-name" href="xml-in-laml-1.html#xml-sort-tag-parameters" title="xml-in-laml">xml-sort-tag-parameters</a> parameters f-name language))
           (<span class="local-name-binding">content-parameters</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> ordered-parameters))
           (<span class="local-name-binding">attribute-prop-list</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> ordered-parameters))
          )
      (parameter-validator! content-parameters attribute-prop-list)
      (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX411" title="R5RS Scheme form">apply</a> f (parameter-mediator content-parameters attribute-prop-list))))))

<a name="guess-xml-language-if-possible"></a><span class="comment">; Return the first and only language in (languages-in-use), or else #f.</span><br /><a name="guess-xml-language-if-possible"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(guess-xml-language-if-possible)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">language-list</span> (<a class="applied-name" href="xml-in-laml-1.html#languages-in-use" title="xml-in-laml">languages-in-use</a>)))
    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX235" title="R5RS Scheme form">=</a> 1 (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX333" title="R5RS Scheme form">length</a> language-list))
        (<a class="schemedoc-name" href="../../../../lib/man/general.html#first" title="Manual: general">first</a> language-list)
        #f)))


<a name="required-implied-attributes"></a><a name="required-implied-attributes"></a><span><a href="../xml-in-laml.html#required-implied-attributes"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(required-implied-attributes required-attribute-names implied-attribute-names . optional-parameter-list)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">tag-name</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#optional-parameter" title="Manual: general">optional-parameter</a> 1 optional-parameter-list "??")))
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">contents</span> <span class="local-name-binding">attributes</span>)
   (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">attribute-names</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#every-second-element" title="Manual: general">every-second-element</a> attributes)))
    (<a class="applied-name" href="xml-in-laml-1.html#xml-check-required-attributes!" title="xml-in-laml">xml-check-required-attributes!</a> attribute-names required-attribute-names tag-name)
    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX200" title="R5RS Scheme form">equal?</a> implied-attribute-names (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> '*)))
        (<a class="applied-name" href="xml-in-laml-1.html#xml-check-for-attribute-existence!" title="xml-in-laml">xml-check-for-attribute-existence!</a> attribute-names (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX334" title="R5RS Scheme form">append</a> required-attribute-names implied-attribute-names) tag-name))
    ))))


<div class="schemedoc-section-comment">;;; AST traversal and AST transformation functions.
;;; The AST traversal functions extract information from AST by means of traversal and searching.
;;; The "find" functions use guided search, aided by the XML navigation information which is derived from the XML DTD.
;;; The "traverse-and-collect" functions are slightly more general (with a node-interesting? predicate), but they
;;; do not (and cannot) make use of the XML navigation information. Thus, these function do an exhaustive search.
;;; The "find" and "transverse-and-collect" functions in this section constitute a 'minimalistic transformation framework' in LAML, which is useful for
;;; target-controlled transformation of an AST.
;;; The function transform-ast is useful for comprehensive, recursive, source-controlled transformation of an AST (similar to a typical use of XSLT).
;;; The following section contains more sophisticated locator functions.
;;; .section-id ast-transf</div>
<a name="find-asts"></a><a name="find-asts"></a><span><a href="../xml-in-laml.html#find-asts"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(find-asts ast el-name . optional-parameter-list)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">ast-transformer</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#optional-parameter" title="Manual: general">optional-parameter</a> 1 optional-parameter-list <a class="schemedoc-name" href="../../../../lib/man/general.html#id-1" title="Manual: general">id-1</a>)))
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX200" title="R5RS Scheme form">equal?</a> (<a class="applied-name" href="xml-in-laml-1.html#ast-element-name" title="xml-in-laml">ast-element-name</a> ast) (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> el-name)) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> (ast-transformer ast)))
        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> 
          (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">sub-asts</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#filter" title="Manual: general">filter</a> <a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> (<a class="applied-name" href="xml-in-laml-1.html#ast-subtrees" title="xml-in-laml">ast-subtrees</a> ast)))
                 (<span class="local-name-binding">possible-sub-asts</span> 
                  (<a class="schemedoc-name" href="../../../../lib/man/general.html#filter" title="Manual: general">filter</a> 
                   (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">sub-ast</span>)
                     (<a class="applied-name" href="xml-in-laml-1.html#can-have-element-constituent?" title="xml-in-laml">can-have-element-constituent?</a> sub-ast el-name)) <span class="comment">; static determination, from XML navigator derived from DTD</span><br />                   sub-asts))
                 )
            (<a class="schemedoc-name" href="../../../../lib/man/general.html#flatten" title="Manual: general">flatten</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">sub-ast</span>) (<a class="applied-name" href="xml-in-laml-1.html#find-asts" title="xml-in-laml">find-asts</a> sub-ast el-name ast-transformer)) possible-sub-asts)))))))

<a name="find-first-ast"></a><a name="find-first-ast"></a><span><a href="../xml-in-laml.html#find-first-ast"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(find-first-ast ast el-name . optional-parameter-list)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">ast-transformer</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#optional-parameter" title="Manual: general">optional-parameter</a> 1 optional-parameter-list <a class="schemedoc-name" href="../../../../lib/man/general.html#id-1" title="Manual: general">id-1</a>)))
  (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX417" title="R5RS Scheme form">call-with-current-continuation</a> 
   (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">return</span>)
    (<a class="applied-name" href="xml-in-laml-1.html#find-first-ast-help" title="xml-in-laml">find-first-ast-help</a> ast el-name ast-transformer return)))))

<a name="find-first-ast-help"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(find-first-ast-help ast el-name ast-transformer return)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX200" title="R5RS Scheme form">equal?</a> (<a class="applied-name" href="xml-in-laml-1.html#ast-element-name" title="xml-in-laml">ast-element-name</a> ast) (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> el-name)) (return (ast-transformer ast)))
        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> 
          (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">sub-asts</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#filter" title="Manual: general">filter</a> <a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> (<a class="applied-name" href="xml-in-laml-1.html#ast-subtrees" title="xml-in-laml">ast-subtrees</a> ast))))
            (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX413" title="R5RS Scheme form">for-each</a> 
              (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">sub-ast</span>)
                (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="applied-name" href="xml-in-laml-1.html#can-have-element-constituent?" title="xml-in-laml">can-have-element-constituent?</a> sub-ast el-name)
                    (<a class="applied-name" href="xml-in-laml-1.html#find-first-ast-help" title="xml-in-laml">find-first-ast-help</a> sub-ast el-name ast-transformer return)))
              sub-asts))))

  <span class="comment">; We did not find any AST</span><br />  #f)

<a name="unique-ast-attribute"></a><a name="unique-ast-attribute"></a><span><a href="../xml-in-laml.html#unique-ast-attribute"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(unique-ast-attribute ast name . optional-parameter-list)</span>
 (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX417" title="R5RS Scheme form">call-with-current-continuation</a> 
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">return</span>)
   (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">default-attribute-value</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#optional-parameter" title="Manual: general">optional-parameter</a> 1 optional-parameter-list #f)))
    (<a class="applied-name" href="xml-in-laml-1.html#unique-ast-attribute-help" title="xml-in-laml">unique-ast-attribute-help</a> ast (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-symbol" title="Manual: general">as-symbol</a> name) default-attribute-value return)
    (<a class="schemedoc-name" href="../../../../lib/man/general.html#laml-error" title="Manual: general">laml-error</a> "unique-ast-attribute: The attribute named" name "is not found in AST, or it is not unique in AST."))))) 


<a name="unique-ast-attribute-help"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(unique-ast-attribute-help ast name default-value return)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">alist</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#propertylist-to-alist" title="Manual: general">propertylist-to-alist</a> (<a class="applied-name" href="xml-in-laml-1.html#ast-attributes" title="xml-in-laml">ast-attributes</a> ast)))
        (<span class="local-name-binding">res</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX341" title="R5RS Scheme form">assq</a> name alist))
        (<span class="local-name-binding">can-be-in-ast</span> (<a class="applied-name" href="xml-in-laml-1.html#can-attribute-be-in-ast" title="xml-in-laml">can-attribute-be-in-ast</a> ast name))
        (<span class="local-name-binding">candidate-sub-asts</span> (<a class="applied-name" href="xml-in-laml-1.html#sub-asts-with-possible-attribute" title="xml-in-laml">sub-asts-with-possible-attribute</a> ast name))
        (<span class="local-name-binding">candidate-count</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX333" title="R5RS Scheme form">length</a> candidate-sub-asts))
       )
   (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> res can-be-in-ast (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX235" title="R5RS Scheme form">=</a> 0 candidate-count)) (return (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> res)))
         ((<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> res) can-be-in-ast (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX235" title="R5RS Scheme form">=</a> 0 candidate-count)) (return default-value))
         ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX235" title="R5RS Scheme form">=</a> 1 candidate-count)
           (<a class="applied-name" href="xml-in-laml-1.html#unique-ast-attribute-help" title="xml-in-laml">unique-ast-attribute-help</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#first" title="Manual: general">first</a> candidate-sub-asts) name default-value return))
         (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> 'do-nothing) <span class="comment">; wait for fall through to fatal error</span><br />   )
  )
)

<a name="sub-asts-with-possible-attribute"></a><span class="comment">; Return the list of sub ASTs of ast in which it is possible for an attribute of name to occur
; (from a statical consideration).</span><br /><a name="sub-asts-with-possible-attribute"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(sub-asts-with-possible-attribute ast name)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">sub-asts</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#filter" title="Manual: general">filter</a> <a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> (<a class="applied-name" href="xml-in-laml-1.html#ast-subtrees" title="xml-in-laml">ast-subtrees</a> ast))))
    (<a class="schemedoc-name" href="../../../../lib/man/general.html#filter" title="Manual: general">filter</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">sub-ast</span>) (<a class="applied-name" href="xml-in-laml-1.html#can-attribute-be-in-ast" title="xml-in-laml">can-attribute-be-in-ast</a> sub-ast name)) sub-asts)))

<a name="can-attribute-be-in-one-of-subtrees?"></a><span class="comment">; Can the attribute name be in one of the subtrees of ast according the statically derived
; XML navigation information from the DTD.</span><br /><a name="can-attribute-be-in-one-of-subtrees?"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(can-attribute-be-in-one-of-subtrees? ast name)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">sub-asts</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#filter" title="Manual: general">filter</a> <a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> (<a class="applied-name" href="xml-in-laml-1.html#ast-subtrees" title="xml-in-laml">ast-subtrees</a> ast))))
   (<a class="schemedoc-name" href="../../../../lib/man/general.html#accumulate-right" title="Manual: general">accumulate-right</a> <a class="applied-name" href="xml-in-laml-1.html#or-fn" title="xml-in-laml">or-fn</a> #f (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">ast</span>) (<a class="applied-name" href="xml-in-laml-1.html#can-attribute-be-in-ast" title="xml-in-laml">can-attribute-be-in-ast</a> ast name)) sub-asts))))

<a name="can-attribute-be-in-ast"></a><span class="comment">; Can the attribute name be in ast according the statically derived
; XML navigation information from the DTD.</span><br /><a name="can-attribute-be-in-ast"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(can-attribute-be-in-ast ast name)</span>
 (<a class="schemedoc-name" href="../../../../lib/man/general.html#turn-into-boolean" title="Manual: general">turn-into-boolean</a>
   (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX338" title="R5RS Scheme form">memq</a> name (<a class="applied-name" href="xml-in-laml-1.html#possible-attributes-rooted-by-element" title="xml-in-laml">possible-attributes-rooted-by-element</a> (<a class="applied-name" href="xml-in-laml-1.html#ast-element-name" title="xml-in-laml">ast-element-name</a> ast) (<a class="applied-name" href="xml-in-laml-1.html#ast-language" title="xml-in-laml">ast-language</a> ast)))))
   



<a name="traverse-and-collect-all-from-ast"></a><a name="traverse-and-collect-all-from-ast"></a><span><a href="../xml-in-laml.html#traverse-and-collect-all-from-ast"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(traverse-and-collect-all-from-ast ast-tree node-interesting? ast-transformer)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="applied-name" href="xml-in-laml-1.html#terminal-ast-node?" title="xml-in-laml">terminal-ast-node?</a> ast-tree) (node-interesting? ast-tree)) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> (ast-transformer ast-tree)))
        ((<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="applied-name" href="xml-in-laml-1.html#terminal-ast-node?" title="xml-in-laml">terminal-ast-node?</a> ast-tree) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (node-interesting? ast-tree))) '())
        ((<a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> ast-tree)
           (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">subtree-results</span>
                   (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> 
                    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">subtr</span>) (<a class="applied-name" href="xml-in-laml-1.html#traverse-and-collect-all-from-ast" title="xml-in-laml">traverse-and-collect-all-from-ast</a> subtr node-interesting? ast-transformer))
                    (<a class="applied-name" href="xml-in-laml-1.html#ast-subtrees" title="xml-in-laml">ast-subtrees</a> ast-tree))))
             (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (node-interesting? ast-tree)
                 (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> 
                   (ast-transformer ast-tree)
                   (<a class="schemedoc-name" href="../../../../lib/man/general.html#flatten" title="Manual: general">flatten</a> subtree-results))
                 (<a class="schemedoc-name" href="../../../../lib/man/general.html#flatten" title="Manual: general">flatten</a> subtree-results))))
        ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX331" title="R5RS Scheme form">list?</a> ast-tree)
            (<a class="schemedoc-name" href="../../../../lib/man/general.html#flatten" title="Manual: general">flatten</a> 
              (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> 
               (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">tr</span>) (<a class="applied-name" href="xml-in-laml-1.html#traverse-and-collect-all-from-ast" title="xml-in-laml">traverse-and-collect-all-from-ast</a> tr node-interesting? ast-transformer))
               (<a class="schemedoc-name" href="../../../../lib/man/general.html#filter" title="Manual: general">filter</a> <a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> ast-tree))))
        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> '())))


<a name="traverse-and-collect-first-from-ast"></a><a name="traverse-and-collect-first-from-ast"></a><span><a href="../xml-in-laml.html#traverse-and-collect-first-from-ast"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(traverse-and-collect-first-from-ast ast-tree node-interesting? ast-transformer)</span>
 (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX417" title="R5RS Scheme form">call-with-current-continuation</a>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">exit</span>)
    (<a class="applied-name" href="xml-in-laml-1.html#traverse-and-collect-first-from-ast-help" title="xml-in-laml">traverse-and-collect-first-from-ast-help</a> ast-tree node-interesting? ast-transformer exit)))
 )


<a name="traverse-and-collect-first-from-ast-help"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(traverse-and-collect-first-from-ast-help ast-tree node-interesting? ast-transformer exit)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="applied-name" href="xml-in-laml-1.html#terminal-ast-node?" title="xml-in-laml">terminal-ast-node?</a> ast-tree) (node-interesting? ast-tree)) (exit (ast-transformer ast-tree)))
        ((<a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> ast-tree)
           (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (node-interesting? ast-tree)
               (exit (ast-transformer ast-tree))
               (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX413" title="R5RS Scheme form">for-each</a>
                 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">subtr</span>) (<a class="applied-name" href="xml-in-laml-1.html#traverse-and-collect-first-from-ast-help" title="xml-in-laml">traverse-and-collect-first-from-ast-help</a> subtr node-interesting? ast-transformer exit))
                 (<a class="applied-name" href="xml-in-laml-1.html#ast-subtrees" title="xml-in-laml">ast-subtrees</a> ast-tree))))
        ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX331" title="R5RS Scheme form">list?</a> ast-tree)
           (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX413" title="R5RS Scheme form">for-each</a>
             (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">tr</span>) (<a class="applied-name" href="xml-in-laml-1.html#traverse-and-collect-first-from-ast-help" title="xml-in-laml">traverse-and-collect-first-from-ast-help</a> tr node-interesting? ast-transformer exit))
              (<a class="schemedoc-name" href="../../../../lib/man/general.html#filter" title="Manual: general">filter</a> <a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> ast-tree)))
        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> #f))
  
  <span class="comment">; We did not find a tree</span><br />  #f)


<a name="transform-ast"></a><a name="transform-ast"></a><span><a href="../xml-in-laml.html#transform-ast"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(transform-ast transform-specs source-items)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">negated-source</span>
          (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> source-items) (<a class="applied-name" href="xml-in-laml-1.html#positive-to-negative-ast-spacing" title="xml-in-laml">positive-to-negative-ast-spacing</a> source-items))
                ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX331" title="R5RS Scheme form">list?</a> source-items) 
                    (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">el</span>) (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> el) (<a class="applied-name" href="xml-in-laml-1.html#positive-to-negative-ast-spacing" title="xml-in-laml">positive-to-negative-ast-spacing</a> el) el)) source-items))
                (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> source-items))))
   (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX123" title="R5RS Scheme form">letrec</a> ((<span class="local-name-binding">real-transformer</span>
	     (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">source</span>)
	       (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> source)) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX331" title="R5RS Scheme form">list?</a> source))  <span class="comment">; a list of source content items</span><br />                      (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> <a class="applied-name" href="xml-in-laml-1.html#apply-transformation-on" title="xml-in-laml">apply-transformation-on</a> source))
		     (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a>                                      <span class="comment">; A single source content item</span><br />                           (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">transform-function</span> (<a class="applied-name" href="xml-in-laml-1.html#lookup-transform-spec" title="xml-in-laml">lookup-transform-spec</a> source transform-specs)))
			     (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> transform-function
				 (transform-function source)
				 '())))))))
     (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> <a class="applied-name" href="xml-in-laml-1.html#apply-transformation-on" title="xml-in-laml">apply-transformation-on</a> real-transformer)
     (<a class="applied-name" href="xml-in-laml-1.html#apply-transformation-on" title="xml-in-laml">apply-transformation-on</a> negated-source))))

<a name="apply-transformation-on"></a><a name="apply-transformation-on"></a><span><a href="../xml-in-laml.html#apply-transformation-on"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">apply-transformation-on</span> #f)


<a name="transform-ast-list"></a><a name="transform-ast-list"></a><span><a href="../xml-in-laml.html#transform-ast-list"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(transform-ast-list input-list . transform-specs)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> input-list)
     '()
     (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">ast</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> input-list))
            (<span class="local-name-binding">transform-function</span> (<a class="applied-name" href="xml-in-laml-1.html#lookup-transform-spec" title="xml-in-laml">lookup-transform-spec</a> ast transform-specs)))
      (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> 
        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> transform-function (transform-function ast) ast)
        (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX411" title="R5RS Scheme form">apply</a> <a class="applied-name" href="xml-in-laml-1.html#transform-ast-list" title="xml-in-laml">transform-ast-list</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> input-list) transform-specs)))))


            

<a name="lookup-transform-spec-flat"></a><span class="comment">; Return the appropriate transformation function on ast in the flat list of transform-specs.
; Not used, because we have settled on a non-flat format of transformation specifications.</span><br /><a name="lookup-transform-spec-flat"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(lookup-transform-spec-flat source transform-specs)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> transform-specs) #f)
        ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> transform-specs))) <span class="comment">; at least two elements</span><br />           (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">pred</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> transform-specs))
                  (<span class="local-name-binding">transformer</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cadr</a> transform-specs)))
             (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (pred source) transformer (<a class="applied-name" href="xml-in-laml-1.html#lookup-transform-spec-flat" title="xml-in-laml">lookup-transform-spec-flat</a> source (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cddr</a> transform-specs)))))
        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#laml-error" title="Manual: general">laml-error</a> "lookup-transform-spec-flat: Odd length transform-spec passed."))))


<a name="lookup-transform-spec"></a><span class="comment">; Return the appropriate transformation function on ast in the list of transform-specs.</span><br /><a name="lookup-transform-spec"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(lookup-transform-spec ast transform-specs)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> transform-specs)
      #f
      (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">single-transform-spec</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> transform-specs))
             (<span class="local-name-binding">pred</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> single-transform-spec))
             (<span class="local-name-binding">transformer</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cadr</a> single-transform-spec)))
        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (pred ast) transformer (<a class="applied-name" href="xml-in-laml-1.html#lookup-transform-spec" title="xml-in-laml">lookup-transform-spec</a> ast (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> transform-specs))))))


<a name="positive-to-negative-ast-spacing"></a><a name="positive-to-negative-ast-spacing"></a><span><a href="../xml-in-laml.html#positive-to-negative-ast-spacing"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(positive-to-negative-ast-spacing ast)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">subtree-list</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-subtrees" title="xml-in-laml">ast-subtrees</a> ast))
         (<span class="local-name-binding">negative-subtree-list</span> (<a class="applied-name" href="xml-in-laml-1.html#positive-to-negative-subtree-list" title="xml-in-laml">positive-to-negative-subtree-list</a> subtree-list)))
     (<a class="applied-name" href="xml-in-laml-1.html#make-ast" title="xml-in-laml">make-ast</a> (<a class="applied-name" href="xml-in-laml-1.html#ast-element-name" title="xml-in-laml">ast-element-name</a> ast)
               negative-subtree-list
               (<a class="applied-name" href="xml-in-laml-1.html#ast-attributes" title="xml-in-laml">ast-attributes</a> ast)
               (<a class="applied-name" href="xml-in-laml-1.html#ast-kind" title="xml-in-laml">ast-kind</a> ast)
               (<a class="applied-name" href="xml-in-laml-1.html#ast-language" title="xml-in-laml">ast-language</a> ast)
               (<a class="applied-name" href="xml-in-laml-1.html#ast-internal-attributes" title="xml-in-laml">ast-internal-attributes</a> ast))))

<a name="positive-to-negative-subtree-list"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(positive-to-negative-subtree-list subtree-list)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> subtree-list) '())    <span class="comment">; zero elements</span><br />        ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> subtree-list))   <span class="comment">; exactly one element</span><br />           (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">only-element</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#first" title="Manual: general">first</a> subtree-list)))
             (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> only-element) (<a class="applied-name" href="xml-in-laml-1.html#positive-to-negative-ast-spacing" title="xml-in-laml">positive-to-negative-ast-spacing</a> only-element) only-element))))
        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="applied-name" href="xml-in-laml-1.html#positive-to-negative-subtree-list-1-2" title="xml-in-laml">positive-to-negative-subtree-list-1-2</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#first" title="Manual: general">first</a> subtree-list) (<a class="schemedoc-name" href="../../../../lib/man/general.html#second" title="Manual: general">second</a> subtree-list) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> subtree-list)))))

<a name="positive-to-negative-subtree-list-1-2"></a><span class="comment">; next-e is first element of rest
; e is not supposed to be white space related.</span><br /><a name="positive-to-negative-subtree-list-1-2"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(positive-to-negative-subtree-list-1-2 e next-e rest)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="applied-name" href="xml-in-laml-1.html#forced-white-space?" title="xml-in-laml">forced-white-space?</a> next-e)
            (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> e) (<a class="applied-name" href="xml-in-laml-1.html#positive-to-negative-ast-spacing" title="xml-in-laml">positive-to-negative-ast-spacing</a> e) e)
                  (<a class="applied-name" href="xml-in-laml-1.html#positive-to-negative-subtree-list" title="xml-in-laml">positive-to-negative-subtree-list</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> rest))))

        ((<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="applied-name" href="xml-in-laml-1.html#white-space-related?" title="xml-in-laml">white-space-related?</a> e)) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="applied-name" href="xml-in-laml-1.html#white-space-related?" title="xml-in-laml">white-space-related?</a> next-e)))
            (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> e) (<a class="applied-name" href="xml-in-laml-1.html#positive-to-negative-ast-spacing" title="xml-in-laml">positive-to-negative-ast-spacing</a> e) e)
              (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a>  <a class="applied-name" href="xml-in-laml-1.html#explicit-space-suppress" title="xml-in-laml">explicit-space-suppress</a>
                (<a class="applied-name" href="xml-in-laml-1.html#positive-to-negative-subtree-list" title="xml-in-laml">positive-to-negative-subtree-list</a> rest))))

        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a>  <span class="comment">; should not happen</span><br />            (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> e) (<a class="applied-name" href="xml-in-laml-1.html#positive-to-negative-ast-spacing" title="xml-in-laml">positive-to-negative-ast-spacing</a> e) e)
              (<a class="applied-name" href="xml-in-laml-1.html#positive-to-negative-subtree-list" title="xml-in-laml">positive-to-negative-subtree-list</a> rest)))))




<div class="schemedoc-section-comment">;;; LAML location path and steps.  
;;; This section contains &lt;a href = "http://www.w3.org/TR/xpath.html"&gt;Xpath&lt;/a&gt; inspirred matching, extraction, and transformation functions.
;;; The definitions in this section make up an alternative to the minimalistic AST traversal and transformation functions in the previous section.
;;; Eventually, there will be additional documentation and examples of the LAML location path framework.
;;; .section-id location-path-step</div>
<a name="match-ast"></a><a name="match-ast"></a><span><a href="../xml-in-laml.html#match-ast"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(match-ast ast . locator-list)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">xml-root-node-assigned-on-before-hand</span> #f))
   (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> <a class="applied-name" href="xml-in-laml-1.html#xml-root-node" title="xml-in-laml">xml-root-node</a> #f) (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> <a class="applied-name" href="xml-in-laml-1.html#xml-root-node" title="xml-in-laml">xml-root-node</a> ast) (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> xml-root-node-assigned-on-before-hand #t))
   (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">result</span> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> (#t (<a class="applied-name" href="xml-in-laml-1.html#match-asts-1" title="xml-in-laml">match-asts-1</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> ast) locator-list))
                       (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#laml-error" title="Manual: general">laml-error</a> "match-ast: Final or intermediate result must either be an AST:" ast)))))
     (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> xml-root-node-assigned-on-before-hand) (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> <a class="applied-name" href="xml-in-laml-1.html#xml-root-node" title="xml-in-laml">xml-root-node</a> #f))
     (<a class="schemedoc-name" href="../../../../lib/man/general.html#remove-duplicates-by-predicate" title="Manual: general">remove-duplicates-by-predicate</a> result <a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a>))))


<a name="xml-root-node"></a><a name="xml-root-node"></a><span><a href="../xml-in-laml.html#xml-root-node"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">xml-root-node</span> #f)

<a name="match-asts-1"></a><span class="comment">; Apply each function in locator-list on each content element in asts, and flatten the resulting lists of lists before applying the next function in the list.
; content-elements is always a list of content elements, among these ASTs.
; This function has no rest parameter, but a second parameter which is a function list.</span><br /><a name="match-asts-1"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(match-asts-1 content-elements locator-list)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> locator-list)
           content-elements)
        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a>
           (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">fu</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#first" title="Manual: general">first</a> locator-list))
                  (<span class="local-name-binding">res-list</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#compose" title="Manual: general">compose</a> <a class="applied-name" href="xml-in-laml-1.html#ensure-list-result-xml-in-laml" title="xml-in-laml">ensure-list-result-xml-in-laml</a> fu) content-elements)))
             (<a class="applied-name" href="xml-in-laml-1.html#match-asts-1" title="xml-in-laml">match-asts-1</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#flatten" title="Manual: general">flatten</a> res-list) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> locator-list))))))

<a name="location-step"></a><a name="location-step"></a><span><a href="../xml-in-laml.html#location-step"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(location-step axis . optional-parameter-list)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">node-test</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#optional-parameter" title="Manual: general">optional-parameter</a> 1 optional-parameter-list #f))
        (<span class="local-name-binding">filtering</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#optional-parameter" title="Manual: general">optional-parameter</a> 2 optional-parameter-list #f)))

    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX123" title="R5RS Scheme form">letrec</a> ((<span class="local-name-binding">sequence-location-step</span> <span class="comment">; common support for sequential location steps. The parameter content-element is not used!</span><br />              (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">content-element</span> <span class="local-name-binding">offsprings</span>)
                (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX374" title="R5RS Scheme form">string?</a> node-test) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX200" title="R5RS Scheme form">equal?</a> node-test "*"))
                       (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">last</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX333" title="R5RS Scheme form">length</a> offsprings)))
                         (<a class="schemedoc-name" href="../../../../lib/man/general.html#mapping-filter" title="Manual: general">mapping-filter</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">child</span> <span class="local-name-binding">pos</span>) (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (filtering child pos last) child #f)) offsprings (<a class="schemedoc-name" href="../../../../lib/man/general.html#number-interval" title="Manual: general">number-interval</a> 1 last))))
                      ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX374" title="R5RS Scheme form">string?</a> node-test)
                       (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">relevant-children-after-node-test</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#filter" title="Manual: general">filter</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">child</span>) (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> child) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX200" title="R5RS Scheme form">equal?</a> (<a class="applied-name" href="xml-in-laml-1.html#ast-element-name" title="xml-in-laml">ast-element-name</a> child) node-test))) offsprings))
                              (<span class="local-name-binding">last</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX333" title="R5RS Scheme form">length</a> relevant-children-after-node-test)))
                         (<a class="schemedoc-name" href="../../../../lib/man/general.html#mapping-filter" title="Manual: general">mapping-filter</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">child</span> <span class="local-name-binding">pos</span>) (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (filtering child pos last) child #f)) relevant-children-after-node-test (<a class="schemedoc-name" href="../../../../lib/man/general.html#number-interval" title="Manual: general">number-interval</a> 1 last))))
                      ((<a class="applied-name" href="xml-in-laml-1.html#node-test?" title="xml-in-laml">node-test?</a> node-test 'node 1) <span class="comment">; only (node)</span><br />                       (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">relevant-children-after-node-test</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#filter" title="Manual: general">filter</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">child</span>) (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> child))) offsprings))
                              (<span class="local-name-binding">last</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX333" title="R5RS Scheme form">length</a> relevant-children-after-node-test)))
                         (<a class="schemedoc-name" href="../../../../lib/man/general.html#mapping-filter" title="Manual: general">mapping-filter</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">child</span> <span class="local-name-binding">pos</span>) (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (filtering child pos last) child #f)) relevant-children-after-node-test (<a class="schemedoc-name" href="../../../../lib/man/general.html#number-interval" title="Manual: general">number-interval</a> 1 last))))
                      ((<a class="applied-name" href="xml-in-laml-1.html#node-test?" title="xml-in-laml">node-test?</a> node-test 'node 2) <span class="comment">; (node "N")</span><br />                       (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">relevant-children-after-node-test</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#filter" title="Manual: general">filter</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">child</span>) (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> child) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX200" title="R5RS Scheme form">equal?</a> (<a class="applied-name" href="xml-in-laml-1.html#ast-element-name" title="xml-in-laml">ast-element-name</a> child) (<a class="schemedoc-name" href="../../../../lib/man/general.html#second" title="Manual: general">second</a> node-test)))) offsprings))
                              (<span class="local-name-binding">last</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX333" title="R5RS Scheme form">length</a> relevant-children-after-node-test)))
                         (<a class="schemedoc-name" href="../../../../lib/man/general.html#mapping-filter" title="Manual: general">mapping-filter</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">child</span> <span class="local-name-binding">pos</span>) (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (filtering child pos last) child #f)) relevant-children-after-node-test (<a class="schemedoc-name" href="../../../../lib/man/general.html#number-interval" title="Manual: general">number-interval</a> 1 last))))
                      ((<a class="applied-name" href="xml-in-laml-1.html#node-test?" title="xml-in-laml">node-test?</a> node-test 'node 3) <span class="comment">; (node "L" "N")</span><br />                       (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">relevant-children-after-node-test</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#filter" title="Manual: general">filter</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">child</span>) (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> child)
                                                                                              (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX200" title="R5RS Scheme form">equal?</a> (<a class="applied-name" href="xml-in-laml-1.html#ast-element-name" title="xml-in-laml">ast-element-name</a> child) (<a class="schemedoc-name" href="../../../../lib/man/general.html#second" title="Manual: general">second</a> node-test))
                                                                                              (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX200" title="R5RS Scheme form">equal?</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> (<a class="applied-name" href="xml-in-laml-1.html#ast-language" title="xml-in-laml">ast-language</a> child)) (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#third" title="Manual: general">third</a> node-test)))))
                                                                         offsprings))
                              (<span class="local-name-binding">last</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX333" title="R5RS Scheme form">length</a> relevant-children-after-node-test)))
                         (<a class="schemedoc-name" href="../../../../lib/man/general.html#mapping-filter" title="Manual: general">mapping-filter</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">child</span> <span class="local-name-binding">pos</span>) (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (filtering child pos last) child #f)) relevant-children-after-node-test (<a class="schemedoc-name" href="../../../../lib/man/general.html#number-interval" title="Manual: general">number-interval</a> 1 last))))
                      ((<a class="applied-name" href="xml-in-laml-1.html#node-test?" title="xml-in-laml">node-test?</a> node-test 'text 1) <span class="comment">; only (text)</span><br />                       (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">relevant-children-after-node-test</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#filter" title="Manual: general">filter</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">child</span>) (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="applied-name" href="xml-in-laml-1.html#cdata?" title="xml-in-laml">cdata?</a> child))) offsprings))
                              (<span class="local-name-binding">last</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX333" title="R5RS Scheme form">length</a> relevant-children-after-node-test)))
                         (<a class="schemedoc-name" href="../../../../lib/man/general.html#mapping-filter" title="Manual: general">mapping-filter</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">child</span> <span class="local-name-binding">pos</span>) (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (filtering child pos last) child #f)) relevant-children-after-node-test (<a class="schemedoc-name" href="../../../../lib/man/general.html#number-interval" title="Manual: general">number-interval</a> 1 last))))
                      ((<a class="applied-name" href="xml-in-laml-1.html#node-test?" title="xml-in-laml">node-test?</a> node-test 'comment 1) <span class="comment">; only (comment)</span><br />                       (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">relevant-children-after-node-test</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#filter" title="Manual: general">filter</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">child</span>) (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="applied-name" href="xml-in-laml-1.html#xml-comment?" title="xml-in-laml">xml-comment?</a> child))) offsprings))
                              (<span class="local-name-binding">last</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX333" title="R5RS Scheme form">length</a> relevant-children-after-node-test)))
                         (<a class="schemedoc-name" href="../../../../lib/man/general.html#mapping-filter" title="Manual: general">mapping-filter</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">child</span> <span class="local-name-binding">pos</span>) (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (filtering child pos last) child #f)) relevant-children-after-node-test (<a class="schemedoc-name" href="../../../../lib/man/general.html#number-interval" title="Manual: general">number-interval</a> 1 last))))
                      ((<a class="applied-name" href="xml-in-laml-1.html#node-test?" title="xml-in-laml">node-test?</a> node-test 'white-space 1) <span class="comment">; only (white-space)</span><br />                       (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">relevant-children-after-node-test</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#filter" title="Manual: general">filter</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">child</span>) (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="applied-name" href="xml-in-laml-1.html#white-space-related?" title="xml-in-laml">white-space-related?</a> child) (<a class="applied-name" href="xml-in-laml-1.html#forced-white-space?" title="xml-in-laml">forced-white-space?</a> child))) offsprings))
                              (<span class="local-name-binding">last</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX333" title="R5RS Scheme form">length</a> relevant-children-after-node-test)))
                         (<a class="schemedoc-name" href="../../../../lib/man/general.html#mapping-filter" title="Manual: general">mapping-filter</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">child</span> <span class="local-name-binding">pos</span>) (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (filtering child pos last) child #f)) relevant-children-after-node-test (<a class="schemedoc-name" href="../../../../lib/man/general.html#number-interval" title="Manual: general">number-interval</a> 1 last))))
                      ((<a class="applied-name" href="xml-in-laml-1.html#node-test?" title="xml-in-laml">node-test?</a> node-test 'processing-instruction 1) <span class="comment">; only (processing-instruction)</span><br />                       (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">relevant-children-after-node-test</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#filter" title="Manual: general">filter</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">child</span>) (<a class="applied-name" href="xml-in-laml-1.html#processing-instruction?" title="xml-in-laml">processing-instruction?</a> child)) offsprings))
                              (<span class="local-name-binding">last</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX333" title="R5RS Scheme form">length</a> relevant-children-after-node-test)))
                         (<a class="schemedoc-name" href="../../../../lib/man/general.html#mapping-filter" title="Manual: general">mapping-filter</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">child</span> <span class="local-name-binding">pos</span>) (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (filtering child pos last) child #f)) relevant-children-after-node-test (<a class="schemedoc-name" href="../../../../lib/man/general.html#number-interval" title="Manual: general">number-interval</a> 1 last))))
                      ((<a class="applied-name" href="xml-in-laml-1.html#node-test?" title="xml-in-laml">node-test?</a> node-test 'processing-instruction 2) <span class="comment">; (processing-instruction "N")</span><br />                       (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">relevant-children-after-node-test</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#filter" title="Manual: general">filter</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">child</span>) (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="applied-name" href="xml-in-laml-1.html#processing-instruction?" title="xml-in-laml">processing-instruction?</a> child)
                                                                                              (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX200" title="R5RS Scheme form">equal?</a> (<a class="applied-name" href="xml-in-laml-1.html#processing-instruction-target" title="xml-in-laml">processing-instruction-target</a> child) (<a class="schemedoc-name" href="../../../../lib/man/general.html#second" title="Manual: general">second</a> node-test))))
                                                                         offsprings))
                              (<span class="local-name-binding">last</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX333" title="R5RS Scheme form">length</a> relevant-children-after-node-test)))
                         (<a class="schemedoc-name" href="../../../../lib/man/general.html#mapping-filter" title="Manual: general">mapping-filter</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">child</span> <span class="local-name-binding">pos</span>) (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (filtering child pos last) child #f)) relevant-children-after-node-test (<a class="schemedoc-name" href="../../../../lib/man/general.html#number-interval" title="Manual: general">number-interval</a> 1 last))))
                      (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#laml-error" title="Manual: general">laml-error</a> "Unknown location step node test:" node-test))))))

      (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> 

            <span class="comment">; The attribute axis is special</span><br />
            ((<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> axis 'attribute) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> node-test) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> filtering))
             (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">content-element</span>)
               (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> content-element)
                   (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">attr-prop-list</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-attributes" title="xml-in-laml">ast-attributes</a> content-element)))
                     (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> attr-prop-list))
                   '())))

            ((<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> axis 'attribute) (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX118" title="R5RS Scheme form">or</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX374" title="R5RS Scheme form">string?</a> node-test) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX346" title="R5RS Scheme form">symbol?</a> node-test)) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> filtering))
             (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">content-element</span>)
               (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> content-element)
                   (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">attr-name</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-symbol" title="Manual: general">as-symbol</a> node-test))
                          (<span class="local-name-binding">attr-prop-list</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-attributes" title="xml-in-laml">ast-attributes</a> content-element)))
                     (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#find-in-property-list" title="Manual: general">find-in-property-list</a> attr-name attr-prop-list)
                         (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-symbol" title="Manual: general">as-symbol</a> node-test) (<a class="schemedoc-name" href="../../../../lib/man/general.html#get-prop" title="Manual: general">get-prop</a> attr-name attr-prop-list)))
                         '()))
                   '())))

            ((<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> axis 'attribute) (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX118" title="R5RS Scheme form">or</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX374" title="R5RS Scheme form">string?</a> node-test) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX346" title="R5RS Scheme form">symbol?</a> node-test)) filtering) <span class="comment">; filtering re-interpreted as attibute value! </span><br />             (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">content-element</span>)
               (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> content-element)
                   (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">attr-name</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-symbol" title="Manual: general">as-symbol</a> node-test))
                          (<span class="local-name-binding">attr-value</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> filtering)) <span class="comment">; renaming and special interpretation</span><br />                          (<span class="local-name-binding">attr-prop-list</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-attributes" title="xml-in-laml">ast-attributes</a> content-element)))
                     (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#find-in-property-list" title="Manual: general">find-in-property-list</a> attr-name attr-prop-list) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX200" title="R5RS Scheme form">equal?</a> attr-value (<a class="schemedoc-name" href="../../../../lib/man/general.html#get-prop" title="Manual: general">get-prop</a> attr-name attr-prop-list)))
                         (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-symbol" title="Manual: general">as-symbol</a> node-test) (<a class="schemedoc-name" href="../../../../lib/man/general.html#get-prop" title="Manual: general">get-prop</a> attr-name attr-prop-list)))
                         '()))
                   '())))


            <span class="comment">; Recursive dispatching in case one of node-test and filtering is not provided</span><br />
            ((<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> node-test) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> filtering)) <span class="comment">; all ancestors towards the root</span><br />             (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX411" title="R5RS Scheme form">apply</a> <a class="applied-name" href="xml-in-laml-1.html#location-step" title="xml-in-laml">location-step</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> axis "*" (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">n</span> <span class="local-name-binding">p</span> <span class="local-name-binding">l</span>) #t))))

            ((<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> node-test (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> filtering))
             (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX411" title="R5RS Scheme form">apply</a> <a class="applied-name" href="xml-in-laml-1.html#location-step" title="xml-in-laml">location-step</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> axis node-test (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">n</span> <span class="local-name-binding">p</span> <span class="local-name-binding">l</span>) #t))))



            <span class="comment">; Remaining location steps with both axis, node-test and filtering</span><br />
            ((<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> axis 'self) node-test filtering)
             (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">content-element</span>)
                (sequence-location-step content-element (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> content-element))))


            ((<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> axis 'child) node-test (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX410" title="R5RS Scheme form">procedure?</a> filtering)) <span class="comment">;  filtering: child x node-position x context-size -&gt; boolean </span><br />             (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">content-element</span>)
               (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> content-element)
                   (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">children</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-subtrees" title="xml-in-laml">ast-subtrees</a> content-element)))
                     (sequence-location-step content-element children))
                   '())))

            ((<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> axis 'descendant) node-test (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX410" title="R5RS Scheme form">procedure?</a> filtering)) <span class="comment">;  filtering: child x node-position x context-size -&gt; boolean</span><br />             (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">content-element</span>)
               (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> content-element)
                   (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">descendants</span> (<a class="applied-name" href="xml-in-laml-1.html#all-children-recursively" title="xml-in-laml">all-children-recursively</a> content-element)))
                     (sequence-location-step content-element descendants))
                   '())))

            ((<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> axis 'following-sibling) node-test filtering)
             (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">content-element</span>)
               (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">path</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-path-from-to" title="xml-in-laml">ast-path-from-to</a> <a class="applied-name" href="xml-in-laml-1.html#xml-root-node" title="xml-in-laml">xml-root-node</a> content-element)))
                 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> path (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX239" title="R5RS Scheme form">&gt;=</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX333" title="R5RS Scheme form">length</a> path) 2))
                     (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">parent</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cadr</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX335" title="R5RS Scheme form">reverse</a> path)))
                            (<span class="local-name-binding">children-of-parent</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-subtrees" title="xml-in-laml">ast-subtrees</a> parent))
                            (<span class="local-name-binding">pos</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#index-in-list-by-predicate" title="Manual: general">index-in-list-by-predicate</a> children-of-parent content-element <a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a>)))
                       (sequence-location-step content-element (<a class="schemedoc-name" href="../../../../lib/man/general.html#rear-sublist" title="Manual: general">rear-sublist</a> children-of-parent (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX251" title="R5RS Scheme form">-</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX333" title="R5RS Scheme form">length</a> children-of-parent) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX249" title="R5RS Scheme form">+</a> pos 1)))))
                     '()))))

            ((<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> axis 'preceding-sibling) node-test filtering)
             (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">content-element</span>)
               (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">path</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-path-from-to" title="xml-in-laml">ast-path-from-to</a> <a class="applied-name" href="xml-in-laml-1.html#xml-root-node" title="xml-in-laml">xml-root-node</a> content-element)))
                 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> path (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX239" title="R5RS Scheme form">&gt;=</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX333" title="R5RS Scheme form">length</a> path) 2))
                     (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">parent</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cadr</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX335" title="R5RS Scheme form">reverse</a> path)))
                            (<span class="local-name-binding">children-of-parent</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-subtrees" title="xml-in-laml">ast-subtrees</a> parent))
                            (<span class="local-name-binding">pos</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#index-in-list-by-predicate" title="Manual: general">index-in-list-by-predicate</a> children-of-parent content-element <a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a>)))
                       (sequence-location-step content-element (<a class="schemedoc-name" href="../../../../lib/man/general.html#front-sublist" title="Manual: general">front-sublist</a> children-of-parent pos)))
                     '()))))

            ((<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> axis 'following) node-test filtering)
             (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">content-element</span>)
               (sequence-location-step content-element (<a class="applied-name" href="xml-in-laml-1.html#traverse-ast-start-after" title="xml-in-laml">traverse-ast-start-after</a> <a class="applied-name" href="xml-in-laml-1.html#xml-root-node" title="xml-in-laml">xml-root-node</a> content-element))))

            ((<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> axis 'preceding) node-test filtering)
             (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">content-element</span>)
               (sequence-location-step content-element (<a class="applied-name" href="xml-in-laml-1.html#traverse-ast-interrupt-before-no-ancestors" title="xml-in-laml">traverse-ast-interrupt-before-no-ancestors</a> <a class="applied-name" href="xml-in-laml-1.html#xml-root-node" title="xml-in-laml">xml-root-node</a> content-element))))

            ((<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> axis 'ancestor) node-test filtering)
             (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">content-element</span>)
               (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">path</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-path-from-to" title="xml-in-laml">ast-path-from-to</a> <a class="applied-name" href="xml-in-laml-1.html#xml-root-node" title="xml-in-laml">xml-root-node</a> content-element)))
                 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> path
                     (sequence-location-step content-element (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX335" title="R5RS Scheme form">reverse</a> path)))
                     '()) )))

           ((<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> axis 'parent) node-test filtering)
             (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">content-element</span>)
               (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">path</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-path-from-to" title="xml-in-laml">ast-path-from-to</a> <a class="applied-name" href="xml-in-laml-1.html#xml-root-node" title="xml-in-laml">xml-root-node</a> content-element)))
                 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> path (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX239" title="R5RS Scheme form">&gt;=</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX333" title="R5RS Scheme form">length</a> path) 2))
                     (sequence-location-step content-element (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cadr</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX335" title="R5RS Scheme form">reverse</a> path))))
                     '()) )  ))

            (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#laml-error" title="Manual: general">laml-error</a> "location-step: axis not supported yet:" axis))
            )
      )
    ))

<a name="node-test?"></a><span class="comment">; Is the node test list nt of kind with a total of n constituents?</span><br /><a name="node-test?"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(node-test? nt kind n)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> 
     (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX331" title="R5RS Scheme form">list?</a> nt)
     (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX235" title="R5RS Scheme form">=</a> n 1) (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX235" title="R5RS Scheme form">=</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX333" title="R5RS Scheme form">length</a> nt) 1) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#first" title="Manual: general">first</a> nt) kind)))
           ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX235" title="R5RS Scheme form">=</a> n 2) (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX235" title="R5RS Scheme form">=</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX333" title="R5RS Scheme form">length</a> nt) 2) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#first" title="Manual: general">first</a> nt) kind)))  
           ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX235" title="R5RS Scheme form">=</a> n 3) (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX235" title="R5RS Scheme form">=</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX333" title="R5RS Scheme form">length</a> nt) 3) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#first" title="Manual: general">first</a> nt) kind)))
           (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> #f))))

<a name="traverse-ast-start-after"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(traverse-ast-start-after ast start-after-content-element)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">collecting?</span> #f)
       (<span class="local-name-binding">collected-content-elements</span> '()))
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX123" title="R5RS Scheme form">letrec</a> ((<span class="local-name-binding">traverse-ast-start-after-1</span>
            (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">cont-element</span>)
              (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> collecting? (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> collected-content-elements (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> cont-element collected-content-elements)))
              (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> cont-element)
                  (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX413" title="R5RS Scheme form">for-each</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">child</span>) (traverse-ast-start-after-1 child)) (<a class="applied-name" href="xml-in-laml-1.html#ast-subtrees" title="xml-in-laml">ast-subtrees</a> cont-element)))
              (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> cont-element start-after-content-element) (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> collecting? #t)) )))
    (traverse-ast-start-after-1 ast)
    (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX335" title="R5RS Scheme form">reverse</a> collected-content-elements))))

<a name="traverse-ast-interrupt-before"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(traverse-ast-interrupt-before ast start-after-content-element)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">collecting?</span> #t)
       (<span class="local-name-binding">collected-content-elements</span> '())
      )
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX123" title="R5RS Scheme form">letrec</a> ((<span class="local-name-binding">traverse-ast-interrupt-before-1</span>
            (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">cont-element</span>)
              (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> cont-element start-after-content-element) (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> collecting? #f))
              (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> collecting? (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> collected-content-elements (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> cont-element collected-content-elements)))
              (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> cont-element)
                  (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX413" title="R5RS Scheme form">for-each</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">child</span>) (traverse-ast-interrupt-before-1 child)) (<a class="applied-name" href="xml-in-laml-1.html#ast-subtrees" title="xml-in-laml">ast-subtrees</a> cont-element))) )))
    (traverse-ast-interrupt-before-1 ast)
    (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX335" title="R5RS Scheme form">reverse</a> collected-content-elements))))

<a name="traverse-ast-interrupt-before-no-ancestors"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(traverse-ast-interrupt-before-no-ancestors ast start-after-content-element)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">root-to-start-path</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-path-from-to" title="xml-in-laml">ast-path-from-to</a> ast start-after-content-element)))
   (<a class="schemedoc-name" href="../../../../lib/man/general.html#list-difference" title="Manual: general">list-difference</a> (<a class="applied-name" href="xml-in-laml-1.html#traverse-ast-interrupt-before" title="xml-in-laml">traverse-ast-interrupt-before</a> ast start-after-content-element) root-to-start-path)))
  

<a name="all-children-recursively"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(all-children-recursively ast)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> ast)
      (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">children</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-subtrees" title="xml-in-laml">ast-subtrees</a> ast)))
        (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX334" title="R5RS Scheme form">append</a> children (<a class="schemedoc-name" href="../../../../lib/man/general.html#flatten" title="Manual: general">flatten</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> <a class="applied-name" href="xml-in-laml-1.html#all-children-recursively" title="xml-in-laml">all-children-recursively</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#filter" title="Manual: general">filter</a> <a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> children)))))
      '()))

<a name="ast-path-from-to"></a><span class="comment">; Find the unique list of AST nodes from ast1 to ast2 via the parent-child relationship in the tree.
; The resulting list starts with ast1, and ends with ast2. In case ast2 is not a descendant of node1, return #f.</span><br /><a name="ast-path-from-to"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(ast-path-from-to ast1 ast2)</span>
  (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX417" title="R5RS Scheme form">call-with-current-continuation</a> 
    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">returning</span>)
      (<a class="applied-name" href="xml-in-laml-1.html#ast-path-from-to-1" title="xml-in-laml">ast-path-from-to-1</a> ast1 ast2 '() returning)
      #f))
)

<a name="ast-path-from-to-1"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(ast-path-from-to-1 ast1 ast2 path-list returning)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> ast1 ast2)
      (returning (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX335" title="R5RS Scheme form">reverse</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> ast2 path-list)))
      (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> ast1)
          (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">children</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-subtrees" title="xml-in-laml">ast-subtrees</a> ast1)))
            (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX413" title="R5RS Scheme form">for-each</a> 
             (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">child</span>)
               (<a class="applied-name" href="xml-in-laml-1.html#ast-path-from-to-1" title="xml-in-laml">ast-path-from-to-1</a> child ast2 (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> ast1 path-list) returning))
             children))))               <span class="comment">; (filter ast? children)</span><br />)

<a name="ensure-list-result-xml-in-laml"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(ensure-list-result-xml-in-laml x)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> x) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> x))
        ((<a class="applied-name" href="xml-in-laml-1.html#cdata?" title="xml-in-laml">cdata?</a> x) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> x))
        ((<a class="applied-name" href="xml-in-laml-1.html#extended-contents-data?" title="xml-in-laml">extended-contents-data?</a> x) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> x))
        ((<a class="applied-name" href="xml-in-laml-1.html#forced-white-space?" title="xml-in-laml">forced-white-space?</a> x) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> x))
        ((<a class="applied-name" href="xml-in-laml-1.html#delayed-procedural-contents-element?" title="xml-in-laml">delayed-procedural-contents-element?</a> x) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> x))
        ((<a class="applied-name" href="xml-in-laml-1.html#char-ref?" title="xml-in-laml">char-ref?</a> x) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> x))
        ((<a class="applied-name" href="xml-in-laml-1.html#xml-comment?" title="xml-in-laml">xml-comment?</a> x) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> x))
        ((<a class="applied-name" href="xml-in-laml-1.html#cdata-section?" title="xml-in-laml">cdata-section?</a> x) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> x))
        ((<a class="applied-name" href="xml-in-laml-1.html#processing-instruction?" title="xml-in-laml">processing-instruction?</a> x) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> x))
        ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX331" title="R5RS Scheme form">list?</a> x) x)
        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#laml-error" title="Manual: general">laml-error</a> "ensure-list-result-xml-in-laml: the parameter must be a single content item or a list of these: " (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> x)))))

<a name="negate-step"></a><a name="negate-step"></a><span><a href="../xml-in-laml.html#negate-step"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(negate-step location-step-procedure)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">content-element</span>)
    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">result</span> (location-step-procedure content-element)))
       (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> result)
           (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> #t)  <span class="comment">; something</span><br />           '()))))

<a name="and-steps"></a><a name="and-steps"></a><span><a href="../xml-in-laml.html#and-steps"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(and-steps . location-step-procedure-list)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX123" title="R5RS Scheme form">letrec</a> ((<span class="local-name-binding">and-fn</span> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">x</span> <span class="local-name-binding">y</span>) (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> x y))))
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">content-element</span>)
    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">result-list</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a>  (<span class="local-name-binding">step</span>) (step content-element)) location-step-procedure-list))
           (<span class="local-name-binding">result-list-1</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> <a class="applied-name" href="xml-in-laml-1.html#does-exist?" title="xml-in-laml">does-exist?</a> result-list)))
      (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#accumulate-right" title="Manual: general">accumulate-right</a> and-fn #t result-list-1)
          (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> #t)  <span class="comment">; success</span><br />          '()        <span class="comment">; failure</span><br />      )))))

<a name="or-steps"></a><a name="or-steps"></a><span><a href="../xml-in-laml.html#or-steps"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(or-steps . location-step-procedure-list)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX123" title="R5RS Scheme form">letrec</a> ((<span class="local-name-binding">or-fn</span> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">x</span> <span class="local-name-binding">y</span>) (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX118" title="R5RS Scheme form">or</a> x y))))
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">content-element</span>)
    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">result-list</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">step</span>) (step content-element)) location-step-procedure-list))
           (<span class="local-name-binding">result-list-1</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> <a class="applied-name" href="xml-in-laml-1.html#does-exist?" title="xml-in-laml">does-exist?</a> result-list)))
      (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#accumulate-right" title="Manual: general">accumulate-right</a> or-fn #f result-list-1)
          (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> #t)  <span class="comment">; success</span><br />          '()        <span class="comment">; failure</span><br />      )))))

<a name="compose-steps"></a><a name="compose-steps"></a><span><a href="../xml-in-laml.html#compose-steps"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(compose-steps . location-step-procedure-list)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">content-element</span>)
    (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX411" title="R5RS Scheme form">apply</a> <a class="applied-name" href="xml-in-laml-1.html#match-ast" title="xml-in-laml">match-ast</a> content-element location-step-procedure-list)))


<a name="identifier-of-predicate"></a><a name="identifier-of-predicate"></a><span><a href="../xml-in-laml.html#identifier-of-predicate"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(identifier-of-predicate p)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">x</span>) (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (p x) x '())))

<a name="ast-text-containing"></a><a name="ast-text-containing"></a><span><a href="../xml-in-laml.html#ast-text-containing"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(ast-text-containing str)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">x</span>)
    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="applied-name" href="xml-in-laml-1.html#cdata?" title="xml-in-laml">cdata?</a> x) (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#substring?" title="Manual: general">substring?</a> x str) str '()))
          ((<a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> x) (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#substring?" title="Manual: general">substring?</a> (<a class="applied-name" href="xml-in-laml-1.html#ast-text" title="xml-in-laml">ast-text</a> x) str) (<a class="applied-name" href="xml-in-laml-1.html#ast-text" title="xml-in-laml">ast-text</a> x) '()))
          (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> '()))))

<a name="ast-text-deep-containing"></a><a name="ast-text-deep-containing"></a><span><a href="../xml-in-laml.html#ast-text-deep-containing"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(ast-text-deep-containing str)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">x</span>)
    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="applied-name" href="xml-in-laml-1.html#cdata?" title="xml-in-laml">cdata?</a> x) (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#substring?" title="Manual: general">substring?</a> x str) str '()))
          ((<a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> x) (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#substring?" title="Manual: general">substring?</a> (<a class="applied-name" href="xml-in-laml-1.html#ast-text-deep" title="xml-in-laml">ast-text-deep</a> x) str) (<a class="applied-name" href="xml-in-laml-1.html#ast-text-deep" title="xml-in-laml">ast-text-deep</a> x) '()))
          (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> '()))))

<a name="ast-node"></a><a name="ast-node"></a><span><a href="../xml-in-laml.html#ast-node"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(ast-node)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">x</span>)
     (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> x) x '()))) 


 
<span class="comment">; ---------------------------------------------------------------------------------------------------------------
; Generated node child axis filtering procedures. The generated procedures can be applied on by location-step.</span><br />
<span class="comment">; Generation of node test procedures.
; Node test procedure occur at the filtering position in location steps.
; Node test procedures filter the results of a location step.
; Basically, a node test procedure takes three parameters: (1) The node, (2) its position within its sibling context, and (3) the number of the last sibling.
; A node test procedure returns a boolean result.</span><br />
<a name="nt:last"></a><a name="nt:last"></a><span><a href="../xml-in-laml.html#nt:last"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(nt:last)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">n</span> <span class="local-name-binding">p</span> <span class="local-name-binding">l</span>) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX235" title="R5RS Scheme form">=</a> p l)))

<a name="nt:child-number"></a><a name="nt:child-number"></a><span><a href="../xml-in-laml.html#nt:child-number"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(nt:child-number q)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">n</span> <span class="local-name-binding">p</span> <span class="local-name-binding">l</span>) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX235" title="R5RS Scheme form">=</a> p q)))

<a name="nt:child-name"></a><a name="nt:child-name"></a><span><a href="../xml-in-laml.html#nt:child-name"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(nt:child-name name)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">n</span> <span class="local-name-binding">p</span> <span class="local-name-binding">l</span>) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX200" title="R5RS Scheme form">equal?</a> name (<a class="applied-name" href="xml-in-laml-1.html#ast-element-name" title="xml-in-laml">ast-element-name</a> n))))

<a name="nt:attribute"></a><a name="nt:attribute"></a><span><a href="../xml-in-laml.html#nt:attribute"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(nt:attribute name value)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">n</span> <span class="local-name-binding">p</span> <span class="local-name-binding">l</span>) 
   (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> n)
    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">attr-prop-list</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-attributes" title="xml-in-laml">ast-attributes</a> n)))
      (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#find-in-property-list" title="Manual: general">find-in-property-list</a> name attr-prop-list)
          (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX200" title="R5RS Scheme form">equal?</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> value) (<a class="schemedoc-name" href="../../../../lib/man/general.html#get-prop" title="Manual: general">get-prop</a> name attr-prop-list))
          #f))
    #f)))

<a name="nt:for-which-predidate-holds"></a><a name="nt:for-which-predidate-holds"></a><span><a href="../xml-in-laml.html#nt:for-which-predidate-holds"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(nt:for-which-predidate-holds pred . location-steps)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">n</span> <span class="local-name-binding">p</span> <span class="local-name-binding">l</span>)
    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">res</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX411" title="R5RS Scheme form">apply</a> <a class="applied-name" href="xml-in-laml-1.html#match-ast" title="xml-in-laml">match-ast</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> n location-steps))))
      (pred res))))

<a name="nt:for-which"></a><a name="nt:for-which"></a><span><a href="../xml-in-laml.html#nt:for-which"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(nt:for-which . location-steps)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">n</span> <span class="local-name-binding">p</span> <span class="local-name-binding">l</span>)
    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">res</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX411" title="R5RS Scheme form">apply</a> <a class="applied-name" href="xml-in-laml-1.html#match-ast" title="xml-in-laml">match-ast</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> n location-steps))))
      (<a class="applied-name" href="xml-in-laml-1.html#does-exist?" title="xml-in-laml">does-exist?</a> res))))

<a name="does-exist?"></a><span class="comment">; Determines if x - the result of a location step - is considered as non-emtpy.</span><br /><a name="does-exist?"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(does-exist? x)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX331" title="R5RS Scheme form">list?</a> x) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> x)))
        ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX374" title="R5RS Scheme form">string?</a> x) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX304" title="R5RS Scheme form">not</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#blank-string?" title="Manual: general">blank-string?</a> x)))
        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#laml-error" title="Manual: general">laml-error</a> "does-exist?: Unknown type of argument of:" x))))

<a name="nt:exist-all"></a><span class="comment">; A filtering that tests if all location steps in the list of location paths succeed.
; Use and-steps on location-steps instead.</span><br /><a name="nt:exist-all"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(nt:exist-all . location-path-list)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX123" title="R5RS Scheme form">letrec</a> ((<span class="local-name-binding">and-fn</span> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">x</span> <span class="local-name-binding">y</span>) (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> x y))))
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">n</span> <span class="local-name-binding">p</span> <span class="local-name-binding">l</span>)
    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">res-list</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">location-step-list</span>) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX411" title="R5RS Scheme form">apply</a> <a class="applied-name" href="xml-in-laml-1.html#match-ast" title="xml-in-laml">match-ast</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> n location-step-list))) location-path-list))
           (<span class="local-name-binding">res-list-1</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> <a class="applied-name" href="xml-in-laml-1.html#does-exist?" title="xml-in-laml">does-exist?</a> res-list)))
      (<a class="schemedoc-name" href="../../../../lib/man/general.html#accumulate-right" title="Manual: general">accumulate-right</a> and-fn #t res-list-1)))))

<a name="nt:exist-some"></a><span class="comment">; A node test procedure that test if at least one of the location steps in the list of location paths succeeds.
; Use or-steps on location-steps instead.</span><br /><a name="nt:exist-some"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(nt:exist-some . location-path-list)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX123" title="R5RS Scheme form">letrec</a> ((<span class="local-name-binding">or-fn</span> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">x</span> <span class="local-name-binding">y</span>) (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX118" title="R5RS Scheme form">or</a> x y))))
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">n</span> <span class="local-name-binding">p</span> <span class="local-name-binding">l</span>)
    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">res-list</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">location-step-list</span>) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX411" title="R5RS Scheme form">apply</a> <a class="applied-name" href="xml-in-laml-1.html#match-ast" title="xml-in-laml">match-ast</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> n location-step-list))) location-path-list))
           (<span class="local-name-binding">res-list-1</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> <a class="applied-name" href="xml-in-laml-1.html#does-exist?" title="xml-in-laml">does-exist?</a> res-list)))
      (<a class="schemedoc-name" href="../../../../lib/man/general.html#accumulate-right" title="Manual: general">accumulate-right</a> or-fn #f res-list-1)))))
          



<div class="schemedoc-section-comment">;;; Element content models.
;;; The functions in this section make the content models of the XML elements available.
;;; As an example, this allows us to find out if an element is empty.
;;; The element content models are defined by the XML DTDs, and as such they are used for generation
;;; of the XML validation procedures.
;;; .section-id content-models</div>
<a name="content-model-map-of"></a><a name="content-model-map-of"></a><span><a href="../xml-in-laml.html#content-model-map-of"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(content-model-map-of language)</span>
 (<a class="schemedoc-name" href="../../../../lib/man/general.html#defaulted-get" title="Manual: general">defaulted-get</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-symbol" title="Manual: general">as-symbol</a> language) xml-in-laml-content-model-structures #f))

<a name="elment-name-of-content-model-structure"></a><span class="comment">; Selector functions of an entry in a content element map</span><br /><a name="elment-name-of-content-model-structure"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">elment-name-of-content-model-structure</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#make-selector-function" title="Manual: general">make-selector-function</a> 1 "elment-name-of-content-model-structure"))
<a name="content-model-of-content-model-structure"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">content-model-of-content-model-structure</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#make-selector-function" title="Manual: general">make-selector-function</a> 2 "content-model-of-content-model-structure"))

<a name="content-model-of"></a><a name="content-model-of"></a><span><a href="../xml-in-laml.html#content-model-of"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(content-model-of element-name language)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">content-model-map</span> (<a class="applied-name" href="xml-in-laml-1.html#content-model-map-of" title="xml-in-laml">content-model-map-of</a> language)))
    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> content-model-map
        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">content-model</span>
                (<a class="schemedoc-name" href="../../../../lib/man/general.html#binary-search-in-vector" title="Manual: general">binary-search-in-vector</a> 
                  content-model-map (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> element-name) <a class="applied-name" href="xml-in-laml-1.html#elment-name-of-content-model-structure" title="xml-in-laml">elment-name-of-content-model-structure</a> <a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX381" title="R5RS Scheme form">string=?</a> <a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX385" title="R5RS Scheme form">string&lt;=?</a>)))
          (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> content-model
              (<a class="applied-name" href="xml-in-laml-1.html#content-model-of-content-model-structure" title="xml-in-laml">content-model-of-content-model-structure</a> content-model)
              #f)
        )
        #f)))


<a name="register-xml-in-laml-content-models"></a><a name="register-xml-in-laml-content-models"></a><span><a href="../xml-in-laml.html#register-xml-in-laml-content-models"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(register-xml-in-laml-content-models language content-model-structure)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> xml-in-laml-content-model-structures (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> language content-model-structure) xml-in-laml-content-model-structures))
)


<span class="comment">; -----------------------------------------------------------------------------------------------------------------------------</span><br />
<div class="schemedoc-section-comment">;;; Action procedure map.   
;;; An action procedure map is a sorted associative vector that maps certain element names to 
;;; action procedures. 
;;; .section-id action-procedures</div>
<a name="action-procedure-map-of"></a><a name="action-procedure-map-of"></a><span><a href="../xml-in-laml.html#action-procedure-map-of"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(action-procedure-map-of language)</span>
  (<a class="schemedoc-name" href="../../../../lib/man/general.html#defaulted-get" title="Manual: general">defaulted-get</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-symbol" title="Manual: general">as-symbol</a> language) xml-in-laml-action-procedure-structures #f))

<a name="action-procedure-of-language"></a><a name="action-procedure-of-language"></a><span><a href="../xml-in-laml.html#action-procedure-of-language"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(action-procedure-of-language element-name language)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">action-procedure-map</span> (<a class="applied-name" href="xml-in-laml-1.html#action-procedure-map-of" title="xml-in-laml">action-procedure-map-of</a> language)))
    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> action-procedure-map
        (<a class="applied-name" href="xml-in-laml-1.html#action-procedure-of-map" title="xml-in-laml">action-procedure-of-map</a> element-name action-procedure-map)
        #f)))

<a name="action-procedure-of-map"></a><a name="action-procedure-of-map"></a><span><a href="../xml-in-laml.html#action-procedure-of-map"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(action-procedure-of-map element-name action-procedure-map)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">action-proc</span> 
         (<a class="schemedoc-name" href="../../../../lib/man/general.html#binary-search-in-vector" title="Manual: general">binary-search-in-vector</a> 
          action-procedure-map (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> element-name) <a class="applied-name" href="xml-in-laml-1.html#element-name-of-action-procedure-entry" title="xml-in-laml">element-name-of-action-procedure-entry</a> <a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX381" title="R5RS Scheme form">string=?</a> <a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX385" title="R5RS Scheme form">string&lt;=?</a>)))
   (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> action-proc
       (<a class="applied-name" href="xml-in-laml-1.html#action-procedure-of-action-procedure-entry" title="xml-in-laml">action-procedure-of-action-procedure-entry</a> action-proc)
       #f)))

<a name="register-xml-in-laml-action-procedures"></a><a name="register-xml-in-laml-action-procedures"></a><span><a href="../xml-in-laml.html#register-xml-in-laml-action-procedures"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(register-xml-in-laml-action-procedures language action-procedure-structure)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> xml-in-laml-action-procedure-structures (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> language action-procedure-structure) xml-in-laml-action-procedure-structures))
)

<a name="element-name-of-action-procedure-entry"></a><span class="comment">; Selector functions of an entry in an action procedure map</span><br /><a name="element-name-of-action-procedure-entry"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">element-name-of-action-procedure-entry</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#make-selector-function" title="Manual: general">make-selector-function</a> 1 "element-name-of-action-procedure-entry"))
<a name="action-procedure-of-action-procedure-entry"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">action-procedure-of-action-procedure-entry</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#make-selector-function" title="Manual: general">make-selector-function</a> 2 "action-procedure-of-action-procedure-entry"))

<a name="process-ast!"></a><a name="process-ast!"></a><span><a href="../xml-in-laml.html#process-ast!"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(process-ast! ast . optional-parameter-list)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">given-language</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#optional-parameter" title="Manual: general">optional-parameter</a> 1 optional-parameter-list (<a class="applied-name" href="xml-in-laml-1.html#ast-language" title="xml-in-laml">ast-language</a> ast)))
        (<span class="local-name-binding">action-map</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#optional-parameter" title="Manual: general">optional-parameter</a> 2 optional-parameter-list (<a class="applied-name" href="xml-in-laml-1.html#action-procedure-map-of" title="xml-in-laml">action-procedure-map-of</a> given-language)))
       )
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">el-name</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-element-name" title="xml-in-laml">ast-element-name</a> ast))
         (<span class="local-name-binding">element-content-items</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-subtrees" title="xml-in-laml">ast-subtrees</a> ast))
         (<span class="local-name-binding">action-proc-of-ast!</span> (<a class="applied-name" href="xml-in-laml-1.html#action-procedure-of-map" title="xml-in-laml">action-procedure-of-map</a> el-name action-map))
        )

    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> action-proc-of-ast! 
        (action-proc-of-ast! ast))

    (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX413" title="R5RS Scheme form">for-each</a> 
         (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">ast</span>) (<a class="applied-name" href="xml-in-laml-1.html#process-ast!" title="xml-in-laml">process-ast!</a> ast given-language action-map)) <span class="comment">; Notice that given-language is bound at root level</span><br />         (<a class="schemedoc-name" href="../../../../lib/man/general.html#filter" title="Manual: general">filter</a> <a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> element-content-items)))))

<span class="comment">; ----------------------------------------------------------------------------------------------------------------------------</span><br />



<div class="schemedoc-section-comment">;;; Expansion of delayed procedural content items.
;;; It is possible to embed a Scheme procedure (with a certain given signature) in an XML-in-LAML document.
;;; This allows for simple and direct handling of context-sensitive aspects of a document.
;;; The function expand-procedural-content-items-in-ast calls such procedures, hereby expanding the AST.</div>
<a name="expand-procedural-content-items-in-ast"></a><a name="expand-procedural-content-items-in-ast"></a><span><a href="../xml-in-laml.html#expand-procedural-content-items-in-ast"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(expand-procedural-content-items-in-ast ast)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="applied-name" href="xml-in-laml-1.html#has-procedural-content-items-deep?" title="xml-in-laml">has-procedural-content-items-deep?</a> ast)
      (<a class="applied-name" href="xml-in-laml-1.html#expand-procedural-content-items-in-ast-1" title="xml-in-laml">expand-procedural-content-items-in-ast-1</a> ast ast)
      ast))

<a name="expand-procedural-content-items-in-ast-1"></a><span class="comment">; Expand all delayed procedural content items (recursively) in ast relative to root-ast</span><br /><a name="expand-procedural-content-items-in-ast-1"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(expand-procedural-content-items-in-ast-1 ast root-ast)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">ast-content-items</span>  (<a class="applied-name" href="xml-in-laml-1.html#ast-subtrees" title="xml-in-laml">ast-subtrees</a> ast)))
   (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#filter" title="Manual: general">filter</a> <a class="applied-name" href="xml-in-laml-1.html#delayed-procedural-contents-element?" title="xml-in-laml">delayed-procedural-contents-element?</a> ast-content-items))  <span class="comment">; NO delayed constituents</span><br />       (<a class="applied-name" href="xml-in-laml-1.html#make-ast" title="xml-in-laml">make-ast</a>    <span class="comment">; just recursively expand sub asts</span><br />          (<a class="applied-name" href="xml-in-laml-1.html#ast-element-name" title="xml-in-laml">ast-element-name</a> ast)
          (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">content-item</span>)   <span class="comment">; recursively expand ASTs</span><br />                 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> content-item)
                         (<a class="applied-name" href="xml-in-laml-1.html#expand-procedural-content-items-in-ast-1" title="xml-in-laml">expand-procedural-content-items-in-ast-1</a> content-item root-ast))
                       (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> content-item)))
               ast-content-items)
          (<a class="applied-name" href="xml-in-laml-1.html#ast-attributes" title="xml-in-laml">ast-attributes</a> ast)
          (<a class="applied-name" href="xml-in-laml-1.html#ast-kind" title="xml-in-laml">ast-kind</a> ast)
          (<a class="applied-name" href="xml-in-laml-1.html#ast-language" title="xml-in-laml">ast-language</a> ast))
       (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">inversed-ast-content-items</span> (<a class="applied-name" href="xml-in-laml-1.html#inverse-laml-content-list-white-spacing" title="xml-in-laml">inverse-laml-content-list-white-spacing</a> ast-content-items)) <span class="comment">; Bring contents items back to original form (wrt. spacing) - as written in the document.</span><br />              (<span class="local-name-binding">expanded-ast-content-items</span>  <span class="comment">; Do the expansions of delayed procedural constituents</span><br />               (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">content-item</span>)
                      (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="applied-name" href="xml-in-laml-1.html#delayed-procedural-contents-element?" title="xml-in-laml">delayed-procedural-contents-element?</a> content-item)
                               (content-item root-ast ast))
                            (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> content-item)))
                    inversed-ast-content-items))
              (<span class="local-name-binding">attributes</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-attributes" title="xml-in-laml">ast-attributes</a> ast))
              (<span class="local-name-binding">combined-contents-and-attributes</span>  (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX334" title="R5RS Scheme form">append</a> expanded-ast-content-items attributes))  <span class="comment">; mix content and attributes - preparing for 'resorting'</span><br />              (<span class="local-name-binding">sorted-contents-attributes</span>    <span class="comment">; re-sort, splitting the expanded and patially reconstructed content list </span><br />                (<a class="applied-name" href="xml-in-laml-1.html#xml-sort-tag-parameters" title="xml-in-laml">xml-sort-tag-parameters</a> combined-contents-and-attributes (<a class="applied-name" href="xml-in-laml-1.html#ast-element-name" title="xml-in-laml">ast-element-name</a> ast) (<a class="applied-name" href="xml-in-laml-1.html#ast-language" title="xml-in-laml">ast-language</a> ast)))
              (<span class="local-name-binding">new-contents</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> sorted-contents-attributes))   <span class="comment">; new content, including constributions from expansion  </span><br />              (<span class="local-name-binding">new-recursively-expanded-content</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">content-item</span>) <span class="comment">; recursively expand ASTs</span><br />                                                       (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> content-item)
                                                                 (<a class="applied-name" href="xml-in-laml-1.html#expand-procedural-content-items-in-ast-1" title="xml-in-laml">expand-procedural-content-items-in-ast-1</a> content-item root-ast)) 
                                                             (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> content-item)))
                                                     new-contents)) 
              (<span class="local-name-binding">new-attributes</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> sorted-contents-attributes)) <span class="comment">; new attributes, including constributions from expansion  </span><br />             )

         <span class="comment">; Validate the expanded AST, which at this location is known to have had a real expansion of delayed procedural content items.</span><br />         (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">el-name</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-element-name" title="xml-in-laml">ast-element-name</a> ast))
                (<span class="local-name-binding">lang</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-language" title="xml-in-laml">ast-language</a> ast))
                (<span class="local-name-binding">validation-proc</span> (<a class="applied-name" href="xml-in-laml-1.html#validation-procedure-of" title="xml-in-laml">validation-procedure-of</a> el-name lang)))
           (validation-proc el-name new-attributes new-recursively-expanded-content <a class="applied-name" href="xml-in-laml-1.html#xml-check-language-overlap?" title="xml-in-laml">xml-check-language-overlap?</a>))

         (<a class="applied-name" href="xml-in-laml-1.html#make-ast" title="xml-in-laml">make-ast</a>
          (<a class="applied-name" href="xml-in-laml-1.html#ast-element-name" title="xml-in-laml">ast-element-name</a> ast)
          new-recursively-expanded-content
          new-attributes
          (<a class="applied-name" href="xml-in-laml-1.html#ast-kind" title="xml-in-laml">ast-kind</a> ast)
          (<a class="applied-name" href="xml-in-laml-1.html#ast-language" title="xml-in-laml">ast-language</a> ast))))))

<a name="has-procedural-content-items-deep?"></a><a name="has-procedural-content-items-deep?"></a><span><a href="../xml-in-laml.html#has-procedural-content-items-deep?"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(has-procedural-content-items-deep? ast)</span>
 (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX417" title="R5RS Scheme form">call-with-current-continuation</a> 
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">return</span>)
    (<a class="applied-name" href="xml-in-laml-1.html#has-procedural-content-items-deep-1?" title="xml-in-laml">has-procedural-content-items-deep-1?</a> ast return))))


<a name="has-procedural-content-items-deep-1?"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(has-procedural-content-items-deep-1? ast return)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">sub-content-items</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-subtrees" title="xml-in-laml">ast-subtrees</a> ast)))
    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#find-in-list" title="Manual: general">find-in-list</a> <a class="applied-name" href="xml-in-laml-1.html#delayed-procedural-contents-element?" title="xml-in-laml">delayed-procedural-contents-element?</a> sub-content-items)
        (return #t)
        (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX413" title="R5RS Scheme form">for-each</a> 
          (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">content-item</span>)
            (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> content-item)
                (<a class="applied-name" href="xml-in-laml-1.html#has-procedural-content-items-deep-1?" title="xml-in-laml">has-procedural-content-items-deep-1?</a> content-item return)))
          sub-content-items)))

  <span class="comment">; We did not find any procedure content item</span><br />  #f)

<a name="has-procedural-content-items?"></a><a name="has-procedural-content-items?"></a><span><a href="../xml-in-laml.html#has-procedural-content-items?"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(has-procedural-content-items? x)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> x)
          (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">sub-content-items</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-subtrees" title="xml-in-laml">ast-subtrees</a> x)))
            (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#find-in-list" title="Manual: general">find-in-list</a> <a class="applied-name" href="xml-in-laml-1.html#delayed-procedural-contents-element?" title="xml-in-laml">delayed-procedural-contents-element?</a> sub-content-items) #t #f)))
       ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX331" title="R5RS Scheme form">list?</a> x)
            (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#find-in-list" title="Manual: general">find-in-list</a> <a class="applied-name" href="xml-in-laml-1.html#delayed-procedural-contents-element?" title="xml-in-laml">delayed-procedural-contents-element?</a> x) #t #f))
       (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#laml-error" title="Manual: general">laml-error</a> "has-procedural-content-items? must be called on an XML-in-LAML AST or a list of content items" x))))
     
     


<a name="inverse-laml-content-list-white-spacing"></a><span class="comment">; Inverse the white spacing in content-items.
; Assume that content-items has a number of explicit-space values among its members (#t).
; No  explicit-space-suppress values (#f) are allowed to occur.
; Return a similar content items, corresponding to the one being input by the user, in which 
; only explicit-space-suppress values occur.
; This function takes a input a content items list as produced by  xml-sort-tag-parameters.
; It returns a content items list similar to the surface form, given by the LAML document author.</span><br /><a name="inverse-laml-content-list-white-spacing"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(inverse-laml-content-list-white-spacing content-items)</span>
  (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> content-items) '())
        (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="applied-name" href="xml-in-laml-1.html#iwssm-start" title="xml-in-laml">iwssm-start</a> content-items '()))  <span class="comment">; start inverse white space state machine</span><br />  ))

<a name="debug-inverse-space-state-machine?"></a><span class="comment">; -----------------------------------------------------------------         
; Start state machine: Inverse white space state machine - iwssm</span><br />
<a name="debug-inverse-space-state-machine?"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">debug-inverse-space-state-machine?</span> #f)

<a name="iwssm-start"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(iwssm-start lst res)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> <a class="applied-name" href="xml-in-laml-1.html#debug-inverse-space-state-machine?" title="xml-in-laml">debug-inverse-space-state-machine?</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#display-message" title="Manual: general">display-message</a> "start"))
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> lst)
     (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX335" title="R5RS Scheme form">reverse</a> res)
     (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">el</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#first" title="Manual: general">first</a> lst))  (<span class="local-name-binding">rest</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> lst)))
      (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> 
       ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX200" title="R5RS Scheme form">equal?</a> <a class="applied-name" href="xml-in-laml-1.html#explicit-space" title="xml-in-laml">explicit-space</a> el) (<a class="applied-name" href="xml-in-laml-1.html#iwssm-start" title="xml-in-laml">iwssm-start</a> rest res))
       (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="applied-name" href="xml-in-laml-1.html#iwssm-string-seen" title="xml-in-laml">iwssm-string-seen</a> el rest res))))))

<a name="iwssm-string-seen"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(iwssm-string-seen the-string lst res)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> <a class="applied-name" href="xml-in-laml-1.html#debug-inverse-space-state-machine?" title="xml-in-laml">debug-inverse-space-state-machine?</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#display-message" title="Manual: general">display-message</a> "string-seen"))
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> res (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> the-string res))

 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> lst)
     (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX335" title="R5RS Scheme form">reverse</a> res)
     (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">el</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#first" title="Manual: general">first</a> lst))  (<span class="local-name-binding">rest</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> lst)))
      (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX200" title="R5RS Scheme form">equal?</a> <a class="applied-name" href="xml-in-laml-1.html#explicit-space" title="xml-in-laml">explicit-space</a> el) (<a class="applied-name" href="xml-in-laml-1.html#iwssm-string-space-seen" title="xml-in-laml">iwssm-string-space-seen</a> rest res))
             (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="applied-name" href="xml-in-laml-1.html#iwssm-string-string-seen" title="xml-in-laml">iwssm-string-string-seen</a> el rest res))))))

<a name="iwssm-string-space-seen"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(iwssm-string-space-seen lst res)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> <a class="applied-name" href="xml-in-laml-1.html#debug-inverse-space-state-machine?" title="xml-in-laml">debug-inverse-space-state-machine?</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#display-message" title="Manual: general">display-message</a> "string-space-seen"))

 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> lst)
     (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX335" title="R5RS Scheme form">reverse</a> res)
     (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">el</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#first" title="Manual: general">first</a> lst))  (<span class="local-name-binding">rest</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> lst)))
      (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX200" title="R5RS Scheme form">equal?</a> <a class="applied-name" href="xml-in-laml-1.html#explicit-space" title="xml-in-laml">explicit-space</a> el) (<a class="applied-name" href="xml-in-laml-1.html#iwssm-string-space-seen" title="xml-in-laml">iwssm-string-space-seen</a> rest res))
             (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="applied-name" href="xml-in-laml-1.html#iwssm-string-seen" title="xml-in-laml">iwssm-string-seen</a> el rest res))))))

<a name="iwssm-string-string-seen"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(iwssm-string-string-seen the-string lst res)</span> 
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> <a class="applied-name" href="xml-in-laml-1.html#debug-inverse-space-state-machine?" title="xml-in-laml">debug-inverse-space-state-machine?</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#display-message" title="Manual: general">display-message</a> "string-string-seen"))
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX106" title="R5RS Scheme form">set!</a> res (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> the-string (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> <a class="applied-name" href="xml-in-laml-1.html#explicit-space-suppress" title="xml-in-laml">explicit-space-suppress</a> res)))

 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> lst)
     (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX335" title="R5RS Scheme form">reverse</a> res)
     (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">el</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#first" title="Manual: general">first</a> lst))  (<span class="local-name-binding">rest</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> lst)))
      (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX200" title="R5RS Scheme form">equal?</a> <a class="applied-name" href="xml-in-laml-1.html#explicit-space" title="xml-in-laml">explicit-space</a> el) (<a class="applied-name" href="xml-in-laml-1.html#iwssm-string-space-seen" title="xml-in-laml">iwssm-string-space-seen</a> rest res))
            (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="applied-name" href="xml-in-laml-1.html#iwssm-string-string-seen" title="xml-in-laml">iwssm-string-string-seen</a> el rest res))))))

<span class="comment">; End state machine
; -----------------------------------------------------------------         </span><br />


<div class="schemedoc-section-comment">;;; Other useful functions. 
;;; In this section there are non-mirror functions which are useful in in the context of XML and LAML.
;;; .section-id others-functions</div>

<a name="ast-to-parse-tree"></a><a name="ast-to-parse-tree"></a><span><a href="../xml-in-laml.html#ast-to-parse-tree"><img src="../../../../images/elucidator/small-prev.gif" title="SchemeDoc Manual entry" alt="" border="0" /></a> <br /></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(ast-to-parse-tree ast)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">pt</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-to-parse-tree-1" title="xml-in-laml">ast-to-parse-tree-1</a> ast)))
   (make-final-parse-tree 'html-tree (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX332" title="R5RS Scheme form">list</a> pt))))


<a name="ast-to-parse-tree-1"></a><span class="comment">; The function doing the real work in the ast to parse tree conversion.</span><br /><a name="ast-to-parse-tree-1"></a><span></span>(<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_7.html#IDX173" title="R5RS Scheme form">define</a> <span class="signature">(ast-to-parse-tree-1 ast)</span>
 (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX123" title="R5RS Scheme form">letrec</a> 
  ((<span class="local-name-binding">subtree-transform</span>     <span class="comment">; the function doing the overall ast to parse tree transformation</span><br />    (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">x</span>) 
     (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="applied-name" href="xml-in-laml-1.html#ast?" title="xml-in-laml">ast?</a> x) (<a class="applied-name" href="xml-in-laml-1.html#ast-to-parse-tree-1" title="xml-in-laml">ast-to-parse-tree-1</a> x))
           ((<a class="applied-name" href="xml-in-laml-1.html#cdata?" title="xml-in-laml">cdata?</a> x) x)
           ((<a class="applied-name" href="xml-in-laml-1.html#char-ref?" title="xml-in-laml">char-ref?</a> x) (<a class="applied-name" href="xml-in-laml-1.html#xml-render-char-ref" title="xml-in-laml">xml-render-char-ref</a> x))
           ((<a class="applied-name" href="xml-in-laml-1.html#forced-white-space?" title="xml-in-laml">forced-white-space?</a> x) " ")
           (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#laml-error" title="Manual: general">laml-error</a> "subtree-transform:" "Unknown subtree constituent" (<a class="schemedoc-name" href="../../../../lib/man/general.html#as-string" title="Manual: general">as-string</a> x)))))
    )

   (<span class="local-name-binding">explicit-space-splicing</span>  <span class="comment">; join explicit spaces, " ", to the left string constituent - to avoid empty lines after pretty printing.</span><br />     (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">parse-tree</span>)
       (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (tree-entry? parse-tree)
           (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">node</span> (root-of-parse-tree parse-tree))
                  (<span class="local-name-binding">subtrees</span> (subtrees-of-parse-tree parse-tree))
                  (<span class="local-name-binding">new-subtrees</span> (explicit-space-splicing-lst subtrees '()))
                 )
             (make-parse-tree node new-subtrees))
           parse-tree)
      ))

   (<span class="local-name-binding">explicit-space-splicing-lst</span>
     (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">subtree-list</span> <span class="local-name-binding">res-lst</span>)
       (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> subtree-list)
                  (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX335" title="R5RS Scheme form">reverse</a> res-lst))
             ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> subtree-list))   <span class="comment">; only a single element left - get finished</span><br />                (explicit-space-splicing-lst (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> subtree-list) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> subtree-list) res-lst)))
             ((<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX117" title="R5RS Scheme form">and</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX374" title="R5RS Scheme form">string?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> subtree-list)) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX374" title="R5RS Scheme form">string?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cadr</a> subtree-list)))   <span class="comment">; interesting case - there are two elements</span><br />                (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX200" title="R5RS Scheme form">equal?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cadr</a> subtree-list) " ")    <span class="comment">; join car and cadr via string-append</span><br />                    (explicit-space-splicing-lst (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cddr</a> subtree-list) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> subtree-list) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cadr</a> subtree-list)) res-lst))
                    (explicit-space-splicing-lst (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> subtree-list) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> subtree-list) res-lst))))
             (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (explicit-space-splicing-lst (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> subtree-list) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> subtree-list) res-lst))))))

   (<span class="local-name-binding">split-attribute-list</span>  <span class="comment">; split in html and css attributes</span><br />     (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">attr-lst</span>) (split-attribute-list-1 attr-lst '() '())))

   (<span class="local-name-binding">split-attribute-list-1</span>  <span class="comment">; iterative helping function</span><br />     (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">attr-lst</span> <span class="local-name-binding">html-attr-list</span> <span class="local-name-binding">css-attr-list</span>)
       (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> attr-lst) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX335" title="R5RS Scheme form">reverse</a> html-attr-list) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX335" title="R5RS Scheme form">reverse</a> css-attr-list)))
             ((<a class="applied-name" href="xml-in-laml-1.html#xml-css-key?" title="xml-in-laml">xml-css-key?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> attr-lst)) 
                (split-attribute-list-1 (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cddr</a> attr-lst) html-attr-list (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cadr</a> attr-lst) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> attr-lst) css-attr-list))))
             (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> 
                (split-attribute-list-1 (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cddr</a> attr-lst) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX325" title="R5RS Scheme form">cadr</a> attr-lst) (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> attr-lst) html-attr-list)) css-attr-list)))))

   (<span class="local-name-binding">to-css-string</span>     <span class="comment">; linearize all css attributes to a single string</span><br />     (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">css-attr-list</span>)
       (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX121" title="R5RS Scheme form">let</a> ((<span class="local-name-binding">css-attr-alist</span> (<a class="schemedoc-name" href="../../../../lib/man/general.html#propertylist-to-alist" title="Manual: general">propertylist-to-alist</a> css-attr-list)))
        (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX392" title="R5RS Scheme form">string-append</a>
         (<a class="schemedoc-name" href="../../../../lib/man/general.html#list-to-string" title="Manual: general">list-to-string</a> 
          (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> 
           (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX98" title="R5RS Scheme form">lambda</a> (<span class="local-name-binding">css-key-val</span>) (<a class="applied-name" href="xml-in-laml-1.html#xml-linearize-attribute-pair-css" title="xml-in-laml">xml-linearize-attribute-pair-css</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> css-key-val) (<a class="applied-name" href="xml-in-laml-1.html#xml-css-key?" title="xml-in-laml">xml-css-key?</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> css-key-val))))
           css-attr-alist)
          ";") ";"))))

   )
   (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX122" title="R5RS Scheme form">let*</a> ((<span class="local-name-binding">element-name</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-element-name" title="xml-in-laml">ast-element-name</a> ast))
          (<span class="local-name-binding">subtrees</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-subtrees" title="xml-in-laml">ast-subtrees</a> ast))
          (<span class="local-name-binding">attr-lst</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-attributes" title="xml-in-laml">ast-attributes</a> ast))  <span class="comment">; prop list format</span><br />          (<span class="local-name-binding">attr-list-normal-css</span> (split-attribute-list attr-lst))
          (<span class="local-name-binding">html-attr-list</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX321" title="R5RS Scheme form">car</a> attr-list-normal-css)) <span class="comment">; prop list format</span><br />          (<span class="local-name-binding">css-attr-list</span> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX322" title="R5RS Scheme form">cdr</a> attr-list-normal-css)) <span class="comment">; prop list format</span><br />          (<span class="local-name-binding">attr-lst-result</span> 
            (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX103" title="R5RS Scheme form">if</a> (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX330" title="R5RS Scheme form">null?</a> css-attr-list)
                html-attr-list
                (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> 'style (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX320" title="R5RS Scheme form">cons</a> (to-css-string css-attr-list) html-attr-list))))
          (<span class="local-name-binding">kind</span> (<a class="applied-name" href="xml-in-laml-1.html#ast-kind" title="xml-in-laml">ast-kind</a> ast))
   
         )
     (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">cond</a> ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> kind 'single)
              (make-tag-structure
               'start-end
               element-name 
               attr-lst-result))
           ((<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX199" title="R5RS Scheme form">eq?</a> kind 'double)
              (explicit-space-splicing
               (make-parse-tree 
                (make-tag-structure
                 'start
                 element-name 
                 attr-lst-result)
                (<a class="scheme-procedure-name" href="../../../../r5rs/r5rs_8.html#IDX412" title="R5RS Scheme form">map</a> subtree-transform subtrees))))
           (<a class="scheme-syntax-name" href="../../../../r5rs/r5rs_6.html#IDX110" title="R5RS Scheme form">else</a> (<a class="schemedoc-name" href="../../../../lib/man/general.html#laml-error" title="Manual: general">laml-error</a> "ast-to-parse-tree-1:" "Unknown kind of ast" kind))))))


</pre></font><div>&nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p> &nbsp; <p></p></div></body></html>